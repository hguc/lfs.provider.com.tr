Thu Mar 28 06:16:43 CET 2013
make[1]: Entering directory `/sources/vim73'
Starting make in the src directory.
If there are problems, cd to the src directory and run make there
cd src && make test
make[2]: Entering directory `/sources/vim73/src'
make -f Makefile vim
make[3]: Entering directory `/sources/vim73/src'
make[3]: `vim' is up to date.
make[3]: Leaving directory `/sources/vim73/src'
if test -n "yes" -a -f po/Makefile; then \
	cd po; make -f Makefile check VIM=../vim; \
fi
make[3]: Entering directory `/sources/vim73/src/po'
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq af.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"af.po" "af.po" 5409 lines, 133809 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch af.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq ca.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"ca.po" "ca.po" 6221 lines, 162354 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch ca.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq cs.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"cs.po" "cs.po" 4664 lines, 111014 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch cs.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq de.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"de.po" "de.po" 6135 lines, 157035 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch de.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq en_GB.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"en_GB.po" "en_GB.po" 298 lines, 9123 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch en_GB.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq eo.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"eo.po" "eo.po" 6566 lines, 165381 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch eo.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq es.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"es.po" "es.po" 8301 lines, 204406 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch es.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq fi.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"fi.po" "fi.po" 6545 lines, 162369 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch fi.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq fr.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"fr.po" "fr.po" 6819 lines, 183272 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch fr.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq ga.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"ga.po" "ga.po" 6521 lines, 164835 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch ga.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq it.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"it.po" "it.po" 6534 lines, 164888 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch it.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq ja.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"ja.po" "ja.po" 6212 lines, 153993 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch ja.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq ko.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"ko.po" "ko.po" 6296 lines, 150966 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch ko.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq ko.UTF-8.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"ko.UTF-8.po" "ko.UTF-8.po" 6296 lines, 166320 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch ko.UTF-8.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq nb.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"nb.po" "nb.po" 6184 lines, 150986 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch nb.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq no.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"no.po" "no.po" 6184 lines, 150986 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch no.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq pl.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"pl.po" "pl.po" 6542 lines, 163162 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch pl.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq pt_BR.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"pt_BR.po" "pt_BR.po" 6254 lines, 161262 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch pt_BR.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq ru.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"ru.po" "ru.po" 5237 lines, 166192 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch ru.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq sk.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"sk.po" "sk.po" 5837 lines, 147794 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch sk.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq sv.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"sv.po" "sv.po" 6166 lines, 149578 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch sv.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq uk.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"uk.po" "uk.po" 6762 lines, 204081 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch uk.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq vi.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"vi.po" "vi.po" 5214 lines, 144441 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch vi.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq zh_CN.UTF-8.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"zh_CN.UTF-8.po" "zh_CN.UTF-8.po" 6158 lines, 147888 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch zh_CN.UTF-8.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq zh_CN.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"zh_CN.po" "zh_CN.po" 6158 lines, 136865 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch zh_CN.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq zh_TW.UTF-8.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"zh_TW.UTF-8.po" "zh_TW.UTF-8.po" 5300 lines, 127707 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch zh_TW.UTF-8.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq zh_TW.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"zh_TW.po" "zh_TW.po" 5293 lines, 117738 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch zh_TW.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq cs.cp1250.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"cs.cp1250.po" "cs.cp1250.po" 4664 lines, 111022 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch cs.cp1250.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq ja.sjis.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"ja.sjis.po" "ja.sjis.po" 6212 lines, 154089 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch ja.sjis.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq pl.cp1250.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"pl.cp1250.po" "pl.cp1250.po" 6542 lines, 163158 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch pl.cp1250.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq pl.UTF-8.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"pl.UTF-8.po" "pl.UTF-8.po" 6542 lines, 165660 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch pl.UTF-8.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq ru.cp1251.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"ru.cp1251.po" "ru.cp1251.po" 5237 lines, 131483 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch ru.cp1251.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq sk.cp1250.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"sk.cp1250.po" "sk.cp1250.po" 5837 lines, 147790 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch sk.cp1250.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq uk.cp1251.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"uk.cp1251.po" "uk.cp1251.po" 6762 lines, 165690 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch uk.cp1251.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq zh_CN.cp936.po
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[?25l[25;1H"zh_CN.cp936.po" "zh_CN.cp936.po" 6158 lines, 136877 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H
[?1l>[?12l[?25h[?1049ltouch zh_CN.cp936.ck
make[3]: Leaving directory `/sources/vim73/src/po'
if test vim != vim -a ! -r vim; then \
	ln -s vim vim; \
fi
cd testdir; make -f Makefile  VIMPROG=../vim 
make[3]: Entering directory `/sources/vim73/src/testdir'
rm -f test.log
rm -f test1.failed tiny.vim small.vim mbyte.vim mzscheme.vim test.ok X* viminfo
../vim -u unix.vim -U NONE --noplugin -s dotest.in test1.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test1.in" 45 lines, 1676 characters[2;1HFirst a simple test to check if the test script works.

If Vim was not compiled with the +eval feature, the small.vim script will be
set to copy the test.ok file to test.out, so that it looks like the test
succeeded.  Otherwise an empty small.vim is written.  small.vim is sourced by
tests that require the +eval feature or other features that are missing in the
small version.

If Vim was not compiled with the +windows feature, the tiny.vim script will be
set like small.vim above.  tiny.vim is sourced by tests that require the
+windows feature or other features that are missing in the tiny version.

If Vim was not compiled with the +multi_byte feature, the mbyte.vim script will
be set like small.vim above.  mbyte.vim is sourced by tests that require the
+multi_byte feature.
Similar logic is applied to the +mzscheme feature, using mzscheme.vim.

STARTTEST
:" Write a single line to test.out to check if testing works at all.
:%d
athis is a test[34m^[[m:w! test.out
:" Create small.vim and tiny.vim empty, create mbyte.vim to skip the test.
0D:w! small.vim[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[19;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 24 lines, 801 characters written[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[20;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[20M[1;25r[5;1H:w! tiny.vim
ae! test.ok
w! test.out
qa!
[34m^[[m:w! mbyte.vim
:w! mzscheme.vim
:" If +multi_byte feature supported, make mbyte.vim empty.
:if has("multi_byte") | sp another | w! mbyte.vim | q | endif
:" If +mzscheme feature supported, make mzscheme.vim empty.
:if has("mzscheme") | sp another | w! mzscheme.vim | q | endif
:" If +eval feature supported quit here, leaving tiny.vim and small.vim empty.
:" Otherwise write small.vim to skip the test.
:if 1 | q! | endif
:w! small.vim
:" If +windows feature not supported :sp will fail and tiny.vim will be
:" written to skip the test.
:sp another
:wq! tiny.vim
:qa!
ENDTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Write a single line to test.out to check if testing works at all.[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h%d[?25l[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [m[25;1H--No lines in buffer--[1;1H[?12l[?25h[?25lthis is a test[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 1 line, 15 characters written[1;14H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Create small.vim and tiny.vim empty, create mbyte.vim to skip the test.[?25l[1;14H[?12l[?25h[?25l[1;1H[K[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw! small.vim[?25l"small.vim" [25;13H[K[25;13H[New File] 1 line, 1 character written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw! tiny.vim[?25l"tiny.vim" [25;12H[K[25;12H[New File] 1 line, 1 character written[1;1H[?12l[?25h[?25le! test.ok
w! test.out[2;12H[K[3;1Hqa![3;4H[K[4;1H[K[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw! mbyte.vim[?25l"mbyte.vim" [25;13H[K[25;13H[New File] 4 lines, 28 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw! mzscheme.vim[?25l"mzscheme.vim" [25;16H[K[25;16H[New File] 4 lines, 28 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" If +multi_byte feature supported, make mbyte.vim empty.[?25l[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hif has("multi_byte") | sp another | w! mbyte.vim | q | endif[?25l"another" [New File][25;21H[K[25;1H
"mbyte.vim" 0 lines, 0 characters written[1;1H[L[1;1He! test.ok[25;1H[K[4;1H[?12l[?25h[?25l[25;1H:[?12l[?25h" If +mzscheme feature supported, make mzscheme.vim empty.[?25l[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hif has("mzscheme") | sp another | w! mzscheme.vim | q | endif[?25l[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" If +eval feature supported quit here, leaving tiny.vim and small.vim empty.[?25l[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Otherwise write small.vim to skip the test.[?25l[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hif 1 | q! | endif[?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* viminfo
rm -rf test2.failed test.ok test.out X* viminfo
cp test2.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test2.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test2.in" 29 lines, 717 characters[2;1HThis is a test if a URL is recognized by "gf", with the cursor before and
after the "://".  Also test ":\\".

STARTTEST
:so small.vim
/^first
/tmp
:call append(0, expand("<cfile>"))
/^second
/URL
:call append(1, expand("<cfile>"))
:if has("ebcdic")
: set isf=@,240-249,/,.,-,_,+,,,$,:,~,\
:else
: set isf=@,48-57,/,.,-,_,+,,,$,:,~,\
:endif
/^third
/name
:call append(2, expand("<cfile>"))
/^fourth
/URL
:call append(3, expand("<cfile>"))
5GdG:wq! test.out[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[5;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[6;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 19 lines, 336 characters written[6;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[6;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[24;1H
[1;25r[24;1HENDTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hfirst test for URL://machine.name/tmp/vimtest2a and other text[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^first[?25l[31msearch hit BOTTOM, continuing at TOP[24;1H[?12l[?25h[?25l[m[25;1H[K[25;1H/[?12l[?25htmp[?25l[24;35H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall append(0, expand("<cfile>"))[?25l[24;35H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^second[?25l[1;24r[24;1H
[1;25r[24;1Hsecond test for URL://machine.name/tmp/vimtest2b. And other text[25;1H[K[24;1H[?12l[?25h[?25l
/[?12l[?25hURL[?25l[24;17H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall append(1, expand("<cfile>"))[?25l[24;17H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hif has("ebcdic")[?25l
:  [?12l[?25h: set isf=@,240-249,/,.,-,_,+,,,$,:,~,\
[?25l:  [?12l[?25h:else
[?25l:  [?12l[?25h: set isf=@,48-57,/,.,-,_,+,,,$,:,~,\
[?25l:  [?12l[?25h:endif[1;1H[4L[?25l[2;1HSTARTTEST
:so small.vim
/^first[25;1H[K[24;17H[?12l[?25h[?25l
/[?12l[?25h^third[?25l[1;24r[24;1H
[1;25r[24;1Hthird test for URL:\\machine.name\vimtest2c and other text[25;1H[K[24;1H[?12l[?25h[?25l
/[?12l[?25hname[?25l[24;30H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall append(2, expand("<cfile>"))[?25l[24;30H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^fourth[?25l[1;24r[24;1H
[1;25r[24;1Hfourth test for URL:\\machine.name\tmp\vimtest2d, and other text[25;1H[K[24;1H[?12l[?25h[?25l
/[?12l[?25hURL[?25l[24;17H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall append(3, expand("<cfile>"))[?25l[24;17H[?12l[?25h[?25l[1;24r[1;1H[5L[1;25r[2;1HThis is a test if a URL is recognized by "gf", with the cursor before and
after the "://".  Also test ":\\".

STARTTEST[25;1H[K[1;1H[?12l[?25h[?25l[25;1H29 fewer lines[27m[m[H[2J[1;1HURL:\\machine.name\tmp\vimtest2d
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [m[25;1H29 fewer lines[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hwq! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 4 lines, 128 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test3.failed test.ok test.out X* viminfo
cp test3.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test3.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test3.in" 1320 lines, 13743 characters[1;1H/* vim: set cin ts=4 sw=4 : */

Test for 'cindent'

STARTTEST
:so small.vim
:set nocompatible viminfo+=nviminfo modeline
:edit[16C" read modeline
/start of AUTO
=/end of AUTO
ENDTEST

/* start of AUTO matically checked vim: set ts=4 : */
{[15;9Hif (test)[16;17Hcmd1;[17;9Hcmd2;
}

{[21;9Hif (test)[22;17Hcmd1;[23;9Helse[24;17Hcmd2;[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1H/* vim: set cin ts=4 sw=4 : */[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[5;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[6;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 5 lines, 125 characters written[6;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[6;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[11;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[12;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[12;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset nocompatible viminfo+=nviminfo modeline[?25l[12;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hedit                " read modeline[?25l"test3.in"[25;22H[K[25;12H1320L, 13743C[15;5Hif (test)[15;14H[K[16;9Hcmd1;[16;17H[K[17;5Hcmd2;[17;10H[K[21;5Hif (test)[21;14H[K[22;9Hcmd1;[22;17H[K[23;5Helse[23;9H[K[24;9Hcmd2;[24;17H[K[12;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25hstart of AUTO[?25l[13;4H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25hend of AUTO[?25l789 lines to indent...750065055045035025015050 lines to indent... 790 lines indented [25;20H[K[13;1H[?12l[?25h[?25l[25;1H[K[25;1H/^STARTTEST[27m[m[H[2J[1;1H}

main()
{
    char    foo[] = "/*";
    /* as[7;8Hdf */
    hello
}
/* end of AUTO */

STARTTEST
:set tw=0 wm=60 columns=80 noai fo=croq
/serious/e
a about life, the universe, and the rest[34m^[[m
ENDTEST

{

/* this is
 * a real serious important big
 * comment
 */
    /* insert " about life, the universe, and the rest" after "serious" */[12;1H[?12l[?25h
[?25l[25;1H:set ff=unix cpo-=A[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3L, 93C written[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[13;1H[?12l[?25h[?25l[25;1H/ENDTEST/+-1[25;13H[K[25;1H[15;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[16;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset tw=0 wm=60 columns=80 noai fo=croq[?25l[27m[m[H[2J[1;1H}

main()
{
    char    foo[] = "/*";
    /* as[7;8Hdf */
    hello
}
/* end of AUTO */

STARTTEST
:set tw=0 wm=60 columns=80 noai fo=croq
/serious/e
a about life, the universe, and the rest[34m^[[m
ENDTEST

{

/* this is
 * a real serious important big
 * comment
 */
    /* insert " about life, the universe, and the rest" after "serious" */[16;1H[?12l[?25h[?25l[25;1H/[?12l[?25hserious/e[?25l[21;17H[?12l[?25h[?25l[25;1H[1m-- INSERT --[m[25;1H[K[21;19H[K[22;4Habout life, the
 * universe, and the
 * rest important big[24;23H[K[24;7H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;2H* comment[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[5M[1;25r[20;2H*/
    /* insert " about life, the universe, and the rest" after "serious" */
}

STARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H:set nocin[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H6L, 78C written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[1;1H[5M[1;25r[20;1H/comments
joabout life[34m^[[m/happens
jothere[34m^[[m/below
oline[34m^[[m/this
Ohello[34m^[[m[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset nocin[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25hcomments[?25l[1;24r[1;1H[4M[1;25r[22;1H{
    /*[24;6H* Testing for comments, without 'cin' set[25;1H[K[24;20H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;6H*/[?12l[?25h[?25l
[1m-- INSERT --[m[25;1H[K[1;24r[24;1H
[1;25r[24;1Habout life[?12l[?25h[?25l
/[?12l[?25hhappens[?25l[1;24r[1;1H[3M[1;25r[23;1H/*
* what happens here?[25;1H[K[24;8H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H*/[?12l[?25h[?25l
[1m-- INSERT --[m[25;1H[K[1;24r[24;1H
[1;25r[24;1Hthere[?12l[?25h[?25l
/[?12l[?25hbelow[?25l[1;24r[1;1H[3M[1;25r[23;5H/*[24;8Hthe end of the comment, try inserting a line below */[25;1H[K[24;53H[?12l[?25h[?25l
[1m-- INSERT --[m[25;1H[K[1;24r[24;1H
[1;25r[24;1Hline[?12l[?25h[?25l
/[?12l[?25hthis[?25l[1;24r[1;1H[3M[1;25r[23;9H/* how about[24;25Hthis one */[25;1H[K[24;25H[?12l[?25h[?25l
[1m-- INSERT --[m[25;1H[K[24;1Hhello[24;25H[K[24;5H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;25Hthis one */[24;8H[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[3M[1;25r[22;1H}

STARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H:set cin[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3L, 18C written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[1;1H[2M[1;25r[23;1H/vec2
==[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cin[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25hvec2[?25l[1;24r[1;1H[5M[1;25r[21;1H{
    var = this + that + vec[0] * vec[0][23;23H+ vec[1] * vec[1][24;23H+ vec2[2] * vec[2];[25;1H[K[24;25H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H}[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H:set cin[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H5L, 51C written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[1;1H[4M[1;25r[21;1H:set cino=}4
/testing1
k2==/testing2
k2==[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cin[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cino=}4[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25htesting1[?25l[1;24r[1;1H[8M[1;25r[18;1H{[19;9Hasdf asdflkajds f;
    if (tes & ting) {[21;9Hasdf asdf asdf ;[22;9Hasdfa sdf asdf;[23;9H}
    testing1;[25;1H[K[24;5H[?12l[?25h[23;8H [?25l

/[?12l[?25htesting2[?25l[1;24r[1;1H[6M[1;25r[19;5Hif (tes & ting)
    {[21;9Hasdf asdf asdf ;[22;9Hasdfa sdf asdf;[23;9H}
    testing2;[25;1H[K[24;5H[?12l[?25h[23;8H [24;9H[?25l
/^STARTTEST[1;24r[1;1H[3M[1;25r[22;1H}

STARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H:set cin[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H4L, 36C written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[1;1H[3M[1;25r[22;1H:set cino=(0,)20
/main
=][[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cin[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cino=(0,)20[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25hmain[?25l[1;24r[1;1H[2M[1;25r[24;1Hmain ( int first_par, /*[25;1H[K[24;1H[?12l[?25h[?25l
19 lines to indent...20[7Cindented [25;19H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;24H* Comment for[25;1H[K[24;4H[?12l[?25h[?25l
/^STARTTEST[27m[m[H[2J[1;23H* Comment for[2;23H* first par[3;23H*/[4;11Hsecond_par /*[5;23H* Comment for[6;23H* second par[7;23H*/[8;9H);

}

STARTTEST
:set cin
:set cino=
]]=][
ENDTEST

{
    do
    {[21;9Hif ()[22;9H{[23;13Hif ()[24;17Hasdf;[12;1H[?12l[?25h
[?25l[25;1H:set ff=unix cpo-=A[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3L, 26C written[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[13;1H[?12l[?25h[?25l[25;1H/ENDTEST/+-1[25;13H[K[25;1H[15;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[16;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cin[?25l[16;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cino=[?25l[16;1H[?12l[?25h

[?25l[25;1H11 lines to indent...12[7Cindented [25;19H[K[18;1H[?12l[?25h
   [?25l[25;1H[K[25;1H/^STARTTEST[1;24r[1;1H[8M[1;25r[17;13Helse[18;17Hasdf;[19;9H}
    } while ();
    cmd;[8C/* this should go under the } */
}

STARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H]]=][[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H1L, 6C written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST/+-1[25;13H[K[25;1H[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HENDTEST[25;1H[K[24;1H[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[1;24r[1;1H[3M[1;25r[23;1Hvoid f()
{[25;1H[K[24;1H[?12l[?25h[?25l
8 lines to indent...9[7Cindented [25;18H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;5Hif ( k() ) {[25;1H[K[24;4H[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[10M[1;25r[15;9Hl();[17;5H} else { /* Start (two words) end */[18;9Hm();
    }[21;5Hn();
}

STARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H:set cino={s,e-s[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 23C written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H]]=][[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cino={s,e-s[?25l[24;1H[?12l[?25h[?25l[1;24r[1;1H[3M[1;25r[23;1Hvoid f()
{[25;1H[K[24;1H[?12l[?25h[?25l
7 lines to indent...8[7Cindented [25;18H[K[24;1H    {[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;5Hif ( k() )[25;1H[K[24;5H[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[9M[1;25r[16;9H{[17;9Hl();[18;9H} else { /* Start (two words) end */[19;9Hm();[20;9H}
    n();    /* should be under the if () */
}

STARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H:set cino={s,fs[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 25C written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H]]=/ foo[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cino={s,fs[?25l[24;1H[?12l[?25h[?25l[1;24r[1;1H[3M[1;25r[23;1Hvoid bar(void)
{[25;1H[K[24;1H[?12l[?25h[?25l
/[?12l[?25h foo[?25l30 lines to indent...31[7Cindented [25;19H[K[24;1H    {[?12l[?25h[?25l[25;1H[K[25;1H/^STARTTEST[27m[m[H[2J[1;1Hvoid func(void)
    {
    a = 1;[4;9H{[5;9Hb = 2;[6;9H}
    c = 3;
    d = 4;
    }
/* foo */

STARTTEST
:set cino=
/while
ohere[34m^[[m
ENDTEST

a()
{
  do {
    a = a +[22;7Ha;
  } while ( a );[8C/* add text under this line */
    if ( a )[12;1H[?12l[?25h
[?25l[25;1H:set ff=unix cpo-=A[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3L, 25C written[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[13;1H[?12l[?25h[?25l[25;1H/ENDTEST/+-1[25;13H[K[25;1H[15;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[16;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cino=[?25l[16;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25hwhile[?25l[23;5H[?12l[?25h[?25l

[1m-- INSERT --[m[25;1H[K[24;3Hhere[24;8H[K[24;6H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;5Hif ( a )    i[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[4M[1;25r[21;7Ha;
}

STARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H:set cino= com=[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3L, 109C written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[1;1H[3M[1;25r[22;1H/comment
olabel2: b();[34m^M[mlabel3 /* post */:[34m^M[m/* pre */ label4:[34m^M[mf(/*com*/);[34m^M[mif (/*com*/)[34m^^[24;1HM[mcmd();[34m^[[m[25;1H[K[23;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cino= com=[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25hcomment[?25l[1;24r[1;1H[6M[1;25r[20;1Ha()
{
label1:[23;13H/* hmm */[24;13H// comment[25;1H[K[24;16H[?12l[?25h[?25l
[1m-- INSERT --[m[25;1H[K[1;24r[1;1H[6M[1;25r[19;1Hlabel2: b();
label3 /* post */:
/* pre */ label4:[22;9Hf(/*com*/);[23;9Hif (/*com*/)[24;13Hcmd();[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H}[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H:set comments& comments^=s:/*,m:**,ex:*/[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3L, 53C written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[1;1H[2M[1;25r[23;1H/simple
=5j[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset comments& comments^=s:/*,m:**,ex:*/[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25hsimple[?25l[1;24r[1;1H[4M[1;25r[22;1H/*
  * A simple comment
   */[25;1H[K[23;7H[?12l[?25h[?25l

5 lines to indent...6[7Cindented [25;18H[K[23;2H* A simple comment[23;20H[K[24;2H*/[24;4H[K[23;2H[?12l[?25h
 [?25l[25;1H[K[25;1H/^STARTTEST[1;24r[1;1H[6M[1;25r[20;1H/*
** A different comment
*/

STARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H:set cino=c0[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3L, 70C written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[1;1H[2M[1;25r[23;1H:set comments& comments-=s1:/* comments^=s0:/*
2kdd]]=][[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cino=c0[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset comments& comments-=s1:/* comments^=s0:/*[?25l[24;1H[?12l[?25h[22;1H[?25l2kdd]]=][[22;10H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[23;1Hvoid f()
{[25;1H[K[24;1H[?12l[?25h[?25l
4 lines to indent...5[7Cindented [25;18H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[25;1H[K[24;1H[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[6M[1;25r[19;5H/*********[20;7HA comment.
    *********/
}

STARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H:set cino=c0,C1[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3L, 73C written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[1;1H[2M[1;25r[23;1H:set comments& comments-=s1:/* comments^=s0:/*
2kdd]]=][[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cino=c0,C1[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset comments& comments-=s1:/* comments^=s0:/*[?25l[24;1H[?12l[?25h[22;1H[?25l2kdd]]=][[22;10H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[23;1Hvoid f()
{[25;1H[K[24;1H[?12l[?25h[?25l
4 lines to indent...5[7Cindented [25;18H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[25;1H[K[24;1H[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[6M[1;25r[19;5H/*********
    A comment.
    *********/
}

STARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H:set cino=[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 17C written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H]]=][[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cino=[?25l[24;1H[?12l[?25h[?25l[1;24r[1;1H[3M[1;25r[23;1Hvoid f()
{[25;1H[K[24;1H[?12l[?25h[?25l
5 lines to indent...6[7Cindented [25;18H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;5Hc = c1 &&[25;1H[K[24;4H[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[7M[1;25r[18;9H([19;10Hc2 ||[20;10Hc3[21;9H) && c4;
}

STARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H:set cino=(s[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 23C written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H2kdd]]=][[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cino=(s[?25l[24;1H[?12l[?25h[22;1H[?25l2kdd]]=][[22;10H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[23;1Hvoid f()
{[25;1H[K[24;1H[?12l[?25h[?25l
5 lines to indent...6[7Cindented [25;18H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;5Hc = c1 &&[25;1H[K[24;4H[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[7M[1;25r[18;9H([19;10Hc2 ||[20;10Hc3[21;9H) && c4;
}

STARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H:set cino=(s,U1[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 28C written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H2kdd]]=][[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cino=(s,U1  [?25l[24;1H[?12l[?25h[22;1H[?25l2kdd]]=][[22;10H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[23;1Hvoid f()
{[25;1H[K[24;1H[?12l[?25h[?25l
5 lines to indent...6[7Cindented [25;18H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;5Hc = c1 &&[25;1H[K[24;4H[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[7M[1;25r[18;9H([19;13Hc2 ||[20;13Hc3[21;9H) && c4;
}

STARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H:set cino=(0[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 23C written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H2kdd]]=][[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cino=(0[?25l[24;1H[?12l[?25h[22;1H[?25l2kdd]]=][[22;10H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[23;1Hvoid f()
{[25;1H[K[24;1H[?12l[?25h[?25l
4 lines to indent...5[7Cindented [25;18H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;5Hif (   c1[25;1H[K[24;4H[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[6M[1;25r[19;12H&& (   c2[20;19H|| c3))[21;9Hfoo;
}

STARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H:set cino=(0,w1[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 28C written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H2kdd]]=][[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cino=(0,w1  [?25l[24;1H[?12l[?25h[22;1H[?25l2kdd]]=][[22;10H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[23;1Hvoid f()
{[25;1H[K[24;1H[?12l[?25h[?25l
4 lines to indent...5[7Cindented [25;18H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;5Hif (   c1[25;1H[K[24;4H[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[6M[1;25r[19;9H&& (   c2[20;13H|| c3))[21;9Hfoo;
}

STARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H:set cino=(s[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 23C written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H2kdd]]=][[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cino=(s[?25l[24;1H[?12l[?25h[22;1H[?25l2kdd]]=][[22;10H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[23;1Hvoid f()
{[25;1H[K[24;1H[?12l[?25h[?25l
8 lines to indent...9[7Cindented [25;18H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;5Hc = c1 && ([25;1H[K[24;4H[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[10M[1;25r[15;9Hc2 ||[16;9Hc3[17;9H) && c4;
    if ([19;9Hc1 && c2[20;8H)[21;9Hfoo;
}

STARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H:set cino=(s,m1[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 28C written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H2kdd]]=][[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cino=(s,m1  [?25l[24;1H[?12l[?25h[22;1H[?25l2kdd]]=][[22;10H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[23;1Hvoid f()
{[25;1H[K[24;1H[?12l[?25h[?25l
8 lines to indent...9[7Cindented [25;18H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;5Hc = c1 && ([25;1H[K[24;4H[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[10M[1;25r[15;9Hc2 ||[16;9Hc3
    ) && c4;
    if ([19;9Hc1 && c2
    )[21;9Hfoo;
}

STARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H:set cino=b1[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 23C written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H2kdd]]=][[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cino=b1[?25l[24;1H[?12l[?25h[22;1H[?25l2kdd]]=][[22;10H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[23;1Hvoid f()
{[25;1H[K[24;1H[?12l[?25h[?25l
9 lines to indent...10 lines indented [25;19H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;5Hswitch (x)[25;1H[K[24;4H[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[11M[1;25r[14;5H{[15;9Hcase 1:[16;13Ha = b;[17;9Hbreak;[18;9Hdefault:[19;13Ha = 0;[20;9Hbreak;
    }
}

STARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H:set cino=(0,W5[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 26C written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H2kdd]]=][[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cino=(0,W5[?25l[24;1H[?12l[?25h[22;1H[?25l2kdd]]=][[22;10H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[23;1Hvoid f()
{[25;1H[K[24;1H[?12l[?25h[?25l
10 lines to indent...11[7Cindented [25;19H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;5Hinvokeme([25;1H[K[24;4H[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[12M[1;25r[13;10Hargu,[14;10Hment);
    invokeme([16;10Hargu,[17;10Hment[18;10H);
    invokeme(argu,[20;14Hment[21;13H);
}

STARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H:set cino=/6[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 23C written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H2kdd]]=][[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cino=/6[?25l[24;1H[?12l[?25h[22;1H[?25l2kdd]]=][[22;10H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[23;1Hvoid f()
{[25;1H[K[24;1H[?12l[?25h[?25l
3 lines to indent...4[7Cindented [25;18H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;5Hstatement;[25;1H[K[24;4H[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[5M[1;25r[20;11H// comment 1[21;11H// comment 2
}

STARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H:set cino=[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3L, 34C written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[1;1H[2M[1;25r[23;1H2kdd]]/comment 1/+1
==[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cino=[?25l[24;1H[?12l[?25h[22;1H[?25l==[22;3H[K[23;1HENDTEST[24;1H[K[22;1H[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[23;1Hvoid f()
{[25;1H[K[24;1H[?12l[?25h[?25l
/[?12l[?25hcomment 1/+1[?25l[1;24r[1;1H[3M[1;25r[22;5Hstatement;[23;8H// comment 1
    // comment 2[25;1H[K[24;4H[?12l[?25h[?25l    // comment 2[24;8H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H}[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H:set cino=g0[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 23C written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H2kdd]]=][[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cino=g0[?25l[24;1H[?12l[?25h[22;1H[?25l2kdd]]=][[22;10H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[23;1Hclass CAbc
{[25;1H[K[24;1H[?12l[?25h[?25l
6 lines to indent...7[7Cindented [25;18H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;5Hint Test() { return FALSE; }[25;1H[K[24;4H[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[8M[1;25r[18;1Hpublic: // comment
    void testfall();
protected:
    void testfall();
};

STARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H:set cino=+20[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 24C written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H2kdd]]=][[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cino=+20[?25l[24;1H[?12l[?25h[22;1H[?25l2kdd]]=][[22;10H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?12l[?25h[?25l[1;24r[1;1H[3M[1;25r[22;5Hvoid
foo()
{[25;1H[K[24;1H[?12l[?25h[?25l
4 lines to indent...5[7Cindented [25;18H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;5Hif (a)[25;1H[K[24;4H[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[6M[1;25r[19;5H{
    } else[21;9Hasdf;
}

STARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H:set cino=(0,W2s[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 27C written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H2kdd]]=][[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cino=(0,W2s[?25l[24;1H[?12l[?25h[22;1H[?25l2kdd]]=][[22;10H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H{[25;1H[K[24;1H[?12l[?25h[?25l
34 lines to indent...35[7Cindented [25;19H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;5Haverylongfunctionnamelongfunctionnameaverylongfunctionname()->asd([25;1H[K[24;4H[?12l[?25h[?25l
/^STARTTEST[27m[m[H[2J[1;21Hdec)->asdfasdfasdf([2;29Hasdfadsf,[3;29Hasdfasdf,[4;29Hasdfasdf,[5;29H),[6;13Hfunc(asdfadf,[7;18Hasdfasdf),[8;13Hasdasdf[9;13H);
}

STARTTEST
:set cino=M1
2kdd]]=][
ENDTEST

int main ()
{
    if (cond1 &&[20;13Hcond2[21;13H)[22;9Hfoo;
}[12;1H[?12l[?25h
[?25l[25;1H:set ff=unix cpo-=A[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 23C written[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[13;1H[?12l[?25h[?25l[25;1H/ENDTEST/+-1[25;13H[K[25;1H[14;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[15;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cino=M1[?25l[15;1H[?12l[?25h[13;1H[?25l[13;24r[24;1H
[1;25r[24;1HSTARTTEST[25;1H[K[13;1H[?12l[?25h[17;1H[?25l[25;1H4 lines to indent...5[7Cindented [25;18H[K[17;1H[?12l[?25h
   [?25l[25;1H[K[25;1H/^STARTTEST[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H:g/^STARTTEST/.,/^ENDTEST/d[25;1H[K[24;1H[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 61C written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST/+-1[25;13H[K[25;1H[23;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hg/^STARTTEST/.,/^ENDTEST/d[?25l128 fewer lines[25;16H[K[1;16H);[1;29H[K[2;29H[K[3;5Haverylongfunctionnameaverylongfunctionnameavery()->asd(fasdf([4;21Habc,[4;29H[K[5;13H        dec)->asdfasdfasdf([6;18H           asdfadsf,[7;13H       [9Casdfasdf,[8;13H  [14Casdfasdf,
 [27C),[10;13Hfunc(asdfadf,
         [8Casdfasdf),
            asdasdf
            );
}[15;1H[K[16;1H[K[17;1Hint main ()[17;12H[K[18;1H{[18;13H[K[19;5Hif (cond1 &&[20;9H    cond2
 [11C)[22;9Hfoo;
}[23;2H[K[24;1H[K[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h1;/start of AUTO/,$wq! test.out[?25l"test.out" [25;12H[K[25;12H[New] 1185L, 11362C written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test4.failed test.ok test.out X* viminfo
cp test4.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test4.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test4.in" 31 lines, 839 characters[1;1HTest for autocommand that changes current buffer on BufEnter event.
Check if modelines are interpreted for the correct buffer.

STARTTEST
:so small.vim
:set nocompatible viminfo+=nviminfo
:au BufEnter Xxx brew
/start of
:.,/end of/w! Xxx   " write test file Xxx
:set ai modeline modelines=3
:sp Xxx[13C" split to Xxx, autocmd will do :brew
G?this is a
othis should be auto-indented[34m^[[m
:[19C" Append text with autoindent to this file
:au! BufEnter Xxx
:buf Xxx[12C" go to Xxx, no autocmd anymore
G?this is a
othis should be in column 1[34m^[[m:wq " append text without autoindent to Xxx
G:r Xxx[13C" include Xxx in the current file
:?startstart?,$w! test.out
:qa!
ENDTEST

startstart[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for autocommand that changes current buffer on BufEnter event.[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[4;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 17 lines, 557 characters written[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[5;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[22;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset nocompatible viminfo+=nviminfo[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau BufEnter Xxx brew[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25hstart of[?25l[1;24r[24;1H
[1;25r[24;1Hstart of test file Xxx[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h.,/end of/w! Xxx   " write test file Xxx[?25l"Xxx" [25;7H[K[25;7H[New] 7L, 124C written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset ai modeline modelines=3[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hsp Xxx             " split to Xxx, autocmd will do :brew[?25l"Xxx" [25;7H[K[25;7H7L, 124C[1;1HTest for autocommand that changes current buffer on BufEnter event.
Check if modelines are interpreted for the correct buffer.[3;1H[K[4;1HSTARTTEST[4;10H[K[5;3Ho small.vim[5;14H[K[6;2Hset nocompatible viminfo+=nviminfo
:au BufEnter Xxx brew
/start of[8;10H[K[9;2H.,/end of/w! Xxx   " write test file Xxx
:set ai modeline modelines=3[10;29H[K[11;1H:sp Xxx    [9C" split to Xxx, autocmd will do :brew
[1m[7mtest4.in                                                                        [m[13;2Hau! BufEnter Xxx[13;21H[K[14;2Hbuf Xxx            " go to Xxx, no autocmd anymore
G?this is a[15;21H[K[16;1Hothis should be in column 1[34m^[[m:wq " append text without autoindent to Xxx
G:r Xxx             " include Xxx in the current file[17;54H[K[18;1H:?startstart?,$w! test.out[18;27H[K[19;2Hqa![19;5H[K[20;1HENDTEST[21;1H[K[22;1Hstartstart[23;6H of test file Xxx
[7mtest4.in                                                                        [m[25;2Htest4.in" line 1 of 31 --3%-- col 1[1;1H[?12l[?25h[?25l:qa![1;6H[K[2;1HENDTEST[2;8H[K[4;1Hstartstart
start of test file Xxx
vim: set noai :[6;16H[K[7;1H        this is a test
        this is a test
        this is a test[9;23H[K[10;1H        this is a test[10;23H[K[11;1Hend of test file Xxx[11;21H[K[11;1H[?12l[?25h[?25l[25;1H[K[25;1H?[?12l[?25hthis is a[?25l[10;9H[?12l[?25h[?25l[25;1H[1m-- INSERT --[m[25;1H[K[11;1H        this should be auto-indented[12;10H[1m[7m[+][m[24;10H[7m[+][11;36H[?12l[?25h[?25l[1;11r[m[11;1H
[1;25r[11;1Hend of test file Xxx[?12l[?25h[?25l[25;1H:[?12l[?25h                   " Append text with autoindent to this file[?25l[11;20H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau! BufEnter Xxx[?25l[11;20H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbuf Xxx            " go to Xxx, no autocmd anymore[?25l"Xxx" [25;7H[K[25;7H7L, 124C[1;1Hstart of test file Xxx
vim: set noai :
        this is a test
        this is a test
        this is a test

end of test file Xxx[7;21H[K[8;1H[1m[34m~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [m[12;1H[1m[7mXxxt          [1;1H[?12l[?25h[7;1H[?25l[m[25;1H[K[25;1H?[?12l[?25hthis is a[?25l[6;9H[?12l[?25h[?25l[25;1H[1m-- INSERT --[m[25;1H[K[7;11r[7;1H[L[1;25r[7;1Hthis should be in column 1[12;5H[1m[7m[+][7;26H[?12l[?25h[?25l[25;1H[m:[?12l[?25hwq " append text without autoindent to Xxx[?25l"Xxx[25;7H[K[25;7H8L, 151C written[1;1HCheck if modelines are interpreted for the correct buffer.[2;1H[K[3;1HSTARTTEST[3;10H[K[4;1H:so small.vim[4;14H[K[5;1H:set nocompatible viminfo+=nviminfo
:au BufEnter Xxx brew[6;22H[K[7;1H/start of[7;10H[K[8;1H:.,/end of/w! Xxx   " write test file Xxx
:set ai modeline modelines=3[9;29H[K[10;1H:sp Xxx             " split to Xxx, autocmd will do :brew[10;58H[K[11;1HG?this is a[11;12H[K[12;1Hothis should be auto-indented[34m^[[m[12;32H[K[13;2H                   " Append text with autoindent to this file
:au! BufEnter Xxx[14;21H[K[15;1H:buf Xxx   [9C" go to Xxx, no autocmd anymore
G?this is a[16;12H[K[17;1Hothis should be in column 1[34m^[[m:wq " append text without autoindent to Xxx
G:r Xxx             " include Xxx in the current file
:?startstart?,$w! test.out
:qa![20;5H[K[21;1HENDTEST[22;1H[K[23;6Hstar[23;11H[K[24;1Hstart of test file Xxx[24;23H[K[24;1H[?12l[?25h[?25l[1;24r[1;1H[7M[1;25r[18;1Hvim: set noai :[19;9Hthis is a test[20;9Hthis is a test[21;9Hthis is a test[22;9Hthis is a test[23;9Hthis should be auto-indented
end of test file Xxx[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hr Xxx             " include Xxx in the current file[?25l"Xxx" [25;20H[K[25;7H8L, 151C[1;24r[24;1H
[1;25r[24;1Hstart of test file Xxx[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h?startstart?,$w! test.out[?25l"test.out" [25;12H[K[25;12H[New] 17L, 316C written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test5.failed test.ok test.out X* viminfo
cp test5.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test5.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test5.in" 29 lines, 949 characters[1;1HTest for autocommand that deletes the current buffer on BufLeave event.
Also test deleting the last buffer, should give a new, empty buffer.

STARTTEST
:so small.vim
:au BufLeave Xxx bwipe
/start of
:.,/end of/w! Xxx[15C" write test file Xxx
:sp Xxx[25C" split to Xxx
:bwipe[26C" delete buffer Xxx, now we're back here
G?this is a
othis is some more text[34m^[[m
:[31C" Append some text to this file
:?start?,$w! test.out[11C" Write current file contents
:bwipe test.out[17C" delete alternate buffer
:au bufleave test5.in bwipe
:bwipe![25C" delete current buffer, get an empty one
ithis is another test line[34m^[[m:w >>test.out
:[31C" append an extra line to the output file
:qa!
ENDTEST

start of test file Xxx
vim: set noai :[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for autocommand that deletes the current buffer on BufLeave event.[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[4;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 16 lines, 664 characters written[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[5;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[21;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[22;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[22;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau BufLeave Xxx bwipe[?25l[22;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25hstart of[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.,/end of/w! Xxx               " write test file Xxx[?25l"Xxx" [25;7H[K[25;7H[New File] 7 lines, 124 characters written[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hsp Xxx                         " split to Xxx[?25l"Xxx" [25;7H[K[25;7H7 lines, 124 characters[1;1Hstart of test file Xxx[1;23H[K[2;1Hvim: set noai :[2;16H[K[3;9Hthis is a test
        this is a test
        this is a test
        this is a test
end of test file Xxx
[1m[34m~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [m[12;1H[1m[7mXxx                                                                             [m[24;1H[7mtest5.in                                                                        [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hbwipe                          " delete buffer Xxx, now we're back here[?25l[1;1HTest for autocommand that deletes the current buffer on BufLeave event.
Also test deleting the last buffer, should give a new, empty buffer.[3;9H[K[4;1HSTARTTEST[4;10H[K[5;1H:so small.vim[5;14H[K[6;1H:au BufLeave Xxx bwipe
/start of[7;10H[K[8;1H:.,/end of/w! Xxx               " write test file Xxx[8;54H[K[9;1H:sp Xxx                         " split to Xxx[9;47H[K[10;1H:bwipe                          " delete buffer Xxx, now we're back here[10;73H[K[11;1HG?this is a[11;12H[K[12;1Hothis is some more text[34m^[[m[12;26H[K[24;1Hvim: set noai :[24;16H[K[23;1H[?12l[?25h[?25l[1;24r[1;1H[5M[1;25r[20;9Hthis is a test[21;9Hthis is a test[22;9Hthis is a test[23;9Hthis is a test
end of test file Xxx[25;1H[K[24;1H[?12l[?25h[?25l
?[?12l[?25hthis is a[?25l[23;9H[?12l[?25h[?25l
this is some more text[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hend of test file Xxx[25;1H[K[24;20H[?12l[?25h[?25l
:[?12l[?25h                               " Append some text to this file[?25l[24;20H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h?start?,$w! test.out           " Write current file contents[?25l"test.out" [25;12H[K[25;12H[New File] 8 lines, 147 characters written[24;20H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe test.out                 " delete alternate buffer[?25l[24;20H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau bufleave test5.in bwipe[?25l[24;20H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe!                         " delete current buffer, get an empty one[?25l[1m[37m[41mError detected while processing BufLeave Auto commands for "test5.in":[m[25;71H[K[25;1H
[1m[37m[41mE89: No write since last change for buffer 1 (add ! to override)[m
[32mPress ENTER or type command to continue[?12l[?25h[m[1;1H[2L[?25l[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [m[25;1H[K[1;1H[?12l[?25h[?25lthis is another test line[?12l[?25h[?25l[25;1H:[?12l[?25hw >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 26 characters appended[1;25H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h                               " append an extra line to the output file[?25l[1;25H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test6.failed test.ok test.out X* viminfo
cp test6.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test6.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test6.in" 24 lines, 739 characters[1;1HTest for autocommand that redefines the argument list, when doing ":all".

STARTTEST
:so small.vim
:au BufReadPost Xxx2 next Xxx2 Xxx1
/^start of
A1[34m^[[m:.,/end of/w! Xxx1    " write test file Xxx1
$r2:.,/end of/w! Xxx2     " write test file Xxx2
$r3:.,/end of/w! Xxx3     " write test file Xxx3
:next! Xxx1 Xxx2 Xxx3     " redefine arglist; go to Xxx1
:all[22C" open window for all args
:w! test.out[14C" Write contents of Xxx1
[34m^W^W^W^W[m:w >>test.out     " Append contents of last window (Xxx1)
:rew[22C" should now be in Xxx2
:w >>test.out[13C" Append contents of Xxx2
:qa!
ENDTEST

start of test file Xxx[20;9Hthis is a test[21;9Hthis is a test[22;9Hthis is a test[23;9Hthis is a test
end of test file Xxx[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for autocommand that redefines the argument list, when doing ":all".[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 13 lines, 537 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[17;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[18;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[18;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau BufReadPost Xxx2 next Xxx2 Xxx1[?25l[18;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^start of[?25l[19;1H[?12l[?25h[?25l[22C1[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.,/end of/w! Xxx1    " write test file Xxx1[?25l"Xxx1" [25;9H[K[25;8H[New File] 6 lines, 109 characters written[19;23H[?12l[?25h[?25l2[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.,/end of/w! Xxx2     " write test file Xxx2[?25l"Xxx2" [25;9H[K[25;8H[New File] 6 lines, 109 characters written[19;23H[?12l[?25h[?25l3[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.,/end of/w! Xxx3     " write test file Xxx3[?25l"Xxx3" [25;9H[K[25;8H[New File] 6 lines, 109 characters written[19;23H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hnext! Xxx1 Xxx2 Xxx3     " redefine arglist; go to Xxx1[?25l"Xxx1"[25;8H[K[25;8H6 lines, 109 characters[1;1Hstart of test file Xxx1[1;24H[K[2;9Hthis is a test
        this is a test
        this is a test
        this is a test[5;23H[K[6;1Hend of test file Xxx
[1m[34m~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hall                      " open window for all args[?25l"Xxx2"[25;27H[K[25;8H6 lines, 109 characters
"Xxx2" 6 lines, 109 characters
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw! test.out              " Write contents of Xxx1[?25l"test.out" [25;12H[K[25;12H[New File] 6 lines, 109 characters written
[32mPress ENTER or type command to continue[?12l[?25h[m[1;1H[3L[?25l[1;1Hstart of test file Xxx1[2;9Hthis is a test[3;9Hthis is a test[12;1H[1m[7mXxx1                                                                            [m[13;1Hstart of test file Xxx2[13;24H[K[14;1H        this is a test[14;23H[K[15;1H        this is a test[15;23H[K[16;1H        this is a test[16;23H[K[17;1H        this is a test[17;23H[K[18;1Hend of test file Xxx[18;21H[K[24;1H[7mXxx2                                                                            [m[25;1H[K[1;1H[?12l[?25h[12;1H[7mXxx1[m[1m[7m [m[7m                                                                            [m[24;1H[1m[7mXxx2                                                                            [13;1H[12;1HXxx1                                                                            [m[24;1H[7mXxx2[m[1m[7m [m[7m                                                                            [1;1H[?25l[25;1H[m:[?12l[?25hw >>test.out     " Append contents of last window (Xxx1)[?25l"test.out" [25;12H[K[25;12H6 lines, 109 characters appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hrew                      " should now be in Xxx2[?25l"Xxx2" line 1 of 6 --16%-- col 1 (file 1 of 2)[25;47H[K[1;23H2[12;4H[1m[7m2 [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw >>test.out             " Append contents of Xxx2[?25l"test.out" [25;12H[K[25;12H6 lines, 109 characters appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test7.failed test.ok test.out X* viminfo
cp test7.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test7.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test7.in" 26 lines, 675 characters[1;1HTest for autocommand that changes the buffer list, when doing ":ball".

STARTTEST
:so small.vim
/^start of
A1[34m^[[m:.,/end of/w! Xxx1   " write test file Xxx1
:sp Xxx1
:close
$r2:.,/end of/w! Xxx2    " write test file Xxx2
:sp Xxx2
:close
$r3:.,/end of/w! Xxx3    " write test file Xxx3
:sp Xxx3
:close
:au BufReadPost Xxx2 bwipe
$r4:ball[17C" open window for all args, close Xxx2
:.,$w! test.out[10C" Write contents of this file
[34m^W^W[m:w >>test.out[8C" Append contents of second window (Xxx1)
[34m^W^W[m:/^start of/,$w >>test.out   " Append contents of last window (this file)
:qa!
ENDTEST

start of test file Xxx[24;9Hthis is a test[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for autocommand that changes the buffer list, when doing ":ball".[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 17 lines, 508 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[21;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[22;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[22;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^start of[?25l[23;1H[?12l[?25h[?25l[22C1[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.,/end of/w! Xxx1   " write test file Xxx1[?25l"Xxx1" [25;9H[K[25;8H[New File] 4 lines, 77 characters written[23;23H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hsp Xxx1[?25l"Xxx1" [25;8H[K[25;8H4 lines, 77 characters[1;1Hstart of test file Xxx1[1;24H[K[2;9Hthis is a test
        this is a test
end of test file Xxx
[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [m[12;1H[1m[7mXxx1                                                                            [m[24;1H[7mtest7.in [+]                                                                    [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hclose[?25l[1;1HTest for autocommand that changes the buffer list, when doing ":ball".[2;9H[K[3;1HSTARTTEST[3;10H[K[4;1H:so small.vim[4;14H[K[5;1H/^start of[5;11H[K[6;1HA1[34m^[[m:.,/end of/w! Xxx1   " write test file Xxx1[6;48H[K[7;1H:sp Xxx1[7;9H[K[8;1H:close[8;7H[K[9;1H$r2:.,/end of/w! Xxx2    " write test file Xxx2[9;48H[K[10;1H:sp Xxx2[10;9H[K[11;1H:close[11;7H[K[12;1H$r3:.,/end of/w! Xxx3    " write test file Xxx3[12;48H[K[24;1H        this is a test[24;23H[K[23;23H[?12l[?25h[?25l2[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.,/end of/w! Xxx2    " write test file Xxx2[?25l"Xxx2" [25;9H[K[25;8H[New File] 4 lines, 77 characters written[23;23H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hsp Xxx2[?25l"Xxx2" [25;8H[K[25;8H4 lines, 77 characters[1;1Hstart of test file Xxx2[1;24H[K[2;9Hthis is a test
        this is a test
end of test file Xxx
[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [m[12;1H[1m[7mXxx2                                                                            [m[24;1H[7mtest7.in [+]                                                                    [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hclose[?25l[1;1HTest for autocommand that changes the buffer list, when doing ":ball".[2;9H[K[3;1HSTARTTEST[3;10H[K[4;1H:so small.vim[4;14H[K[5;1H/^start of[5;11H[K[6;1HA1[34m^[[m:.,/end of/w! Xxx1   " write test file Xxx1[6;48H[K[7;1H:sp Xxx1[7;9H[K[8;1H:close[8;7H[K[9;1H$r2:.,/end of/w! Xxx2    " write test file Xxx2[9;48H[K[10;1H:sp Xxx2[10;9H[K[11;1H:close[11;7H[K[12;1H$r3:.,/end of/w! Xxx3    " write test file Xxx3[12;48H[K[24;1H        this is a test[24;23H[K[23;23H[?12l[?25h[?25l3[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.,/end of/w! Xxx3    " write test file Xxx3[?25l"Xxx3" [25;9H[K[25;8H[New File] 4 lines, 77 characters written[23;23H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hsp Xxx3[?25l"Xxx3" [25;8H[K[25;8H4 lines, 77 characters[1;1Hstart of test file Xxx3[1;24H[K[2;9Hthis is a test
        this is a test
end of test file Xxx
[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [m[12;1H[1m[7mXxx3                                                                            [m[24;1H[7mtest7.in [+]                                                                    [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hclose[?25l[1;1HTest for autocommand that changes the buffer list, when doing ":ball".[2;9H[K[3;1HSTARTTEST[3;10H[K[4;1H:so small.vim[4;14H[K[5;1H/^start of[5;11H[K[6;1HA1[34m^[[m:.,/end of/w! Xxx1   " write test file Xxx1[6;48H[K[7;1H:sp Xxx1[7;9H[K[8;1H:close[8;7H[K[9;1H$r2:.,/end of/w! Xxx2    " write test file Xxx2[9;48H[K[10;1H:sp Xxx2[10;9H[K[11;1H:close[11;7H[K[12;1H$r3:.,/end of/w! Xxx3    " write test file Xxx3[12;48H[K[24;1H        this is a test[24;23H[K[23;23H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau BufReadPost Xxx2 bwipe[?25l[23;23H[?12l[?25h[?25l4[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hball                 " open window for all args, close Xxx2[?25l"Xxx1"[25;23H[K[25;8H4 lines, 77 characters
"Xxx2" 4 lines, 77 characters
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h.,$w! test.out          " Write contents of this file[?25l"test.out" [25;12H[K[25;12H[New File] 4 lines, 77 characters written
[32mPress ENTER or type command to continue[?12l[?25h[27m[m[H[2J[?25l[1;1H:sp Xxx3
:close
:au BufReadPost Xxx2 bwipe
$r4:ball[17C" open window for all args, close Xxx2
:.,$w! test.out[10C" Write contents of this file
[34m^W^W[m:w >>test.out[8C" Append contents of second window (Xxx1)
[34m^W^W[m:/^start of/,$w >>test.out   " Append contents of last window (this file)
:qa!
ENDTEST

start of test file Xxx4
[1m[7mtest7.in [+]                                                                    [m[13;1Hstart of test file Xxx1[14;9Hthis is a test[15;9Hthis is a test
end of test file Xxx
[1m[34m~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [m[24;1H[7mXxx1                                                                            [11;23H[?12l[?25h
test7.in [+][m[1m[7m [m[7m                                                                    [m[24;1H[1m[7mXxx1                                                                            [13;1H[?25l[25;1H[m:[?12l[?25hw >>test.out        " Append contents of second window (Xxx1)[?25l"test.out" [25;12H[K[25;12H4 lines, 77 characters appended[13;1H[?12l[?25h[12;1H[1m[7mtest7.in [+]                                                                    [m[24;1H[7mXxx1[m[1m[7m [m[7m                                                                            [11;23H[?25l[m[25;1H[K[25;1H:[?12l[?25h/^start of/,$w >>test.out   " Append contents of last window (this file)[?25l[31msearch hit BOTTOM, continuing at TOP[m[25;37H[K[25;1H"test.out" [25;12H[K[25;12H4 lines, 77 characters appended[11;23H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test8.failed test.ok test.out X* viminfo
cp test8.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test8.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test8.in" 24 lines, 797 characters[1;1HTest for BufWritePre autocommand that deletes or unloads the buffer.

STARTTEST
:so small.vim
:au BufWritePre Xxx1 bunload
:au BufWritePre Xxx2 bwipe
/^start of
A1[34m^[[m:.,/end of/w! Xxx1  " write test file Xxx1
$r2:.,/end of/w! Xxx2   " write test file Xxx2
:e! Xxx2[16C" edit Xxx2
:bdel test8.in[10C" delete this file from the buffer list
:e Xxx1[17C" edit Xxx1
:w[22C" write it, will unload it and give an error msg
:w! test.out[12C" Write contents of this file
:e! Xxx2[16C" start editing Xxx2
:bwipe test.out[9C" remove test.out from the buffer list
:w[22C" write it, will delete the buffer and give an error msg[18;1H:w >>test.out[11C" Append contents of this file
:qa!
ENDTEST

start of Xxx[23;9Htest
end of Xxx[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for BufWritePre autocommand that deletes or unloads the buffer.[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 16 lines, 678 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[20;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[21;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[21;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau BufWritePre Xxx1 bunload[?25l[21;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau BufWritePre Xxx2 bwipe[?25l[21;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^start of[?25l[22;1H[?12l[?25h[?25l[12C1[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.,/end of/w! Xxx1  " write test file Xxx1[?25l"Xxx1" [25;9H[K[25;8H[New File] 3 lines, 31 characters written[22;13H[?12l[?25h[?25l2[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.,/end of/w! Xxx2   " write test file Xxx2[?25l"Xxx2" [25;9H[K[25;8H[New File] 3 lines, 31 characters written[22;13H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! Xxx2                " edit Xxx2[?25l"Xxx2" [25;8H[K[25;8H3 lines, 31 characters[1;1Hstart of Xxx2[1;14H[K[2;9Htest
end of Xxx
[1m[34m~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hbdel test8.in[34m^I^I[m" delete this file from the buffer list[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he Xxx1                 " edit Xxx1[?25l"Xxx1" [25;25H[K[25;8H3 lines, 31 characters[1;13H1[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw                      " write it, will unload it and give an error msg[?25l"Xxx2"[25;25H[K[25;8H3 lines, 31 characters
[1m[37m[41mE203: Autocommands deleted or unloaded buffer to be written[m
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw! test.out            " Write contents of this file[?25l"test.out" [25;12H[K[25;12H[New File] 3 lines, 31 characters written
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25he! Xxx2                " start editing Xxx2[?25l"Xxx2" [25;8H[K[25;8H3 lines, 31 characters[1;1H[3L[1;1Hstart of Xxx2[2;9Htest
end of Xxx[25;1H[K[25;1H"Xxx2" 3 lines, 31 characters[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe test.out         " remove test.out from the buffer list[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw                      " write it, will delete the buffer and give an error ms
[24;80Hg[25;1H[?25l[24;1H"Xxx1"[24;25H[K[24;8H3 lines, 31 characters
[1m[37m[41mE203: Autocommands deleted or unloaded buffer to be written[m
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw >>test.out           " Append contents of this file[?25l"test.out" [25;12H[K[25;12H3 lines, 31 characters appended
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test9.failed test.ok test.out X* viminfo
cp test9.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test9.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test9.in" 12 lines, 255 characters[1;1HTest for Bufleave autocommand that deletes the buffer we are about to edit.

STARTTEST
:so small.vim
:au BufLeave test9.in bwipe yy
:e yy
:/^start of/,$w! test.out      " Write contents of this file
:qa!
ENDTEST

start of test file xx
end of test file xx
[1m[34m~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for Bufleave autocommand that deletes the buffer we are about to edit.[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 5 lines, 117 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[9;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[10;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[10;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau BufLeave test9.in bwipe yy[?25l[10;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he yy[?25l[1m[37m[41mE143: Autocommands unexpectedly deleted new buffer yy[10;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h/^start of/,$w! test.out      " Write contents of this file[?25l"test.out" [25;12H[K[25;12H[New File] 2 lines, 42 characters written[10;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test10.failed test.ok test.out X* viminfo
cp test10.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test10.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test10.in" 57 lines, 1624 characters[1;1HTest for 'errorformat'.  This will fail if the quickfix feature was disabled.

STARTTEST
:so small.vim
:/start of errorfile/,/end of errorfile/w! Xerrorfile
:/start of testfile/,/end of testfile/w! Xtestfile
:cf Xerrorfile
rA
:cn
rB
:cn
rC
:cn
rD
:cn
rE
:w! test.out[13C" Write contents of this file
:qa!
ENDTEST

start of errorfile
"Xtestfile", line 4.12: 1506-045 (S) Undeclared identifier fd_set.
"Xtestfile", line 7 col 19; this is an error
gcc -c -DHAVE_CONFIsing-prototypes -I/usr/X11R6/include  version.c[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for 'errorformat'.  This will fail if the quickfix feature was disabled.[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 15 lines, 225 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[19;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/start of errorfile/,/end of errorfile/w! Xerrorfile[?25l"Xerrorfile" [25;14H[K[25;14H[New File] 13 lines, 447 characters written[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/start of testfile/,/end of testfile/w! Xtestfile[?25l"Xtestfile" [25;13H[K[25;13H[New File] 23 lines, 853 characters written[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcf Xerrorfile[?25l"Xtestfile" [25;13H[K[25;13H23 lines, 853 characters
(2 of 13): 1506-045 (S) Undeclared identifier fd_set.
[32mPress ENTER or type command to continue[?12l[?25h[m[1;1H[2L[?25l[1;1Hstart of testfile
line 2  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 4  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[5;39H[K[6;1Hline 6  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[6;39H[K[7;1Hline 7  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 8  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 9  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 10 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 11 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 12 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 13 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 14 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 15 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 16 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 17 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[17;39H[K[18;1Hline 18 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 19 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 20 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 21 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 22 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[22;39H[K[23;1Hend of testfile[23;16H[K[24;1H[1m[34m~                                                                               [m[25;1H[K[4;12H[?12l[?25h[?25lA[?12l[?25h[5;12H[?25l[25;1H:[?12l[?25hcn[?25l(3 of 13): this is an error[7;19H[?12l[?25h[?25lB[?12l[?25h[8;19H[?25l[25;1H[K[25;1H:[?12l[?25hcn[?25l(5 of 13): parse error before `asd'[13;1H[?12l[?25h[?25lC[?12l[?25h
[?25l[25;1H[K[25;1H:[?12l[?25hcn[?25l(7 of 13): there is an error[16;1H[?12l[?25h[?25lD[?12l[?25h
[?25l[25;1H[K[25;1H:[?12l[?25hcn[?25l(10 of 13): yet another problem[19;1H[?12l[?25h[?25lE[?12l[?25h
[?25l[25;1H[K[25;1H:[?12l[?25hw! test.out             " Write contents of this file[?25l"test.out" [25;12H[K[25;12H[New File] 23 lines, 853 characters written[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test11.failed test.ok test.out X* viminfo
cp test11.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test11.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test11.in" 84 lines, 3345 characters[1;1HTests for autocommands:
- FileWritePre[10Cwriting a compressed file
- FileReadPost[10Creading a compressed file
- BufNewFile[12Creading a file template
- BufReadPre[12Cdecompressing the file to be read
- FilterReadPre[9Csubstituting characters in the temp file
- FilterReadPost[8Csubstituting characters after filtering
- FileReadPre[11Cset options for decompression
- FileReadPost[10Cdecompress the file

Note: This test is skipped if "gzip" is not available.
$GZIP is made empty, "-v" would cause trouble.
Use a FileChangedShell autocommand to avoid a prompt for "Xtestfile.gz" being
modified outside of Vim (noticed on Solaris).

STARTTEST
:so small.vim
:" drop out when there is no gzip program
:if !executable("gzip")
: e! test.ok
: w! test.out
: qa!
:endif
:let $GZIP = ""[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for autocommands:[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[16;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[17;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 48 lines, 2277 characters written[17;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[17;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;1H:23,$s/\r$//[17C" remove CR for when sed adds them
:au! FileReadPre    *.gz   exe '!gzip -d ' . shellescape(expand("<afile>"))
:au  FileReadPre    *.gz   call rename(expand("<afile>:r"), expand("<afile>"))
:au! FileReadPost   *.gz   '[,']s/l/L/
:$r Xtestfile.gz[13C" Read compressed file
:w[27C" write it, after filtering
:au![13C" remove all autocommands
:e[15C" Edit test.out again
:set nobin ff&   " use the default fileformat for writing
:w
:qa!
ENDTEST

startstart
start of testfile
line 2  Abcdefghijklmnopqrstuvwxyz
line 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 4  Abcdefghijklmnopqrstuvwxyz
line 5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 6  Abcdefghijklmnopqrstuvwxyz
line 7  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 8  Abcdefghijklmnopqrstuvwxyz
line 9  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 10 Abcdefghijklmnopqrstuvwxyz[12;1H[?12l[?25h
[?25l[25;1H:so! Xdotest[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" drop out when there is no gzip program[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hif !executable("gzip")[?25l
:  [?12l[?25h: e! test.ok
[?25l:  [?12l[?25h: w! test.out
[?25l:  [?12l[?25h: qa!
[?25l:  [?12l[?25h:endif[1;1H[4L[?25l[1;1H:23,$s/\r$//[17C" remove CR for when sed adds them
:au! FileReadPre    *.gz   exe '!gzip -d ' . shellescape(expand("<afile>"))
:au  FileReadPre    *.gz   call rename(expand("<afile>:r"), expand("<afile>"))
:au! FileReadPost   *.gz   '[,']s/l/L/[25;1H[K[13;1H[?12l[?25h[?25l[25;1H:[?12l[?25hlet $GZIP = ""[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau FileChangedShell * echo "caught FileChangedShell"[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset bin[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau FileWritePre    *.gz   '[,']!gzip[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau FileWritePost   *.gz   undo[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^start of testfile/,/^end of testfile/w! Xtestfile.gz[?25l[?12l[?25h[?25l11 lines filtered[25;18H[K[25;1H
"Xtestfile.gz" [New File][Incomplete last line] 1 line, 111 characters written
10 more lines; before #1  0 seconds ago
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hau FileReadPost    *.gz   '[,']!gzip -d[?25l[1;1H[3L[1;1H:au! FileReadPre    *.gz   exe '!gzip -d ' . shellescape(expand("<afile>"))
:au  FileReadPre    *.gz   call rename(expand("<afile>:r"), expand("<afile>"))
:au! FileReadPost   *.gz   '[,']s/l/L/
:$r Xtestfile.gz             " Read compressed file
:w              [15Cwrite it, after filtering
:au![13C" remove all autocommands[6;43H[K[7;2He  [15CEdit test.out again[7;39H[K[8;2Hset nobin ff&   " use the default fileformat for writing
:w[9;3H[K[10;2Hqa!
ENDTEST[12;1H[K[13;1Hstartstart[14;6H of testfile
line 2  Abcdefghijklmnopqrstuvwxyz[16;6H3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[17;6H4  Abcdefghijklmnopqrstuvwxyz[17;35H[K[18;6H5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[19;6H6  Abcdefghijklmnopqrstuvwxyz[19;35H[K[20;6H7  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[21;6H8  Abcdefghijklmnopqrstuvwxyz[21;35H[K[22;6H9  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[23;6H10 Abcdefghijklmnopqrstuvwxyz[23;35H[K[24;1Hend of testfile[24;16H[K[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$r Xtestfile.gz                " Read and decompress the testfile[?25l"Xtestfile.gz" [25;16H[K[25;16H[Incomplete last line] 1 line, 111 characters[?12l[?25h[60C[?25l[1;24r[1;1H[7M[1;25r[19;1Hstart of test.c
/*
 * Here is a new .c file
 */
end of test.c
start of testfile[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h?startstart?,$w! test.out      " Write contents of this file[?25l"test.out" [25;12H[K[25;12H[New File] 29 lines, 788 characters written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau BufNewFile      *.c    read Xtest.c[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^start of test.c/+1,/^end of test.c/-1w! Xtest.c[?25l[31msearch hit BOTTOM, continuing at TOP[m[25;37H[K[25;1H"Xtest.c" [25;11H[K[25;11H[New File] 3 lines, 32 characters written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! foo.c                       " Will load Xtest.c[?25l"foo.c" [New File][25;33H[K[25;1H
"Xtest.c" 3 lines, 32 characters
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hau FileAppendPre   *.out  '[,']s/new/NEW/[?25l[1;1H[2L[2;1H/*
 * Here is a new .c file
 */[4;4H[K[5;1H[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [m[25;1H[K[2;1H[?12l[?25h[?25l[25;1H:[?12l[?25hau FileAppendPost  *.out  !cat Xtest.c >>test.out[?25l[2;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw>>test.out                    " Append it to the output file[?25l"test.out" [25;12H[K[25;12H4 lines, 33 characters appended
:!cat Xtest.c >>test.out
[?12l[?25h[m
[32mPress ENTER or type command to continue[?25l[m[25;1H[K[25;1H:[?12l[?25hau! FileAppendPre[?25l[27m[m[H[2J[2;1H/*
 * Here is a NEW .c file
 */
[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [3;2H[?12l[?25h[?25l[25;1H[m:[?12l[?25h" setup autocommands to decompress before reading and re-compress afterwards[?25l[3;2H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau BufReadPre      *.gz   exe '!gzip -d ' . shellescape(expand("<afile>"))[?25l[3;2H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau BufReadPre      *.gz   call rename(expand("<afile>:r"), expand("<afile>"))[?25l[3;2H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau BufReadPost     *.gz   call rename(expand("<afile>"), expand("<afile>:r"))[?25l[3;2H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau BufReadPost     *.gz   exe '!gzip ' . shellescape(expand("<afile>:r"))[?25l[3;2H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! Xtestfile.gz                " Edit compressed file[?25l:!gzip -d 'Xtestfile.gz'[25;33H[K[25;25H
[?12l[?25h[?25l[m"Xtestfile.gz"[24;1H"Xtestfile.gz" 11 lines, 357 characters[25;1H[K[25;1H:!gzip 'Xtestfile'
[?12l[?25h[m
[32mPress ENTER or type command to continue[?25l[m[25;1H[K[25;1H:[?12l[?25hw>>test.out                    " Append it to the output file[?25l"test.out" [25;12H[K[25;12H11 lines, 357 characters appended
:!cat Xtest.c >>test.out
[?12l[?25h[m
[32mPress ENTER or type command to continue[?25l[m[25;1H[K[25;1H:[?12l[?25hset shelltemp                  " need temp files here[?25l[27m[m[H[2J[1;1Hstart of testfile
line 2  Abcdefghijklmnopqrstuvwxyz
line 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 4  Abcdefghijklmnopqrstuvwxyz
line 5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 6  Abcdefghijklmnopqrstuvwxyz
line 7  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 8  Abcdefghijklmnopqrstuvwxyz
line 9  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 10 Abcdefghijklmnopqrstuvwxyz
end of testfile
[1m[34m~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[25;1H[m:[?12l[?25hau FilterReadPre   *.out  call rename(expand("<afile>"), expand("<afile>") . "
[24;80H.[25;1Ht")[?25l[1;1H[L[1;1Hstart of testfile[25;1H[K[1;1H[?12l[?25h[?25l[25;1H:[?12l[?25hau FilterReadPre   *.out  exe '!sed s/e/E/ ' . shellescape(expand("<afile>")) 
[24;80H.[25;1H ".t >" . shellescape(expand("<afile>"))[?25l[1;1H[L[1;1Hstart of testfile[25;1H[K[1;1H[?12l[?25h[?25l[25;1H:[?12l[?25hau FilterReadPre   *.out  exe '!rm ' . shellescape(expand("<afile>")) . '.t'[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau FilterReadPost  *.out  '[,']s/x/X/g[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! test.out                    " Edit the output file[?25l"test.out" [25;12H[K[25;12H50 lines, 1242 characters[1;6Hstar[1;11H[K[2;1Hstart of testfile[2;18H[K[3;6H2  Abcdefghijklmnopqrstuvwxyz[3;35H[K[4;6H3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[5;6H4  Abcdefghijklmnopqrstuvwxyz[5;35H[K[6;6H5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[7;6H6  Abcdefghijklmnopqrstuvwxyz[7;35H[K[8;6H7  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[9;6H8  Abcdefghijklmnopqrstuvwxyz[9;35H[K[10;6H9  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 10 Abcdefghijklmnopqrstuvwxyz
end of testfile[12;16H[K[13;1H[K[14;1Hstart of test.c[14;16H[K[15;1H/*[15;3H[K[16;1H * Here is a new .c file[16;25H[K[17;1H */[17;4H[K[18;1Hend of test.c[18;14H[K[19;1Hstart of testfile[19;18H[K[20;1Hline 2  Abcdefghijklmnopqrstuvwxyz[20;35H[K[21;1Hline 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[21;39H[K[22;1Hline 4  Abcdefghijklmnopqrstuvwxyz[22;35H[K[23;1Hline 5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[23;39H[K[24;1Hline 6  Abcdefghijklmnopqrstuvwxyz[24;35H[K[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h23,$!cat[?25l[?12l[?25h[?25l:!sed s/e/E/ '/tmp/v29mHc6/1'.t >'/tmp/v29mHc6/1'
[?12l[?25h[?25l[m:!rm '/tmp/v29mHc6/1'.t
[?12l[?25h[?25l[m218 substitutions on 15 lines
28 lines filtered
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h23,$s/\r$//                 " remove CR for when sed adds them[?25l[1m[37m[41mE486: Pattern not found: \r$[m[25;30H[K[25;1H
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hau! FileReadPre    *.gz   exe '!gzip -d ' . shellescape(expand("<afile>"))[?25l[27m[m[H[2J[1;1Hstartstart
start of testfile
line 2  Abcdefghijklmnopqrstuvwxyz
line 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 4  Abcdefghijklmnopqrstuvwxyz
line 5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 6  Abcdefghijklmnopqrstuvwxyz
line 7  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 8  Abcdefghijklmnopqrstuvwxyz
line 9  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 10 Abcdefghijklmnopqrstuvwxyz
end of testfile

start of test.c
/*
 * Here is a new .c file
 */
end of test.c
start of testfile
line 2  Abcdefghijklmnopqrstuvwxyz
line 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 4  Abcdefghijklmnopqrstuvwxyz
linE 5  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
linE 6  AbcdefghijklmnopqrstuvwXyz[23;1H[?12l[?25h[?25l

:[?12l[?25hau  FileReadPre    *.gz   call rename(expand("<afile>:r"), expand("<afile>"))[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau! FileReadPost   *.gz   '[,']s/l/L/[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$r Xtestfile.gz             " Read compressed file[?25l:!gzip -d 'Xtestfile.gz'[25;30H[K[25;25H
[?12l[?25h[?25l[m"Xtestfile.gz"[24;1H"Xtestfile.gz" 11 lines, 357 characters[25;1H[K[25;1H11 substitutions on 11 lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw                           " write it, after filtering[?25l"test.out"[25;30H[K[25;12H61 lines, 1599 characters written
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hau!             " remove all autocommands[?25l[1m[37m[41mE216: No such group or event: " remove all autocommands[m
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25he               " Edit test.out again[?25l"test.out"[25;18H[K[25;12H61 lines, 1599 characters[27m[m[H[2J[1;1Hstartstart
start of testfile
line 2  Abcdefghijklmnopqrstuvwxyz
line 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 4  Abcdefghijklmnopqrstuvwxyz
line 5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 6  Abcdefghijklmnopqrstuvwxyz
line 7  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 8  Abcdefghijklmnopqrstuvwxyz
line 9  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 10 Abcdefghijklmnopqrstuvwxyz
end of testfile

start of test.c
/*
 * Here is a new .c file
 */
end of test.c
start of testfile
line 2  Abcdefghijklmnopqrstuvwxyz
line 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 4  Abcdefghijklmnopqrstuvwxyz
linE 5  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
linE 6  AbcdefghijklmnopqrstuvwXyz
"test.out" 61 lines, 1599 characters[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset nobin ff&   " use the default fileformat for writing[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw[?25l"test.out" 61 lines, 1599 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test12.failed test.ok test.out X* viminfo
cp test12.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test12.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test12.in" 52 lines, 1199 characters[1;1HTests for 'directory' option.
- ".", in same dir as file
- "./dir", in directory relative to file
- "dir", in directory relative to current dir

STARTTEST
:so small.vim
:set nocompatible viminfo+=nviminfo
:set dir=.,~
:/start of testfile/,/end of testfile/w! Xtest1
:" do an ls of the current dir to find the swap file (should not be there)
:if has("unix")
:  !ls .X*.swp >test.out
:else
:  r !ls X*.swp >test.out
:endif
:!echo first line >>test.out
:e Xtest1
:if has("unix")
:" Do an ls of the current dir to find the swap file, remove the leading dot
:" to make the result the same for all systems.
:  r!ls .X*.swp
:  s/\.*X/X/
:  .w >>test.out[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for 'directory' option.[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[6;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[7;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 40 lines, 965 characters written[7;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[7;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;1H:!echo under Xtest1.swp >>test.out
:!mkdir Xtest2
:set dir=./Xtest2,.,~
:e Xtest1
:!ls X*.swp >>test.out
:!echo under under >>test.out
:!ls Xtest2 >>test.out
:!echo under Xtest1.swp >>test.out
:!mkdir Xtest.je
:/start of testfile/,/end of testfile/w! Xtest2/Xtest3
:set dir=Xtest.je,~
:e Xtest2/Xtest3
:swap
:!ls Xtest2 >>test.out
:!echo under Xtest3 >>test.out
:!ls Xtest.je >>test.out
:!echo under Xtest3.swp >>test.out
:qa!
ENDTEST

start of testfile
line 2 Abcdefghij
line 3 Abcdefghij
end of testfile[19;1H[?12l[?25h
[?25l[25;1H:so! Xdotest[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset nocompatible viminfo+=nviminfo[?25l[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset dir=.,~[?25l[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/start of testfile/,/end of testfile/w! Xtest1[?25l"Xtest1" [25;10H[K[25;10H[New] 4L, 70C written[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" do an ls of the current dir to find the swap file (should not be there)[?25l[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hif has("unix")[?25l
:  [?12l[?25h:  !ls .X*.swp >test.out
[?25l:!ls .X*.swp >test.out[?1l>[?12l[?25h[?1049l
ls: cannot access .X*.swp: No such file or directory

shell returned 2

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:  :[?12l[?25helse
[?25l:  [?12l[?25h:  r !ls X*.swp >test.out
[?25l:  [?12l[?25h:endif[?25l[25;1H[K[25;1H:[?12l[?25h!echo first line >>test.out[?25l[28C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H:[?12l[?25he Xtest1[?25l"Xtest1" 4L, 70C[27m[m[H[2J[1;1Hstart of testfile
line 2 Abcdefghij
line 3 Abcdefghij
end of testfile
[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [m[25;1H"Xtest1" 4L, 70C[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hif has("unix")[?25l
:  [?12l[?25h:" Do an ls of the current dir to find the swap file, remove the leading dot
[?25l:  [?12l[?25h:" to make the result the same for all systems.
[?25l:  [?12l[?25h:  r!ls .X*.swp[m
[?25l:  [?12l[?25h:  s/\.*X/X/
[?25l:  [?12l[?25h:  .w >>test.out[?25l"test.out" [25;12H[K[25;12H1L, 11C appended
:  [?12l[?25h:  undo
[?25l1 line less; before #1  0 seconds ago
:  [?12l[?25h:else
[?25l:  [?12l[?25h:  !ls X*.swp >>test.out
[?25l:  [?12l[?25h:endif[27m[m[H[2J[?25l[1;1Hstart of testfile
line 2 Abcdefghij
line 3 Abcdefghij
end of testfile
[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[25;1H[m:[?12l[?25h!echo under Xtest1.swp >>test.out[?25l[34C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H:[?12l[?25h!mkdir Xtest2[?25l[14C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H:[?12l[?25hset dir=./Xtest2,.,~[?25l[27m[m[H[2J[1;1Hstart of testfile
line 2 Abcdefghij
line 3 Abcdefghij
end of testfile
[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[25;1H[m:[?12l[?25he Xtest1[?25l"Xtest1" 4L, 70C[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h!ls X*.swp >>test.out[?25l[22C[?1l>[?12l[?25h[?1049l
ls: cannot access X*.swp: No such file or directory

shell returned 2

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H:[?12l[?25h!echo under under >>test.out[?25l[29C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H:[?12l[?25h!ls Xtest2 >>test.out[?25l[22C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H:[?12l[?25h!echo under Xtest1.swp >>test.out[?25l[34C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H:[?12l[?25h!mkdir Xtest.je[?25l[16C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H:[?12l[?25h/start of testfile/,/end of testfile/w! Xtest2/Xtest3[?25l[31msearch hit BOTTOM, continuing at TOP[m[25;37H[K[25;1H"Xtest2/Xtest3" [25;17H[K[25;17H[New] 4L, 70C written[27m[m[H[2J[1;1Hstart of testfile
line 2 Abcdefghij
line 3 Abcdefghij
end of testfile
[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [m[25;1H"Xtest2/Xtest3" [New] 4L, 70C written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset dir=Xtest.je,~[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he Xtest2/Xtest3[?25l"Xtest2/Xtest3" 4L, 70C[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hswap[?25lXtest.je/Xtest3.swp[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h!ls Xtest2 >>test.out[?25l[22C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H:[?12l[?25h!echo under Xtest3 >>test.out[?25l[30C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H:[?12l[?25h!ls Xtest.je >>test.out[?25l[24C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H:[?12l[?25h!echo under Xtest3.swp >>test.out[?25l[34C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[?1l>[?12l[?25h[?1049l
rm -rf X* test.ok viminfo
rm -rf test13.failed test.ok test.out X* viminfo
cp test13.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test13.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test13.in" 58 lines, 1133 characters[1;1HTests for autocommands on :close command

Write three files and open them, each in a window.
Then go to next window, with autocommand that deletes the previous one.
Do this twice, writing the file.

Also test deleting the buffer on a Unload event.  If this goes wrong there
will be the ATTENTION prompt.

Also test changing buffers in a BufDel autocommand.  If this goes wrong there
are ml_line errors and/or a Crash.

STARTTEST
:so small.vim
:/^start of testfile/,/^end of testfile/w! Xtestje1
:/^start of testfile/,/^end of testfile/w! Xtestje2
:/^start of testfile/,/^end of testfile/w! Xtestje3
:e Xtestje1
otestje1[34m^[[m
:w
:sp Xtestje2
otestje2[34m^[[m
:w
:sp Xtestje3[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for autocommands on :close command[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[13;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[14;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 38 lines, 631 characters written[14;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[14;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;1H:bwipe Xtestje2 Xtestje3 test.out
:au!
:au! BufUnload Xtestje1 bwipe
:e Xtestje3
:w >>test.out
:e Xtestje2
:sp Xtestje1
:e
:w >>test.out
:au!
:only
:e Xtestje1
:bwipe Xtestje2 Xtestje3 test.out test13.in
:au BufWipeout Xtestje1 buf Xtestje1
:bwipe
:w >>test.out
:qa!
ENDTEST

start of testfile[21;9Hcontents[22;9Hcontents[23;9Hcontents
end of testfile[18;1H[?12l[?25h
[?25l[25;1H:so! Xdotest[19;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[19;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^start of testfile/,/^end of testfile/w! Xtestje1[?25l"Xtestje1" [25;13H[K[25;12H[New File] 5 lines, 64 characters written[19;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^start of testfile/,/^end of testfile/w! Xtestje2[?25l"Xtestje2" [25;13H[K[25;12H[New File] 5 lines, 64 characters written[19;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^start of testfile/,/^end of testfile/w! Xtestje3[?25l"Xtestje3" [25;13H[K[25;12H[New File] 5 lines, 64 characters written[19;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he Xtestje1[?25l"Xtestje1" 5 lines, 64 characters[1;1Hstart of testfile[1;18H[K[2;1H        contents
        contents[3;17H[K[4;1H        contents
end of testfile
[1m[34m~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[2;24r[m[2;1H[L[1;25r[2;1Htestje1[25;1H[K[2;7H[?12l[?25h[3;8H[?25l[25;1H:[?12l[?25hw[?25l"Xtestje1" 6 lines, 72 characters written[3;8H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hsp Xtestje2[?25l"Xtestje2" [25;12H[K[25;12H5 lines, 64 characters[2;1H        contents


end of testfile[5;16H[K[6;1H[1m[34m~                                                                               [m[12;1H[1m[7mXtestje2                                                                        [m[13;1Htestje1[13;8H[K[14;1H        contents[14;17H[K[15;1H        contents[15;17H[K[16;1H        contents[16;17H[K[17;1Hend of testfile[17;16H[K[24;1H[7mXtestje1                                                                        [1;1H[?12l[?25h[?25l[2;11r[m[2;1H[L[1;25r[2;1Htestje2[12;10H[1m[7m[+][m[25;1H[K[2;7H[?12l[?25h[3;8H[?25l[25;1H:[?12l[?25hw[?25l"Xtestje2" 6 lines, 72 characters written[12;10H[1m[7m    [3;8H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hsp Xtestje3[?25l"Xtestje3" [25;12H[K[25;12H5 lines, 64 characters[27m[m[H[2J[1;1Hstart of testfile[2;9Hcontents[3;9Hcontents[4;9Hcontents
end of testfile
[1m[34m~                                                                               [7;1H~                                                                               [m[8;1H[1m[7mXtestje3                                                                        [m[9;1Htestje2[10;9Hcontents[11;9Hcontents[12;9Hcontents
end of testfile
[1m[34m~                                                                               [15;1H~                                                                               [m[16;1H[7mXtestje2                                                                        [m[17;9Hcontents[18;9Hcontents[19;9Hcontents
end of testfile
[1m[34m~                                                                               [22;1H~                                                                               [23;1H~                                                                               [m[24;1H[7mXtestje1                                                                        [1;1H[?12l[?25h[?25l[2;7r[m[2;1H[L[1;25r[2;1Htestje3[8;10H[1m[7m[+][2;7H[?12l[?25h[3;8H[?25l[25;1H[m:[?12l[?25hw[?25l"Xtestje3" 6 lines, 72 characters written[8;10H[1m[7m    [3;8H[?12l[?25h[m[8;1H[7mXtestje3[m[1m[7m [m[7m                                                                        [m[16;1H[1m[7mXtestje2                                                                        [10;8H[11;8H[?25l[m[25;1H[K[25;1H:[?12l[?25hau WinLeave Xtestje2 bwipe[?25l[11;8H[?12l[?25h[27m[m[H[2J[?25l[1;1Hstart of testfile
testje3[3;9Hcontents[4;9Hcontents[5;9Hcontents
end of testfile
[1m[34m~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [m[12;1H[7mXtestje3                                                                        [m[13;1Htestje1[14;9Hcontents[15;9Hcontents[16;9Hcontents
end of testfile
[1m[34m~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [m[24;1H[1m[7mXtestje1                                                                        [14;8H[?12l[?25h[15;8H[?25l[25;1H[m:[?12l[?25hw! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 6 lines, 72 characters written[15;8H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau WinLeave Xtestje1 bwipe Xtestje3[?25l[15;8H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hclose[?25l[2;7H1[12;1H[1m[34m~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [24;1H~                                                                               [4;8H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw >>test.out[?25l"test.out" [25;12H[K[25;12H6 lines, 72 characters appended[4;8H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he Xtestje1[?25l"Xtestje1" 6 lines, 72 characters[4;9H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe Xtestje2 Xtestje3 test.out[?25l[1m[37m[41mE94: No matching buffer for Xtestje2 Xtestje3 test.out[4;9H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hau![?25l[4;9H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau! BufUnload Xtestje1 bwipe[?25l[4;9H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he Xtestje3[?25l"Xtestje3" 6 lines, 72 characters[2;7H3[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>test.out[?25l"test.out" [25;12H[K[25;12H6 lines, 72 characters appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he Xtestje2[?25l"Xtestje2" 6 lines, 72 characters[2;7H2[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hsp Xtestje1[?25l"Xtestje1" [25;12H[K[25;12H6 lines, 72 characters[2;7H1[12;1H[1m[7mXtestje1                                                                        [m[13;1Hstart of testfile[13;18H[K[14;1Htestje2[14;8H[K[15;1H        contents[15;17H[K[16;1H        contents[16;17H[K[17;1H        contents[17;17H[K[18;1Hend of testfile[18;16H[K[24;1H[7mXtestje2                                                                        [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25he[?25l[1m[37m[41mE143: Autocommands unexpectedly deleted new buffer Xtestje1[m[2;7H2[12;1H[1m[34m~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw >>test.out[?25l"test.out" [25;12H[K[25;12H6 lines, 72 characters appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau![?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25honly[?25lAlready only one window[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he Xtestje1[?25l"Xtestje1" 6 lines, 72 characters[2;7H1[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe Xtestje2 Xtestje3 test.out test13.in[?25l4 buffers wiped out[25;20H[K[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau BufWipeout Xtestje1 buf Xtestje1[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe[?25l"Xtestje1" 6 lines, 72 characters[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>test.out[?25l"test.out" [25;12H[K[25;12H6 lines, 72 characters appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test14.failed test.ok test.out X* viminfo
cp test14.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test14.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test14.in" 66 lines, 1022 characters[1;1HTests for "vaBiB", end could be wrong.
Also test ":s/pat/sub/" with different ~s in sub.
Also test for ^Vxff and ^Vo123 in Insert mode.
Also test "[m", "]m", "[M" and "]M"

STARTTEST
:so small.vim
/Start cursor here
vaBiBD:?Bug?,/Piece/-2w! test.out
/^- Bug
:s/u/~u~/
:s/i/~u~/
:s/o/~~~/
:.w >>test.out
:if has("ebcdic")
: let tt = "o\<C-V>193\<C-V>xc2\<C-V>o303 \<C-V>90a\<C-V>xfg\<C-V>o578\<Esc>"
:else
: let tt = "o\<C-V>65\<C-V>x42\<C-V>o103 \<C-V>33a\<C-V>xfg\<C-V>o78\<Esc>"
:endif
:exe "normal " . tt
:unlet tt
:.w >>test.out
:set vb
/^Piece[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for "vaBiB", end could be wrong.[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[6;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[7;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 31 lines, 623 characters written[7;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[7;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;1H]maC[34m^[[m:.w >>test.out
[maD[34m^[[m:.w >>test.out
k2[maE[34m^[[m:.w >>test.out
3[maF[34m^[[m:.w >>test.out
]MaG[34m^[[m:.w >>test.out
j2]MaH[34m^[[m:.w >>test.out
]M]MaI[34m^[[m:.w >>test.out
2[MaJ[34m^[[m:.w >>test.out
k[MaK[34m^[[m:.w >>test.out
3[MaL[34m^[[m:.w >>test.out
:qa!
ENDTEST

- Bug in "vPPPP" on this text (Webb):[15;9H{[16;17Hcmd;[17;17H{[18;25Hcmd;    /* <-- Start cursor here */[19;25H{[20;25H}[21;17H}[22;9H}

Piece of Java[12;1H[?12l[?25h
[?25l[25;1H:so! Xdotest[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25hStart cursor here[?25l[18;40H[?12l[?25h[?25l[?12l[?25h[?25l[17;17H[7m{ 
                        cmd;    /* <-- Start cursor here */ 
                        { 
                        } 
                [?12l[?25h[?25l[16;1H                cmd; 
                [21;17H}[?12l[?25h[?25l[m[25;1H6 fewer lines[25;15H[K[16;24r[16;1H[6M[1;25r[19;1H{[20;9Htt m1 {[21;17Ht1;[22;9H} e1[24;9Htt m2 {[25;1H[K[25;1H6 fewer lines[16;9H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h?Bug?,/Piece/-2w! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 3 lines, 44 characters written[16;9H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^- Bug[?25l[31msearch hit BOTTOM, continuing at TOP[14;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hs/u/~u~/[?25l[14;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hs/i/~u~/[?25l[14;7Huuun "vPPPP" on this text (Webb):[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hs/o/~~~/[?25l[14;20Huuuuuuuuun this text (Webb):[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 48 characters appended[14;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hif has("ebcdic")[?25l
:  [?12l[?25h: let tt = "o\<C-V>193\<C-V>xc2\<C-V>o303 \<C-V>90a\<C-V>xfg\<C-V>o578\<Esc>
[24;80H"[25;1H
[?25l:  [?12l[?25h:else
[?25l:  [?12l[?25h: let tt = "o\<C-V>65\<C-V>x42\<C-V>o103 \<C-V>33a\<C-V>xfg\<C-V>o78\<Esc>"
[?25l:  [?12l[?25h:endif[1;1H[5L[?25l[1;1H]maC[34m^[[m:.w >>test.out
[maD[34m^[[m:.w >>test.out
k2[maE[34m^[[m:.w >>test.out
3[maF[34m^[[m:.w >>test.out
]MaG[34m^[[m:.w >>test.out[25;1H[K[14;1H[?12l[?25h[?25l[25;1H:[?12l[?25hexe "normal " . tt[?25l[15;24r[15;1H[L[1;25r[15;1HABC !a[34m^O[mg[34m^G[m8[25;1H[K[15;12H[?12l[?25h[?25l[25;1H:[?12l[?25hunlet tt[?25l[15;12H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 11 characters appended[15;12H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset vb[?25l[15;12H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^Piece[?25l[19;1H[?12l[?25h[21;15H[?25l{A[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 10 characters appended[21;16H[?12l[?25h[22;16H[?25l[1;24r[24;1H
[1;25r[24;9Htt m2 {[25;1H[K[24;15H[?12l[?25h[?25l{B[?12l[?25h[?25l
:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 10 characters appended[24;16H[?12l[?25h[?25l[1;24r[1;1H[4M[1;25r[21;17Ht2;[22;9H} e2[24;9Htt m3 {[25;1H[K[24;15H[?12l[?25h[?25l{C[?12l[?25h[?25l
:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 10 characters appended[24;16H[?12l[?25h[?25l{DC[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 11 characters appended[24;16H[?12l[?25h[23;1H[16;15H[?25l{EA[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 11 characters appended[16;16H[?12l[?25h[15;1H[?25l{F[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 3 characters appended[15;2H[?12l[?25h[18;9H[?25l}G e1[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 7 characters appended[18;10H[?12l[?25h
[?25l[1;24r[1;1H[5M[1;25r[20;17Hif (x)[21;17H{[22;25Ht3;[23;17H}[24;9H} e3[25;1H[K[24;9H[?12l[?25h[?25l}H e3[?12l[?25h[?25l
:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 7 characters appended[24;10H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H}[25;1H[K[24;1H[?12l[?25h[?5h[?5l[?25l}I[?12l[?25h[?25l
:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 3 characters appended[24;2H[?12l[?25h[23;9H[?25l}JH e3[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 8 characters appended[23;10H[?12l[?25h[22;16H[16;9H[?25l}K e2[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 7 characters appended[16;10H[?12l[?25h[9;1H[?25l{LF[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 4 characters appended[9;2H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test15.failed test.ok test.out X* viminfo
cp test15.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test15.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test15.in" 136 lines, 2246 characters[1;1HTests for :right on text with embedded TAB.
Also test formatting a paragraph.
Also test undo after ":%s" and formatting.

STARTTEST
:so small.vim
:set tw=65

:/^\s*test for :left/,/^\s*test for :center/ left
:/^\s*test for :center/,/^\s*test for :right/ center
:/^\s*test for :right/,/^xxx/-1 right
:set fo+=tcroql tw=72
/xxxxxxxx$
0gq6kk
:set nocp viminfo+=nviminfo
:" undo/redo here to make the next undo only work on the following changes
u[34m^R[m
:map gg :.,.+2s/^/x/<CR>kk:set tw=3<CR>gqq
/^aa
ggu
:?test for :left?,$w! test.out
:qa!
ENDTEST[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for :right on text with embedded TAB.[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[5;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[6;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 17 lines, 401 characters written[6;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[6;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[23;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset tw=65[?25l[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;9Htest for :left[25;1H[K[24;8H[?12l[?25h[?25l
:[?12l[?25h/^\s*test for :left/,/^\s*test for :center/ left[?25l[31msearch hit BOTTOM, continuing at TOP[m[25;37H[K[24;1Htest for :left[24;15H[K[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^\s*test for :center/,/^\s*test for :right/ center[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^\s*test for :right/,/^xxx/-1 right[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fo+=tcroql tw=72[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25hxxxxxxxx$[?25l[27m[m[H[2J[1;41Hasxxdfa[9Caxxxoike[2;40Hasxa;ofa[9Caxxxoike[3;39Hasdfaqwer[9Caxxxoike[4;47Ha[9Caxxxoikey[5;46Hfa[9Caxxxoikey[6;45Hdfa[9Caxxxoikey[7;44Hsdfa[9Caxxxoikey[8;43Hasdfa[9Caxxxoikey[9;42Hxasdfa[9Caxxxoikey[10;41Hasxxdfa[9Caxxxoikey[11;40Hasxa;ofa[9Caxxxoikey[12;39Hasdfaqwer[9Caxxxoikey

xxxxx xx xxxxxx
xxxxxxx xxxxxxxxx xxx xxxx xxxxx xxxxx xxx xx
xxxxxxxxxxxxxxxxxx xxxxx xxxx, xxxx xxxx xxxx xxxx xxx xx xx
xx xxxxxxx. xxxx xxxx.

> xx xx, xxxx xxxx xxx xxxx xxx xxxxx xxx xxx xxxxxxx xxx xxxxx
> xxxxxx xxxxxxx: xxxx xxxxxxx, xx xxxxxx xxxx xxxxxxxxxx

aa aa aa aa
bb bb bb bb
cc cc cc cc[20;50H[?12l[?25h[?25l[14;24r[24;1H
[1;25r[14;6H xx xxxxxx xxxxxxx xxxxxxxxx xxx xxxx xxxxx xxxxx xxx xx[15;62Hxx xxxxxxx.
xxxx xxxx.[16;11H[K[18;65Hxxxxxx[19;9Hx: xxxx xxxxxxx, xx xxxx[7C xxxxxxx[19;51H[K[24;1H[1m[34m~                                                                               [19;1H[?12l[?25h[18;1H
[?25l[25;1H[m:[?12l[?25hset nocp viminfo+=nviminfo[?25l[19;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" undo/redo here to make the next undo only work on the following changes[?25l[19;1H[?12l[?25h[?25l[25;1H1 more line; before #1  0 seconds ago[25;38H[K[27m[m[H[2J[1;1H0gq6kk
:set nocp viminfo+=nviminfo
:" undo/redo here to make the next undo only work on the following changes
u[34m^R[m
:map gg :.,.+2s/^/x/<CR>kk:set tw=3<CR>gqq
/^aa
ggu
:?test for :left?,$w! test.out
:qa!
ENDTEST[12;9Htest for :left[13;11Ha[13Ca[14;13Hfa[10Ca[15;11Hdfa[11Ca[16;17Hsdfa[12Ca[17;11Hasdfa[9Ca[18;17Hxasdfa[10Ca
asxxdfa[9Ca[21;9Htest for :center[22;11Ha[13Ca[23;13Hfa[10Cafd asdf[24;11Hdfa[11Ca[12;8H[?12l[?25h[?25l[25;1H1 line less; after #1  0 seconds ago[12;1Htest for :left[12;15H[K[13;1Ha[9C      a[13;25H[K[14;1Hfa[10C    a[14;25H[K[15;1Hdfa[7C      a[15;25H[K[16;1Hsdfa[12Ca[16;18H[K[17;1Hasdfa           a[17;25H[K[18;1Hxasdfa[10Ca[18;18H[K[21;9H                test for :center[22;11H [13C a[14Ca[23;13H  [8Cfa        [8Cafd asdf[24;11H   [11C dfa[12Ca[12;1H[?12l[?25h
[?25l[25;1H[K[25;1H:[?12l[?25hmap gg :.,.+2s/^/x/<CR>kk:set tw=3<CR>gqq[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^aa[?25l[27m[m[H[2J[1;42Hxasdfa[9Caxxxoike[2;41Hasxxdfa[9Caxxxoike[3;40Hasxa;ofa[9Caxxxoike[4;39Hasdfaqwer[9Caxxxoike[5;47Ha[9Caxxxoikey[6;46Hfa[9Caxxxoikey[7;45Hdfa[9Caxxxoikey[8;44Hsdfa[9Caxxxoikey[9;43Hasdfa[9Caxxxoikey[10;42Hxasdfa[9Caxxxoikey[11;41Hasxxdfa[9Caxxxoikey[12;40Hasxa;ofa[9Caxxxoikey[13;39Hasdfaqwer[9Caxxxoikey

xxxxx xx xxxxxx xxxxxxx xxxxxxxxx xxx xxxx xxxxx xxxxx xxx xx
xxxxxxxxxxxxxxxxxx xxxxx xxxx, xxxx xxxx xxxx xxxx xxx xx xx xx xxxxxxx.
xxxx xxxx.

> xx xx, xxxx xxxx xxx xxxx xxx xxxxx xxx xxx xxxxxxx xxx xxxxx xxxxxx
> xxxxxxx: xxxx xxxxxxx, xx xxxxxx xxxx xxxxxxxxxx

aa aa aa aa
bb bb bb bb
cc cc cc cc[22;1H[?12l[?25h[?25l


:.,.+2s/^/x/3 substitutions on 3 lines[22;1Hxaa aa aa aa
xbb bb bb bb
xcc cc cc cc[?12l[?25h[23;1H[22;1H[?25l[25;1H[K[25;1H:set tw=3[22;1H[?12l[?25h[?25l


3 more lines[1;24r[24;1H
[1;25r[21;5H[K[22;1Haa[22;3H[K[23;1Haa[23;3H[K[24;1Haa[25;1H[K[25;1H3 more lines[24;1H[?12l[?25h[?25l
3 fewer lines; before #2  0 seconds ago[21;1Haa aa aa aa
bb bb bb bb
cc cc cc cc
[1m[34m~                                                                               [21;1H[?12l[?25h
[?25l[m[25;1H[K[25;1H:[?12l[?25h?test for :left?,$w! test.out[?25l"test.out"[25;12H[K[25;12H[New] 111L, 2304C written[22;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test17.failed test.ok test.out X* viminfo
cp test17.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test17.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test17.in" 27 lines, 368 characters[1;1HTests for "gf" on ${VAR}

STARTTEST
:so small.vim
:if has("ebcdic")
: set isfname=@,240-249,/,.,-,_,+,,,$,:,~,{,}
:else
: set isfname=@,48-57,/,.,-,_,+,,,$,:,~,{,}
:endif
:if has("unix")
:let $CDIR = "."
/CDIR
:else
:if has("amiga")
:let $TDIR = "/testdir"
:else
:let $TDIR = "."
:endif
/TDIR
:endif
gf
:w! test.out
:qa!
ENDTEST[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for "gf" on ${VAR}[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 20 lines, 285 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[25;1H[K[24;1H[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hif has("ebcdic")[?25l
:  [?12l[?25h: set isfname=@,240-249,/,.,-,_,+,,,$,:,~,{,}
[?25l:  [?12l[?25h:else
[?25l:  [?12l[?25h: set isfname=@,48-57,/,.,-,_,+,,,$,:,~,{,}
[?25l:  [?12l[?25h:endif[1;1H[4L[?25l[2;1HSTARTTEST
:so small.vim
:if has("ebcdic")[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hif has("unix")[?25l
:  [?12l[?25h:let $CDIR = "."
[?25l:  [?12l[?25h/CDIR
[?25l:  [?12l[?25h:else
[?25l:  [?12l[?25h:if has("amiga")
[?25l:    [?12l[?25h:let $TDIR = "/testdir"
[?25l:    [?12l[?25h:else
[?25l:    [?12l[?25h:let $TDIR = "."
[?25l:    [?12l[?25h:endif
[?25l:  [?12l[?25h/TDIR
[?25l:  [?12l[?25h:endif[1;1H[10L[?25l[1;1HSTARTTEST
:so small.vim
:if has("ebcdic")
: set isfname=@,240-249,/,.,-,_,+,,,$,:,~,{,}
:else
: set isfname=@,48-57,/,.,-,_,+,,,$,:,~,{,}
:endif
:if has("unix")
:let $CDIR = "."
/CDIR
:else
:if has("amiga")
:let $TDIR = "/testdir"
:else[14;6H[K[15;2Hlet $TDIR = "."
:endif[16;7H[K[17;1H/TDIR[17;6H[K[18;1H:endif
gf[19;3H[K[20;1H:w! test.out
:qa![21;5H[K[22;1HENDTEST[23;1H[K[24;9H${CDIR}/test17a.in[25;1H[K[24;9H[?12l[?25h[?25l
"/sources/vim73/src/testdir/./test17a.in" 3 lines, 88 characters[1;1HThis file is just to test "gf" in test 17.
The contents is not important.
Just testing![3;14H[K[4;1H[1m[34m~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h
[?25l[m[25;1H[K[25;1H:[?12l[?25hw! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 3 lines, 88 characters written[2;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test18.failed test.ok test.out X* viminfo
cp test18.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test18.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test18.in" 16 lines, 213 characters[1;1HTests for not doing smart indenting when it isn't set.

STARTTEST
:so small.vim
:set nocin nosi ai
/some
2cc#test[34m^[[m
:?start?,$w! test.out
:qa!
ENDTEST

start text[13;17Hsome test text[14;17Htest text
test text[16;17Htest text
[1m[34m~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for not doing smart indenting when it isn't set.[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 6 lines, 76 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[10;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[11;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[11;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset nocin nosi ai[?25l[11;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25hsome[?25l[13;17H[?12l[?25h[?25l[13;24r[24;1H
[1;25r[13;17H#test[13;22H[K[24;1H[1m[34m~                                                                               [m[25;1H[K[13;21H[?12l[?25h[14;9H[?25l[25;1H:[?12l[?25h?start?,$w! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 4 lines, 41 characters written[14;9H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test19.failed test.ok test.out X* viminfo
cp test19.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test19.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test19.in" 25 lines, 465 characters[1;1HTests for "r<Tab>" with 'smarttab' and 'expandtab' set/not set.

STARTTEST
:set smarttab expandtab ts=8 sw=4
:" make sure that backspace works, no matter what termcap is used
:set t_kD=[34m^V[mx7f t_kb=[34m^V[mx08
/some
r[7C:set noexpandtab
/other
r
:" Test replacing with Tabs and then backspacing to undo it
0wR[21C[34m^H^H^H^[[m
:" Test replacing with Tabs
0wR[21C[34m^[[m
:?^start?,$w! test.out
:qa!
ENDTEST

start text[20;17Hsome test text
test text[22;17Hother test text
    a cde
    f ghi[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for "r<Tab>" with 'smarttab' and 'expandtab' set/not set.[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 13 lines, 295 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[17;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[18;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset smarttab expandtab ts=8 sw=4[?25l[18;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" make sure that backspace works, no matter what termcap is used[?25l[18;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset t_kD=^[34m^?[m t_kb=^[34m^H[?25l[27m[m[H[2J[1;1HTests for "r<Tab>" with 'smarttab' and 'expandtab' set/not set.

STARTTEST
:set smarttab expandtab ts=8 sw=4
:" make sure that backspace works, no matter what termcap is used
:set t_kD=[34m^V[mx7f t_kb=[34m^V[mx08
/some
r[7C:set noexpandtab
/other
r
:" Test replacing with Tabs and then backspacing to undo it
0wR[21C[34m^H^H^H^[[m
:" Test replacing with Tabs
0wR[21C[34m^[[m
:?^start?,$w! test.out
:qa!
ENDTEST

start text[20;17Hsome test text
test text[22;17Hother test text
    a cde
    f ghi[18;1H[?12l[?25h[?25l[25;1H/[?12l[?25hsome[?25l[20;17H[?12l[?25h[?25l    ome test text[20;20H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset noexpandtab[?25l[20;20H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25hother[?25l[22;17H[?12l[?25h[?25l    ther test text[22;20H[?12l[?25h[23;9H[?25l[25;1H[K[25;1H:[?12l[?25h" Test replacing with Tabs and then backspacing to undo it[?25l[23;9H[?12l[?25h    [?25l[?12l[?25h
   [?25l[25;1H[K[25;1H:[?12l[?25h" Test replacing with Tabs[?25l[24;4H[?12l[?25h    [?25l     [7Chi[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Htest text[25;1H[K[24;9H[?12l[?25h[?25l
:[?12l[?25h?^start?,$w! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 7 lines, 91 characters written[24;9H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test20.failed test.ok test.out X* viminfo
cp test20.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test20.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test20.in" 22 lines, 361 characters[1;1HTests Blockwise Visual when there are TABs before the text.
First test for undo working properly when executing commands from a register.
Also test this in an empty buffer.

STARTTEST
:so tiny.vim
G0"ay$k@au
:new
@auY:quit!
GP
/start here$
[34m^V[mjjlld
:/here$/,$-1w! test.out
:qa!
ENDTEST

test text test tex start here[18;17Hsome text[19;17Htest text
test text

Ox[34m^[[mjAy[34m^[[mkdd
[1m[34m~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests Blockwise Visual when there are TABs before the text.[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[5;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[6;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 9 lines, 92 characters written[6;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[6;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[15;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[16;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso tiny.vim[?25l[16;1H[?12l[?25h[22;1H[21;1H[?25l[21;24r[21;1H[L[1;25r[21;1Hx[25;1H[K[21;1H[?12l[?25h
[?25ly[?12l[?25h[21;1H[?25l[21;24r[24;1H
[1;25r[24;1H[1m[34m~                                                                               [21;1H[?12l[?25h[?25l[m[25;1H2 changes; before #1  0 seconds ago[21;1H[K[21;1H[?12l[?25h
[?25l[25;1H[K[25;1H:[?12l[?25hnew[?25l[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [m[12;1H[1m[7m[No Name]                                                                       [m[24;1H[7mtest20.in                                                                       [1;1H[?12l[?25h[?25l[1;11r[m[1;1H[L[1;25r[1;1Hx[12;11H[1m[7m[+][m[25;1H[K[1;1H[?12l[?25h
[?25ly[?12l[?25h[1;1H[?25l[1;11r[11;1H
[1;25r[11;1H[1m[34m~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H1 line less; before #1  0 seconds ago[1;1H[K[12;11H[1m[7m    [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hquit![?25l[1;1HTests Blockwise Visual when there are TABs before the text.
First test for undo working properly when executing commands from a register.[2;78H[K[3;1HAlso test this in an empty buffer.[3;35H[K[4;1H[K[5;1HSTARTTEST[5;10H[K[6;1H:so tiny.vim[6;13H[K[7;1HG0"ay$k@au[7;11H[K[8;1H:new[8;5H[K[9;1H@auY:quit![9;11H[K[10;1HGP[10;3H[K[11;1H/start here$[11;13H[K[12;1H[34m^V[mjjlld[12;8H[K[24;1H[1m[34m~                                                                               [22;1H[?12l[?25h[?25l[m[22;1H[K[23;1HOx[34m^[[mjAy[34m^[[mkdd[23;13H[K[22;1H[?12l[?25h
[?25l[25;1H[K[25;1H/[?12l[?25hstart here$[?25l[31msearch hit BOTTOM, continuing at TOP[17;20H[?12l[?25h[?25l[?12l[?25h[?25l[m[7ms[18;20H[?12l[?25h[?25le[19;20H[?12l[?25h[?25l[17;21Ht[18;21H [19;20Ht[?12l[?25h[?25l[17;22Ha[18;22Ht[19;21H [?12l[?25h[?25l[m[17;20Hrt here[17;27H[K[18;20Hext[18;23H[K[19;20Hex[19;23H[K[17;20H[?12l[?25h[18;20H[?25l[25;1H[K[25;1H:[?12l[?25h/here$/,$-1w! test.out[?25l[31msearch hit BOTTOM, continuing at TOP[m"test.out" [25;12H[K[25;12H[New File] 6 lines, 57 characters written[18;20H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test21.failed test.ok test.out X* viminfo
cp test21.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test21.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test21.in" 19 lines, 297 characters[1;1HTests for [ CTRL-I with a count and CTRL-W CTRL-I with a count

STARTTEST
:so small.vim
/start
6[      :.w! test.out
?start here
6[34m^W[m     :.w >>test.out
:qa!
ENDTEST

#include test21.in

/* test text test tex start here[15;17Hsome text[16;17Htest text[17;17Hstart OK if found this line[18;9Hstart found wrong line
test text
[1m[34m~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for [ CTRL-I with a count and CTRL-W CTRL-I with a count[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 6 lines, 73 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[10;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[11;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[11;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25hstart[?25l[14;23H[?12l[?25h[17;17H[?25l[25;1H[K[25;1H:[?12l[?25h.w! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 1 line, 30 characters written[17;17H[?12l[?25h[?25l[25;1H[K[25;1H?[?12l[?25hstart here[?25l[14;23H[?12l[?25h[?25l[1;1H/* test text test tex start here[1;33H[K[2;17Hsome text
         [7Ctest text
                start OK if found this line
        start found wrong line
test text[6;10H[K[7;1H[1m[34m~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [m[12;1H[1m[7mtest21.in                                                                       [m[13;1H6[34m^W[m     :.w >>test.out
:qa![14;5H[K[15;1HENDTEST[15;17H[K[16;17H[K[17;1H#include test21.in[17;19H[K[18;9H[K[19;1H/* test text test tex start here
                some text[20;26H[K[21;1H                test text[21;26H[K[22;1H                start OK if found this line[22;44H[K[23;1H        start found wrong line[23;31H[K[24;1H[7mtest21.in                                                                       [4;17H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 30 characters appended[4;17H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test22.failed test.ok test.out X* viminfo
cp test22.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test22.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test22.in" 13 lines, 197 characters[1;1HTests for file with some lines ending in CTRL-M, some not[34m^M
^M[m
STARTTEST
:set ta tx
:e!
:$-3,$w! test.out
:qa!
ENDTEST

this lines ends in a[34m^M[m
this one doesn't
this one does[34m^M[m
and the last one doesn't
[1m[34m~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for file with some lines ending in CTRL-M, some not[34m^M[m[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 4 lines, 38 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[8;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[9;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset ta tx[?25l[9;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he![?25l"test22.in" 13 lines, 197 characters[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$-3,$w! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 4 lines, 79 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test23.failed test.ok test.out X* viminfo
cp test23.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test23.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test23.in" 15 lines, 282 characters[1;1HTests for complicated + argument to :edit command

STARTTEST
:$-1w! Xfile1
:$w! Xfile2
:edit +1|s/|/PIPE/|w Xfile1| e Xfile2|1 | s/\//SLASH/|w
:w! test.out
:e Xfile1
:w >> test.out
:qa!
ENDTEST

The result should be in Xfile1: "fooPIPEbar", in Xfile2: "fooSLASHbar"
foo|bar
foo/bar
[1m[34m~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for complicated + argument to :edit command[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 7 lines, 125 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[11;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[12;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$-1w! Xfile1[?25l"Xfile1" [25;10H[K[25;10H[New File] 1 line, 8 characters written[12;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$w! Xfile2[?25l"Xfile2" [25;10H[K[25;10H[New File] 1 line, 8 characters written[12;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hedit +1|s/|/PIPE/|w Xfile1| e Xfile2|1 | s/\//SLASH/|w[?25l"Xfile1" [25;10H[K[25;10H1 line, 8 characters
foo|bar
"Xfile1" 1 line, 11 characters written
"Xfile2" 1 line, 8 characters
foo/bar
"Xfile2" 1 line, 12 characters written
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 1 line, 12 characters written
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25he Xfile1[?25l"Xfile1" 1 line, 11 characters[1;1H[7L[1;1HfooPIPEbar
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [m[25;1H[K[25;1H"Xfile1" 1 line, 11 characters[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >> test.out[?25l"test.out" [25;12H[K[25;12H1 line, 11 characters appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test24.failed test.ok test.out X* viminfo
cp test24.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test24.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test24.in" 79 lines, 1240 characters[1;1HTests for regexp with backslash and other special characters inside []
Also test backslash for hex/octal numbered character.

STARTTEST
:set nocompatible viminfo+=nviminfo
/[\x]
x/[\t\]]
x/[]y]
x/[\]]
x/[y^]
x/[$y]
x/[\x61]
x/[\x60-\x64]
xj0/[\x785]
x/[\o143]
x/[\o140-\o144]
x/[\o417]
x/\%x42
x/\%o103
x/[\x00]
x
:s/[\x00-\x10]//g

:s/[\x-z]\+//[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for regexp with backslash and other special characters inside [][25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[4;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 44 lines, 480 characters written[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[5;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;1H:s/\(a\)*\(12\)\@>/A/

:s/\(foo\)\@<!bar/A/

:s/\(an\_s\+\)\@<=file/A/

:s/^\(\h\w*\%(->\|\.\)\=\)\+=/XX/

:s/^\(\h\w*\%(->\|\.\)\=\)\+=/YY/
:?start?,$w! test.out
:qa!
ENDTEST

start
test \text test text
test    text test text
test text ]test text
test ]text test text
test text te^st text
test te$xt test text
test taext test text  x61
test tbext test text  x60-x64
test 5text test text  x78 5
testc text test text  o143[12;1H[?12l[?25h
[?25l[25;1H:so! Xdotest[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset nocompatible viminfo+=nviminfo[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h[\x][?25l[15;6H[?12l[?25h[?25ltext test text[15;20H[K[15;6H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h[\t\]][?25l[16;8H[?12l[?25h[?25ltext test tex[16;20H[K[16;6H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h[]y][?25l[17;11H[?12l[?25h[?25ltest text[17;20H[K[17;11H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h[\]][?25l[18;6H[?12l[?25h[?25ltext test text[18;20H[K[18;6H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h[y^][?25l[19;13H[?12l[?25h[?25lst text[19;20H[K[19;13H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h[$y][?25l[20;8H[?12l[?25h[?25lxt test text[20;20H[K[20;8H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h[\x61][?25l[21;7H[?12l[?25h[?25lext test text  x61[21;25H[K[21;7H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h[\x60-\x64][?25l[22;7H[?12l[?25h[?25lext test text  x60-x64[22;29H[K[22;7H[?12l[?25h[23;7H[?25l[25;1H[K[25;1H/[?12l[?25h[\x785][?25l[23;6H[?12l[?25h[?25ltext test text  x78 5[23;27H[K[23;6H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h[\o143][?25l[24;5H[?12l[?25h[?25l text test text  o143[24;26H[K[24;5H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h[\o140-\o144][?25l[1;24r[24;1H
[1;25r[24;1Htesdt text test text  o140-o144[25;1H[K[24;4H[?12l[?25h[?25lt text test text  o140-o14[24;31H[K[24;4H[?12l[?25h[?25l
/[?12l[?25h[\o417][?25l[1;24r[24;1H
[1;25r[24;1Htest7 text test text  o41 7[25;1H[K[24;5H[?12l[?25h[?25l text test text  o41 7[24;27H[K[24;5H[?12l[?25h[?25l
/[?12l[?25h\%x42[?25l[1;24r[24;1H
[1;25r[24;1Htest text tBest text  \%x42[25;1H[K[24;12H[?12l[?25h[?25lest text  \%x42[24;27H[K[24;12H[?12l[?25h[?25l
/[?12l[?25h\%o103[?25l[1;24r[24;1H
[1;25r[24;1Htest text teCst text  \%o103[25;1H[K[24;13H[?12l[?25h[?25lst text  \%o103[24;28H[K[24;13H[?12l[?25h[?25l
/[?12l[?25h[\x00][?25l[1;24r[24;1H
[1;25r[24;1Htest text [34m^@[mtest text  [\x00][25;1H[K[24;11H[?12l[?25h[?25ltest text  [\x00][24;28H[K[24;11H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Htest te[34m^@[mxt t[34m^D[mest t[34m^P[mext  [\x00-\x10][24;11H[?12l[?25h[?25l
:[?12l[?25hs/[\x00-\x10]//g[?25l3 substitutions on 1 line[24;8Hxt test text  [\x00-\x10][24;33H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Htest \xyztext test text  [\x-z][25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hs/[\x-z]\+//[?25l[24;6Htext test text  [\x-z][24;28H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Htest text tev\uyst text  [\u-z][25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hs/[\u-z]\{2,}//[?25l[24;13Hst text  [\u-z][24;28H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hxx aaaaa xx a[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hs/\(a\)\+//[?25l[24;4H xx [24;10H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hxx aaaaa xx a[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hs/\(a*\)\+//[?25l[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hxx aaaaa xx a[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hs/\(a*\)*//[?25l[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hxx aaaaa xx[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hs/\(a\)\{2,3}/A/[?25l[24;4HAaa xx[24;10H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hxx aaaaa xx[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hs/\(a\)\{-2,3}/A/[?25l[24;4HAaaa x[24;11H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hxx aaa12aa xx[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hs/\(a\)*\(12\)\@>/A/[?25l[24;4HAaa xx[24;10H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hxx foobar xbar xx[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hs/\(foo\)\@<!bar/A/[?25l[24;12HA xx[24;16H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hxx an file xx[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hs/\(an\_s\+\)\@<=file/A/[?25l[24;7HA xx[24;12H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hx= 9;[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hs/^\(\h\w*\%(->\|\.\)\=\)\+=/XX/[?25l[24;1HXX[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hhh= 77;[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hs/^\(\h\w*\%(->\|\.\)\=\)\+=/YY/[?25l[24;1HYY 77;[24;7H[K[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h?start?,$w! test.out[?25l"test.out" [25;12H[K[25;12H[New] 29L, 571C written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test25.failed test.ok test.out X* viminfo
cp test25.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test25.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test25.in" 31 lines, 840 characters[1;1HTest for jumping to a tag with 'hidden' set, with symbolic link in path of tag.
This only works for Unix, because of the symbolic link.

STARTTEST
:so small.vim
:set hidden
:" Create a link from test25.dir to the current directory.
:!rm -f test25.dir
:!ln -s . test25.dir
:" Create tags.text, with the current directory name inserted.
/tags line
:r !pwd
d$/test
hP:.w! tags.test
:" Try jumping to a tag in the current file, but with a path that contains a
:" symbolic link.  When wrong, this will give the ATTENTION message.  The next
:" space will then be eaten by hit-return, instead of moving the cursor to 'd'.
:set tags=tags.test
G[34m^][m x:.w! test.out
:!rm -f test25.dir tags.test
:qa!
ENDTEST

tags line:[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for jumping to a tag with 'hidden' set, with symbolic link in path of tag.[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[4;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 17 lines, 540 characters written[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[5;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[22;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset hidden[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Create a link from test25.dir to the current directory.[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h!rm -f test25.dir[?25l[18C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H:[?12l[?25h!ln -s . test25.dir[?25l[20C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H:[?12l[?25h" Create tags.text, with the current directory name inserted.[?25l[27m[m[H[2J[1;1HTest for jumping to a tag with 'hidden' set, with symbolic link in path of tag.
This only works for Unix, because of the symbolic link.

STARTTEST
:so small.vim
:set hidden
:" Create a link from test25.dir to the current directory.
:!rm -f test25.dir
:!ln -s . test25.dir
:" Create tags.text, with the current directory name inserted.
/tags line
:r !pwd
d$/test
hP:.w! tags.test
:" Try jumping to a tag in the current file, but with a path that contains a
:" symbolic link.  When wrong, this will give the ATTENTION message.  The next
:" space will then be eaten by hit-return, instead of moving the cursor to 'd'.
:set tags=tags.test
G[34m^][m x:.w! test.out
:!rm -f test25.dir tags.test
:qa!
ENDTEST

tags line:[23;1H[?12l[?25h[?25l

/[?12l[?25htags line[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hr !pwd[?25l[?12l[?25h[27m[m[H[2J[?25l[1;1HThis only works for Unix, because of the symbolic link.

STARTTEST
:so small.vim
:set hidden
:" Create a link from test25.dir to the current directory.
:!rm -f test25.dir
:!ln -s . test25.dir
:" Create tags.text, with the current directory name inserted.
/tags line
:r !pwd
d$/test
hP:.w! tags.test
:" Try jumping to a tag in the current file, but with a path that contains a
:" symbolic link.  When wrong, this will give the ATTENTION message.  The next
:" space will then be eaten by hit-return, instead of moving the cursor to 'd'.
:set tags=tags.test
G[34m^][m x:.w! test.out
:!rm -f test25.dir tags.test
:qa!
ENDTEST

tags line:
/sources/vim73/src/testdir[?12l[?25h[?25l[24;1H[K[24;1H[?12l[?25h[?25l
/[?12l[?25htest[?25l[1;24r[24;1H
[1;25r[24;1HSECTION_OFF     /test25.dir/test25.in   /^#define  SECTION_OFF  3$/[25;1H[K[24;18H[?12l[?25h[?25l/sources/vim73/src/testdir/test25.dir/test25.in /^#define  SECTI[24;1H[1m[34m@                                                                               [1;24r[m[24;1H
[1;25r[23;1HSECTION_OFF     /sources/vim73/src/testdir/test25.dir/test25.in /^#define  SECTII[24;1HON_OFF  3$/[23;42H[?12l[?25h[?25l

:[?12l[?25h.w! tags.test[?25l"tags.test" [25;13H[K[25;13H[New File] 1 line, 88 characters written[23;42H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Try jumping to a tag in the current file, but with a path that contains a[?25l[23;42H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" symbolic link.  When wrong, this will give the ATTENTION message.  The next[?25l[23;42H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" space will then be eaten by hit-return, instead of moving the cursor to 'd'.[?25l[23;42H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset tags=tags.test[?25l[23;42H[?12l[?25h[?25l[1;24r[1;1H[6M[1;25r[20;1H/*tx.c*/
#define  SECTION_OFF  3
#define  NUM_SECTIONS 3

SECTION_OFF[25;1H[K[24;1H[?12l[?25h[21;1H#[?25lefine  SECTION_OFF  3[21;23H[K[21;2H[?12l[?25h[?25l[25;1H:[?12l[?25h.w! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 1 line, 23 characters written[21;2H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h!rm -f test25.dir tags.test[?25l[28C[?1l>[?12l[?25h[?1049l
[No write since last change]

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[?1l>[?12l[?25h[?1049l
rm -rf X* test.ok viminfo
rm -rf test26.failed test.ok test.out X* viminfo
cp test26.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test26.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test26.in" 44 lines, 750 characters[1;1HTest for :execute, :while and :if

STARTTEST
:so small.vim
mt:let i = 0
:while i < 12
:  let i = i + 1
:  if has("ebcdic")
:    execute "normal o" . i . "\047"
:  else
:    execute "normal o" . i . "\033"
:  endif
:  if i % 2
:    normal Ax[34m^V^[[m
:    if i == 9
:      break
:    endif
:    if i == 5
:      continue
:    else
:      let j = 9
:      while j > 0
:[8Cif has("ebcdic")
:[10Cexecute "normal" j . "a" . j . "\x27"[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for :execute, :while and :if[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 39 lines, 696 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[19M[1;25r[6;1H:[8Celse
:[10Cexecute "normal" j . "a" . j . "\x1b"
:[8Cendif
:[8Clet j = j - 1
:      endwhile
:    endif
:  endif
:  if i == 9
:    if has("ebcdic")
:      execute "normal Az\047"
:    else
:      execute "normal Az\033"
:    endif
:  endif
:endwhile
:unlet i j
:'t,$w! test.out
:qa!
ENDTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet i = 0[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hwhile i < 12[?25l
:  [?12l[?25h:  let i = i + 1
[?25l:  [?12l[?25h:  if has("ebcdic")
[?25l:    [?12l[?25h:    execute "normal o" . i . "\047"
[?25l:    [?12l[?25h:  else
[?25l:    [?12l[?25h:    execute "normal o" . i . "\033"
[?25l:    [?12l[?25h:  endif
[?25l:  [?12l[?25h:  if i % 2
[?25l:    [?12l[?25h:    normal Ax^[34m^[[m
[?25l:    [?12l[?25h:    if i == 9
[?25l:      [?12l[?25h:      break
[?25l:      [?12l[?25h:    endif
[?25l:    [?12l[?25h:    if i == 5
[?25l:      [?12l[?25h:      continue
[?25l:      [?12l[?25h:    else
[?25l:      [?12l[?25h:      let j = 9
[?25l:      [?12l[?25h:      while j > 0
[?25l:[8C[?12l[?25h:        if has("ebcdic")
[?25l:[10C[?12l[?25h:          execute "normal" j . "a" . j . "\x27"
[?25l:[10C[?12l[?25h:        else
[?25l:[10C[?12l[?25h:          execute "normal" j . "a" . j . "\x1b"
[?25l:[10C[?12l[?25h:        endif
[?25l:[8C[?12l[?25h:        let j = j - 1
[?25l:[8C[?12l[?25h:      endwhile
[?25l:      [?12l[?25h:    endif
[?25l:    [?12l[?25h:  endif
[?25l:  [?12l[?25h:  if i == 9
[?25l:    [?12l[?25h:    if has("ebcdic")
[?25l:      [?12l[?25h:      execute "normal Az\047"
[?25l:      [?12l[?25h:    else
[?25l:      [?12l[?25h:      execute "normal Az\033"
[?25l:      [?12l[?25h:    endif
[?25l:    [?12l[?25h:  endif
[?25l:  [?12l[?25h:endwhile[27m[m[H[2J[?25l[1;1H:    endif
:  endif
:  if i == 9
:    if has("ebcdic")
:      execute "normal Az\047"
:    else
:      execute "normal Az\033"
:    endif
:  endif
:endwhile
:unlet i j
:'t,$w! test.out
:qa!
ENDTEST

1x999999999888888887777777666666555554444333221
2
3x999999999888888887777777666666555554444333221
4
5x
6
7x999999999888888887777777666666555554444333221
8
9x[?12l[?25h[?25l
:[?12l[?25hunlet i j[?25l[24;2H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h't,$w! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 10 lines, 159 characters written[24;2H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test27.failed test.ok test.out X* viminfo
cp test27.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test27.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test27.in" 20 lines, 270 characters[1;1HTest for expanding file names

STARTTEST
:!mkdir Xdir1
:!mkdir Xdir2
:!mkdir Xdir3
:cd Xdir3
:!mkdir Xdir4
:cd ..
:w Xdir1/file
:w Xdir3/Xdir4/file
:n Xdir?/*/file
Go[34m^R[m%[34m^[[m:.w! test.out
:n! Xdir?/*/nofile
Go[34m^R[m%[34m^[[m:.w >>test.out
:e! xx
:!rm -rf Xdir1 Xdir2 Xdir3
:qa!
ENDTEST

[1m[34m~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for expanding file names[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 15 lines, 220 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[19;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h!mkdir Xdir1[?25l[13C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H:[?12l[?25h!mkdir Xdir2[?25l[13C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H:[?12l[?25h!mkdir Xdir3[?25l[13C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H:[?12l[?25hcd Xdir3[?25l/sources/vim73/src/testdir/Xdir3[27m[m[H[2J[1;1HTest for expanding file names

STARTTEST
:!mkdir Xdir1
:!mkdir Xdir2
:!mkdir Xdir3
:cd Xdir3
:!mkdir Xdir4
:cd ..
:w Xdir1/file
:w Xdir3/Xdir4/file
:n Xdir?/*/file
Go[34m^R[m%[34m^[[m:.w! test.out
:n! Xdir?/*/nofile
Go[34m^R[m%[34m^[[m:.w >>test.out
:e! xx
:!rm -rf Xdir1 Xdir2 Xdir3
:qa!
ENDTEST

[1m[34m~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [20;1H[?12l[?25h[?25l[25;1H[m:[?12l[?25h!mkdir Xdir4[?25l[13C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H:[?12l[?25hcd ..[?25l/sources/vim73/src/testdir[27m[m[H[2J[1;1HTest for expanding file names

STARTTEST
:!mkdir Xdir1
:!mkdir Xdir2
:!mkdir Xdir3
:cd Xdir3
:!mkdir Xdir4
:cd ..
:w Xdir1/file
:w Xdir3/Xdir4/file
:n Xdir?/*/file
Go[34m^R[m%[34m^[[m:.w! test.out
:n! Xdir?/*/nofile
Go[34m^R[m%[34m^[[m:.w >>test.out
:e! xx
:!rm -rf Xdir1 Xdir2 Xdir3
:qa!
ENDTEST

[1m[34m~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [20;1H[?12l[?25h[?25l[25;1H[m:[?12l[?25hw Xdir1/file[?25l"Xdir1/file" [New File] 20 lines, 270 characters written[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw Xdir3/Xdir4/file[?25l"Xdir3/Xdir4/file" [New File] 20 lines, 270 characters written[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hn Xdir?/*/file[?25l"Xdir3/Xdir4/file" 20 lines, 270 characters[1;1H[?12l[?25h[20;1H[?25l
Xdir3/Xdir4/file[21;17H[K[21;16H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 1 line, 17 characters written[21;16H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hn! Xdir?/*/nofile[?25l"Xdir?/*/nofile" [New DIRECTORY][1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m
Xdir?/*/nofile[2;15H[K[2;14H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 15 characters appended[2;14H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! xx[?25l"xx" [New File][2;1H[1m[34m~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h!rm -rf Xdir1 Xdir2 Xdir3[?25l[26C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[?1l>[?12l[?25h[?1049l
rm -rf X* test.ok viminfo
rm -rf test28.failed test.ok test.out X* viminfo
cp test28.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test28.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test28.in" 23 lines, 364 characters[1;1HTest for sourcing a file with CTRL-V's at the end of the line

STARTTEST
:/firstline/+1,/lastline/-1w! Xtestfile
:so Xtestfile
Gmm__1[34m^[^[[m__2[34m^[[m__3[34m^[^[[m__4[34m^[[m__5[34m^[[m:'m,$s/[34m^@[m/0/g
:'m,$w! test.out
:qa!
ENDTEST

firstline
map __1 afirst
map __2 asecond
map __3 athird
map __4 afourth
map __5 afifth
map __1 asd[34m^V[m
map __2 asd[34m^V^V[m
map __3 asd[34m^V^V[m
map __4 asd[34m^V^V^V[m
map __5 asd[34m^V^V^V[m
lastline

[1m[34m~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for sourcing a file with CTRL-V's at the end of the line[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 5 lines, 114 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[9;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[10;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/firstline/+1,/lastline/-1w! Xtestfile[?25l"Xtestfile" [25;13H[K[25;13H[New File] 10 lines, 148 characters written[10;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso Xtestfile[?25l[10;1H[?12l[?25h[23;1H[24;12H[?25l[23;1Hsd
map __2 asd[34m^[[m[24;14H[K[24;12H[?12l[?25h[?25l[2Csecond[?12l[?25hd  [?25lsd[34m^[[?12l[?25h^[[m  [13C[?25l[24;24Hsd[34m^@[mmap __5 asd[34m^@[?12l[?25h[?25l[m[2Cfifth[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h'm,$s/[34m^@[m/0/g[?25l[24;26H0map __5 asd0fifth[24;44H[K[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h'm,$w! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 2 lines, 45 characters written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test29.failed test.ok test.out X* viminfo
cp test29.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test29.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test29.in" 56 lines, 939 characters[1;1HTest for joining lines and marks in them
 in compatible and nocompatible modes
 and with 'joinspaces' set or not
 and with 'cpoptions' flag 'j' set or not

STARTTEST
:set nocompatible viminfo+=nviminfo
:set nojoinspaces
:set cpoptions-=j
/firstline/
j"tdGpJjJjJjJjJjJjJjJjJjJjJjJjJjJj05lmx2j06lmy2k4Jy3l$p`xyl$p`yy2l$p:set cpoptioo[12;1Hns+=j
j05lmx2j06lmy2k4Jy3l$p`xyl$p`yy2l$p:set cpoptions-=j joinspaces
j"tpJjJjJjJjJjJjJjJjJjJjJjJjJjJj05lmx2j06lmy2k4Jy3l$p`xyl$p`yy2l$p:set cpoptionss[15;1H+=j
j05lmx2j06lmy2k4Jy3l$p`xyl$p`yy2l$p:set cpoptions-=j nojoinspaces compatible
j"tpJjJjJjJjJjJjJjJjJjJjJjJjJjJj4Jy3l$pjdG:?firstline?+1,$w! test.out
:qa!
ENDTEST

firstline
asdfasdf.
asdf
asdfasdf.[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for joining lines and marks in them[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[6;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[7;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 10 lines, 470 characters written[7;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[7;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[19;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset nocompatible viminfo+=nviminfo[?25l[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset nojoinspaces[?25l[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cpoptions-=j[?25l[20;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25hfirstline/[?25l[25;11H[K[25;1H[21;1H[?12l[?25h
[?25l


37 fewer lines[22;1H[1m[34m~                                                                               [23;1H~                                                                               [24;1H~                                                                               [21;1H[?12l[?25h[?25l[m[25;4Hmore lines[25;14H[K[22;1Hasdfasdf.[22;10H[K[23;1Hasdf[23;5H[K[24;1Hasdfasdf. [24;11H[K[22;1H[?12l[?25h[?25l[10Casdf
asdfasdf.[24;5H[K[22;10H[?12l[?25h[23;10H[?25l asdf
asdfasdf.[23;11H[?12l[?25h[24;11H[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf.[25;1H[K[24;16H[?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf.      [?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf.[7C[?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf.[14C[?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf[?12l[?25h[?25lf asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf[?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf [?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf[7C[?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf[8C[?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf[7C[?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[23;1Hasdfasdf
asdf[23;24H[?12l[?25h[?25l asdf
zx cvn.[23;25H[?12l[?25h[24;7Hzx cv[?25l[1;24r[1;1H[3M[1;25r[22;1Has dfg?
hjkl iop!
ert[23;6H[?12l[?25hhjkl i[21;7H[?25l. as dfg? hjkl iop! ert
zx cvn.
as dfg?[23;8H[K[24;1Hhjkl iop![21;26H[?12l[?25h er[?25lt er[?12l[?25hzx cv[26C[?25lrn[?12l[?25h[21;23H[10C[?25lnop[?12l[?25h[?25l[25;1H:[?12l[?25hset cpoptions+=j[?25l[21;35H[?12l[?25h[22;7Hzx cv[24;6Hhjkl i[22;7H[?25l. as dfg? hjkl iop! ert[23;1H[K[24;1H[1m[34m~                                                                               [22;26H[?12l[?25h[m er[?25lt er[?12l[?25hzx cv[26C[?25lrn[?12l[?25h[22;23H[10C[?25lnop[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cpoptions-=j joinspaces[?25l[22;35H[?12l[?25h
[?25l

37 more lines[25;14H[K[24;1Hasdfasdf.[24;10H[K[24;1H[?12l[?25h[?25l[11Casdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf.[25;1H[K[24;10H[?12l[?25h[?25l  asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf. [?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf.      [?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf.      [?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf.[7C[?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf.[14C[?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf[?12l[?25h[?25lf asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf[?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf [?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf[7C[?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf[8C[?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf[7C[?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf[15C[?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hzx cvn.[?12l[?25hzx cv[?25l[1;24r[1;1H[2M[1;25r[23;1Has dfg?
hjkl iop![?12l[?25hhjkl i[22;7H[?25l.  as dfg?  hjkl iop!  ert
zx cvn.
as dfg?[24;8H[K[22;28H[?12l[?25h  er[?25lt  e[?12l[?25hzx cv[29C[?25len[?12l[?25h[22;25H[11C[?25lnop[?12l[?25h[?25l


:[?12l[?25hset cpoptions+=j[?25l[22;38H[?12l[?25h[23;7Hzx cv[?25l[1;24r[24;1H
[1;25r[24;1Hhjkl iop![25;1H[K[24;6H[?12l[?25hhjkl i[22;7H[?25l.  as dfg? hjkl iop! ert[23;1H[K[24;1H[1m[34m~                                                                               [22;27H[?12l[?25h[m er[?25lt er[?12l[?25hzx cv[27C[?25lrn[?12l[?25h[22;24H[10C[?25lnop[?12l[?25h[?25l


:[?12l[?25hset cpoptions-=j nojoinspaces compatible[?25l[22;36H[?12l[?25h
[?25l

37 more lines[25;14H[K[24;1Hasdfasdf.[24;10H[K[24;1H[?12l[?25h[?25l[11Casdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf.[25;1H[K[24;10H[?12l[?25h[?25l  asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf. [?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf.      [?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf.      [?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf.[7C[?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf.[14C[?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf[?12l[?25h[?25lf asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf[?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf [?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf[7C[?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf[8C[?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf[7C[?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hasdfasdf[15C[?12l[?25h[?25l asdf[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hzx cvn.[?12l[?25h[?25l.  as dfg? hjkl iop! ert[24;8H[?12l[?25h[22C[?25lt  a[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hzx cvn.[?12l[?25h[?25l
5 fewer lines[24;1H[1m[34m~                                                                               [23;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h?firstline?+1,$w! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 49 lines, 821 characters written[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test30.failed test.ok test.out X* viminfo
cp test30.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test30.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test30.in" 222 lines, 3463 characters[1;1HTest for a lot of variations of the 'fileformats' option

Note: This test will fail if "cat" is not available.

STARTTEST
:so small.vim
:" first write three test files, one in each format
:set fileformat=unix
:set fileformats=
:/^1/w! XX1
:/^2/w! XX2
:/^3/w! XX3
:/^4/w! XX4
:/^5/w! XX5
:/^6/w! XX6
:/^7/w! XX7
:/^8/w! XX8
:/^9/w! XX9
:/^10/w! XX10
:/^unix/;/eof/-1w! XXUnix
:/^dos/;/eof/-1w! XXDos
:set bin noeol
:$w! XXMac
:set nobin eol[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for a lot of variations of the 'fileformats' option[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[5;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[6;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 195 lines, 3271 characters written[6;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[6;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;1H:$r XXtt62
:$r XXtt63
Go7[34m^[[m:$r XXtt71
Go8[34m^[[m:$r XXtt81
Go9[34m^[[m:$r XXtt91
:$r XXtt92
:$r XXtt93
Go10[34m^[[m:$r XXUnix
:set nobinary ff&
:w
:qa!
ENDTEST

1
2
3
4
5
6
7
8
9
10[12;1H[?12l[?25h
[?25l[25;1H:so! Xdotest[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" first write three test files, one in each format[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fileformat=unix[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fileformats=[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^1/w! XX1[?25l"XX1" [25;7H[K[25;7H[New File] 1 line, 2 characters written[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^2/w! XX2[?25l"XX2" [25;7H[K[25;7H[New File] 1 line, 2 characters written[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^3/w! XX3[?25l"XX3" [25;7H[K[25;7H[New File] 1 line, 2 characters written[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^4/w! XX4[?25l"XX4" [25;7H[K[25;7H[New File] 1 line, 2 characters written[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^5/w! XX5[?25l"XX5" [25;7H[K[25;7H[New File] 1 line, 2 characters written[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^6/w! XX6[?25l"XX6" [25;7H[K[25;7H[New File] 1 line, 2 characters written[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^7/w! XX7[?25l"XX7" [25;7H[K[25;7H[New File] 1 line, 2 characters written[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^8/w! XX8[?25l"XX8" [25;7H[K[25;7H[New File] 1 line, 2 characters written[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^9/w! XX9[?25l"XX9" [25;7H[K[25;7H[New File] 1 line, 2 characters written[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^10/w! XX10[?25l"XX10" [25;8H[K[25;8H[New File] 1 line, 3 characters written[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^unix/;/eof/-1w! XXUnix[?25l"XXUnix" [25;10H[K[25;10H[New File] 2 lines, 10 characters written[1;24r[24;1H
[1;25r[24;1Hunix[25;1H[K[25;1H"XXUnix" [New File] 2 lines, 10 characters written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^dos/;/eof/-1w! XXDos[?25l"XXDos" [25;9H[K[25;9H[New File] 2 lines, 10 characters written[1;24r[1;1H[4M[1;25r[21;1Hunix
eof

dos[34m^M[m[25;1H[K[25;1H"XXDos" [New File] 2 lines, 10 characters written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset bin noeol[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$w! XXMac[?25l"XXMac" [25;9H[K[25;9H[New File][Incomplete last line] 1 line, 8 characters written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset nobin eol[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe XXUnix XXDos XXMac[?25l3 buffers wiped out[25;21H[K[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" create mixed format files[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hif has("vms")[?25l
:  [?12l[?25h: !copy XXUnix,XXDos XXUxDs.
[?25l:  [?12l[?25h: !copy XXUnix,XXMac XXUxMac.
[?25l:  [?12l[?25h: !copy XXDos,XXMac  XXDosMac.
[?25l:  [?12l[?25h: !copy XXUnix,XXDos,XXMac XXUxDsMc.
[?25l:  [?12l[?25h:elseif has("win32")
[?25l:  [?12l[?25h: !copy /b XXUnix+XXDos XXUxDs
[?25l:  [?12l[?25h: !copy /b XXUnix+XXMac XXUxMac
[?25l:  [?12l[?25h: !copy /b XXDos+XXMac XXDosMac
[?25l:  [?12l[?25h: !copy /b XXUnix+XXDos+XXMac XXUxDsMc
[?25l:  [?12l[?25h:else
[?25l:  [?12l[?25h: !cat XXUnix XXDos >XXUxDs
[?25l:!cat XXUnix XXDos >XXUxDs[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:  :[?12l[?25h !cat XXUnix XXMac >XXUxMac
[?25l:!cat XXUnix XXMac >XXUxMac[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:  :[?12l[?25h !cat XXDos XXMac >XXDosMac
[?25l:!cat XXDos XXMac >XXDosMac[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:  :[?12l[?25h !cat XXUnix XXDos XXMac >XXUxDsMc
[?25l:!cat XXUnix XXDos XXMac >XXUxDsMc[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:  :[?12l[?25hendif[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[27m[m[H[2J[1;1H:$r XXtt92
:$r XXtt93
Go10[34m^[[m:$r XXUnix
:set nobinary ff&
:w
:qa!
ENDTEST

1
2
3
4
5
6
7
8
9
10

unix
unix
eof

dos[34m^M[?12l[?25h[?25l
[m:[?12l[?25h" try reading and writing with 'fileformats' empty[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fileformat=unix[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! XXUnix[?25l"XXUnix" [25;10H[K[25;10H2 lines, 10 characters[1;1Hunix[1;5H[K[2;1Hunix[2;5H[K[3;1H[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 2 lines, 10 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! XXDos[?25l"XXDos" [25;9H[K[25;9H2 lines, 10 characters[1;1Hdos[34m^M[m
dos[34m^M[1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw! XXtt01[?25l"XXtt01" [25;10H[K[25;10H[New File] 2 lines, 10 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! XXMac[?25l"XXMac" [25;9H[K[25;9H[Incomplete last line] 1 line, 8 characters[1;1Hmac[2Cmac[34m^M[m
[1m[34m~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw! XXtt02[?25l"XXtt02" [25;10H[K[25;10H[New File] 1 line, 9 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe XXUnix XXDos XXMac[?25l"test30.in" [25;13H[K[25;13H222 lines, 3463 characters
3 buffers wiped out
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hset fileformat=dos[?25l[1;1H[2L[1;1H:w
:qa!
ENDTEST[3;8H[K[4;1H[K[5;1H1[5;2H[K[6;1H2[6;2H[K[7;1H3[7;2H[K[8;1H4[8;2H[K[9;1H5[9;2H[K[10;1H6[10;2H[K[11;1H7[11;2H[K[12;1H8[12;2H[K[13;1H9[13;2H[K[14;1H10[14;3H[K[15;1H[K[16;1Hunix[16;5H[K[17;1Hunix[17;5H[K[18;1Heof[18;4H[K[19;1H[K[20;1Hdos[34m^M[m[20;6H[K[21;1Hdos[34m^M[m[21;6H[K[22;1Heof[22;4H[K[23;1H[K[24;1Hmac[34m^M[mmac[34m^M[m[24;11H[K[25;1H[K[20;1H[?12l[?25h[?25l[25;1H:[?12l[?25he! XXUnix[?25l"XXUnix" [25;10H[K[25;10H[CR missing][dos format] 2 lines, 10 characters[1;1Hunix
unix
[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw! XXtt11[?25l"XXtt11" [25;10H[K[25;10H[New File][dos format] 2 lines, 12 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! XXDos[?25l"XXDos" [25;9H[K[25;9H[dos format] 2 lines, 10 characters[1;1Hdos[1;4H[K[2;1Hdos[2;4H[K[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw! XXtt12[?25l"XXtt12" [25;10H[K[25;10H[New File][dos format] 2 lines, 10 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! XXMac[?25l"XXMac" [25;9H[K[25;9H[Incomplete last line][dos format] 1 line, 8 characters[1;1Hmac[34m^M[mmac[34m^M[m
[1m[34m~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw! XXtt13[?25l"XXtt13" [25;10H[K[25;10H[New File][dos format] 1 line, 10 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe XXUnix XXDos XXMac[?25l"test30.in" [25;13H[K[25;13H[CR missing][dos format] 222 lines, 3463 characters
3 buffers wiped out
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hset fileformat=mac[?25l[1;1H[2L[1;1H:w
:qa!
ENDTEST[3;8H[K[4;1H[K[5;1H1[5;2H[K[6;1H2[6;2H[K[7;1H3[7;2H[K[8;1H4[8;2H[K[9;1H5[9;2H[K[10;1H6[10;2H[K[11;1H7[11;2H[K[12;1H8[12;2H[K[13;1H9[13;2H[K[14;1H10[14;3H[K[15;1H[K[16;1Hunix[16;5H[K[17;1Hunix[17;5H[K[18;1Heof[18;4H[K[19;1H[K[20;1Hdos[20;4H[K[21;1Hdos[21;4H[K[22;1Heof[22;4H[K[23;1H[K[24;1Hmac[34m^J[mmac[24;9H[K[25;1H[K[20;1H[?12l[?25h[?25l[25;1H:[?12l[?25he! XXUnix[?25l"XXUnix" [25;10H[K[25;10H[Incomplete last line][mac format] 1 line, 10 characters[1;1Hunix[34m^J[munix[34m^J[m
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw! XXtt21[?25l"XXtt21" [25;10H[K[25;10H[New File][mac format] 1 line, 11 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! XXDos[?25l"XXDos" [25;9H[K[25;9H[Incomplete last line][mac format] 3 lines, 10 characters[1;1Hdos[1;4H[K[2;1H[34m^J[mdos[2;6H[K[3;1H[34m^J[m[3;3H[K[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw! XXtt22[?25l"XXtt22" [25;10H[K[25;10H[New File][mac format] 3 lines, 11 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! XXMac[?25l"XXMac" [25;9H[K[25;9H[mac format] 2 lines, 8 characters[1;1Hmac
mac[2;4H[K[3;1H[1m[34m~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw! XXtt23[?25l"XXtt23" [25;10H[K[25;10H[New File][mac format] 2 lines, 8 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe XXUnix XXDos XXMac[?25l"test30.in" [25;13H[K[25;13H[Incomplete last line][mac format] 5 lines, 3463 characters
3 buffers wiped out
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h"[?25l[1;1H[2L[1;1H[34m^J[mdos
[34m^J[meof[34m^J^J[mmac
mac[3;4H[K[4;1H[34m^J[m[4;3H[K[25;1H[K[4;1H[?12l[?25h[?25l[25;1H:[?12l[?25h" try reading and writing with 'fileformats' set to one format[?25l[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fileformats=unix[?25l[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! XXUxDsMc[?25l"XXUxDsMc" [25;12H[K[25;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;5H[K[2;1Hunix[2;5H[K[3;1Hdos[34m^M[m
dos[34m^M[m
mac[34m^M[mmac[34m^M[m[5;11H[K[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw! XXtt31[?25l"XXtt31" [25;10H[K[25;10H[New File] 5 lines, 29 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe XXUxDsMc[?25l"test30.in" [25;13H[K[25;13H222 lines, 3463 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HNote: This test will fail if "cat" is not available.[4;1H[K[5;1HSTARTTEST[5;10H[K[6;1H:so small.vim[6;14H[K[7;1H:" first write three test files, one in each format[7;52H[K[8;1H:set fileformat=unix[8;21H[K[9;1H:set fileformats=[9;18H[K[10;1H:/^1/w! XX1[10;12H[K[11;1H:/^2/w! XX2[11;12H[K[12;1H:/^3/w! XX3[12;12H[K[13;1H:/^4/w! XX4[13;12H[K[14;1H:/^5/w! XX5[14;12H[K[15;1H:/^6/w! XX6[15;12H[K[16;1H:/^7/w! XX7[16;12H[K[17;1H:/^8/w! XX8[17;12H[K[18;1H:/^9/w! XX9[18;12H[K[19;1H:/^10/w! XX10[19;14H[K[20;1H:/^unix/;/eof/-1w! XXUnix[20;26H[K[21;1H:/^dos/;/eof/-1w! XXDos[21;24H[K[22;1H:set bin noeol[22;15H[K[23;1H:$w! XXMac[23;11H[K[24;1H:set nobin eol[24;15H[K[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fileformats=dos[?25l[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! XXUxDsMc[?25l"XXUxDsMc" [25;12H[K[25;12H[Incomplete last line][CR missing][dos format] 5 lines, 28 character
[24;80Hs[25;1H
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw! XXtt32[?25l"XXtt32" [25;10H[K[25;10H[New File][dos format] 5 lines, 32 characters written
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hbwipe XXUxDsMc[?25l"test30.in" [25;13H[K[25;13H[CR missing][dos format] 222 lines, 3463 characters[1;1H[3L[1;1HTest for a lot of variations of the 'fileformats' option

Note: This test will fail if "cat" is not available.[25;1H[K[25;1H"test30.in" [CR missing][dos format] 222 lines, 3463 characters[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fileformats=mac[?25l[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! XXUxDsMc[?25l"XXUxDsMc" [25;12H[K[25;12H[mac format] 4 lines, 28 characters[1;1Hunix[34m^J[munix[34m^J[mdos[1;16H[K[2;1H[34m^J[mdos
[34m^J[mmac[3;7H[K[4;1Hmac
[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw! XXtt33[?25l"XXtt33" [25;10H[K[25;10H[New File][mac format] 4 lines, 28 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe XXUxDsMc[?25l"test30.in" [25;13H[K[25;13H[Incomplete last line][mac format] 5 lines, 3463 characters[1;1H[34m^J[mdos[1;6H[K[2;3Heof[34m^J^J[mmac
mac[3;4H[K[4;1H[34m^J[m[4;3H[K[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" try reading and writing with 'fileformats' set to two formats[?25l[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fileformats=unix,dos[?25l[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! XXUxDsMc[?25l"XXUxDsMc" [25;12H[K[25;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;5H[K[2;1Hunix[2;5H[K[3;1Hdos[34m^M[m
dos[34m^M[m
mac[34m^M[mmac[34m^M[m[5;11H[K[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw! XXtt41[?25l"XXtt41" [25;10H[K[25;10H[New File] 5 lines, 29 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe XXUxDsMc[?25l"test30.in" [25;13H[K[25;13H222 lines, 3463 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HNote: This test will fail if "cat" is not available.[4;1H[K[5;1HSTARTTEST[5;10H[K[6;1H:so small.vim[6;14H[K[7;1H:" first write three test files, one in each format[7;52H[K[8;1H:set fileformat=unix[8;21H[K[9;1H:set fileformats=[9;18H[K[10;1H:/^1/w! XX1[10;12H[K[11;1H:/^2/w! XX2[11;12H[K[12;1H:/^3/w! XX3[12;12H[K[13;1H:/^4/w! XX4[13;12H[K[14;1H:/^5/w! XX5[14;12H[K[15;1H:/^6/w! XX6[15;12H[K[16;1H:/^7/w! XX7[16;12H[K[17;1H:/^8/w! XX8[17;12H[K[18;1H:/^9/w! XX9[18;12H[K[19;1H:/^10/w! XX10[19;14H[K[20;1H:/^unix/;/eof/-1w! XXUnix[20;26H[K[21;1H:/^dos/;/eof/-1w! XXDos[21;24H[K[22;1H:set bin noeol[22;15H[K[23;1H:$w! XXMac[23;11H[K[24;1H:set nobin eol[24;15H[K[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! XXUxMac[?25l"XXUxMac" [25;11H[K[25;11H[Incomplete last line] 3 lines, 18 characters[1;1Hunix[1;6H[K[2;1Hunix
mac[34m^M[mmac[34m^M[m[3;12H[K[4;1H[1m[34m~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw! XXtt42[?25l"XXtt42" [25;10H[K[25;10H[New File] 3 lines, 19 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe XXUxMac[?25l"test30.in" [25;13H[K[25;13H222 lines, 3463 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HNote: This test will fail if "cat" is not available.[4;1H[K[5;1HSTARTTEST[5;10H[K[6;1H:so small.vim[6;14H[K[7;1H:" first write three test files, one in each format[7;52H[K[8;1H:set fileformat=unix[8;21H[K[9;1H:set fileformats=[9;18H[K[10;1H:/^1/w! XX1[10;12H[K[11;1H:/^2/w! XX2[11;12H[K[12;1H:/^3/w! XX3[12;12H[K[13;1H:/^4/w! XX4[13;12H[K[14;1H:/^5/w! XX5[14;12H[K[15;1H:/^6/w! XX6[15;12H[K[16;1H:/^7/w! XX7[16;12H[K[17;1H:/^8/w! XX8[17;12H[K[18;1H:/^9/w! XX9[18;12H[K[19;1H:/^10/w! XX10[19;14H[K[20;1H:/^unix/;/eof/-1w! XXUnix[20;26H[K[21;1H:/^dos/;/eof/-1w! XXDos[21;24H[K[22;1H:set bin noeol[22;15H[K[23;1H:$w! XXMac[23;11H[K[24;1H:set nobin eol[24;15H[K[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! XXDosMac[?25l"XXDosMac" [25;12H[K[25;12H[Incomplete last line][dos format] 3 lines, 18 characters[1;1Hdo[1;4H[K[2;1Hdos
mac[34m^M[mmac[34m^M[m[3;12H[K[4;1H[1m[34m~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw! XXtt43[?25l"XXtt43" [25;10H[K[25;10H[New File][dos format] 3 lines, 20 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe XXDosMac[?25l"test30.in" [25;13H[K[25;13H222 lines, 3463 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HNote: This test will fail if "cat" is not available.[4;1H[K[5;1HSTARTTEST[5;10H[K[6;1H:so small.vim[6;14H[K[7;1H:" first write three test files, one in each format[7;52H[K[8;1H:set fileformat=unix[8;21H[K[9;1H:set fileformats=[9;18H[K[10;1H:/^1/w! XX1[10;12H[K[11;1H:/^2/w! XX2[11;12H[K[12;1H:/^3/w! XX3[12;12H[K[13;1H:/^4/w! XX4[13;12H[K[14;1H:/^5/w! XX5[14;12H[K[15;1H:/^6/w! XX6[15;12H[K[16;1H:/^7/w! XX7[16;12H[K[17;1H:/^8/w! XX8[17;12H[K[18;1H:/^9/w! XX9[18;12H[K[19;1H:/^10/w! XX10[19;14H[K[20;1H:/^unix/;/eof/-1w! XXUnix[20;26H[K[21;1H:/^dos/;/eof/-1w! XXDos[21;24H[K[22;1H:set bin noeol[22;15H[K[23;1H:$w! XXMac[23;11H[K[24;1H:set nobin eol[24;15H[K[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fileformats=unix,mac[?25l[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! XXUxDs[?25l"XXUxDs" [25;10H[K[25;10H4 lines, 20 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[34m^M[m[3;7H[K[4;1Hdos[34m^M[m
[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw! XXtt51[?25l"XXtt51" [25;10H[K[25;10H[New File] 4 lines, 20 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe XXUxDs[?25l"test30.in" [25;13H[K[25;13H222 lines, 3463 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HNote: This test will fail if "cat" is not available.[4;1H[K[5;1HSTARTTEST[5;10H[K[6;1H:so small.vim[6;14H[K[7;1H:" first write three test files, one in each format[7;52H[K[8;1H:set fileformat=unix[8;21H[K[9;1H:set fileformats=[9;18H[K[10;1H:/^1/w! XX1[10;12H[K[11;1H:/^2/w! XX2[11;12H[K[12;1H:/^3/w! XX3[12;12H[K[13;1H:/^4/w! XX4[13;12H[K[14;1H:/^5/w! XX5[14;12H[K[15;1H:/^6/w! XX6[15;12H[K[16;1H:/^7/w! XX7[16;12H[K[17;1H:/^8/w! XX8[17;12H[K[18;1H:/^9/w! XX9[18;12H[K[19;1H:/^10/w! XX10[19;14H[K[20;1H:/^unix/;/eof/-1w! XXUnix[20;26H[K[21;1H:/^dos/;/eof/-1w! XXDos[21;24H[K[22;1H:set bin noeol[22;15H[K[23;1H:$w! XXMac[23;11H[K[24;1H:set nobin eol[24;15H[K[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! XXUxDsMc[?25l"XXUxDsMc" [25;12H[K[25;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[34m^M[m[3;7H[K[4;1Hdos[34m^M[m
mac[34m^M[mmac[34m^M[m
[1m[34m~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw! XXtt52[?25l"XXtt52" [25;10H[K[25;10H[New File] 5 lines, 29 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe XXUxDsMc[?25l"test30.in" [25;13H[K[25;13H222 lines, 3463 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HNote: This test will fail if "cat" is not available.[4;1H[K[5;1HSTARTTEST[5;10H[K[6;1H:so small.vim[6;14H[K[7;1H:" first write three test files, one in each format[7;52H[K[8;1H:set fileformat=unix[8;21H[K[9;1H:set fileformats=[9;18H[K[10;1H:/^1/w! XX1[10;12H[K[11;1H:/^2/w! XX2[11;12H[K[12;1H:/^3/w! XX3[12;12H[K[13;1H:/^4/w! XX4[13;12H[K[14;1H:/^5/w! XX5[14;12H[K[15;1H:/^6/w! XX6[15;12H[K[16;1H:/^7/w! XX7[16;12H[K[17;1H:/^8/w! XX8[17;12H[K[18;1H:/^9/w! XX9[18;12H[K[19;1H:/^10/w! XX10[19;14H[K[20;1H:/^unix/;/eof/-1w! XXUnix[20;26H[K[21;1H:/^dos/;/eof/-1w! XXDos[21;24H[K[22;1H:set bin noeol[22;15H[K[23;1H:$w! XXMac[23;11H[K[24;1H:set nobin eol[24;15H[K[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! XXDosMac[?25l"XXDosMac" [25;12H[K[25;12H[mac format] 4 lines, 18 characters[1;1Hdo[1;4H[K[2;1H[34m^J[mdos
[34m^J[mmac[3;7H[K[4;1Hmac
[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw! XXtt53[?25l"XXtt53" [25;10H[K[25;10H[New File][mac format] 4 lines, 18 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe XXDosMac[?25l"test30.in" [25;13H[K[25;13H222 lines, 3463 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HNote: This test will fail if "cat" is not available.[4;1H[K[5;1HSTARTTEST[5;10H[K[6;1H:so small.vim[6;14H[K[7;1H:" first write three test files, one in each format[7;52H[K[8;1H:set fileformat=unix[8;21H[K[9;1H:set fileformats=[9;18H[K[10;1H:/^1/w! XX1[10;12H[K[11;1H:/^2/w! XX2[11;12H[K[12;1H:/^3/w! XX3[12;12H[K[13;1H:/^4/w! XX4[13;12H[K[14;1H:/^5/w! XX5[14;12H[K[15;1H:/^6/w! XX6[15;12H[K[16;1H:/^7/w! XX7[16;12H[K[17;1H:/^8/w! XX8[17;12H[K[18;1H:/^9/w! XX9[18;12H[K[19;1H:/^10/w! XX10[19;14H[K[20;1H:/^unix/;/eof/-1w! XXUnix[20;26H[K[21;1H:/^dos/;/eof/-1w! XXDos[21;24H[K[22;1H:set bin noeol[22;15H[K[23;1H:$w! XXMac[23;11H[K[24;1H:set nobin eol[24;15H[K[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fileformats=dos,mac[?25l[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! XXUxDs[?25l"XXUxDs" [25;10H[K[25;10H[CR missing][dos format] 4 lines, 20 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[3;4H[K[4;1Hdos
[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw! XXtt61[?25l"XXtt61" [25;10H[K[25;10H[New File][dos format] 4 lines, 22 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe XXUxDs[?25l"test30.in" [25;13H[K[25;13H[CR missing][dos format] 222 lines, 3463 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HNote: This test will fail if "cat" is not available.[4;1H[K[5;1HSTARTTEST[5;10H[K[6;1H:so small.vim[6;14H[K[7;1H:" first write three test files, one in each format[7;52H[K[8;1H:set fileformat=unix[8;21H[K[9;1H:set fileformats=[9;18H[K[10;1H:/^1/w! XX1[10;12H[K[11;1H:/^2/w! XX2[11;12H[K[12;1H:/^3/w! XX3[12;12H[K[13;1H:/^4/w! XX4[13;12H[K[14;1H:/^5/w! XX5[14;12H[K[15;1H:/^6/w! XX6[15;12H[K[16;1H:/^7/w! XX7[16;12H[K[17;1H:/^8/w! XX8[17;12H[K[18;1H:/^9/w! XX9[18;12H[K[19;1H:/^10/w! XX10[19;14H[K[20;1H:/^unix/;/eof/-1w! XXUnix[20;26H[K[21;1H:/^dos/;/eof/-1w! XXDos[21;24H[K[22;1H:set bin noeol[22;15H[K[23;1H:$w! XXMac[23;11H[K[24;1H:set nobin eol[24;15H[K[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! XXUxMac[?25l"XXUxMac" [25;11H[K[25;11H[Incomplete last line][CR missing][dos format] 3 lines, 18 characters[1;1Hunix[1;6H[K[2;1Hunix
mac[34m^M[mmac[34m^M[m[3;12H[K[4;1H[1m[34m~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw! XXtt62[?25l"XXtt62" [25;10H[K[25;10H[New File][dos format] 3 lines, 22 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe XXUxMac[?25l"test30.in" [25;13H[K[25;13H[CR missing][dos format] 222 lines, 3463 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HNote: This test will fail if "cat" is not available.[4;1H[K[5;1HSTARTTEST[5;10H[K[6;1H:so small.vim[6;14H[K[7;1H:" first write three test files, one in each format[7;52H[K[8;1H:set fileformat=unix[8;21H[K[9;1H:set fileformats=[9;18H[K[10;1H:/^1/w! XX1[10;12H[K[11;1H:/^2/w! XX2[11;12H[K[12;1H:/^3/w! XX3[12;12H[K[13;1H:/^4/w! XX4[13;12H[K[14;1H:/^5/w! XX5[14;12H[K[15;1H:/^6/w! XX6[15;12H[K[16;1H:/^7/w! XX7[16;12H[K[17;1H:/^8/w! XX8[17;12H[K[18;1H:/^9/w! XX9[18;12H[K[19;1H:/^10/w! XX10[19;14H[K[20;1H:/^unix/;/eof/-1w! XXUnix[20;26H[K[21;1H:/^dos/;/eof/-1w! XXDos[21;24H[K[22;1H:set bin noeol[22;15H[K[23;1H:$w! XXMac[23;11H[K[24;1H:set nobin eol[24;15H[K[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! XXUxDsMc[?25l"XXUxDsMc" [25;12H[K[25;12H[Incomplete last line][CR missing][dos format] 5 lines, 28 character
[24;80Hs[25;1H
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw! XXtt63[?25l"XXtt63" [25;10H[K[25;10H[New File][dos format] 5 lines, 32 characters written
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hbwipe XXUxDsMc[?25l"test30.in" [25;13H[K[25;13H[CR missing][dos format] 222 lines, 3463 characters[1;1H[3L[1;1HTest for a lot of variations of the 'fileformats' option

Note: This test will fail if "cat" is not available.[25;1H[K[25;1H"test30.in" [CR missing][dos format] 222 lines, 3463 characters[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" try reading and writing with 'fileformats' set to three formats[?25l[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fileformats=unix,dos,mac[?25l[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! XXUxDsMc[?25l"XXUxDsMc" [25;12H[K[25;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[34m^M[m[3;7H[K[4;1Hdos[34m^M[m
mac[34m^M[mmac[34m^M[m
[1m[34m~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw! XXtt71[?25l"XXtt71" [25;10H[K[25;10H[New File] 5 lines, 29 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe XXUxDsMc[?25l"test30.in" [25;13H[K[25;13H222 lines, 3463 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HNote: This test will fail if "cat" is not available.[4;1H[K[5;1HSTARTTEST[5;10H[K[6;1H:so small.vim[6;14H[K[7;1H:" first write three test files, one in each format[7;52H[K[8;1H:set fileformat=unix[8;21H[K[9;1H:set fileformats=[9;18H[K[10;1H:/^1/w! XX1[10;12H[K[11;1H:/^2/w! XX2[11;12H[K[12;1H:/^3/w! XX3[12;12H[K[13;1H:/^4/w! XX4[13;12H[K[14;1H:/^5/w! XX5[14;12H[K[15;1H:/^6/w! XX6[15;12H[K[16;1H:/^7/w! XX7[16;12H[K[17;1H:/^8/w! XX8[17;12H[K[18;1H:/^9/w! XX9[18;12H[K[19;1H:/^10/w! XX10[19;14H[K[20;1H:/^unix/;/eof/-1w! XXUnix[20;26H[K[21;1H:/^dos/;/eof/-1w! XXDos[21;24H[K[22;1H:set bin noeol[22;15H[K[23;1H:$w! XXMac[23;11H[K[24;1H:set nobin eol[24;15H[K[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fileformats=mac,dos,unix[?25l[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! XXUxDsMc[?25l"XXUxDsMc" [25;12H[K[25;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[34m^M[m[3;7H[K[4;1Hdos[34m^M[m
mac[34m^M[mmac[34m^M[m
[1m[34m~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw! XXtt81[?25l"XXtt81" [25;10H[K[25;10H[New File] 5 lines, 29 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe XXUxDsMc[?25l"test30.in" [25;13H[K[25;13H222 lines, 3463 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HNote: This test will fail if "cat" is not available.[4;1H[K[5;1HSTARTTEST[5;10H[K[6;1H:so small.vim[6;14H[K[7;1H:" first write three test files, one in each format[7;52H[K[8;1H:set fileformat=unix[8;21H[K[9;1H:set fileformats=[9;18H[K[10;1H:/^1/w! XX1[10;12H[K[11;1H:/^2/w! XX2[11;12H[K[12;1H:/^3/w! XX3[12;12H[K[13;1H:/^4/w! XX4[13;12H[K[14;1H:/^5/w! XX5[14;12H[K[15;1H:/^6/w! XX6[15;12H[K[16;1H:/^7/w! XX7[16;12H[K[17;1H:/^8/w! XX8[17;12H[K[18;1H:/^9/w! XX9[18;12H[K[19;1H:/^10/w! XX10[19;14H[K[20;1H:/^unix/;/eof/-1w! XXUnix[20;26H[K[21;1H:/^dos/;/eof/-1w! XXDos[21;24H[K[22;1H:set bin noeol[22;15H[K[23;1H:$w! XXMac[23;11H[K[24;1H:set nobin eol[24;15H[K[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" try with 'binary' set[?25l[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fileformats=mac,unix,dos[?25l[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset binary[?25l[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! XXUxDsMc[?25l"XXUxDsMc" [25;12H[K[25;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[34m^M[m[3;7H[K[4;1Hdos[34m^M[m
mac[34m^M[mmac[34m^M[m
[1m[34m~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw! XXtt91[?25l"XXtt91" [25;10H[K[25;10H[New File][Incomplete last line] 5 lines, 28 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe XXUxDsMc[?25l"test30.in" [25;13H[K[25;13H222 lines, 3463 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HNote: This test will fail if "cat" is not available.[4;1H[K[5;1HSTARTTEST[5;10H[K[6;1H:so small.vim[6;14H[K[7;1H:" first write three test files, one in each format[7;52H[K[8;1H:set fileformat=unix[8;21H[K[9;1H:set fileformats=[9;18H[K[10;1H:/^1/w! XX1[10;12H[K[11;1H:/^2/w! XX2[11;12H[K[12;1H:/^3/w! XX3[12;12H[K[13;1H:/^4/w! XX4[13;12H[K[14;1H:/^5/w! XX5[14;12H[K[15;1H:/^6/w! XX6[15;12H[K[16;1H:/^7/w! XX7[16;12H[K[17;1H:/^8/w! XX8[17;12H[K[18;1H:/^9/w! XX9[18;12H[K[19;1H:/^10/w! XX10[19;14H[K[20;1H:/^unix/;/eof/-1w! XXUnix[20;26H[K[21;1H:/^dos/;/eof/-1w! XXDos[21;24H[K[22;1H:set bin noeol[22;15H[K[23;1H:$w! XXMac[23;11H[K[24;1H:set nobin eol[24;15H[K[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fileformats=mac[?25l[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! XXUxDsMc[?25l"XXUxDsMc" [25;12H[K[25;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[34m^M[m[3;7H[K[4;1Hdos[34m^M[m
mac[34m^M[mmac[34m^M[m
[1m[34m~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw! XXtt92[?25l"XXtt92" [25;10H[K[25;10H[New File][Incomplete last line] 5 lines, 28 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe XXUxDsMc[?25l"test30.in" [25;13H[K[25;13H222 lines, 3463 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HNote: This test will fail if "cat" is not available.[4;1H[K[5;1HSTARTTEST[5;10H[K[6;1H:so small.vim[6;14H[K[7;1H:" first write three test files, one in each format[7;52H[K[8;1H:set fileformat=unix[8;21H[K[9;1H:set fileformats=[9;18H[K[10;1H:/^1/w! XX1[10;12H[K[11;1H:/^2/w! XX2[11;12H[K[12;1H:/^3/w! XX3[12;12H[K[13;1H:/^4/w! XX4[13;12H[K[14;1H:/^5/w! XX5[14;12H[K[15;1H:/^6/w! XX6[15;12H[K[16;1H:/^7/w! XX7[16;12H[K[17;1H:/^8/w! XX8[17;12H[K[18;1H:/^9/w! XX9[18;12H[K[19;1H:/^10/w! XX10[19;14H[K[20;1H:/^unix/;/eof/-1w! XXUnix[20;26H[K[21;1H:/^dos/;/eof/-1w! XXDos[21;24H[K[22;1H:set bin noeol[22;15H[K[23;1H:$w! XXMac[23;11H[K[24;1H:set nobin eol[24;15H[K[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fileformats=dos[?25l[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! XXUxDsMc[?25l"XXUxDsMc" [25;12H[K[25;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[34m^M[m[3;7H[K[4;1Hdos[34m^M[m
mac[34m^M[mmac[34m^M[m
[1m[34m~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw! XXtt93[?25l"XXtt93" [25;10H[K[25;10H[New File][Incomplete last line] 5 lines, 28 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Append "END" to each file so that we can see what the last written char was.[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fileformat=unix nobin[?25l[1;1H[?12l[?25h[?25l[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [m[25;1H--No lines in buffer--[25;23H[K[1;1H[?12l[?25h[?25lEND[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>XXtt01[?25l"XXtt01" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>XXtt02[?25l"XXtt02" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>XXtt11[?25l"XXtt11" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>XXtt12[?25l"XXtt12" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>XXtt13[?25l"XXtt13" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>XXtt21[?25l"XXtt21" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>XXtt22[?25l"XXtt22" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>XXtt23[?25l"XXtt23" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>XXtt31[?25l"XXtt31" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>XXtt32[?25l"XXtt32" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>XXtt33[?25l"XXtt33" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>XXtt41[?25l"XXtt41" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>XXtt42[?25l"XXtt42" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>XXtt43[?25l"XXtt43" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>XXtt51[?25l"XXtt51" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>XXtt52[?25l"XXtt52" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>XXtt53[?25l"XXtt53" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>XXtt61[?25l"XXtt61" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>XXtt62[?25l"XXtt62" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>XXtt63[?25l"XXtt63" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>XXtt71[?25l"XXtt71" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>XXtt81[?25l"XXtt81" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>XXtt91[?25l"XXtt91" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>XXtt92[?25l"XXtt92" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>XXtt93[?25l"XXtt93" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Concatenate the results.[?25l[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Make fileformat of test.out the native fileformat.[?25l[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Add a newline at the end.[?25l[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset binary[?25l[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! test.out[?25l"test.out" [25;12H[K[25;12H2 lines, 10 characters[1;1Hunix
unix[2;5H[K[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$r XXtt01[?25l"XXtt01" [25;10H[K[25;10H3 lines, 14 characters[3;1Hdos[34m^M[m[3;6H[K[4;1Hdos[34m^M[m[4;6H[K[5;1HEND[5;4H[K[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$r XXtt02[?25l"XXtt02" [25;10H[K[25;10H2 lines, 13 characters[6;1Hmac[34m^M[mmac[34m^M[m[6;11H[K[7;1HEND[7;4H[K[6;1H[?12l[?25h
[?25l
1[8;2H[K[8;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$r XXtt11[?25l"XXtt11" [25;10H[K[25;10H3 lines, 16 characters[9;1Hunix[34m^M[m[9;7H[K[10;1Hunix[34m^M[m[10;7H[K[11;1HEND[11;4H[K[9;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$r XXtt12[?25l"XXtt12" [25;10H[K[25;10H3 lines, 14 characters[12;1Hdos[34m^M[m[12;6H[K[13;1Hdos[34m^M[m[13;6H[K[14;1HEND[14;4H[K[12;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$r XXtt13[?25l"XXtt13" [25;10H[K[25;10H2 lines, 14 characters[15;1Hmac[34m^M[mmac[34m^M^M[m[15;13H[K[16;1HEND[16;4H[K[15;1H[?12l[?25h
[?25l
2[17;2H[K[17;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$r XXtt21[?25l"XXtt21" [25;10H[K[25;10H3 lines, 15 characters[18;1Hunix[18;5H[K[19;1Hunix[19;5H[K[20;1H[34m^M[mEND[20;6H[K[18;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$r XXtt22[?25l"XXtt22" [25;10H[K[25;10H3 lines, 15 characters[21;1Hdos[34m^M[m[21;6H[K[22;1Hdos[34m^M[m[22;6H[K[23;1H[34m^M[mEND[23;6H[K[21;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$r XXtt23[?25l"XXtt23" [25;10H[K[25;10H1 line, 12 characters[24;1Hmac[34m^M[mmac[34m^M[mEND[24;14H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H3[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$r XXtt31[?25l"XXtt31" [25;10H[K[25;10H6 lines, 33 characters[1;24r[24;1H
[1;25r[24;1Hunix[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$r XXtt32[?25l"XXtt32" [25;10H[K[25;10H6 lines, 36 characters[1;24r[1;1H[6M[1;25r[19;1Hunix
dos[34m^M[m
dos[34m^M[m
mac[34m^M[mmac[34m^M[m
END
unix[34m^M[m[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$r XXtt33[?25l"XXtt33" [25;10H[K[25;10H5 lines, 32 characters[1;24r[1;1H[6M[1;25r[19;1Hunix[34m^M[m
dos[34m^M[m
dos[34m^M[m
mac[34m^M[mmac[34m^M^M[m
END
unix[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[1;1H[4M[1;25r[21;1Hunix
dos[34m^M[m
dos[34m^M[m
mac[34m^M[mmac[34m^M[mEND[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H4[?12l[?25h[?25l
:[?12l[?25h$r XXtt41[?25l"XXtt41" [25;10H[K[25;10H6 lines, 33 characters[1;24r[24;1H
[1;25r[24;1Hunix[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$r XXtt42[?25l"XXtt42" [25;10H[K[25;10H4 lines, 23 characters[1;24r[1;1H[6M[1;25r[19;1Hunix
dos[34m^M[m
dos[34m^M[m
mac[34m^M[mmac[34m^M[m
END
unix[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$r XXtt43[?25l"XXtt43" [25;10H[K[25;10H4 lines, 24 characters[1;24r[1;1H[4M[1;25r[21;1Hunix
mac[34m^M[mmac[34m^M[m
END
dos[34m^M[m[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[1;1H[3M[1;25r[22;1Hdos[34m^M[m
mac[34m^M[mmac[34m^M^M[m
END[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H5[?12l[?25h[?25l
:[?12l[?25h$r XXtt51[?25l"XXtt51" [25;10H[K[25;10H5 lines, 24 characters[1;24r[24;1H
[1;25r[24;1Hunix[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$r XXtt52[?25l"XXtt52" [25;10H[K[25;10H6 lines, 33 characters[1;24r[1;1H[5M[1;25r[20;1Hunix
dos[34m^M[m
dos[34m^M[m
END
unix[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$r XXtt53[?25l"XXtt53" [25;10H[K[25;10H3 lines, 22 characters[1;24r[1;1H[6M[1;25r[19;1Hunix
dos[34m^M[m
dos[34m^M[m
mac[34m^M[mmac[34m^M[m
END
dos[34m^M[m[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[23;1Hdos[34m^M[m
mac[34m^M[mmac[34m^M[mEND[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H6[?12l[?25h[?25l
:[?12l[?25h$r XXtt61[?25l"XXtt61" [25;10H[K[25;10H5 lines, 26 characters[1;24r[24;1H
[1;25r[24;1Hunix[34m^M[m[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$r XXtt62[?25l"XXtt62" [25;10H[K[25;10H4 lines, 26 characters[1;24r[1;1H[5M[1;25r[20;1Hunix[34m^M[m
dos[34m^M[m
dos[34m^M[m
END
unix[34m^M[m[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$r XXtt63[?25l"XXtt63" [25;10H[K[25;10H6 lines, 36 characters[1;24r[1;1H[4M[1;25r[21;1Hunix[34m^M[m
mac[34m^M[mmac[34m^M^M[m
END
unix[34m^M[m[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[1;1H[5M[1;25r[20;1Hunix[34m^M[m
dos[34m^M[m
dos[34m^M[m
mac[34m^M[mmac[34m^M^M[m
END[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H7[?12l[?25h[?25l
:[?12l[?25h$r XXtt71[?25l"XXtt71" [25;10H[K[25;10H6 lines, 33 characters[1;24r[24;1H
[1;25r[24;1Hunix[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[1;1H[5M[1;25r[20;1Hunix
dos[34m^M[m
dos[34m^M[m
mac[34m^M[mmac[34m^M[m
END[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H8[?12l[?25h[?25l
:[?12l[?25h$r XXtt81[?25l"XXtt81" [25;10H[K[25;10H6 lines, 33 characters[1;24r[24;1H
[1;25r[24;1Hunix[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[1;1H[5M[1;25r[20;1Hunix
dos[34m^M[m
dos[34m^M[m
mac[34m^M[mmac[34m^M[m
END[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H9[?12l[?25h[?25l
:[?12l[?25h$r XXtt91[?25l"XXtt91" [25;10H[K[25;10H5 lines, 32 characters[1;24r[24;1H
[1;25r[24;1Hunix[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$r XXtt92[?25l"XXtt92" [25;10H[K[25;10H5 lines, 32 characters[1;24r[1;1H[5M[1;25r[20;1Hunix
dos[34m^M[m
dos[34m^M[m
mac[34m^M[mmac[34m^M[mEND
unix[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$r XXtt93[?25l"XXtt93" [25;10H[K[25;10H5 lines, 32 characters[1;24r[1;1H[5M[1;25r[20;1Hunix
dos[34m^M[m
dos[34m^M[m
mac[34m^M[mmac[34m^M[mEND
unix[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[1;1H[4M[1;25r[21;1Hunix
dos[34m^M[m
dos[34m^M[m
mac[34m^M[mmac[34m^M[mEND[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H10[?12l[?25h[?25l
:[?12l[?25h$r XXUnix[?25l"XXUnix" [25;10H[K[25;10H2 lines, 10 characters[1;24r[24;1H
[1;25r[24;1Hunix[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hset nobinary ff&[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw[?25l"test.out" 121 lines, 664 characters written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[?1l>[?12l[?25h[?1049l
rm -rf X* test.ok viminfo
rm -rf test31.failed test.ok test.out X* viminfo
cp test31.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test31.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test31.in" 69 lines, 1423 characters[1;1HTest for commands that close windows and/or buffers:
:quit
:close
:hide
:only
:sall
:all
:ball
:buf
:edit

STARTTEST
:so tiny.vim
GA 1[34m^[[m:$w! Xtest1
$r2:$w! Xtest2
$r3:$w! Xtest3
:n! Xtest1 Xtest2
A 1[34m^[[m:set hidden
:" test for working :n when hidden set; write "testtext 2"
:n
:w! test.out
:" test for failing :rew when hidden not set; write "testtext 2 2"
:set nohidden
A 2[34m^[[m:rew[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for commands that close windows and/or buffers:[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[12;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 54 lines, 1288 characters written[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[13;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;1HA 2[34m^[[m:hide
:w >>test.out
:" test ":edit" failing in modified buffer when 'hidden' not set
:" write "testtext 3 3"
A 3[34m^[[m:e Xtest1
:w >>test.out
:" test ":edit" working in modified buffer when 'hidden' set; write "testtext 1"[8;1H:set hidden
:e Xtest1
:w >>test.out
:" test ":close" not hiding when 'hidden' not set in modified buffer;
:" write "testtext 3 3 3"
:sp Xtest3
:set nohidden
A 3[34m^[[m:close
:w >>test.out
:" test ":close!" does hide when 'hidden' not set in modified buffer;
:" write "testtext 1"
A 3[34m^[[m:close!
:w >>test.out
:qa!
ENDTEST

testtext[22;1H[?12l[?25h
[?25l

:so! Xdotest[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso tiny.vim[?25l[23;1H[?12l[?25h
[?25l[9C1[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$w! Xtest1[?25l"Xtest1" [25;10H[K[25;10H[New File] 1 line, 11 characters written[24;10H[?12l[?25h[?25l2[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$w! Xtest2[?25l"Xtest2" [25;10H[K[25;10H[New File] 1 line, 11 characters written[24;10H[?12l[?25h[?25l3[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$w! Xtest3[?25l"Xtest3" [25;10H[K[25;10H[New File] 1 line, 11 characters written[24;10H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hn! Xtest1 Xtest2[?25l"Xtest1" [25;10H[K[25;10H1 line, 11 characters[1;1Htesttext 1
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[11C1[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset hidden[?25l[1;12H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" test for working :n when hidden set; write "testtext 2"[?25l[1;12H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hn[?25l"Xtest2" 1 line, 11 characters[1;10H2[1;12H[K[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 1 line, 11 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" test for failing :rew when hidden not set; write "testtext 2 2"[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset nohidden[?25l[1;1H[?12l[?25h[?25l[11C2[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hrew[?25l[1m[37m[41mE37: No write since last change (add ! to override)[1;12H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 13 characters appended[1;12H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" test for working :rew when hidden set; write "testtext 1 1"[?25l[1;12H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset hidden[?25l[1;12H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hrew[?25l"Xtest1" [Modified] line 1 of 1 --100%-- col 1 (file 1 of 2)[1;10H1 1[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 13 characters appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" test for :all keeping a buffer when it's modified; write "testtext 1 1 1"[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset nohidden[?25l[1;1H[?12l[?25h[?25l[13C1[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hsp[?25l[12;1H[1m[7mXtest1 [+]                                                                      [m[13;1Htesttext 1 1 1[13;15H[K[24;1H[7mXtest1 [+]                                                                      [1;14H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hn Xtest2 Xtest3[?25l"Xtest2" [Modified] line 1 of 1 --100%-- col 1 (file 1 of 2)[1;10H2 2[1;14H[K[12;6H[1m[7m2 [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hall[?25l"Xtest3" 1 line, 11 characters[27m[m[H[2J[1;1Htesttext 1 1 1
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [m[8;1H[7mXtest1 [+]                                                                      [m[9;1Htesttext 2 2
[1m[34m~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [m[16;1H[1m[7mXtest2 [+]                                                                      [m[17;1Htesttext 3
[1m[34m~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [m[24;1H[7mXtest3                                                                          [9;1H[?12l[?25h[?25l[25;1H[m:[?12l[?25h1wincmd w[?25l[8;1H[1m[7mXtest1 [+]                                                                      [m[16;1H[7mXtest2 [+][m[1m[7m [m[7m                                                                      [1;14H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 15 characters appended[1;14H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" test abandoning changed buffer, should be unloaded even when 'hidden' set[?25l[1;14H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" write "testtext 2 2" twice[?25l[1;14H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset hidden[?25l[1;14H[?12l[?25h[?25l1 1[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hq![?25l[27m[m[H[2J[1;1Htesttext 2 2
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [m[12;1H[1m[7mXtest2 [+]                                                                      [m[13;1Htesttext 3
[1m[34m~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [m[24;1H[7mXtest3                                                                          [1;1H[?12l[?25h[?25l[25;1H[m:[?12l[?25hw >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 13 characters appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hunhide[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 13 characters appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" test ":hide" hides anyway when 'hidden' not set; write "testtext 3"[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset nohidden[?25l[1;1H[?12l[?25h[?25l[13C2[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hhide[?25l[1;10H3[1;12H[K[12;1H[1m[34m~                                                                               [13;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 11 characters appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" test ":edit" failing in modified buffer when 'hidden' not set[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" write "testtext 3 3"[?25l[1;1H[?12l[?25h[?25l[11C3[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he Xtest1[?25l[1m[37m[41mE37: No write since last change (add ! to override)[1;12H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 13 characters appended[1;12H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" test ":edit" working in modified buffer when 'hidden' set; write "testtext 1
[24;80H"[25;1H[?25l[1;1H[L[1;1Htesttext 3 3[25;1H[K[1;12H[?12l[?25h[?25l[25;1H:[?12l[?25hset hidden[?25l[1;12H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he Xtest1[?25l"Xtest1" 1 line, 11 characters[1;10H1[1;12H[K[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 11 characters appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" test ":close" not hiding when 'hidden' not set in modified buffer;[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" write "testtext 3 3 3"[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hsp Xtest3[?25l"Xtest3" [Modified] line 1 of 1 --100%-- col 1 (file 2 of 2)[1;10H3 3[12;1H[1m[7mXtest3 [+]                                                                      [m[13;1Htesttext 1[13;11H[K[24;1H[7mXtest1                                                                          [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hset nohidden[?25l[1;1H[?12l[?25h[?25l[13C3[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hclose[?25l[1m[37m[41mE37: No write since last change (add ! to override)[1;14H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 15 characters appended[1;14H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" test ":close!" does hide when 'hidden' not set in modified buffer;[?25l[1;14H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" write "testtext 1"[?25l[1;14H[?12l[?25h[?25l3 3[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hclose![?25l[1;10H1[1;12H[K[12;1H[1m[34m~                                                                               [13;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 11 characters appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test32.failed test.ok test.out X* viminfo
cp test32.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test32.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test32.in" 57 lines, 1242 characters[1;1HTest for insert expansion

:se cpt=.,w
* add-expands (word from next line) from other window
* add-expands (current buffer first)
* Local expansion, ends in an empty line (unless it becomes a global expansion)
* starts Local and switches to global add-expansion
:se cpt=.,w,i
* i-add-expands and switches to local
* add-expands lines (it would end in an empty line if it didn't ignored it self)[11;1H:se cpt=kXtestfile
* checks k-expansion, and file expansion (use Xtest11 instead of test11,
* because TEST11.OUT may match first on DOS)
:se cpt=w
* checks make_cyclic in other window
:se cpt=u nohid
* checks unloaded buffer expansion
* checks adding mode abortion
:se cpt=t,d
* tag expansion, define add-expansion interrupted
* t-expansion

STARTTEST
:so small.vim[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for insert expansion[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[23;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 24 lines, 384 characters written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;1H[34m^X^L^X^L^P^P^[[m
:se cpt=kXtestfile
:w Xtest11.one
:w Xtest11.two
O[34m^N^[[mIX[34m^[[mA[34m^X^F^N^[[m
:se cpt=w
OST[34m^N^P^P^P^P^[[m
:se cpt=u nohid
[34m^W[moOEN[34m^N[m
unl[34m^N^X^X^P^[[m
:se cpt=t,d def=^\\k* tags=Xtestfile notagbsearch
O[34m^X^]^X^D^X^D^X^X^D^X^D^X^D^X^D[m
a[34m^N^[[m
:wq! test.out
ENDTEST

start of testfile
run1
run2
end of testfile

test11  36Gepeto[8C/Tag/
asd     test11file      36G
Makefile[8Cto      run[15;1H[?12l[?25h
[?25l[25;1H:so! Xdotest[16;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[16;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hse nocp viminfo+=nviminfo cpt=.,w ff=unix | $-2,$w!Xtestfile | set ff&[?25l"Xtestfile" [25;13H[K[25;13H[New] 3L, 57C written[16;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hse cot=[?25l[16;1H[?12l[?25h[?25l[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [m[12;1H[1m[7m[No Name]                                                                       [m[13;1H[34m^W[moOEN[34m^N[m
unl[34m^N^X^X^P^[[m
:se cpt=t,d def=^\\k* tags=Xtestfile notagbsearch
O[34m^X^]^X^D^X^D^X^X^D^X^D^X^D^X^D[m
a[34m^N^[[m[17;7H[K[18;1H:wq! test.out
ENDTEST[20;1H[K[21;1Hstart of testfile
run1[22;5H[K[23;1Hrun2[23;9H[K[24;1H[7mtest32.in                                                                       [1;1H[?12l[?25h[?25l[m[25;1H[1m-- INSERT ---- Keyword completion (^N^P) -- Searching...[m[32mScanning: test32.in[m[1mo[m[25;20H[K[25;1Hmatch in file test32.in[1m-- Keyword completion (^N^P) [m[32mmatch 1 of 4[2;3H[m[25;29H[K[25;1Hmatch in file test32.in[1m^[m[25;24H[K[25;1H[1m-- Keyword completion (^N^P) [m[32mmatch 2 of 4[2;5H[m[25;29H[K[25;1H[K[25;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERTe --^[m[25;13H[K[25;4H[1mAdding Keyword completion (^N^P) -- Searching...[m[32mScanning: test32.in[m[1mo[m[25;20H[K[25;1Hmatch in file test32.in[1m-- Adding Keyword completion (^N^P) Word from other line[2;10H[1;11r[m[1;1H[2L[1;25r[1;1H#include "Xtestfile"
run1 run2[12;11H[1m[7m[+][2;10H[?12l[?25h[m[25;1H[K[?25l[25;1H[1m-- Adding Keyword completion (^N^P) Word from other line[m[25;1H[K[25;1H[1m-- INSERT --[m[25;1H[K[2;9H[?12l[?25h[?25l3[?12l[?25h
[?25l[25;1H[1m-- INSERT ---- Keyword completion (^N^P) -- Searching...[m[32mScanning: test32.in[m[1mo[m[25;20H[K[25;1H[1m-- Keyword completion (^N^P) [m[32mmatch 1 of 103[3;5H[m[25;29H[K[25;1H[K[25;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERTe --^[m[25;13H[K[25;4H[1mAdding Keyword completion (^N^P) -- Searching...[m[32mScanning: test32.in[m[1mo[m[25;20H[K[25;1H[1m-- Adding Keyword completion (^N^P) Word from other line[3;10H[m[25;1H[K[25;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERTe --^[m[25;13H[K[25;4H[1mKeyword Local completion (^N^P) -- Searching...[m[25;36H[32mmatch 1 of 4[m[1m.[m[25;48H[K[4;5H[25;35H[K[25;35H[1m [m[32mmatch 2 of 4[4;5H[m[25;35H[K[25;35H[1m [m[32mmatch 3 of 4[4;10H[m[25;35H[K[25;35H[1m [m[32mmatch 4 of 4[4;8H[m[25;35H[K[25;35H[1m [m[31mBack at original[4;1H[m[25;1H[K[25;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERTe --^[m[25;13H[K[25;4H[1mKeyword Local completion (^N^P) -- Searching...[m[25;36H[32mmatch 1 of 4[m[1m.[m[25;48H[K[5;5H[25;35H[K[25;35H[1m [m[32mmatch 2 of 4[5;5H[m[25;35H[K[25;1H[K[25;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERTe --^[m[25;13H[K[25;4H[1m^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERTe --^[m[25;13H[K[25;4H[1mKeyword completion (^N^P) -- Searching...[m[32mScanning: test32.in[m[1mo[m[25;20H[K[25;1H[1m-- Keyword completion (^N^P) The only match[5;5H[m[25;29H[K[25;1H[K[25;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERTe --^[m[25;13H[K[25;4H[1mAdding Keyword completion (^N^P) -- Searching...[m[32mScanning: test32.in[m[1mo[m[25;20H[K[25;1H[1m-- Adding Keyword completion (^N^P) [m[32mmatch 1 of 2[5;10H[m[25;36H[K[25;1Hmatch in file test32.in[1me[m[25;24H[K[25;1H[1m-- Adding Keyword completion (^N^P) Word from other line[5;10H[3;11r[m[3;1H[3L[1;25r[3;1Hrun3 run3

run1 run2[?12l[?25h[25;1H[K[?25l[25;1H[1m-- Adding Keyword completion (^N^P) Word from other line[m[25;1H[K[25;1H[1m-- INSERT --[m[25;1H[K[5;9H[?12l[?25h
[?25l[25;1H:[?12l[?25hse cpt=.,w,i[?25l[6;1H[?12l[?25h[5;1H[?25l[25;1H[1m-- INSERT --[m[25;13H[K[25;4H[1mKeyword completion (^N^P) -- Searching...[m[32mScanning: test32.in[m[1mo[m[25;20H[K[25;9H[32m included file: Xtestfile[mmatch in file test32.in[25;24H[K[25;1H[1m-- Keyword completion (^N^P) The only match[5;9H[m[25;29H[K[25;1H[K[25;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERTe --^[m[25;13H[K[25;4H[1mAdding Keyword completion (^N^P) -- Searching...[m[32mScanning: test32.in[m[1mo[m[25;20H[K[25;9H[32m included file: Xtestfile[mmatch in file test32.in[25;24H[K[25;1H[1m-- Adding Keyword completion (^N^P) The only match[5;19H[m[25;36H[K[25;1H[K[25;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERTe --^[m[25;13H[K[25;4H[1mAdding Keyword completion (^N^P) -- Searching...[m[32mScanning: test32.in[m[1mo[m[25;20H[K[25;9H[32m included file: Xtestfile[mmatch in file test32.in[25;24H[K[25;1H[1m-- Adding Keyword completion (^N^P) The only match[5;28H[m[25;36H[K[25;1H[K[25;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERTe --^[m[25;13H[K[25;4H[1m^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERTe --^[m[25;13H[K[25;4H[1m^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERTe --^[m[25;13H[K[25;4H[1mKeyword Local completion (^N^P) -- Searching...[m[25;36H[32mmatch 1 of 3[m[1m.[m[25;48H[K[5;29H[25;1H[K[25;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- Whole line completion (^L^N^P)^ U-- Searching...[m[32mScanning: test32.in[m[1me[m[25;20H[K[25;1H[1m-- Whole line completion (^L^N^P) [m[32mmatch 1 of 54[6;29H[m[25;4H[1mINSERT --e[m[25;13H[K[25;1H[K[25;1H[1m-- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y) [m[32mmatch 1 of 54[m[25;4H[1mAddinge Whole line completion (^L^N^P) -- Searching...[m[32mScanning: test32.in[m[1me[m[25;20H[K[25;1H[1m-- Adding Whole line completion (^L^N^P) The only match[7;29H[m[25;41H[K[25;41H[1m [m[31mBack at original[7;1H[m[25;41H[K[25;41H[1m The only match[7;29H[5;11r[m[5;1H[3L[1;25r[5;1HMakefile[8Cto      run3
Makefile[8Cto      run3
Makefile[8Cto      run3[?12l[?25h[25;1H[K[?25l[25;1H[1m-- INSERT --[m[25;1H[K[7;28H[?12l[?25h[8;9H[?25l[25;1H:[?12l[?25hse cpt=kXtestfile[?25l[8;9H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw Xtest11.one[?25l"Xtest11.one" [New] 9L, 104C written[12;1H[1m[7mXtest11.one+   [8;9H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw Xtest11.two[?25l"Xtest11.two" [New] 9L, 104C written[8;9H[?12l[?25h[?25l[25;1H[1m-- INSERT --[m[25;13H[K[25;4H[1mKeyword completion (^N^P) -- Searching...[m[32mScanning dictionary: Xtestfile[m[1m-[m[25;31H[K[25;1Hmatch in file Xtestfile[25;24H[K[25;1H[1m-- Keyword completion (^N^P) [m[32mmatch 1 of 9[8;7H[8;11r[m[8;1H[L[1;25r[8;1Htest11[12;13H[1m[7m[+][8;7H[mI[?12l[?25h [25;1H[K[?25l[25;1H[1m-- Keyword completion (^N^P) [m[32mmatch 1 of 9[m[25;1H[K[25;1H[1m-- INSERT --[m[25;1H[K[8;6H[?12l[?25h[?25l[25;1H[1m-- INSERT --[m[25;1H[K[8;1HXtest11[?12l[?25h[?25l[25;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- File name completion (^F^N^P)s ^-- Searching...[m[25;34H[32mmatch 1 of 2[m[1m.[m[25;46H[K[8;12H[25;33H[K[25;33H[1m [m[32mmatch 2 of 2[8;12H[m.two[?12l[?25h[25;1H[K[?25l[25;1H[1m-- INSERT --[m[25;1H[K[8;11H[?12l[?25h[9;9H[?25l[25;1H:[?12l[?25hse cpt=w[?25l[9;9H[?12l[?25h[?25l[25;1H[1m-- INSERT ---- Keyword completion (^N^P) -- Searching...[m[32mScanning: test32.in[m[1mo[m[25;20H[K[25;1Hmatch in file test32.in[1m-- Keyword completion (^N^P) The only match[9;10H[m[25;29H[K[25;29H[1m [m[31mBack at original[9;3H[m[25;29H[K[25;1Hmatch in file test32.in[1m^[m[25;24H[K[25;1H[1m-- Keyword completion (^N^P) The only match[9;10H[m[25;29H[K[25;29H[1m [m[31mBack at original[9;3H[m[25;29H[K[25;1Hmatch in file test32.in[1m^[m[25;24H[K[25;1H[1m-- Keyword completion (^N^P) The only match[9;10H[mSTARTTEST
run1 run2[11;1H[K[9;10H[?12l[?25h[25;1H[K[?25l[25;1H[1m-- Keyword completion (^N^P) The only match[m[25;1H[K[25;1H[1m-- INSERT --[m[25;1H[K[9;9H[?12l[?25h[10;9H[?25l[25;1H:[?12l[?25hse cpt=u nohid[?25l[10;9H[?12l[?25h[?25l

[1m[34m~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [10;9H[?12l[?25h[?25l[m[25;1H[1m-- INSERT --[m[25;13H[K[25;4H[1mKeyword completion (^N^P) -- Searching...[m[32mScanning: test32.in[m[1mo[m[25;20H[K[25;1Hmatch in file test32.in[1m-- Keyword completion (^N^P) The only match[10;8H[m[25;1H[K[25;1H[1m-- INSERT ---- Keyword completion (^N^P) -- Searching...[m[32mScanning: test32.in[m[1mo[m[25;20H[K[25;1Hmatch in file test32.in[1m-- Keyword completion (^N^P) [m[32mmatch 1 of 3[11;7H[m[25;29H[K[25;1H[K[25;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERTe --^[m[25;13H[K[25;4H[1m^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERTe --^[m[25;13H[K[25;4H[1mKeyword completion (^N^P) -- Searching...[m[32mScanning: test32.in[m[1mo[m[25;20H[K[25;1Hmatch in file test32.in[1m-- Keyword completion (^N^P) The only match[11;7H[10;24r[m[10;1H[2L[1;25r[10;1HENDTEST
unless[?12l[?25h[25;1H[K[?25l[25;1H[1m-- Keyword completion (^N^P) The only match[m[25;1H[K[25;1H[1m-- INSERT --[m[25;1H[K[11;6H[?12l[?25h[12;6H[?25l[25;1H:[?12l[?25hse cpt=t,d def=^\\k* tags=Xtestfile notagbsearch[?25l[12;6H[?12l[?25h[?25l[25;1H[1m-- INSERT --[m[25;13H[K[25;4H[1m^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- Tag completion (^]^N^P)^ N-- Searching...[m[25;28H[32mmatch 1 of 3[m[1m.[m[25;40H[K[12;7H[25;4H[1mINSERTm --e[m[25;13H[K[25;1H[K[25;1H[1m-- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y) [m[32mmatch 1 of 3[m[25;4H[1mDefinition completion (^D^N^P)^ U-- Searching...[m[25;50H[K[25;1H[32mScanning included file: Xtestfile[m[1m [m[25;34H[K[25;1Hmatch in file Xtestfile[25;24H[K[25;1H[1m-- Definition completion (^D^N^P) The only match[12;11H[25;4HINSERTt --n[m[25;13H[K[25;1H[K[25;1H[1m-- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y) The only match-- Addinge Definition completion (^D^N^P) -- Searching...[m[32mScanning included file: Xtestfile[m[1m^[m[25;34H[K[25;1Hmatch in file Xtestfile[25;24H[K[25;1H[1m-- Adding Definition completion (^D^N^P) The only match[12;20H[25;4HINSERT --f[m[25;13H[K[25;1H[K[25;1H[1m-- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y) The only match-- INSERTe --^[m[25;13H[K[25;4H[1m^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- Definition completion (^D^N^P)^ U-- Searching...[m[32mScanning included file: Xtestfile[m[1m [m[25;34H[K[25;1Hmatch in file Xtestfile[25;24H[K[25;1H[1m-- Definition completion (^D^N^P) The only match[12;25H[25;4HINSERTt --n[m[25;13H[K[25;1H[K[25;1H[1m-- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y) The only match-- Addinge Definition completion (^D^N^P) -- Searching...[m[32mScanning included file: Xtestfile[m[1m^[m[25;34H[K[25;1Hmatch in file Xtestfile[25;24H[K[25;1H[1m-- Adding Definition completion (^D^N^P) The only match[12;37H[25;4HINSERT --f[m[25;13H[K[25;1H[K[25;1H[1m-- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y) The only match-- Addinge Definition completion (^D^N^P) -- Searching...[m[32mScanning included file: Xtestfile[m[1m^[m[25;34H[K[25;1Hmatch in file Xtestfile[25;24H[K[25;1H[1m-- Adding Definition completion (^D^N^P) The only match[12;38H[25;4HINSERT --f[m[25;13H[K[25;1H[K[25;1H[1m-- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y) The only match-- Addinge Definition completion (^D^N^P) -- Searching...[m[32mScanning included file: Xtestfile[m[1m^[m[25;34H[K[25;1Hmatch in file Xtestfile[25;24H[K[25;1H[1m-- Adding Definition completion (^D^N^P) Word from other line[12;42H[25;4HINSERT --f[m[25;13H[K[25;1H[K[25;1H[1m-- Keyword completion (^N^P) -- Searching...[m[32mScanning tags.[m[1mp[m[25;15H[K[25;10H[32mincluded file: Xtestfile[m[1m-- Keyword completion (^N^P) The only match[13;4H[12;24r[m[12;1H[2L[1;25r[12;1Htest11file      36Gepeto[8C/Tag/ asd
asd[?12l[?25h[25;1H[K[?25l[25;1H[1m-- Keyword completion (^N^P) The only match[m[25;1H[K[25;1H[1m-- INSERT --[m[25;1H[K[13;3H[?12l[?25h
ru[?25l[25;1H:[?12l[?25hwq! test.out[?25l"test.out" [25;12H[K[25;12H[New] 15L, 175C written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test33.failed test.ok test.out X* viminfo
cp test33.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test33.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test33.in" 34 lines, 616 characters[1;1HTest for 'lisp'
If the lisp feature is not enabled, this will fail!

STARTTEST
:so small.vim
:set lisp
/^(defun
=G:/^(defun/,$w! test.out
:q!
ENDTEST

(defun html-file (base)
(format nil "~(~A~).html" base))

(defmacro page (name title &rest body)
(let ((ti (gensym)))
`(with-open-file (*standard-output*
(html-file ,name)
:direction :output
:if-exists :supersede)
(let ((,ti ,title))
(as title ,ti)
(with center
(as h2 (string-upcase ,ti)))[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for 'lisp'[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[4;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 5 lines, 63 characters written[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[5;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[10;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[11;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[11;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset lisp[?25l[11;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^(defun[?25l[12;1H[?12l[?25h[?25l[25;1H22 lines to indent...23[7Cindented [25;19H[K[13;1H  (format nil "~(~A~).html" base))


  (let ((ti (gensym)))
       `(with-open-file (*standard-output*
                 [8C(html-file ,name)
                  [7C:direction :output
                         :if-exists :supersede)
                        (let ((,ti ,title))
              [15C(as title ,ti)
            [17C(with center
                            [7C(as h2 (string-upcase ,ti)))[12;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^(defun/,$w! test.out[?25l[31msearch hit BOTTOM, continuing at TOP[m"test.out" [25;12H[K[25;12H[New File] 23 lines, 544 characters written[12;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hq![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test34.failed test.ok test.out X* viminfo
cp test34.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test34.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test34.in" 72 lines, 1258 characters[1;1HTest for user functions.
Also test an <expr> mapping calling a function.

STARTTEST
:so small.vim
:function Table(title, ...)
:  let ret = a:title
:  let idx = 1
:  while idx <= a:0
:    exe "let ret = ret . a:" . idx
:    let idx = idx + 1
:  endwhile
:  return ret
:endfunction
:function Compute(n1, n2, divname)
:  if a:n2 == 0
:    return "fail"
:  endif
:  exe "let g:" . a:divname . " = ". a:n1 / a:n2
:  return "ok"
:endfunction
:func Expr1()
:  normal! v
:  return "111"[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for user functions.[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[4;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 65 lines, 1160 characters written[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[5;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;1H/^here
C[34m^R[m=Table("xxx", 4, "asdf")
 [34m^R[m=Compute(45, 0, "retval")
 [34m^R[m=retval
 [34m^R[m=Compute(45, 5, "retval")
 [34m^R[m=retval
 [34m^R[m=g:FuncRef(333)

XX+-XX
---*---
(one
(two
[(one again[34m^[[m:$-5,$w! test.out
:delfunc Table
:delfunc Compute
:delfunc Expr1
:delfunc Expr2
:delfunc ListItem
:delfunc ListReset
:unlet retval counter
:q!
ENDTEST

here[22;1H[?12l[?25h
[?25l

:so! Xdotest[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfunction Table(title, ...)[?25l
:  [?12l[?25h:  let ret = a:title
[?25l:  [?12l[?25h:  let idx = 1
[?25l:  [?12l[?25h:  while idx <= a:0
[?25l:    [?12l[?25h:    exe "let ret = ret . a:" . idx
[?25l:    [?12l[?25h:    let idx = idx + 1
[?25l:    [?12l[?25h:  endwhile
[?25l:  [?12l[?25h:  return ret
[?25l:  [?12l[?25h:endfunction[1;1H[8L[?25l[1;1H/^here
C[34m^R[m=Table("xxx", 4, "asdf")
 [34m^R[m=Compute(45, 0, "retval")
 [34m^R[m=retval
 [34m^R[m=Compute(45, 5, "retval")
 [34m^R[m=retval
 [34m^R[m=g:FuncRef(333)[25;1H[K[23;1H[?12l[?25h[?25l

:[?12l[?25hfunction Compute(n1, n2, divname)[?25l
:  [?12l[?25h:  if a:n2 == 0
[?25l:    [?12l[?25h:    return "fail"
[?25l:    [?12l[?25h:  endif
[?25l:  [?12l[?25h:  exe "let g:" . a:divname . " = ". a:n1 / a:n2
[?25l:  [?12l[?25h:  return "ok"
[?25l:  [?12l[?25h:endfunction[1;1H[6L[?25l[1;1H/^here
C[34m^R[m=Table("xxx", 4, "asdf")
 [34m^R[m=Compute(45, 0, "retval")
 [34m^R[m=retval
 [34m^R[m=Compute(45, 5, "retval")
 [34m^R[m=retval[25;1H[K[23;1H[?12l[?25h[?25l

:[?12l[?25hfunc Expr1()[?25l
:  [?12l[?25h:  normal! v
[?25l:  [?12l[?25h:  return "111"
[?25l:  [?12l[?25h:endfunc[1;1H[3L[?25l[1;1H/^here
C[34m^R[m=Table("xxx", 4, "asdf")
 [34m^R[m=Compute(45, 0, "retval")[25;1H[K[23;1H[?12l[?25h[?25l

:[?12l[?25hfunc Expr2()[?25l
:  [?12l[?25h:  call search('XX', 'b')
[?25l:  [?12l[?25h:  return "222"
[?25l:  [?12l[?25h:endfunc[1;1H[3L[?25l[1;1H/^here
C[34m^R[m=Table("xxx", 4, "asdf")
 [34m^R[m=Compute(45, 0, "retval")[25;1H[K[23;1H[?12l[?25h[?25l

:[?12l[?25hfunc ListItem()[?25l
:  [?12l[?25h:  let g:counter += 1
[?25l:  [?12l[?25h:  return g:counter . '. '
[?25l:  [?12l[?25h:endfunc[1;1H[3L[?25l[1;1H/^here
C[34m^R[m=Table("xxx", 4, "asdf")
 [34m^R[m=Compute(45, 0, "retval")[25;1H[K[23;1H[?12l[?25h[?25l

:[?12l[?25hfunc ListReset()[?25l
:  [?12l[?25h:  let g:counter = 0
[?25l:  [?12l[?25h:  return ''
[?25l:  [?12l[?25h:endfunc[1;1H[3L[?25l[1;1H/^here
C[34m^R[m=Table("xxx", 4, "asdf")
 [34m^R[m=Compute(45, 0, "retval")[25;1H[K[23;1H[?12l[?25h[?25l

:[?12l[?25hfunc FuncWithRef(a)[?25l
:  [?12l[?25h:  unlet g:FuncRef
[?25l:  [?12l[?25h:  return a:a
[?25l:  [?12l[?25h:endfunc[1;1H[3L[?25l[1;1H/^here
C[34m^R[m=Table("xxx", 4, "asdf")
 [34m^R[m=Compute(45, 0, "retval")[25;1H[K[23;1H[?12l[?25h[?25l

:[?12l[?25hlet g:FuncRef=function("FuncWithRef")[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet counter = 0[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hinoremap <expr> ( ListItem()[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hinoremap <expr> [ ListReset()[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25himap <expr> + Expr1()[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25himap <expr> * Expr2()[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet retval = "nop"[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^here[?25l[24;1H[?12l[?25h[?25lher$[25;1H[K[25;1H=[?12l[?25hTable("xxx", 4, "asdf")[?25l[25;1H[K[25;1H=[?12l[?25hCompute(45, 0, "retval")[?25l[25;1H[K[25;1H=[?12l[?25hretval[?25l[25;1H[K[25;1H=[?12l[?25hCompute(45, 5, "retval")[?25l[25;1H[K[25;1H=[?12l[?25hretval[?25l[25;1H[K[25;1H=[?12l[?25hg:FuncRef(333)
[?25l[1m[37m[41mError detected while processing function Expr1:[m
[33mline    1:[m
[1m[37m[41mE523: Not allowed here[m
[32mPress ENTER or type command to continue[?12l[?25h[m[1;1H[4L[?25l[1;2H[34m^R[m=retval
 [34m^R[m=g:FuncRef(333)

XX+-XX
---*---[5;8H[K[6;1H(one[6;5H[K[7;1H(two[7;5H[K[8;1H[(one again[34m^[[m:$-5,$w! test.out
:delfunc Table
:delfunc Compute
:delfunc Expr1
:delfunc Expr2
:delfunc ListItem[13;18H[K[14;10HListReset
:unlet retval counter
:q![16;4H[K[17;1HENDTEST[17;8H[K[18;1H[K[19;1Hxxx4asdf fail nop ok 9 333
XX111XX[20;8H[K[21;1H---222---
1. one[22;7H[K[23;1H2. two[24;1H[K[25;1H[K[24;1H[?12l[?25h[?25l1. one again[?12l[?25h[?25l
:[?12l[?25h$-5,$w! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 6 lines, 72 characters written[24;12H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hdelfunc Table[?25l[24;12H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hdelfunc Compute[?25l[24;12H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hdelfunc Expr1[?25l[24;12H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hdelfunc Expr2[?25l[24;12H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hdelfunc ListItem[?25l[24;12H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hdelfunc ListReset[?25l[24;12H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hunlet retval counter[?25l[24;12H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hq![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test35.failed test.ok test.out X* viminfo
cp test35.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test35.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test35.in" 21 lines, 448 characters[1;1HTest Ctrl-A and Ctrl-X, which increment and decrement decimal, hexadecimal,
and octal numbers.

STARTTEST
/^start-here
:set nrformats=octal,hex
j[34m^A[m102[34m^X^A[ml[34m^X[ml[34m^A[m64[34m^A[m128[34m^X[m$[34m^X[m
:set nrformats=octal
0[34m^A[m102[34m^X^A[ml[34m^X[m2[34m^A[mw65[34m^A[m129[34m^X[mblx6lD
:set nrformats=hex
0101[34m^X[ml257[34m^X^A[mTxldt [34m^A[m [34m^X[m [34m^X[m
:set nrformats=
0200[34m^X[ml100[34m^X[mw78[34m^X^A[mk
:$-3,$wq! test.out
ENDTEST

start-here
100     0x100     077     0
100     0x100     077
100     0x100     077     0xfF     0xFf
100     0x100     077
[1m[34m~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest Ctrl-A and Ctrl-X, which increment and decrement decimal, hexadecimal,[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[4;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 10 lines, 200 characters written[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[5;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[15;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[16;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^start-here[?25l[17;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset nrformats=octal,hex[?25l[17;1H[?12l[?25h
[?25l101[?12l[?25h[?25l-1     0x100     077     0[18;27H[K[18;2H[?12l[?25h[?25l0     0x100     077     0[18;26H[K[18;1H[?12l[?25h0[?25l[7C0ff[?12l[?25hf[?25l     0100     0[18;20H[?12l[?25h[?25l20[?12l[?25h[?25l00[?12l[?25h0     [?25l-1[?12l[?25h[19;26H[?25l[25;1H[K[25;1H:[?12l[?25hset nrformats=octal[?25l[19;26H[?12l[?25h[?25l101[?12l[?25h[?25l-1     0x100     077 -[?12l[?25h[?25l0     0x100     077 [?12l[?25h0[?25l     -1x100     077[19;8H[?12l[?25h[?25l1x100     077 [19;7H[?12l[?25h[10C[?25l0200[?12l[?25h[?25l1777777777777777777777[?12l[?25h[19;17H0[?25l7[20C [19;18H[?12l[?25h777777[?25l[19;24H[K[19;23H[?12l[?25h[20;23H[?25l[25;1H[K[25;1H:[?12l[?25hset nrformats=hex[?25l[20;23H[?12l[?25h[?25l-1     0x100     077     0xfF     0xFf[20;39H[K[20;2H[?12l[?25h1[?25l[7Cffffffffffffffff     077     0xfF     0xFf[20;25H[?12l[?25h[?25l[20;10H0000000000000000[?12l[?25h[20;10H0[?25l     077     0xfF     0xFf[20;39H[K[20;11H[?12l[?25h[?25l[7C8[?12l[?25h8[?25l[7CFE[?12l[?25hE[?25l[7Cfe[?12l[?25h[21;26H[?25l[25;1H[K[25;1H:[?12l[?25hset nrformats=[?25l[21;26H[?12l[?25h[?25l-100     0x100     077-10[?12l[?25h0[?25l     -100x100     077[21;13H[?12l[?25h[10C[?25l-001[?12l[?25h[?25l000 [?12l[?25h[20;25H[21;25H[?25l[25;1H[K[25;1H:[?12l[?25h$-3,$wq! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 4 lines, 120 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test36.failed test.ok test.out X* viminfo
cp test36.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test36.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test36.in" 40 lines, 1596 characters[1;1HTest character classes in regexp

STARTTEST
/^start-here
j:s/\d//g
j:s/\D//g
j:s/\o//g
j:s/\O//g
j:s/\x//g
j:s/\X//g
j:s/\w//g
j:s/\W//g
j:s/\h//g
j:s/\H//g
j:s/\a//g
j:s/\A//g
j:s/\l//g
j:s/\L//g
j:s/\u//g
j:s/\U//g
:/^start-here/+1,$wq! test.out
ENDTEST

start-here[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest character classes in regexp[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 18 lines, 204 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[22;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[23;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^start-here[?25l[24;1H[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[23;9H[34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[24;1H[34m^?~@~B~P~[[m[25;1H[K[23;8H[?12l[?25h[?25l

:[?12l[?25hs/\d//g[?25l10 substitutions on 1 line[23;29H:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[34m^?~@~B~P~[[[m[24;1H[24;7H[K[23;9H[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[23;9H[34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[24;1H[34m^?~@~B~P~[[m[25;1H[K[23;9H[?12l[?25h[?25l

:[?12l[?25hs/\D//g[?25l72 substitutions on 1 line[23;1H0123456789[23;11H[K[24;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m@                                                                               [23;1H[?12l[?25h[?25l[1;24r[m[24;1H
[1;25r[23;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[24;1H[34m^?~@~B~P~[[m[25;1H[K[23;8H[?12l[?25h[?25l

:[?12l[?25hs/\o//g[?25l8 substitutions on 1 line[23;29H89:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[34m^?~@~B~PP[24;1H~[[m[24;9H[K[23;9H[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[23;9H[34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[24;1H[34m^?~@~B~P~[[m[25;1H[K[23;9H[?12l[?25h[?25l

:[?12l[?25hs/\O//g[?25l74 substitutions on 1 line[23;1H01234567[23;9H[K[24;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m@                                                                               [23;1H[?12l[?25h[?25l[1;24r[m[24;1H
[1;25r[23;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[24;1H[34m^?~@~B~P~[[m[25;1H[K[23;8H[?12l[?25h[?25l

:[?12l[?25hs/\x//g[?25l22 substitutions on 1 line[23;29H:;<=>?@GHIXYZ[\]^_`ghiwxyz{|}~[34m^?~@~B~P~[[m[23;75H[K[24;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m@                                                                               [23;9H[?12l[?25h[?25l[1;24r[m[24;1H
[1;25r[23;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[24;1H[34m^?~@~B~P~[[m[25;1H[K[23;9H[?12l[?25h[?25l

:[?12l[?25hs/\X//g[?25l60 substitutions on 1 line[23;1H0123456789ABCDEFabcdef[23;23H[K[24;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m@                                                                               [23;1H[?12l[?25h[?25l[1;24r[m[24;1H
[1;25r[23;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[24;1H[34m^?~@~B~P~[[m[25;1H[K[23;8H[?12l[?25h[?25l

:[?12l[?25hs/\w//g[?25l36 substitutions on 1 line[23;29H:;<=>?@[\]^`{|}~[34m^?~@~B~P~[[m[23;61H[K[24;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m@                                                                               [23;9H[?12l[?25h[?25l[1;24r[m[24;1H
[1;25r[23;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[24;1H[34m^?~@~B~P~[[m[25;1H[K[23;9H[?12l[?25h[?25l

:[?12l[?25hs/\W//g[?25l46 substitutions on 1 line[23;1H0123456789ABCDEFGHIXYZ_abcdefghiwxyz[23;37H[K[24;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m@                                                                               [23;1H[?12l[?25h[?25l[1;24r[m[24;1H
[1;25r[23;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[24;1H[34m^?~@~B~P~[[m[25;1H[K[23;8H[?12l[?25h[?25l

:[?12l[?25hs/\h//g[?25l26 substitutions on 1 line[23;46H[\]^`{|}~[34m^?~@~B~P~[[m[23;71H[K[24;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m@                                                                               [23;9H[?12l[?25h[?25l[1;24r[m[24;1H
[1;25r[23;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[24;1H[34m^?~@~B~P~[[m[25;1H[K[23;9H[?12l[?25h[?25l

:[?12l[?25hs/\H//g[?25l56 substitutions on 1 line[23;1HABCDEFGHIXYZ_abcdefghiwxyz[23;27H[K[24;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m@                                                                               [23;1H[?12l[?25h[?25l[1;24r[m[24;1H
[1;25r[23;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[24;1H[34m^?~@~B~P~[[m[25;1H[K[23;8H[?12l[?25h[?25l

:[?12l[?25hs/\a//g[?25l25 substitutions on 1 line[23;46H[\]^_`{|}~[34m^?~@~B~P~[[m[23;72H[K[24;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m@                                                                               [23;9H[?12l[?25h[?25l[1;24r[m[24;1H
[1;25r[23;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[24;1H[34m^?~@~B~P~[[m[25;1H[K[23;9H[?12l[?25h[?25l

:[?12l[?25hs/\A//g[?25l57 substitutions on 1 line[23;1HABCDEFGHIXYZabcdefghiwxyz[23;26H[K[24;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m@                                                                               [23;1H[?12l[?25h[?25l[1;24r[m[24;1H
[1;25r[23;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[24;1H[34m^?~@~B~P~[[m[25;1H[K[23;8H[?12l[?25h[?25l

:[?12l[?25hs/\l//g[?25l13 substitutions on 1 line[23;64H{|}~[34m^?~@~B~P~[[m[24;1H[24;4H[K[23;9H[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[23;9H[34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[24;1H[34m^?~@~B~P~[[m[25;1H[K[23;9H[?12l[?25h[?25l

:[?12l[?25hs/\L//g[?25l69 substitutions on 1 line[23;1Habcdefghiwxyz[23;14H[K[24;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m@                                                                               [23;1H[?12l[?25h[?25l[1;24r[m[24;1H
[1;25r[23;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[24;1H[34m^?~@~B~P~[[m[25;1H[K[23;8H[?12l[?25h[?25l

:[?12l[?25hs/\u//g[?25l12 substitutions on 1 line[23;46H[\]^_`abcdefghiwxyz{|}~[34m^?~@~B~P~[[m[24;1H[24;5H[K[23;9H[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[23;9H[34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[24;1H[34m^?~@~B~P~[[m[25;1H[K[23;9H[?12l[?25h[?25l

:[?12l[?25hs/\U//g[?25l70 substitutions on 1 line[23;1HABCDEFGHIXYZ[23;14H[K[24;1H[1m[34m~                                                                               [23;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h/^start-here/+1,$wq! test.out[?25l[31msearch hit BOTTOM, continuing at TOP[m"test.out" [25;12H[K[25;12H[New File] 16 lines, 672 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test37.failed test.ok test.out X* viminfo
cp test37.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test37.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test37.in" 116 lines, 3262 characters[1;1HTest for 'scrollbind'. <eralston@computer.org>   Do not add a line below!
STARTTEST
:so small.vim
:set noscrollbind
:set scrollopt=ver,jump
:set scrolloff=2
:set nowrap
:set noequalalways
:set splitbelow
:" TEST using two windows open to one buffer, one extra empty window
:split
:new
[34m^W[mt:
:resize 8
/^start of window 1$/
zt:
:set scrollbind
[34m^W[mj:
:resize 7
/^start of window 2$/
zt:
:set scrollbind
:" -- start of tests --
:" TEST scrolling down[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for 'scrollbind'. <eralston@computer.org>   Do not add a line below![25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[2;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 72 lines, 1498 characters written[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[3;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;1HHk[34m^W[mtH[34m^W[mjHyy[34m^W[mbp[34m^W[mtyy[34m^W[mbp:
[34m^W[mt:set noscb
ggL[34m^W[mj:set noscb
ggL:set scb
[34m^W[mt:set scb
[34m^W[mtG[34m^W[mjG[34m^W[mt:syncbind
Hk[34m^W[mjH[34m^W[mtHyy[34m^W[mbp[34m^W[mt[34m^W[mjyy[34m^W[mbp:
[34m^W[mtH3k[34m^W[mjH[34m^W[mtHyy[34m^W[mbp[34m^W[mt[34m^W[mjyy[34m^W[mbp:
:" ***** done with tests *****
:w! test.out[13C" Write contents of this file
:qa!
ENDTEST


start of window 1
. line 01 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01
. line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02
. line 03 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 03
. line 04 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 04
. line 05 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05
. line 06 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06
. line 07 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 07
. line 08 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 08
. line 09 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 09[12;1H[?12l[?25h
[?25l[25;1H:so! Xdotest[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset noscrollbind[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset scrollopt=ver,jump[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset scrolloff=2[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset nowrap[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset noequalalways[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset splitbelow[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" TEST using two windows open to one buffer, one extra empty window[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hsplit[?25l[1;1H[34m^W[mtH3k[4C[34m^W[mtHyy[2Cbp[34m^W[mt[34m^W[mjyy[34m^W[mbp:
:" ***** done with tests *****
:w! test.out    [9C" Write contents of this file
:qa![4;5H[K[5;1HENDTEST[5;9H[K[6;1H[K[7;1H[K[8;1Hstart of window 1[8;18H[K[9;1H. line 01 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01
. line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[10;51H[K[11;1H. line 03 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 03
[7mtest37.in                                                                       [m[13;1H:qa!
ENDTEST[15;1H[K[16;1H[K[17;1Hstart of window 1[17;18H[K[18;9H1[39C1[19;9H2[39C2[20;9H3[39C3[21;9H4[39C4[22;9H5[39C5[23;9H6[39C6
[1m[7mtest37.in                                                                       [15;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hnew[?25l[18;1H[7mtest37.in                                                                       [m[19;1H[K[20;1H[1m[34m~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [m[24;1H[1m[7m[No Name] [19;1H[?12l[?25h[12;1Htest37.in                                                                       [m[24;1H[7m[No Name][m[1m[7m [m[7m                                                                       [6;1H[?25l[m[25;1H[K[25;1H:[?12l[?25h[?25l[6;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hresize 8[?25l[1;1H:" ***** done with tests *****[1;31H[K[2;2Hw! test.out             " Write contents of this file
:qa![3;5H[K[4;1HENDTEST[5;1H[K[7;1Hstart of window 1
. line 01 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01
[1m[7mtest37.in                                                                       [m[10;1HENDTEST[10;8H[K[11;1H[K[12;1H[K[13;1Hstart of window 1
. line 01 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01
. line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02
. line 03 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 03
. line 04 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 04[5;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^start of window 1$/[?25l[25;21H[K[25;1H[1;8r[8;1H
[1;25r[8;1H. line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[25;1H[K[6;1H[?12l[?25h[?25l[1;8r[1;1H[3M[1;25r[6;1H. line 03 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 03
. line 04 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 04
. line 05 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05[3;1H[?12l[?25h[?25l[25;1H:[?12l[?25h[?25l[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset scrollbind[?25l[3;1H[?12l[?25h[?25l[9;1H[7mtest37.in[m[1m[7m [m[7m                                                                       [10;17r[m[10;1H[L[1;25r[10;1H:qa![18;1H[1m[7mtest37.in                                                                       [m[25;1H[K[12;1H[?12l[?25h[?25l[25;1H:[?12l[?25h[?25l[12;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hresize 7[?25l[17;1H[1m[7mtest37.in                                                                       [m[18;1H[K[19;1H[1m[34m~                                                                               [12;1H[?12l[?25h[?25l[m[25;1H[K[25;1H/[?12l[?25h^start of window 2$/[?25l[25;21H[K[25;1H[10;1Hend of window 1[11;1H[K[13;1Hstart of window 2
. line 01 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 01[15;9H2 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 02[16;9H3 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 03[13;1H[?12l[?25h[?25l[10;16r[16;1H
[1;25r[16;1H. line 04 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 04[25;1H[K[12;1H[?12l[?25h[?25l[25;1H:[?12l[?25h[?25l[12;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset scrollbind[?25l[12;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" -- start of tests --[?25l[12;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" TEST scrolling down[?25l[12;1H[?12l[?25h

[?25l[1;8r[1;1H[5M[1;25r[4;1H. line 06 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06
. line 07 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 07
. line 08 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 08
. line 09 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 09
. line 10 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 10[10;16r[10;1H[5M[1;25r[12;1H. line 05 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 05
. line 06 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 06
. line 07 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 07
. line 08 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 08
. line 09 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 09[25;1H[K[14;1H[?12l[?25h[12;1H[17;1H[7mtest37.in[m[1m[7m [m[7m                                                                       [m[24;1H[1m[7m[No Name]                                                                       [18;1H[?25l[m
. line 05 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 05[19;50H[K[24;11H[1m[7m[+][19;1H[?12l[?25h[?25l[m0[?12l[?25h[9;1H[1m[7mtest37.in                                                                       [m[24;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [3;1H[9;1Htest37.in[m[1m[7m [m[7m                                                                       [m[24;1H[1m[7m[No Name] [+]                                                                   [19;1H[?25l[m
. line 05 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05[20;50H[K[20;1H[?12l[?25h[?25l1[?12l[?25h[9;1H[1m[7mtest37.in                                                                       [m[24;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [3;1H


[?25l[1;8r[m[1;1H[6M[1;25r[3;1H. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11
. line 12 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 12
. line 13 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 13
. line 14 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 14
. line 15 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 15
end of window 1[10;16r[10;1H[6M[1;25r[11;1H. line 10 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 10
. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11
. line 12 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 12
. line 13 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 13
. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14
. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15[6;1H[?12l[?25h[3;1H[9;1H[7mtest37.in[m[1m[7m [m[7m                                                                       [m[24;1H[1m[7m[No Name] [+]                                                                   [20;1H[?25l[m
. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11[21;50H[K[21;1H[?12l[?25h[?25l2[?12l[?25h[17;1H[1m[7mtest37.in                                                                       [m[24;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [12;1H[17;1Htest37.in[m[1m[7m [m[7m                                                                       [m[24;1H[1m[7m[No Name] [+]                                                                   [21;1H[?25l[m
. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11[22;50H[K[22;1H[?12l[?25h[?25l3[?12l[?25h[?25l


:[?12l[?25h[?25l[22;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" TEST scrolling up[?25l[22;1H[?12l[?25h[9;1H[1m[7mtest37.in                                                                       [m[24;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [3;1H[?25l[1;8r[m[1;1H[5L[1;25r[1;1H. line 04 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 04
. line 05 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05
. line 06 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06
. line 07 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 07
. line 08 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 08[10;9H4[39C4[11;8H05[38C05[12;8H06[38C06[13;8H07[38C07[14;8H08[38C08[15;8H09[38C09[16;9H0[39C0[25;1H[K[4;1H[?12l[?25h[9;1H[7mtest37.in[m[1m[7m [m[7m                                                                       [m[17;1H[1m[7mtest37.in                                                                       [14;1H[12;1H[9;1Htest37.in                                                                       [m[17;1H[7mtest37.in[m[1m[7m [m[7m                                                                       [4;1H[3;1H[9;1Htest37.in[m[1m[7m [m[7m                                                                       [m[24;1H[1m[7m[No Name] [+]                                                                   [22;1H[?25l[m
. line 06 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06[23;50H[K[23;1H[?12l[?25h[?25l4[?12l[?25h[17;1H[1m[7mtest37.in                                                                       [m[24;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [12;1H[17;1Htest37.in[m[1m[7m [m[7m                                                                       [m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[18;23r[m[23;1H
[1;25r[23;1H. line 06 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 06[?12l[?25h[?25l5[?12l[?25h[17;1H[1m[7mtest37.in                                                                       [m[24;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [12;1H[?25l[1;8r[m[1;1H[4L[1;25r[1;1Hstart of window 1
. line 01 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01
. line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02
. line 03 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 03[10;16r[10;1H[4L[1;25r[10;1Hstart of window 2
. line 01 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 01
. line 02 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 02
. line 03 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 03[?12l[?25h[9;1H[1m[7mtest37.in                                                                       [m[17;1H[7mtest37.in[m[1m[7m [m[7m                                                                       [6;1H[3;1H[9;1Htest37.in[m[1m[7m [m[7m                                                                       [m[17;1H[1m[7mtest37.in                                                                       [13;1H[12;1H[m[17;1H[7mtest37.in[m[1m[7m [m[7m                                                                       [m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[18;23r[m[23;1H
[1;25r[23;1H. line 02 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 02[?12l[?25h[?25l6[?12l[?25h[9;1H[1m[7mtest37.in                                                                       [m[24;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [3;1H[9;1Htest37.in[m[1m[7m [m[7m                                                                       [m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[18;23r[m[23;1H
[1;25r[23;1H. line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[?12l[?25h[?25l7[?12l[?25h[?25l

:[?12l[?25h[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" TEST horizontal scrolling[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset scrollopt+=hor[?25l[23;1H[?12l[?25h[?25l[18;23r[18;1H[3L[1;25r[19;1H0 line 05 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 05
1 line 05 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05[25;1H[K[18;1H[?12l[?25h[?25l[18;23r[18;1H[3M[1;25r[21;1H5 line 06 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 06
6 line 02 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 02
7 line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[?12l[?25h[?25l[18;23r[23;1H
[1;25r[23;1H[?12l[?25h[9;1H[1m[7mtest37.in                                                                       [m[24;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [3;1H[?25l[m[1;1H 1[1;3H[K[2;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01[2;35H[K[3;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[3;35H[K[4;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 03[4;35H[K[5;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 04[5;35H[K[6;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05[6;35H[K[7;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06[7;35H[K[8;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 07[8;35H[K[10;1H 2[10;3H[K[11;1HUTSRQPONMLKJIHGREDCBA9876543210 01[11;35H[K[12;1HUTSRQPONMLKJIHGREDCBA9876543210 02[12;35H[K[13;1HUTSRQPONMLKJIHGREDCBA9876543210 03[13;35H[K[14;1HUTSRQPONMLKJIHGREDCBA9876543210 04[14;35H[K[15;1HUTSRQPONMLKJIHGREDCBA9876543210 05[15;35H[K[16;1HUTSRQPONMLKJIHGREDCBA9876543210 06[16;35H[K[3;1H[?12l[?25h[9;1H[7mtest37.in[m[1m[7m [m[7m                                                                       [m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[m56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[?12l[?25h[?25l[18;23r[23;1H
[1;25r[23;1H[?12l[?25h[17;1H[1m[7mtest37.in                                                                       [m[24;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [12;1H[17;1Htest37.in[m[1m[7m [m[7m                                                                       [m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[mUTSRQPONMLKJIHGREDCBA9876543210 02[?12l[?25h[?25l[18;23r[23;1H
[1;25r[23;1H[?12l[?25h[?25l

:[?12l[?25h[?25l[23;1H[?12l[?25h[17;1H[1m[7mtest37.in                                                                       [m[24;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [12;1H[?25l[m[1;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 09[2;33H10[3;33H11[4;33H12[5;33H13[6;33H14[7;33H15[8;1H[K[10;1HUTSRQPONMLKJIHGREDCBA9876543210 09[11;33H10[12;33H11[13;33H12[14;33H13[15;33H14[16;33H15[13;1H[?12l[?25h[?25l[1;1H. line 09 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 09
. line 10 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 10
. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11
. line 12 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 12
. line 13 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 13
. line 14 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 14
. line 15 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 15
end of window 1

. line 09 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 09
. line 10 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 10
. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11
. line 12 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 12
. line 13 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 13
. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14
. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15[12;1H[?12l[?25h[?25l[?12l[?25h[17;1H[7mtest37.in[m[1m[7m [m[7m                                                                       [m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[m. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11[?12l[?25h[?25l[18;23r[23;1H
[1;25r[25;1H[K[23;1H[?12l[?25h[9;1H[1m[7mtest37.in                                                                       [m[24;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [3;16H[9;1Htest37.in[m[1m[7m [m[7m                                                                       [m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[m. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11[?12l[?25h[?25l[18;23r[23;1H
[1;25r[23;1H[?12l[?25h[?25l

:[?12l[?25h[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset scrollopt-=hor[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" ****** tests using two different buffers *****[?25l[23;1H[?12l[?25h[9;1H[1m[7mtest37.in                                                                       [m[24;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [3;1H[9;1Htest37.in[m[1m[7m [m[7m                                                                       [m[17;1H[1m[7mtest37.in                                                                       [12;1H[?25l[m[25;1H[K[25;1H:[?12l[?25h[?25l[12;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hclose[?25l[9;1H[K[10;1H[K[11;1Hstart of window 2[11;18H[K[12;8H0[39C0[13;8H0[39C0[14;8H0[39C0[15;8H0[39C0[16;8H0[39C0[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[?25l[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset noscrollbind[?25l[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^start of window 2$/,/^end of window 2$/y[?25l18 lines yanked[25;16H[K[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hnew[?25l[8;1H[7mtest37.in                                                                       [m[10;1H[1m[34m~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [m[17;1H[1m[7m[No Name] [9;1H[?12l[?25h[8;1Htest37.in                                                                       [m[17;1H[7m[No Name][m[1m[7m [m[7m                                                                       [3;1H[8;1Htest37.in[m[1m[7m [m[7m                                                                       [m[17;1H[1m[7m[No Name]                                                                       [9;1H[?25l[m[25;1H4 more lines[10;1H[K[11;1H[K[12;1H[K[13;1H[K[17;11H[1m[7m[+][10;1H[?12l[?25h


[?25l[m[25;1H18 more lines[14;1Hstart of window 2[14;18H[K[15;1H. line 01 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 01[15;50H[K[16;1H. line 02 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 02[16;50H[K[14;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[?25l[14;1H[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[17;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [3;1H[?25l[m[25;1H[K[25;1H/[?12l[?25h^start of window 1$/[?25l[25;21H[K[25;1H[31msearch hit BOTTOM, continuing at TOP[m[1;1HENDTEST[1;8H[K[2;1H[K[3;1H[K[4;1Hstart of window 1[4;18H[K[5;8H01[38C01[6;8H02[38C02[7;8H03[38C03[4;1H[?12l[?25h[?25l[1;7r[7;1H
[1;25r[7;1H. line 04 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 04[25;1H[K[3;1H[?12l[?25h[?25l[25;1H:[?12l[?25h[?25l[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset scrollbind[?25l[3;1H[?12l[?25h[8;1H[7mtest37.in[m[1m[7m [m[7m                                                                       [m[17;1H[1m[7m[No Name] [+]                                                                   [14;1H[?25l[m[25;1H[K[25;1H:[?12l[?25h[?25l[14;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^start of window 2$/[?25l[25;21H[K[25;1H[31msearch hit BOTTOM, continuing at TOP[14;1H[?12l[?25h[?25l[9;16r[m[9;1H[3M[1;25r[14;1H. line 03 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 03
. line 04 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 04
. line 05 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 05[25;1H[K[11;1H[?12l[?25h[?25l[25;1H:[?12l[?25h[?25l[11;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset scrollbind[?25l[11;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" -- start of tests --[?25l[11;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" TEST scrolling down[?25l[11;1H[?12l[?25h


[?25l[1;7r[1;1H[5M[1;25r[3;1H. line 05 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05
. line 06 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06
. line 07 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 07
. line 08 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 08
. line 09 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 09[9;16r[9;1H[5M[1;25r[12;1H. line 06 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 06
. line 07 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 07
. line 08 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 08
. line 09 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 09
. line 10 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 10[25;1H[K[14;1H[?12l[?25h[11;1H[17;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[18;23r[m[23;1H
[1;25r[23;1H. line 05 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 05[?12l[?25h[?25l0[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[24;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [3;1H[8;1Htest37.in[m[1m[7m [m[7m                                                                       [m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[18;23r[m[23;1H
[1;25r[23;1H. line 05 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05[?12l[?25h[?25l1[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[24;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [3;1H

[?25l[1;7r[m[1;1H[6M[1;25r[2;1H. line 10 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 10
. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11
. line 12 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 12
. line 13 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 13
. line 14 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 14
. line 15 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 15[9;16r[9;1H[6M[1;25r[11;1H. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11
. line 12 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 12
. line 13 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 13
. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14
. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15
. line 16 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 16[5;1H[?12l[?25h[3;1H[8;1H[7mtest37.in[m[1m[7m [m[7m                                                                       [m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[18;23r[m[23;1H
[1;25r[23;1H. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11[?12l[?25h[?25l2[?12l[?25h[17;1H[1m[7m[No Name] [+]                                                                   [m[24;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [11;1H[17;1H[No Name] [+][m[1m[7m [m[7m                                                                   [m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[18;23r[m[23;1H
[1;25r[23;1H. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11[?12l[?25h[?25l3[?12l[?25h[?25l

:[?12l[?25h[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" TEST scrolling up[?25l[23;1H[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[24;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [3;1H[?25l[m[1;9H4[39C4[2;8H05[38C05[3;8H06[38C06[4;8H07[38C07[5;8H08[38C08[6;8H09[38C09[7;9H0[39C0[9;16r[9;1H[5L[1;25r[9;1H. line 04 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 04
. line 05 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 05
. line 06 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 06
. line 07 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 07
. line 08 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 08[25;1H[K[4;1H[?12l[?25h[8;1H[7mtest37.in[m[1m[7m [m[7m                                                                       [m[17;1H[1m[7m[No Name] [+]                                                                   [14;1H[11;1H[8;1Htest37.in                                                                       [m[17;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [4;1H[3;1H[8;1Htest37.in[m[1m[7m [m[7m                                                                       [m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[18;23r[m[23;1H
[1;25r[23;1H. line 06 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06[?12l[?25h[?25l4[?12l[?25h[17;1H[1m[7m[No Name] [+]                                                                   [m[24;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [11;1H[17;1H[No Name] [+][m[1m[7m [m[7m                                                                   [m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[18;23r[m[23;1H
[1;25r[23;1H. line 06 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 06[?12l[?25h[?25l5[?12l[?25h[17;1H[1m[7m[No Name] [+]                                                                   [m[24;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [11;1H[?25l[1;7r[m[1;1H[4L[1;25r[1;1Hstart of window 1
. line 01 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01
. line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02
. line 03 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 03[9;16r[9;1H[4L[1;25r[9;1Hstart of window 2
. line 01 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 01
. line 02 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 02
. line 03 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 03[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[17;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [5;1H[3;1H[8;1Htest37.in[m[1m[7m [m[7m                                                                       [m[17;1H[1m[7m[No Name] [+]                                                                   [12;1H[11;1H[m[17;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[18;23r[m[23;1H
[1;25r[23;1H. line 02 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 02[?12l[?25h[?25l6[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[24;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [3;1H[8;1Htest37.in[m[1m[7m [m[7m                                                                       [m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[18;23r[m[23;1H
[1;25r[23;1H. line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[?12l[?25h[?25l7[?12l[?25h[?25l

:[?12l[?25h[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" TEST horizontal scrolling[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset scrollopt+=hor[?25l[23;1H[?12l[?25h[?25l[18;1H[K[19;1H0 line 05[38C05
1[7C5[39C5
2 line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11
3 line 11[38C11
4[7C6[39C6[18;1H[?12l[?25h[?25l2 line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11
3 line 11[38C11
4[7C6[39C6
5 line 06 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 06
6 line 02[38C02
7[7C2[39C2[?12l[?25h[?25l[18;23r[23;1H
[1;25r[25;1H[K[23;1H[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[24;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [3;1H[?25l[m[1;1H 1[1;3H[K[2;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01[2;35H[K[3;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[3;35H[K[4;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 03[4;35H[K[5;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 04[5;35H[K[6;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05[6;35H[K[7;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06[7;35H[K[9;1H 2[9;3H[K[10;1HUTSRQPONMLKJIHGREDCBA9876543210 01[10;35H[K[11;1HUTSRQPONMLKJIHGREDCBA9876543210 02[11;35H[K[12;1HUTSRQPONMLKJIHGREDCBA9876543210 03[12;35H[K[13;1HUTSRQPONMLKJIHGREDCBA9876543210 04[13;35H[K[14;1HUTSRQPONMLKJIHGREDCBA9876543210 05[14;35H[K[15;1HUTSRQPONMLKJIHGREDCBA9876543210 06[15;35H[K[16;1HUTSRQPONMLKJIHGREDCBA9876543210 07[16;35H[K[3;1H[?12l[?25h[8;1H[7mtest37.in[m[1m[7m [m[7m                                                                       [m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[m56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[?12l[?25h[?25l[18;23r[23;1H
[1;25r[23;1H[?12l[?25h[17;1H[1m[7m[No Name] [+]                                                                   [m[24;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [11;1H[17;1H[No Name] [+][m[1m[7m [m[7m                                                                   [m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[mUTSRQPONMLKJIHGREDCBA9876543210 02[?12l[?25h[?25l[18;23r[23;1H
[1;25r[23;1H[?12l[?25h[?25l

:[?12l[?25h[?25l[23;1H[?12l[?25h[17;1H[1m[7m[No Name] [+]                                                                   [m[24;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [11;1H[?25l[m[1;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 09[2;33H10[3;33H11[4;33H12[5;33H13[6;33H14[7;33H15

UTSRQPONMLKJIHGREDCBA9876543210 09[10;33H10[11;33H11[12;33H12[13;33H13[14;33H14[15;33H15[16;33H16[12;1H[?12l[?25h[?25l[1;1H. line 09 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 09
. line 10 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 10
. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11
. line 12 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 12
. line 13 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 13
. line 14 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 14
. line 15 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 15

. line 09 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 09
. line 10 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 10
. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11
. line 12 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 12
. line 13 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 13
. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14
. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15
. line 16 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 16[11;1H[?12l[?25h[?25l[?12l[?25h[17;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[m. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11[?12l[?25h[?25l[18;23r[23;1H
[1;25r[25;1H[K[23;1H[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[24;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [3;16H[8;1Htest37.in[m[1m[7m [m[7m                                                                       [m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[m. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11[?12l[?25h[?25l[18;23r[23;1H
[1;25r[23;1H[?12l[?25h[?25l

:[?12l[?25h[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset scrollopt-=hor[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" TEST syncbind[?25l[23;1H[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[24;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [3;1H[?25l[m[25;1H[K[25;1H:[?12l[?25hset noscb[?25l[3;1H[?12l[?25h[?25l[1;1HTest for 'scrollbind'. <eralston@computer.org>   Do not add a line below!
STARTTEST[2;11H[K[3;1H:so small.vim[3;14H[K[4;1H:set noscrollbind[4;18H[K[5;1H:set scrollopt=ver,jump[5;24H[K[6;1H:set scrolloff=2[6;17H[K[7;1H:set nowrap[7;12H[K[1;1H[?12l[?25h[5;1H


[7mtest37.in[m[1m[7m [m[7m                                                                       [m[17;1H[1m[7m[No Name] [+]                                                                   [11;1H[?25l[m[25;1H[K[25;1H:[?12l[?25hset noscb[?25l[11;1H[?12l[?25h[?25l[9;1H[K[10;1H[K[11;1H[K[12;1H[K[13;1H[K[14;1Hstart of window 2[14;18H[K[15;8H01[38C01[16;8H02[38C02[9;1H[?12l[?25h[14;1H[?25l[25;1H[K[25;1H:[?12l[?25hset scb[?25l[14;1H[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[17;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [5;1H[?25l[m[25;1H[K[25;1H:[?12l[?25hset scb[?25l[5;1H[?12l[?25h[?25l[1;1H. line 13 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 13[1;50H[K[2;1H. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14
. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15
. line 16 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 16
end of window 2[5;16H[K[6;1H[K[7;1Hend of test37.in (please don't delete this line)

end of window 2
[1m[34m~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [7;1H[?12l[?25h[?25l[m[1;1Hzt:[1;4H[K[2;1H:set scrollbind[2;16H[K[3;1H:" -- start of tests --[3;24H[K[4;1H:" TEST scrolling down[4;23H[K[5;1HL5jHyy[34m^W[mbpr0[34m^W[mtHyy[34m^W[mbpr1[34m^W[mtL6jHyy[34m^W[mbpr2[34m^W[mkHyy[34m^W[mbpr3:
:" TEST scrolling up
[34m^W[mtH4k[34m^W[mjH[34m^W[mtHyy[34m^W[mbpr4[34m^W[mkHyy[34m^W[mbpr5[34m^W[mk3k[34m^W[mtH[34m^W[mjHyy[34m^W[mbpr6[34m^W[mtHyy[34m^W[mbpr7:
[7mtest37.in[m[1m[7m [m[7m                                                                       [9;16r[m[9;1H[2L[1;25r[9;1H. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15
. line 16 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 16[17;1H[1m[7m[No Name] [+]                                                                   [m[25;1H[K[11;1H[?12l[?25h[?25l[25;1H:[?12l[?25hsyncbind[?25l[11;1H[?12l[?25h[?25l[1;7r[1;1H[L[1;25r[1;1H/^start of window 2$/[9;16r[9;1H[L[1;25r[9;1H. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14[25;1H[K[11;1H[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[17;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [5;1H[3;1H[8;1Htest37.in[m[1m[7m [m[7m                                                                       [m[17;1H[1m[7m[No Name] [+]                                                                   [11;1H[m[17;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[18;23r[m[23;1H
[1;25r[23;1H. line 16 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 16[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[24;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [3;1H[8;1Htest37.in[m[1m[7m [m[7m                                                                       [m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[18;23r[m[23;1H
[1;25r[23;1H:set scrollbind[?12l[?25h[?25l

:[?12l[?25h[?25l[23;1H[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[24;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [3;1H[?25l[m[25;1H[K[25;1H:[?12l[?25hset noscb[?25l[3;1H[?12l[?25h[?25l[1;1HTest for 'scrollbind'. <eralston@computer.org>   Do not add a line below!
STARTTEST
:so small.vim[3;14H[K[4;2Hset noscrollbind[4;18H[K[5;2Hset scrollopt=ver,jump
:set scrolloff=2[6;17H[K[7;2Hset nowrap[7;12H[K[1;1H[?12l[?25h[5;1H


[7mtest37.in[m[1m[7m [m[7m                                                                       [m[17;1H[1m[7m[No Name] [+]                                                                   [11;1H[?25l[m[25;1H[K[25;1H:[?12l[?25hset noscb[?25l[11;1H[?12l[?25h[?25l[9;1H[K[10;1H[K[11;1H[K[12;1H[K[13;1H[K[14;1Hstart of window 2[14;18H[K[15;1H. line 01 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 01[15;50H[K[16;1H. line 02 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 02[16;50H[K[9;1H[?12l[?25h[14;1H[?25l[25;1H[K[25;1H:[?12l[?25hset scb[?25l[14;1H[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[17;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [5;1H[?25l[m[25;1H[K[25;1H:[?12l[?25hset scb[?25l[5;1H[?12l[?25h[?25l[1;1H. line 13 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 13[1;50H[K[2;1H. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14
. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15
. line 16 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 16
end of window 2[5;16H[K[6;1H[K[7;1Hend of test37.in (please don't delete this line)

end of window 2
[1m[34m~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [7;1H[?12l[?25h[?25l[m[1;1Hzt:[1;4H[K[2;1H:set scrollbind[2;16H[K[3;1H:" -- start of tests --[3;24H[K[4;1H:" TEST scrolling down[4;23H[K[5;1HL5jHyy[34m^W[mbpr0[34m^W[mtHyy[34m^W[mbpr1[34m^W[mtL6jHyy[34m^W[mbpr2[34m^W[mkHyy[34m^W[mbpr3:
:" TEST scrolling up
[34m^W[mtH4k[34m^W[mjH[34m^W[mtHyy[34m^W[mbpr4[34m^W[mkHyy[34m^W[mbpr5[34m^W[mk3k[34m^W[mtH[34m^W[mjHyy[34m^W[mbpr6[34m^W[mtHyy[34m^W[mbpr7:
[7mtest37.in[m[1m[7m [m[7m                                                                       [9;16r[m[9;1H[2L[1;25r[9;1H. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15
. line 16 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 16[17;1H[1m[7m[No Name] [+]                                                                   [m[25;1H[K[11;1H[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[17;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [5;1H[?25l[25;1H[m:[?12l[?25hsyncbind[?25l[5;1H[?12l[?25h[3;1H[?25l[1;7r[1;1H[L[1;25r[1;1H/^start of window 2$/[9;16r[9;1H[2L[1;25r[9;1H. line 13 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 13
. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14[25;1H[K[3;1H[?12l[?25h[?25l[1;7r[1;1H[L[1;25r[1;1H:resize 7[8;1H[7mtest37.in[m[1m[7m [m[7m                                                                       [m[17;1H[1m[7m[No Name] [+]                                                                   [12;1H[?12l[?25h[11;1H[8;1Htest37.in                                                                       [m[17;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [4;1H[3;1H[8;1Htest37.in[m[1m[7m [m[7m                                                                       [m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[18;23r[m[23;1H
[1;25r[23;1Hzt:[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[24;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [3;1H[8;1Htest37.in[m[1m[7m [m[7m                                                                       [m[17;1H[1m[7m[No Name] [+]                                                                   [11;1H[m[17;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[18;23r[m[23;1H
[1;25r[23;1H. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15[?12l[?25h[?25l

:[?12l[?25h[?25l[23;1H[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[24;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [3;1H[?25l[1;7r[m[1;1H[4L[1;25r[1;1H/^start of window 1$/
zt:
:set scrollbind
[34m^W[mj:[9;16r[9;1H[4L[1;25r[9;1H. line 09 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 09
. line 10 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 10
. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11
. line 12 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 12[25;1H[K[4;1H[?12l[?25h[8;1H[7mtest37.in[m[1m[7m [m[7m                                                                       [m[17;1H[1m[7m[No Name] [+]                                                                   [14;1H[11;1H[8;1Htest37.in                                                                       [m[17;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [4;1H[3;1H[8;1Htest37.in[m[1m[7m [m[7m                                                                       [m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[18;23r[m[23;1H
[1;25r[23;1H:set scrollbind[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[24;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [3;1H[8;1Htest37.in[m[1m[7m [m[7m                                                                       [m[17;1H[1m[7m[No Name] [+]                                                                   [11;1H[m[17;1H[7m[No Name] [+][m[1m[7m [m[7m                                                                   [m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[18;23r[m[23;1H
[1;25r[23;1H. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11[?12l[?25h[?25l

:[?12l[?25h[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" ***** done with tests *****[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw! test.out             " Write contents of this file[?25l"test.out" [25;12H[K[25;12H[New File] 33 lines, 1329 characters written[24;1H[1m[7mtest.out]      [23;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test38.failed test.ok test.out X* viminfo
cp test38.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test38.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test38.in" 35 lines, 455 characters[2;1HTest Virtual replace mode.

STARTTEST
:so small.vim
:" make sure that backspace works, no matter what termcap is used
:set t_kD=[34m^V[mx7f t_kb=[34m^V[mx08
ggdGa
abcdefghi
jk      lmn
    opq rst
[34m^D[muvwxyz
[34m^[[mgg:set ai
:set bs=2
gR0[34m^D[m 1
A
BCDEFGHIJ[18;9HKL
MNO
PQR[34m^[[mG:ka
o0[34m^D[m
abcdefghi
jk      lmn
    opq rst[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[4;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 29 lines, 407 characters written[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[5;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[10M[1;25r[15;1H[34m^D[muvwxyz
[34m^[[m'ajgR0[34m^D[m 1
A
BCDEFGHIJ[19;9HKL
MNO
PQR[34m^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^[[m:$
iab     cdefghi jkl[34m^[[m0gRAB......CDEFGHI.J[34m^[[mo[34m^[[m:
iabcdefghijklmnopqrst[34m^[[m0gRAB    IJKLMNO QR[34m^[[m:wq! test.out
ENDTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" make sure that backspace works, no matter what termcap is used[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset t_kD=^[34m^?[m t_kb=^[34m^H[?25l[27m[m[H[2J[1;1H[34m^D[muvwxyz
[34m^[[mgg:set ai
:set bs=2
gR0[34m^D[m 1
A
BCDEFGHIJ[7;9HKL
MNO
PQR[34m^[[mG:ka
o0[34m^D[m
abcdefghi
jk      lmn
    opq rst
[34m^D[muvwxyz
[34m^[[m'ajgR0[34m^D[m 1
A
BCDEFGHIJ[18;9HKL
MNO
PQR[34m^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^[[m:$
iab     cdefghi jkl[34m^[[m0gRAB......CDEFGHI.J[34m^[[mo[34m^[[m:
iabcdefghijklmnopqrst[34m^[[m0gRAB    IJKLMNO QR[34m^[[m:wq! test.out
ENDTEST
[?12l[?25h[?25l[1;24r[1;1H[11L[1;25r[2;1HTest Virtual replace mode.

STARTTEST
:so small.vim
:" make sure that backspace works, no matter what termcap is used
:set t_kD=[34m^V[mx7f t_kb=[34m^V[mx08
ggdGa
abcdefghi
jk      lmn
    opq rst[1;1H[?12l[?25h[?25l
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [m[25;1H--No lines in buffer--[1;1H[?12l[?25h[?25l
abcdefghi[2;10H[K[3;1Hjk      lmn[3;12H[K[4;1H    opq rst[4;12H[K[5;1Huvwxyz[5;7H[K[6;1H[K[6;1H[?12l[?25h[1;1H[?25l[25;1H[K[25;1H:[?12l[?25hset ai[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset bs=2[?25l[1;1H[?12l[?25h[?25l 1
 A[2;3H[K[3;1H BCDEFGHIJ[3;11H[K[4;5H    KL[4;11H[K[5;1H        MNO[6;9HPQR[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hka[?25l[6;9H[?12l[?25h[?25l[7;1H[K[8;1Habcdefghi[8;10H[K[9;1Hjk      lmn[9;12H[K[10;1H    opq rst[10;12H[K[11;1Huvwxyz[11;7H[K[12;1H[K[12;1H[?12l[?25h[6;9H
[?25l 1[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$[?25l[12;1H[?12l[?25h[?25lab      cdefghi jkl[?12l[?25h[?25lAB......CDEFGHI.J[?12l[?25h[?25l[13;1H[K[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[?25l[13;1H[?12l[?25h[?25labcdefghijklmnopqrst[?12l[?25h[?25lAB      IJKLMNO QR[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hwq! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 13 lines, 107 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test39.failed test.ok test.out X* viminfo
cp test39.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test39.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test39.in" 43 lines, 916 characters[2;1HTest Visual block mode commands
And test "U" in Visual mode, also on German sharp S.

STARTTEST
:so small.vim
:so mbyte.vim
:" This only works when 'encoding' is "latin1", don't depend on the environment
:set enc=latin1
/^abcde
:" Test shift-right of a block
jllll[34m^V[mjj>wll[34m^V[mjlll>
:" Test shift-left of a block
G$hhhh[34m^V[mkk<
:" Test block-insert
Gkl[34m^V[mkkkIxyz[34m^[[m
:" Test block-replace
Gllll[34m^V[mkkklllrq
:" Test block-change
G$khhh[34m^V[mhhkkcmno[34m^[[m
:$-4,$w! test.out
:" gUe must uppercase a whole word, also when  changes to SS
Gothe youtueuu end[34m^[[mYpk0wgUe
:" gUfx must uppercase until x, inclusive.[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[5;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[6;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 31 lines, 740 characters written[6;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[6;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[13M[1;25r[12;1HO- youtuexu -[34m^[[m0fogUfx
:" VU must uppercase a whole line
YpkVU
:" same, when it's the last line in the buffer
YPGi111[34m^[[mVUddP
:" Uppercase two lines
Oblah di
doh dut[34m^[[mVkUj
:" Uppercase part of two lines
ddppi333[34m^[[mk0i222[34m^[[mfyllvjfuUk
:/^the/,$w >> test.out
:qa!
ENDTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso mbyte.vim[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" This only works when 'encoding' is "latin1", don't depend on the environment[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset enc=latin1[?25l[27m[m[H[2J[1;1H:" Test block-insert
Gkl[34m^V[mkkkIxyz[34m^[[m
:" Test block-replace
Gllll[34m^V[mkkklllrq
:" Test block-change
G$khhh[34m^V[mhhkkcmno[34m^[[m
:$-4,$w! test.out
:" gUe must uppercase a whole word, also when  changes to SS
Gothe youtueuu end[34m^[[mYpk0wgUe
:" gUfx must uppercase until x, inclusive.
O- youtuexu -[34m^[[m0fogUfx
:" VU must uppercase a whole line
YpkVU
:" same, when it's the last line in the buffer
YPGi111[34m^[[mVUddP
:" Uppercase two lines
Oblah di
doh dut[34m^[[mVkUj
:" Uppercase part of two lines
ddppi333[34m^[[mk0i222[34m^[[mfyllvjfuUk
:/^the/,$w >> test.out
:qa!
ENDTEST
[?12l[?25h[?25l
/[?12l[?25h^abcde[?25l[1;24r[24;1H
[1;25r[24;1Habcdefghijklm[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h" Test shift-right of a block[?25l[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Habcdefghijklm[25;1H[K[24;1H[?12l[?25habcd[?25l[?12l[?25h[?25l[1;24r[24;1H
[1;25r[23;5H[7me[m
abcdefghijklmabcd[?12l[?25h[?25l[1;24r[24;1H
[1;25r[23;5H[7me[m
abcdefghijklmabcd[?12l[?25h[?25l
3 lines >ed 1 time[22;5H        efghijklm
abcd        efghijklm
abcd        efghijklm[22;8H[?12l[?25h     ef[?25l[?12l[?25h[?25l[7mg[23;15H[?12l[?25h[?25l[22;16Hh[23;15Hg[?12l[?25h[?25l[22;17Hi[23;16Hh[?12l[?25h[?25l[22;18Hj[23;17Hi[?12l[?25h[?25l[m[22;15H        ghijklm[23;15H        ghijklm[22;16H[?12l[?25h[23;16H[?25l[25;1H[K[25;1H:[?12l[?25h" Test shift-left of a block[?25l[23;16H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Habcdefghijklm[25;1H[K[24;1H[?12l[?25h[12C[?25l[?12l[?25h[?25l[7mi[23;9H[?12l[?25h[?25l [22;9H[?12l[?25h[?25l[m


3 lines <ed 1 time[22;9Hef    [23;9Hefghijklm[23;18H[K[24;9Hi[22;9H[?12l[?25h[23;9H[?25l[25;1H[K[25;1H:[?12l[?25h" Test block-insert[?25l[23;9H[?12l[?25h
[23;1Ha[?25l[?12l[?25h[?25l[7mb[22;2H[?12l[?25h[?25lb[21;2H[?12l[?25h[?25lb[20;2H[?12l[?25h[?25l[m
ab
ab
ab[20;2Hxyzbcdefghijklm
axyzbcd
axyzbcd
axyzbcd[20;2H[?12l[?25h
a[?25l[25;1H[K[25;1H:[?12l[?25h" Test block-replace[?25l[21;2H[?12l[?25h


abcd[?25l[?12l[?25h[?25l[7me[23;5H[?12l[?25h[?25lb[22;5H[?12l[?25h[?25lb[21;5H[?12l[?25h[?25lb[22;6Hc[23;6Hc[24;6Hf[21;6H[?12l[?25h[?25lc[22;7Hd[23;7Hd[24;7Hg[21;7H[?12l[?25h[?25ld[22;8H [23;8H [24;8Hh[21;8H[?12l[?25h[?25l[mqqqq
axyzqqqq
axyzqqqq
abcdqqqq[21;5H[?12l[?25h
axyz[?25l[25;1H[K[25;1H:[?12l[?25h" Test block-change[?25l[22;5H[?12l[?25h

[12C[23;17H[?25l[?12l[?25h[?25l[7mj[?12l[?25h[?25li[?12l[?25h[?25l[22;12H     [23;11Hghijkl[22;11H[?12l[?25h[?25l[21;13Hef[m[22;15H  [23;11Hg[3Ckl[21;12H[?12l[?25h[?25lmno[22;12Hmno[23;12Hmno[21;14H[?12l[?25h[22;14H[?25l[25;1H[K[25;1H:[?12l[?25h$-4,$w! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 5 lines, 108 characters written[22;14H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" gUe must uppercase a whole word, also when  changes to SS[?25l[22;14H[?12l[?25h

[?25l[1;24r[24;1H
[1;25r[24;1Hthe youtueuu end[25;1H[K[24;17H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hthe youtueuu end[?12l[?25h[23;1Hthe [?25lYOUTUSSEUU endthe [?12l[?25h
the [?25l
:[?12l[?25h" gUfx must uppercase until x, inclusive.[?25l[24;5H[?12l[?25h[?25l- youtuexu -[24;15H[K[24;14H[?12l[?25h- y[?25lOUSSTUSSEXu -- y[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hthe youtueuu end[25;1H[K[24;4H[?12l[?25h[?25l
:[?12l[?25h" VU must uppercase a whole line[?25l[24;4H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hthe youtueuu end[25;1H[K[24;1H[?12l[?25h[23;1H[?25lt[7mhe youtueuu end [?12l[?25h[?25l[mTHE YOUTUSSEUU END[?12l[?25h
[?25l
:[?12l[?25h" same, when it's the last line in the buffer[?25l[24;1H[?12l[?25h[?25l[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hthe youtueuu end[25;1H[K[24;1H[?12l[?25h[?25l111the youtueuu end11[?12l[?25h[?25l[7m11[m1[7mthe youtueuu end 11[?12l[?25h[?25l[m111THE YOUTUSSEUU END[?12l[?25h[?25l[1m[34m~                                                                               [23;1H[?12l[?25h[?25l[m111THE YOUTUSSEUU END
the youtueuu end[24;18H[K[23;1H[?12l[?25h
[?25l
:[?12l[?25h" Uppercase two lines[?25l[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[23;1Hblah di[23;8H[K[24;1Hdoh dut[25;1H[K[24;7H[?12l[?25h[?25l[7mdoh du[mt[7m [?12l[?25h[?25l[23;1Hblah d[mi[7m [24;7Ht[23;7H[?12l[?25h[?25l[mBLAH DI[23;8H[K[24;1HDOH DUT[24;8H[K[23;7H[?12l[?25h[24;7H[?25l[1;24r[24;1H
[1;25r[24;1Hthe youtueuu end[24;7H[?12l[?25h[?25l
:[?12l[?25h" Uppercase part of two lines[?25l[24;7H[?12l[?25h[?25l[1m[34m~                                                                               [23;1H[?12l[?25h[?25l[m
the youtueuu end[24;18H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hthe youtueuu end[25;1H[K[24;1H[?12l[?25h[?25l333the youtueuu end33[?12l[?25h[23;3H[?25l222the youtueuu end22[?12l[?25h2the yo[?25l[?12l[?25h[?25l[7mutueuu end 
333the yo[?12l[?25h[?25lut[?12l[?25h[?25l[m[23;10HUTUSSEUU END
333THE YOUTU[23;10H[?12l[?25h[22;7H[23;10H[?25l

:[?12l[?25h/^the/,$w >> test.out[?25l[31msearch hit BOTTOM, continuing at TOP[m"test.out" [25;12H[K[25;12H8 lines, 136 characters appended[23;10H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test40.failed test.ok test.out X* viminfo
cp test40.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test40.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test40.in" 63 lines, 1521 characters[1;1HTest for "*Cmd" autocommands

STARTTEST
:so small.vim
:/^start/,$w! Xxx[15C" write lines below to Xxx
:au BufReadCmd testA 0r Xxx|$del
:e testA[24C" will read text of Xxd instead
:au BufWriteCmd testA call append(line("$"), "write")
:w[30C" will append a line to the file
:r testA[24C" should not read anything
:[31C" now we have:
:[31C" 1     start of Xxx
:[31C" 2[13Ctest40
:[31C" 3     end of Xxx
:[31C" 4     write
:au FileReadCmd testB '[r Xxx
:2r testB[23C" will read Xxx below line 2 instead
:[31C" 1     start of Xxx
:[31C" 2[13Ctest40
:[31C" 3     start of Xxx
:[31C" 4[13Ctest40
:[31C" 5     end of Xxx
:[31C" 6     end of Xxx
:[31C" 7     write[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for "*Cmd" autocommands[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 55 lines, 1440 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;1H:$r testD[23C" should not read anything
:$w >>test.out[18C" append "end of Xxx" to test.out
:au BufReadCmd testE 0r test.out|$del
:sp testE[23C" split window with test.out
5Goasdf[34m^[^W^W[m:"
:au BufWriteCmd testE w! test.out
:wall[27C" will write other window to test.out
:[31C" 1     start of Xxx
:[31C" 2[13Ctest40
:[31C" 3     start of Xxx
:[31C" 4[13Ctest401
:[31C" 5     end of Xxx
:[31C" 6     asdf
:[31C" 7     end of Xxx
:[31C" 8     write
:[31C" 9[13Ctest401
:[31C" 10    end of Xxx
:[31C" 11    end of Xxx
:qa!
ENDTEST

start of Xxx[23;9Htest40
end of Xxx[20;1H[?12l[?25h
[?25l[25;1H:so! Xdotest[21;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[21;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^start/,$w! Xxx[34m^I^I[m" write lines below to Xxx[?25l"Xxx" [25;7H[K[25;7H[New File] 3 lines, 32 characters written[21;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau BufReadCmd testA 0r Xxx|$del[?25l[21;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he testA[34m^I^I^I[m" will read text of Xxd instead[?25l"Xxx" [25;7H[K[25;7H3 lines, 32 characters[1;1Hstart of Xxx[1;33H[K[2;1H        test40[2;33H[K[3;1Hend of Xxx[3;11H[K[4;1H[1m[34m~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [3;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hau BufWriteCmd testA call append(line("$"), "write")[?25l[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw[34m^I^I^I^I[m" will append a line to the file[?25l[4;1Hwrite[4;6H[K[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hr testA[34m^I^I^I[m" should not read anything[?25l[1m[37m[41mE484: Can't open file testA[m[25;28H[K[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" now we have:[?25l[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" 1[34m^I[mstart of Xxx[?25l[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" 2[34m^I^I[mtest40[?25l[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" 3[34m^I[mend of Xxx[?25l[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" 4[34m^I[mwrite[?25l[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau FileReadCmd testB '[r Xxx[?25l[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h2r testB[34m^I^I^I[m" will read Xxx below line 2 instead[?25l"Xxx" [25;7H[K[25;7H3 lines, 32 characters[3;24r[3;1H[3L[1;25r[3;1Hstart of Xxx[4;9Htest40
end of Xxx[25;1H[K[3;1H[?12l[?25h[?25l[25;1H:[?12l[?25h[34m^I^I^I^I[m" 1[34m^I[mstart of Xxx[?25l[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" 2[34m^I^I[mtest40[?25l[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" 3[34m^I[mstart of Xxx[?25l[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" 4[34m^I^I[mtest40[?25l[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" 5[34m^I[mend of Xxx[?25l[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" 6[34m^I[mend of Xxx[?25l[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" 7[34m^I[mwrite[?25l[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau FileWriteCmd testC '[,']copy $[?25l[3;1H[?12l[?25h[4;9H[?25ltest401[?12l[?25h[5;10H[?25l[25;1H[K[25;1H:[?12l[?25h4,5w testC[34m^I^I^I[m" will copy lines 4 and 5 to the end[?25l[8;1H        test401[8;16H[K[9;1Hend of Xxx[9;11H[K[9;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hr testC[34m^I^I^I[m" should not read anything[?25l[1m[37m[41mE484: Can't open file testC[m[25;28H[K[9;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" 1[34m^I[mstart of Xxx[?25l[9;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" 2[34m^I^I[mtest40[?25l[9;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" 3[34m^I[mstart of Xxx[?25l[9;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" 4[34m^I^I[mtest401[?25l[9;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" 5[34m^I[mend of Xxx[?25l[9;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" 6[34m^I[mend of Xxx[?25l[9;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" 7[34m^I[mwrite[?25l[9;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" 8[34m^I^I[mtest401[?25l[9;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" 9[34m^I[mend of Xxx[?25l[9;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau FILEAppendCmd testD '[,']w! test.out[?25l[9;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>testD[34m^I^I^I[m" will write all lines to test.out[?25l"test.out" [25;12H[K[25;12H[New File] 9 lines, 91 characters written[9;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$r testD[34m^I^I^I[m" should not read anything[?25l[1m[37m[41mE484: Can't open file testD[m[25;29H[K[9;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$w >>test.out[34m^I^I^I[m" append "end of Xxx" to test.out[?25l"test.out" [25;12H[K[25;12H1 line, 11 characters appended[9;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau BufReadCmd testE 0r test.out|$del[?25l[9;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hsp testE[34m^I^I^I[m" split window with test.out[?25l"test.out" [25;12H[K[25;12H10 lines, 102 characters[10;1Hend of Xxx[10;11H[K[12;1H[1m[7mtestE                                                                           [m[13;1Hend of Xxx[13;11H[K[14;1Hwrite[14;6H[K[15;1H        test401[15;16H[K[16;1Hend of Xxx[16;11H[K[24;1H[7mtestA                                                                           [10;1H[?12l[?25h[5;1H[?25l[6;11r[m[6;1H[L[1;25r[6;1Hasdf[12;7H[1m[7m[+][m[25;1H[K[6;4H[?12l[?25h[12;1H[7mtestE [+][m[1m[7m [m[7m                                                                       [m[24;1H[1m[7mtestA                                                                           [16;1H[?25l[25;1H[m:[?12l[?25h"[?25l[16;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau BufWriteCmd testE w! test.out[?25l[16;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hwall[34m^I^I^I^I[m" will write other window to test.out[?25l"test.out" [25;12H[K[25;12H11 lines, 107 characters written[12;7H[7m   [16;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" 1[34m^I[mstart of Xxx[?25l[16;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" 2[34m^I^I[mtest40[?25l[16;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" 3[34m^I[mstart of Xxx[?25l[16;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" 4[34m^I^I[mtest401[?25l[16;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" 5[34m^I[mend of Xxx[?25l[16;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" 6[34m^I[masdf[?25l[16;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" 7[34m^I[mend of Xxx[?25l[16;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" 8[34m^I[mwrite[?25l[16;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" 9[34m^I^I[mtest401[?25l[16;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" 10[34m^I[mend of Xxx[?25l[16;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h[34m^I^I^I^I[m" 11[34m^I[mend of Xxx[?25l[16;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test41.failed test.ok test.out X* viminfo
cp test41.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test41.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test41.in" 24 lines, 421 characters[1;1HTest for writing and reading a file of over 100 Kbyte

1 line: "This is the start"
3001 lines: "This is the leader"
1 line: "This is the middle"
3001 lines: "This is the trailer"
1 line: "This is the end"

STARTTEST
:%d
aThis is the start
This is the leader
This is the middle
This is the trailer
This is the end[34m^[[mkY3000p2GY3000p
:w! Xtest
:%d
:e! Xtest
:.w! test.out
3003G:.w >>test.out
6005G:.w >>test.out
:qa!
ENDTEST[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for writing and reading a file of over 100 Kbyte[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[9;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[10;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 13 lines, 196 characters written[10;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[10;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[23;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h%d[?25l[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [m[25;1H--No lines in buffer--[1;1H[?12l[?25h[?25lThis is the start
This is the leader[2;19H[K[3;1HThis is the middle[3;19H[K[4;1HThis is the trailer[4;20H[K[5;1HThis is the end[5;16H[K[5;15H[?12l[?25h[4;15H[?25l[25;1H3000 more lines[25;16H[K[5;13Htrailer
This is the trailer[6;20H[K[7;1HThis is the trailer[7;20H[K[8;1HThis is the trailer[8;20H[K[9;1HThis is the trailer[9;20H[K[10;1HThis is the trailer[10;20H[K[11;1HThis is the trailer[11;20H[K[12;1HThis is the trailer[12;20H[K[13;1HThis is the trailer[13;20H[K[14;1HThis is the trailer[14;20H[K[15;1HThis is the trailer[15;20H[K[16;1HThis is the trailer[16;20H[K[17;1HThis is the trailer[17;20H[K[18;1HThis is the trailer[18;20H[K[19;1HThis is the trailer[19;20H[K[20;1HThis is the trailer[20;20H[K[21;1HThis is the trailer[21;20H[K[22;1HThis is the trailer[22;20H[K[23;1HThis is the trailer[23;20H[K[24;1HThis is the trailer[24;20H[K[5;1H[?12l[?25h[2;1H[?25l[3;13Hleader[4;13Hleader[4;19H[K[5;13Hleader[5;19H[K[6;13Hleader[6;19H[K[7;13Hleader[7;19H[K[8;13Hleader[8;19H[K[9;13Hleader[9;19H[K[10;13Hleader[10;19H[K[11;13Hleader[11;19H[K[12;13Hleader[12;19H[K[13;13Hleader[13;19H[K[14;13Hleader[14;19H[K[15;13Hleader[15;19H[K[16;13Hleader[16;19H[K[17;13Hleader[17;19H[K[18;13Hleader[18;19H[K[19;13Hleader[19;19H[K[20;13Hleader[20;19H[K[21;13Hleader[21;19H[K[22;13Hleader[22;19H[K[23;13Hleader[23;19H[K[24;13Hleader[24;19H[K[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:[?12l[?25hw! Xtest[?25l"Xtest" [25;9H[K[25;9H[New File] 6005 lines, 117092 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h%d[?25l[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [m[25;1H--No lines in buffer--[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! Xtest[?25l"Xtest" [25;9H[K[25;9H6005 lines, 117092 characters[1;1HThis is the start
This is the leader[2;19H[K[3;1HThis is the leader[3;19H[K[4;1HThis is the leader[4;19H[K[5;1HThis is the leader[5;19H[K[6;1HThis is the leader[6;19H[K[7;1HThis is the leader[7;19H[K[8;1HThis is the leader[8;19H[K[9;1HThis is the leader[9;19H[K[10;1HThis is the leader[10;19H[K[11;1HThis is the leader[11;19H[K[12;1HThis is the leader[12;19H[K[13;1HThis is the leader[13;19H[K[14;1HThis is the leader[14;19H[K[15;1HThis is the leader[15;19H[K[16;1HThis is the leader[16;19H[K[17;1HThis is the leader[17;19H[K[18;1HThis is the leader[18;19H[K[19;1HThis is the leader[19;19H[K[20;1HThis is the leader[20;19H[K[21;1HThis is the leader[21;19H[K[22;1HThis is the leader[22;19H[K[23;1HThis is the leader[23;19H[K[24;1HThis is the leader[24;19H[K[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 1 line, 18 characters written[1;1H[?12l[?25h[?25l[27m[m[H[2J[1;1HThis is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the middle
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer[12;1H[?12l[?25h[?25l[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 19 characters appended[12;1H[?12l[?25h[?25l[27m[m[H[2J[1;1HThis is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the end[?12l[?25h[?25l
:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 16 characters appended[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test42.failed test.ok test.out X* viminfo
cp test42.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test42.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test42.in" 130 lines, 2368 characters[1;1HTest for writing and reading a file starting with a BOM

STARTTEST
:so mbyte.vim
:set encoding=utf-8
:set fileencodings=ucs-bom,latin-1
:set ff=unix ffs=unix[11C" This changes the file for DOS and MAC
:" --- Write the test files
:/^latin-1$/+1w! Xtest0
:/^utf-8$/+1w! Xtest1
:/^utf-8-err$/+1w! Xtest2
:/^ucs-2$/+1w! Xtest3
:/^ucs-2le$/+1w! Xtest4
:" Need to add a NUL byte after the NL byte
:set bin
:e! Xtest4[22C" Ignore change from setting 'ff'
o[34m^V^@^[[m:set noeol
:w
:set ffs& nobinary[14C" Allow default test42.in format
:e #
:set ff=unix[20C" Format for files to write
:/^ucs-4$/+1w! Xtest5
:/^ucs-4le$/+1w! Xtest6
:" Need to add three NUL bytes after the NL byte[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for writing and reading a file starting with a BOM[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 111 lines, 2116 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;1H:e! test.out
:$r Xtest0x
:$r Xtest1x
:$r Xtest2x
:$r Xtest3x
:$r Xtest4x
:$r Xtest5x
:$r Xtest6x
:set nobin ff&[15C" Write the file in default format
:w! test.out
:qa!
ENDTEST

latin-1
latin-1
utf-8
﻿utf-8
utf-8-err
﻿utf-8[34m~@[merr
ucs-2
[34m^@[mu[34m^@[mc[34m^@[ms[34m^@[m-[34m^@[m2[34m^@[m
ucs-2le
u[34m^@[mc[34m^@[ms[34m^@[m-[34m^@[m2[34m^@[ml[34m^@[me[34m^@[m
ucs-4[12;1H[?12l[?25h
[?25l[25;1H:so! Xdotest[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso mbyte.vim[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset encoding=utf-8[?25l[27m[m[H[2J[1;1H:e! test.out
:$r Xtest0x
:$r Xtest1x
:$r Xtest2x
:$r Xtest3x
:$r Xtest4x
:$r Xtest5x
:$r Xtest6x
:set nobin ff&[14C " Write the file in default format
:w! test.out
:qa!
ENDTEST

latin-1
[34m<fe><fe>[mlatin-1
utf-8
[34m<feff>[mutf-8
utf-8-err
[34m<feff>[mutf-8[34m<80>[merr
ucs-2
[34m<fe><ff>^@[mu[34m^@[mc[34m^@[ms[34m^@[m-[34m^@[m2[34m^@[m
ucs-2le
[34m<ff><fe>[mu[34m^@[mc[34m^@[ms[34m^@[m-[34m^@[m2[34m^@[ml[34m^@[me[34m^@[m
ucs-4[13;1H[?12l[?25h[?25l[25;1H:[?12l[?25hset fileencodings=ucs-bom,latin-1[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset ff=unix ffs=unix           " This changes the file for DOS and MAC[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" --- Write the test files[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^latin-1$/+1w! Xtest0[?25l"Xtest0" [25;10H[K[25;10H[New File] 1 line, 10 characters written[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^utf-8$/+1w! Xtest1[?25l"Xtest1" [25;10H[K[25;10H[New File] 1 line, 9 characters written[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^utf-8-err$/+1w! Xtest2[?25l"Xtest2" [25;10H[K[25;10H[New File] 1 line, 13 characters written[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^ucs-2$/+1w! Xtest3[?25l"Xtest3" [25;10H[K[25;10H[New File] 1 line, 14 characters written[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^ucs-2le$/+1w! Xtest4[?25l"Xtest4" [25;10H[K[25;10H[New File] 1 line, 17 characters written[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Need to add a NUL byte after the NL byte[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset bin[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! Xtest4                      " Ignore change from setting 'ff'[?25l"Xtest4" [25;10H[K[25;10H1 line, 17 characters[1;1H[34m<ff><fe>[mu[34m^@[mc[34m^@[ms[34m^@[m-[34m^@[m2[34m^@[ml[34m^@[me[34m^@[m
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h
[?25l[m[34m^@[m[2;3H[K[2;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset noeol[?25l[2;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw[?25l"Xtest4" [Incomplete last line] 2 lines, 18 characters written[2;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset ffs& nobinary              " Allow default test42.in format[?25l[2;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he #[?25l"test42.in" [converted] 130 lines, 2385 characters[1;1H:$r Xtest0x[1;12H[K[2;1H:$r Xtest1x
:$r Xtest2x[3;12H[K[4;1H:$r Xtest3x[4;12H[K[5;1H:$r Xtest4x[5;12H[K[6;1H:$r Xtest5x[6;12H[K[7;1H:$r Xtest6x[7;12H[K[8;1H:set nobin ff&               " Write the file in default format[8;64H[K[9;1H:w! test.out[9;13H[K[10;1H:qa![10;5H[K[11;1HENDTEST[11;8H[K[12;1H[K[13;1Hlatin-1[13;8H[K[14;1Hþþlatin-1[14;10H[K[15;1Hutf-8[15;6H[K[16;1Hï»¿utf-8[16;9H[K[17;1Hutf-8-err[17;10H[K[18;1Hï»¿utf-8[34m<80>[merr[18;16H[K[19;1Hucs-2[19;6H[K[20;1Hþÿ[34m^@[mu[34m^@[mc[34m^@[ms[34m^@[m-[34m^@[m2[34m^@[m[20;20H[K[21;1Hucs-2le[21;8H[K[22;1Hÿþu[34m^@[mc[34m^@[ms[34m^@[m-[34m^@[m2[34m^@[ml[34m^@[me[34m^@[m[22;24H[K[23;1Hucs-4[23;6H[K[24;1H[34m^@^@[mþÿ[34m^@^@^@[mu[34m^@^@^@[mc[34m^@^@^@[ms[34m^@^@^@[m-[34m^@^@^@[m4[34m^@^@^@[m[24;48H[K[12;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset ff=unix                    " Format for files to write[?25l[12;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^ucs-4$/+1w! Xtest5[?25l"Xtest5" [25;10H[K[25;10H[converted][New File] 1 line, 30 characters written[12;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^ucs-4le$/+1w! Xtest6[?25l"Xtest6" [25;10H[K[25;10H[converted][New File] 1 line, 35 characters written[12;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Need to add three NUL bytes after the NL byte[?25l[12;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset bin[?25l[12;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! Xtest6                      " ! for when setting 'ff' is a change[?25l"Xtest6" [25;10H[K[25;10H1 line, 33 characters[1;1H[34m<ff><fe>^@^@[mu[34m^@^@^@[mc[34m^@^@^@[ms[34m^@^@^@[m-[34m^@^@^@[m4[34m^@^@^@[ml[34m^@^@^@[me[34m^@^@^@[m
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h
~   [?25l[m[34m^@^@^@[m[2;7H[K[2;5H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset noeol[?25l[2;5H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw[?25l"Xtest6" [Incomplete last line] 2 lines, 36 characters written[2;5H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset nobin[?25l[2;5H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he #[?25l"test42.in" [converted] 130 lines, 2385 characters[1;1H:$r Xtest0x[1;12H[K[2;1H:$r Xtest1x
:$r Xtest2x[3;12H[K[4;1H:$r Xtest3x[4;12H[K[5;1H:$r Xtest4x[5;12H[K[6;1H:$r Xtest5x[6;12H[K[7;1H:$r Xtest6x[7;12H[K[8;1H:set nobin ff&               " Write the file in default format[8;64H[K[9;1H:w! test.out[9;13H[K[10;1H:qa![10;5H[K[11;1HENDTEST[11;8H[K[12;1H[K[13;1Hlatin-1[13;8H[K[14;1Hþþlatin-1[14;10H[K[15;1Hutf-8[15;6H[K[16;1Hï»¿utf-8[16;9H[K[17;1Hutf-8-err[17;10H[K[18;1Hï»¿utf-8[34m<80>[merr[18;16H[K[19;1Hucs-2[19;6H[K[20;1Hþÿ[34m^@[mu[34m^@[mc[34m^@[ms[34m^@[m-[34m^@[m2[34m^@[m[20;20H[K[21;1Hucs-2le[21;8H[K[22;1Hÿþu[34m^@[mc[34m^@[ms[34m^@[m-[34m^@[m2[34m^@[ml[34m^@[me[34m^@[m[22;24H[K[23;1Hucs-4[23;6H[K[24;1H[34m^@^@[mþÿ[34m^@^@^@[mu[34m^@^@^@[mc[34m^@^@^@[ms[34m^@^@^@[m-[34m^@^@^@[m4[34m^@^@^@[m[24;48H[K[12;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[12;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" --- Check that editing a latin-1 file doesn't see a BOM[?25l[12;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! Xtest0[?25l"Xtest0" [25;10H[K[25;10H[converted] 1 line, 12 characters[1;1Hþþlatin-1[1;10H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hredir! >test.out[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fileencoding bomb?[?25l[25;1H[K[25;1H  fileencoding=latin1
nobomb
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hredir END[?25l[1;1H[2L[1;1Hþþlatin-1
[1m[34m~                                                                               [m[25;3H[K[1;1H[?12l[?25h[?25l[25;1H:[?12l[?25hset fenc=latin-1[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>test.out[?25l"test.out" [25;12H[K[25;12H[converted] 1 line, 12 characters appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset bomb fenc=latin-1[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw! Xtest0x[?25l"Xtest0x" [25;11H[K[25;11H[converted][New File] 1 line, 12 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" --- Check utf-8[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! Xtest1[?25l"Xtest1" [25;10H[K[25;10H1 line, 9 characters[1;1Hutf-8[1;6H[K[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hredir >>test.out[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fileencoding bomb?[?25l[25;1H[K[25;1H  fileencoding=utf-8
  bomb
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hredir END[?25l[1;1H[2L[1;1Hutf-8
[1m[34m~                                                                               [m[25;3H[K[1;1H[?12l[?25h[?25l[25;1H:[?12l[?25hset fenc=latin-1[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>test.out[?25l"test.out" [25;12H[K[25;12H[converted] 1 line, 6 characters appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fenc=utf-8[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw! Xtest1x[?25l"Xtest1x" [25;11H[K[25;11H[New File] 1 line, 9 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" --- Check utf-8 with an error (will fall back to latin-1)[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! Xtest2[?25l"Xtest2" [25;10H[K[25;10H[converted] 1 line, 17 characters[1;1Hï»¿utf-8[34m<80>[merr[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hredir >>test.out[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fileencoding bomb?[?25l[25;1H[K[25;1H  fileencoding=latin1
nobomb
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hredir END[?25l[1;1H[2L[1;1Hï»¿utf-8[34m<80>[merr
[1m[34m~                                                                               [m[25;3H[K[1;1H[?12l[?25h[?25l[25;1H:[?12l[?25hset fenc=latin-1[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>test.out[?25l"test.out" [25;12H[K[25;12H[converted] 1 line, 17 characters appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fenc=utf-8[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw! Xtest2x[?25l"Xtest2x" [25;11H[K[25;11H[New File] 1 line, 17 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" --- Check ucs-2[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! Xtest3[?25l"Xtest3" [25;10H[K[25;10H[converted] 1 line, 8 characters[1;1Hucs-2[1;6H[K[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hredir >>test.out[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fileencoding bomb?[?25l[25;1H[K[25;1H  fileencoding=utf-16
  bomb
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hredir END[?25l[1;1H[2L[1;1Hucs-2
[1m[34m~                                                                               [m[25;3H[K[1;1H[?12l[?25h[?25l[25;1H:[?12l[?25hset fenc=latin-1[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>test.out[?25l"test.out" [25;12H[K[25;12H[converted] 1 line, 6 characters appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fenc=ucs-2[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw! Xtest3x[?25l"Xtest3x" [25;11H[K[25;11H[converted][New File] 1 line, 8 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" --- Check ucs-2le[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! Xtest4[?25l"Xtest4" [25;10H[K[25;10H[converted] 1 line, 10 characters[1;5H2le[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hredir >>test.out[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fileencoding bomb?[?25l[25;1H[K[25;1H  fileencoding=utf-16le
  bomb
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hredir END[?25l[1;1H[2L[1;1Hucs-2le
[1m[34m~                                                                               [m[25;3H[K[1;1H[?12l[?25h[?25l[25;1H:[?12l[?25hset fenc=latin-1[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>test.out[?25l"test.out" [25;12H[K[25;12H[converted] 1 line, 8 characters appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fenc=ucs-2le[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw! Xtest4x[?25l"Xtest4x" [25;11H[K[25;11H[converted][New File] 1 line, 10 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" --- Check ucs-4[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! Xtest5[?25l"Xtest5" [25;10H[K[25;10H[converted] 1 line, 10 characters[1;4H-4[1;6H[K[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hredir >>test.out[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fileencoding bomb?[?25l[25;1H[K[25;1H  fileencoding=ucs-4
  bomb
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hredir END[?25l[1;1H[2L[1;1Hucs-4
[1m[34m~                                                                               [m[25;3H[K[1;1H[?12l[?25h[?25l[25;1H:[?12l[?25hset fenc=latin-1[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>test.out[?25l"test.out" [25;12H[K[25;12H[converted] 1 line, 6 characters appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fenc=ucs-4[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw! Xtest5x[?25l"Xtest5x" [25;11H[K[25;11H[converted][New File] 1 line, 10 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" --- Check ucs-4le[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! Xtest6[?25l"Xtest6" [25;10H[K[25;10H[converted] 1 line, 12 characters[1;5H4le[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hredir >>test.out[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fileencoding bomb?[?25l[25;1H[K[25;1H  fileencoding=ucs-4le
  bomb
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hredir END[?25l[1;1H[2L[1;1Hucs-4le
[1m[34m~                                                                               [m[25;3H[K[1;1H[?12l[?25h[?25l[25;1H:[?12l[?25hset fenc=latin-1[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw >>test.out[?25l"test.out" [25;12H[K[25;12H[converted] 1 line, 8 characters appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fenc=ucs-4le[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw! Xtest6x[?25l"Xtest6x" [25;11H[K[25;11H[converted][New File] 1 line, 12 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" --- Check the files written with BOM[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset bin[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! test.out[?25l"test.out" [25;12H[K[25;12H35 lines, 275 characters[1;1H[K[2;1H[K[3;1H  fileencoding=latin1[3;22H[K[4;1Hnobomb[4;7H[K[5;1H[34m<fe><fe>[mlatin-1[5;16H[K[6;1H[K[7;1H[K[8;1H  fileencoding=utf-8[8;21H[K[9;1H  bomb[9;7H[K[10;1Hutf-8[10;6H[K[11;1H[K[12;1H[K[13;1H  fileencoding=latin1[13;22H[K[14;1Hnobomb[14;7H[K[15;1H[34m<feff>[mutf-8[34m<80>[merr[15;19H[K[16;1H[K[17;1H[K[18;1H  fileencoding=utf-16[18;22H[K[19;1H  bomb[19;7H[K[20;1Hucs-2[20;6H[K[21;1H[K[22;1H[K[23;1H  fileencoding=utf-16le[23;24H[K[24;1H  bomb[24;7H[K[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$r Xtest0x[?25l"Xtest0x" [25;11H[K[25;11H1 line, 10 characters[1;24r[1;1H[12M[1;25r[13;1Hucs-2le[16;2H fileencoding=ucs-4
  bomb
ucs-4[21;2H fileencoding=ucs-4le
  bomb
ucs-4le
[34m<fe><fe>[mlatin-1[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$r Xtest1x[?25l"Xtest1x" [25;11H[K[25;11H1 line, 9 characters[1;24r[24;1H
[1;25r[24;1H[34m<feff>[mutf-8[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$r Xtest2x[?25l"Xtest2x" [25;11H[K[25;11H1 line, 17 characters[1;24r[24;1H
[1;25r[24;1Hï»¿utf-8[34m<80>[merr[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$r Xtest3x[?25l"Xtest3x" [25;11H[K[25;11H1 line, 14 characters[1;24r[24;1H
[1;25r[24;1H[34m<fe><ff>^@[mu[34m^@[mc[34m^@[ms[34m^@[m-[34m^@[m2[34m^@[m[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$r Xtest4x[?25l"Xtest4x" [25;11H[K[25;11H[Incomplete last line] 2 lines, 18 characters[1;24r[24;1H
[1;25r[24;1H[34m<ff><fe>[mu[34m^@[mc[34m^@[ms[34m^@[m-[34m^@[m2[34m^@[ml[34m^@[me[34m^@[m[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$r Xtest5x[?25l"Xtest5x" [25;11H[K[25;11H1 line, 28 characters[1;24r[1;1H[2M[1;25r[23;1H[34m^@
^@^@<fe><ff>^@^@^@[mu[34m^@^@^@[mc[34m^@^@^@[ms[34m^@^@^@[m-[34m^@^@^@[m4[34m^@^@^@[m[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$r Xtest6x[?25l"Xtest6x" [25;11H[K[25;11H[Incomplete last line] 2 lines, 36 characters[1;24r[24;1H
[1;25r[24;1H[34m<ff><fe>^@^@[mu[34m^@^@^@[mc[34m^@^@^@[ms[34m^@^@^@[m-[34m^@^@^@[m4[34m^@^@^@[ml[34m^@^@^@[me[34m^@^@^@[m[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hset nobin ff&               " Write the file in default format[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw! test.out[?25l"test.out" [25;12H[K[25;12H44 lines, 409 characters written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test43.failed test.ok test.out X* viminfo
cp test43.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test43.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test43.in" 27 lines, 412 characters[1;1HTests for regexp with various magic settings.

STARTTEST
:set nocompatible viminfo+=nviminfo
/^1
/a*b\{2}c\+/e
x/\Md\*e\{2}f\+/e
x:set nomagic
/g\*h\{2}i\+/e
x/\mj*k\{2}l\+/e
x/\vm*n{2}o+/e
x/\V^aa$
x:set magic
/\v(a)(b)\2\1\1/e
x/\V[ab]\(\[xy]\)\1
x:?^1?,$w! test.out
:qa!
ENDTEST

1 a aa abb abbccc
2 d dd dee deefff
3 g gg ghh ghhiii
4 j jj jkk jkklll
5 m mm mnn mnnooo[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for regexp with various magic settings.[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 14 lines, 217 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[18;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[19;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset nocompatible viminfo+=nviminfo[?25l[19;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^1[?25l[20;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25ha*b\{2}c\+/e[?25l[20;17H[?12l[?25h[?25l[20;17H[K[20;16H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h\Md\*e\{2}f\+/e[?25l[21;17H[?12l[?25h[?25l[21;17H[K[21;16H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset nomagic[?25l[21;16H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25hg\*h\{2}i\+/e[?25l[22;17H[?12l[?25h[?25l[22;17H[K[22;16H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h\mj*k\{2}l\+/e[?25l[23;17H[?12l[?25h[?25l[23;17H[K[23;16H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h\vm*n{2}o+/e[?25l[24;17H[?12l[?25h[?25l[24;17H[K[24;16H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h\V^aa$[?25l[1;24r[24;1H
[1;25r[24;1H6 x ^aa$ x[25;1H[K[24;5H[?12l[?25h[?25laa$ x[24;10H[K[24;5H[?12l[?25h[?25l
:[?12l[?25hset magic[?25l[24;5H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h\v(a)(b)\2\1\1/e[?25l[1;24r[24;1H
[1;25r[24;1H7 (a)(b) abbaa[25;1H[K[24;14H[?12l[?25h[?25l[24;14H[K[24;13H[?12l[?25h[?25l
/[?12l[?25h\V[ab]\(\[xy]\)\1[?25l[1;24r[24;1H
[1;25r[24;1H8 axx [ab]xx[25;1H[K[24;7H[?12l[?25h[?25lab]x[24;12H[K[24;7H[?12l[?25h[?25l
:[?12l[?25h?^1?,$w! test.out[?25l"test.out" [25;12H[K[25;12H[New] 8L, 121C written[24;7H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test44.failed test.ok test.out X* viminfo
cp test44.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test44.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test44.in" 55 lines, 1137 characters[1;1HTests for regexp with multi-byte encoding and various magic settings.
Test matchstr() with a count and multi-byte chars.

STARTTEST
:so mbyte.vim
:set nocompatible encoding=utf-8 termencoding=latin1 viminfo+=nviminfo
/^1
/a*b\{2}c\+/e
x/\Md\*e\{2}f\+/e
x:set nomagic
/g\*h\{2}i\+/e
x/\mj*k\{2}l\+/e
x/\vm*n{2}o+/e
x/\V^aa$
x:set magic
/\v(a)(b)\2\1\1/e
x/\V[ab]\(\[xy]\)\1
x:" Now search for multi-byte without composing char
/ม
x:" Now search for multi-byte with composing char
/ม[34m~H[m
x:" find word by change of word class
/[34m~A[m\<[34m~B[m[34m~C[m\>[34m~A[m
x:" Test \%u, [\u] and friends[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for regexp with multi-byte encoding and various magic settings.[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[4;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 33 lines, 760 characters written[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[5;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;1Hx/\%U12345678
x/[\U1234abcd\u1234\uabcd]
x/\%d21879b
x:?^1?,$w! test.out
:e! test.out
G:put =matchstr(\"[34m~P[m[34m~Q[m[34m~R[m[34m~S[m\", \".\", 0, 2) " [34m~Q[m
:put =matchstr(\"[34m~P[m[34m~Q[m[34m~R[m[34m~S[m\", \"..\", 0, 2) " [34m~Q[m[34m~R[m
:put =matchstr(\"[34m~P[m[34m~Q[m[34m~R[m[34m~S[m\", \".\", 0, 0) " [34m~P[m
:put =matchstr(\"[34m~P[m[34m~Q[m[34m~R[m[34m~S[m\", \".\", 4, -1) " [34m~R[m
:w!
:qa!
ENDTEST

1 a aa abb abbccc
2 d dd dee deefff
3 g gg ghh ghhiii
4 j jj jkk jkklll
5 m mm mnn mnnooo
6 x ^aa$ x
7 (a)(b) abbaa
8 axx [ab]xx
9 หม[34m~H[mx อมx
a อมx หม[34m~H[mx
b [34m~A[m[34m~B[m[34m~C[m[34m~A[m[12;1H[?12l[?25h
[?25l[25;1H:so! Xdotest[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso mbyte.vim[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset nocompatible encoding=utf-8 termencoding=latin1 viminfo+=nviminfo[?25l[27m[m[H[2J[1;1Hx/\%U12345678
x/[\U1234abcd\u1234\uabcd]
x/\%d21879b
x:?^1?,$w! test.out
:e! test.out
G:put =matchstr(\"\", \".\", 0, 2) " 
:put =matchstr(\"\", \"..\", 0, 2) " 
:put =matchstr(\"\", \".\", 0, 0) " 
:put =matchstr(\"\", \".\", 4, -1) " 
:w!
:qa!
ENDTEST

1 a aa abb abbccc
2 d dd dee deefff
3 g gg ghh ghhiii
4 j jj jkk jkklll
5 m mm mnn mnnooo
6 x ^aa$ x
7 (a)(b) abbaa
8 axx [ab]xx
9 x x
a x x
b ????[13;1H[?12l[?25h[?25l[25;1H/[?12l[?25h^1[?25l[14;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25ha*b\{2}c\+/e[?25l[14;17H[?12l[?25h[?25l[14;17H[K[14;16H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h\Md\*e\{2}f\+/e[?25l[15;17H[?12l[?25h[?25l[15;17H[K[15;16H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset nomagic[?25l[15;16H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25hg\*h\{2}i\+/e[?25l[16;17H[?12l[?25h[?25l[16;17H[K[16;16H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h\mj*k\{2}l\+/e[?25l[17;17H[?12l[?25h[?25l[17;17H[K[17;16H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h\vm*n{2}o+/e[?25l[18;17H[?12l[?25h[?25l[18;17H[K[18;16H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h\V^aa$[?25l[19;5H[?12l[?25h[?25l aa$ x[19;10H[K[19;5H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset magic[?25l[19;5H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h\v(a)(b)\2\1\1/e[?25l[20;14H[?12l[?25h[?25l[20;14H[K[20;13H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h\V[ab]\(\[xy]\)\1[?25l[21;7H[?12l[?25h[?25l ab]x[21;12H[K[21;7H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Now search for multi-byte without composing char[?25l[21;7H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h[?25l[22;8H[?12l[?25h[?25lx[22;9H[K[22;8H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Now search for multi-byte with composing char[?25l[22;8H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h[?25l[23;8H[?12l[?25h[?25lx[23;9H[K[23;8H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" find word by change of word class[?25l[23;8H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h?\<??\>?[?25l[24;3H[?12l[?25h[?25l???[24;9H[K[24;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Test \%u, [\u] and friends[?25l[24;3H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h\%u20ac[?25l[1;24r[24;1H
[1;25r[24;1Hc x x[25;1H[K[24;6H[?12l[?25h[?25lx[24;7H[K[24;6H[?12l[?25h[?25l
/[?12l[?25h[\u4f7f\u5929]\+[?25l[1;24r[24;1H
[1;25r[24;1Hd ??x[25;1H[K[24;3H[?12l[?25h[?25l ?x [24;7H[K[24;3H[?12l[?25h[?25l
/[?12l[?25h\%U12345678[?25l[1;24r[24;1H
[1;25r[24;1He y[25;1H[K[24;3H[?12l[?25h[?25l y[24;4H[K[24;3H[?12l[?25h[?25l
/[?12l[?25h[\U1234abcd\u1234\uabcd][?25l[1;24r[24;1H
[1;25r[24;1Hf z[25;1H[K[24;3H[?12l[?25h[?25l z[24;4H[K[24;3H[?12l[?25h[?25l
/[?12l[?25h\%d21879b[?25l[1;24r[24;1H
[1;25r[24;1Hg a?bb[25;1H[K[24;4H[?12l[?25h[?25labb[24;6H[K[24;4H[?12l[?25h[?25l
:[?12l[?25h?^1?,$w! test.out[?25l"test.out" [25;12H[K[25;12H[New] 16L, 195C written[24;4H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! test.out[?25l"test.out" [25;12H[K[25;12H16L, 195C[1;1H1 a aa abb abbcc[1;17H[K[2;1H2 d dd dee deeff[2;17H[K[3;1H3 g gg ghh ghhii[3;17H[K[4;1H4 j jj jkk jkkll[4;17H[K[5;1H5 m mm mnn mnnoo
6 x aa$ x
7 (a)(b) abba
8 axx ab]xx
9 x x[9;9H[K[10;1Ha x x[10;9H[K[11;1Hb ???[11;9H[K[12;1Hc x x[12;8H[K[13;1Hd ?x[13;6H[K[14;1He y[14;5H[K[15;1Hf z[15;4H[K[16;1Hg abb[16;7H[K[17;1H[1m[34m~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[16;1H[?25l[m[25;1H[K[25;1H:[?12l[?25hput =matchstr(\"\", \".\", 0, 2) " [?25l[17;1H[17;2H[K[17;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hput =matchstr(\"\", \"..\", 0, 2) " [?25l[18;1H[18;3H[K[18;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hput =matchstr(\"\", \".\", 0, 0) " [?25l[19;1H[19;2H[K[19;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hput =matchstr(\"\", \".\", 4, -1) " [?25l[20;1H[20;2H[K[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw![?25l"test.out" 20L, 209C written[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test45.failed test.ok test.out X* viminfo
cp test45.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test45.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test45.in" 80 lines, 1824 characters[1;1HTests for folding. vim: set ft=vim :

STARTTEST
:so small.vim
:" We also need the +syntax feature here.
:if !has("syntax")
   e! test.ok
   w! test.out
   qa!
:endif
:" basic test if a fold can be created, opened, moving to the end and closed
/^1
zf2j:call append("$", "manual " . getline(foldclosed(".")))
zo:call append("$", foldclosed("."))
]z:call append("$", getline("."))
zc:call append("$", getline(foldclosed(".")))
:" test folding with markers.
:set fdm=marker fdl=1 fdc=3
/^5
:call append("$", "marker " . foldlevel("."))
[z:call append("$", foldlevel("."))
jo{{ [34m^[[mr{jj:call append("$", foldlevel("."))
kYpj:call append("$", foldlevel("."))
:" test folding with indent[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for folding. vim: set ft=vim :[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 63 lines, 1691 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;1H/bb$
:call append("$", "expr " . foldlevel("."))
/hh$
:call append("$", foldlevel("."))
/ii$
:call append("$", foldlevel("."))
/kk$
:call append("$", foldlevel("."))
:/^last/+1,$w! test.out
:delfun Flvl
:qa!
ENDTEST

1 aa
2 bb
3 cc
4 dd {{{
5 ee {{{ }}}
6 ff }}}
7 gg
8 hh
9 ii
a jj
b kk[12;1H[?12l[?25h
[?25l[25;1H:so! Xdotest[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" We also need the +syntax feature here.[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hif !has("syntax")[?25l
:  [?12l[?25h   e! test.ok
[?25l:  [?12l[?25h   w! test.out
[?25l:  [?12l[?25h   qa!
[?25l:  [?12l[?25h:endif[1;1H[4L[?25l[1;1H/bb$
:call append("$", "expr " . foldlevel("."))
/hh$
:call append("$", foldlevel("."))[25;1H[K[13;1H[?12l[?25h[?25l[25;1H:[?12l[?25h" basic test if a fold can be created, opened, moving to the end and closed[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^1[?25l[14;1H[?12l[?25h[?25l[34m[47m+--  3 lines: 1 aa--------------------------------------------------------------[m[15;1H4 dd {{{
5 ee {{{ }}}
6 ff }}}
7 gg[18;6H[K[19;1H8 hh[19;6H[K[20;1H9 ii
a jj
b kk
last
[1m[34m~                                                                               [14;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hcall append("$", "manual " . getline(foldclosed(".")))[?25l[24;1Hmanual 1 aa[24;12H[K[14;1H[?12l[?25h[?25l1 aa[14;5H[K[15;1H2 bb[15;6H[K[16;1H3 cc[16;6H[K[17;1H4 dd {{{
5 ee {{{ }}}
6 ff }}}
7 gg
8 hh
9 ii
a jj
b kk[24;5H[K[14;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall append("$", foldclosed("."))[?25l[14;1H[?12l[?25h

[?25l[25;1H[K[25;1H:[?12l[?25hcall append("$", getline("."))[?25l[16;1H[?12l[?25h[?25l[14;1H[34m[47m+--  3 lines: 1 aa--------------------------------------------------------------[m[15;1H4 dd {{{
5 ee {{{ }}}
6 ff }}}
7 gg[18;6H[K[19;1H8 hh[19;6H[K[20;1H9 ii
a jj
b kk
last
manual 1 aa[14;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall append("$", getline(foldclosed(".")))[?25l[14;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" test folding with markers.[?25l[14;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fdm=marker fdl=1 fdc=3[?25l[1;1H[34m[47m   [m/bb$
[34m[47m   [m:call append("$", "expr " . foldlevel("."))
[34m[47m   [m/hh$
[34m[47m   [m:call append("$", foldlevel("."))
[34m[47m   [m/ii$
[34m[47m   [m:call append("$", foldlevel("."))
[34m[47m   [m/kk$
[34m[47m   [m:call append("$", foldlevel("."))
[34m[47m   [m:/^last/+1,$w! test.out
[34m[47m   [m:delfun Flvl
[34m[47m   [m:qa!
[34m[47m   [mENDTEST
[34m[47m   
   [m1 aa[14;8H[K[15;1H[34m[47m   [m2 bb[15;8H[K[16;1H[34m[47m   [m3 cc[16;8H[K[17;1H[34m[47m-  [m4 dd {{{
[34m[47m|- [m5 ee {{{ }}}
[34m[47m|  [m6 ff }}}
[34m[47m   [m7 gg
[34m[47m   [m8 hh
[34m[47m   [m9 ii
[34m[47m   [ma jj
[34m[47m   [mb kk[24;8H[K[16;4H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^5[?25l[18;4H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall append("$", "marker " . foldlevel("."))[?25l[18;4H[?12l[?25h[17;4H[?25l[25;1H[K[25;1H:[?12l[?25hcall append("$", foldlevel("."))[?25l[17;4H[?12l[?25h[18;4H[?25l[20;24r[20;1H[L[1;25r[19;4H{{ [19;7H[K[20;1H[34m[47m|  [m6 ff }}}[25;1H[K[19;6H[?12l[?25h[?25l[19;2H[34m[47m-[m[3C{[20;2H[34m[47m|
|
|
|
|[19;6H[?12l[?25h[20;6H[21;6H[?25l[25;1H[m:[?12l[?25hcall append("$", foldlevel("."))[?25l[21;6H[?12l[?25h[20;6H[?25l[21;4H6 ff }}}
[34m[47m [m[2C7 gg
[34m[47m [m[2C8 hh
[34m[47m [m[2C9 ii[21;4H[?12l[?25h[22;4H[?25l[25;1H[K[25;1H:[?12l[?25hcall append("$", foldlevel("."))[?25l[22;4H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" test folding with indent[?25l[22;4H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fdm=indent sw=2[?25l[17;1H[34m[47m 
  
  
  
 
   [?12l[?25h[?25l[m[25;1H[K[25;1H/[?12l[?25h^2 b[?25l[31msearch hit BOTTOM, continuing at TOP[15;4H[?12l[?25h[?25l[m[34m[47m-[m[2C  2 bb[?12l[?25h[16;5H[?25l[34m[47m|-[m[1C    3 cc[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall append("$", "indent " . foldlevel("."))[?25l[16;7H[?12l[?25h[15;7H[?25l[25;1H[K[25;1H:[?12l[?25hcall append("$", foldlevel("."))[?25l[15;7H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" test syntax folding[?25l[15;7H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fdm=syntax fdl=0[?25l[15;1H[34m[47m 
  [15;7H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hsyn region Hup start="dd" end="ii" fold contains=Fd1,Fd2,Fd3[?25l[17;1H[34m[47m+  +--  8 lines: 4 dd ----------------------------------------------------------[m[18;4Ha jj[18;9H[K[19;4Hb kk[20;4Hlast[20;9H[K[21;4Hmanual 1 aa[22;4H-1[22;6H[K[23;4H3 cc[24;4H1 aa[15;7H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hsyn region Fd1 start="ee" end="ff" fold contained[?25l[15;7H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hsyn region Fd2 start="gg" end="hh" fold contained[?25l[15;7H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hsyn region Fd3 start="commentstart" end="commentend" fold contained[?25l[15;7H[?12l[?25h[?25l[1;24r[1;1H[6M[1;25r[19;1H[34m[47m   [mmarker 2
[34m[47m   [m1
[34m[47m   [m1
[34m[47m   [m0
[34m[47m   [mindent 2
[34m[47m   [m1[25;1H[K[24;4H[?12l[?25h[11;4H[?25l[25;1H:[?12l[?25hcall append("$", "folding " . getline("."))[?25l[11;4H[?12l[?25h[10;4H[?25l[25;1H[K[25;1H:[?12l[?25hcall append("$", getline("."))[?25l[10;4H[?12l[?25h[11;4H[?25l[34m[47m--[m[1C4 dd {{{commentstart  [11;26H[K[12;1H[34m[47m||[m[1C5 ee {{{ }}}
[34m[47m||[m[1C{{{[13;7H[K[14;1H[34m[47m||[m[1C6 ff }}}
[34m[47m||[m[1C6 ff }}}[15;13H[K[16;1H[34m[47m||[m[1C7 gg
[34m[47m||[m[1C8 hh
[34m[47m||[m[1C9 ii
[34m[47m||[m[1Ca jj[19;8H[K[20;1H[34m[47m||[m[1Cb kk
[34m[47m||[m[1Clast
[34m[47m||[m[1Cmanual 1 aa
[34m[47m||[m[1C-1[23;6H[K[24;1H[34m[47m||[m[1C3 cc[11;25H[?12l[?25h[?25l[11;2H[34m[47m [m[23Ccommentend[12;2H[34m[47m-[15;2H 
|-

| 
  
  
  
  
  
  [11;35H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hset fdl=1[?25l[12;2H[34m[47m+ +---  3 lines: 5 ee ---------------------------------------------------------[13;2H [m[1C6 ff }}}[14;2H[34m[47m+ +---  2 lines: 7 gg----------------------------------------------------------[m[15;4H9 ii[15;9H[K[16;1H[34m[47m  [m[1Ca jj
[34m[47m  [m[1Cb kk
[34m[47m [m[2Clast[19;4Hmanual 1 aa[20;4H-1[20;6H[K[21;4H3 cc[22;4H1 aa[22;8H[K[23;4Hmarker 2[24;4H1[24;6H[K[11;35H[?12l[?25h[14;4H[?25l[25;1H[K[25;1H:[?12l[?25hcall append("$", getline("."))[?25l[14;4H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset fdl=0[?25l[11;1H[34m[47m+  +--  8 lines: 4 dd commentstart  commentend----------------------------------[12;1H  [m[1Ca jj[12;8H[K[13;1H[34m[47m [m[2Cb kk[13;9H[K[14;1H[34m[47m  [m[1Clast[14;8H[K[15;1H[34m[47m [m[2Cmanual 1 aa[16;4H-1[16;6H[K[17;4H3 cc[18;4H1 aa[19;6Hrker 2[19;13H[K[20;4H1[20;5H[K[21;4H1[21;6H[K[22;4H0[22;6H[K[23;4Hindent[11;4H[?12l[?25h[?25l[34m[47m-[m[2C4 dd {{{commentstart  commentend[11;36H[K[12;1H[34m[47m|-[m[1C5 ee {{{ }}}
[34m[47m||[m[1C{{{[13;7H[K[14;1H[34m[47m||[m[1C6 ff }}}
[34m[47m|[m[2C6 ff }}}[15;13H[K[16;1H[34m[47m|-[m[1C7 gg
[34m[47m||[m[1C8 hh
[34m[47m|[m[2C9 ii[19;4Ha jj[19;8H[K[20;4Hb kk[21;4Hlast[22;4Hmanual 1 aa[23;4H-1[23;6H[K[24;4H3 cc[16;7H[?12l[?25h[27m[m[H[2J[?25l[1;1H[34m[47m   [m/kk$
[34m[47m   [m:call append("$", foldlevel("."))
[34m[47m   [m:/^last/+1,$w! test.out
[34m[47m   [m:delfun Flvl
[34m[47m   [m:qa!
[34m[47m   [mENDTEST
[34m[47m   
   [m1 aa
[34m[47m   [m  2 bb
[34m[47m   [m    3 cc
[34m[47m-  [m4 dd {{{commentstart  commentend
[34m[47m|- [m5 ee {{{ }}}
[34m[47m|| [m{{{
[34m[47m|| [m6 ff }}}
[34m[47m|  [m6 ff }}}
[34m[47m|- [m7 gg
[34m[47m|| [m8 hh
[34m[47m|  [m9 ii
[34m[47m   [ma jj
[34m[47m   [mb kk
[34m[47m   [mlast
[34m[47m   [mmanual 1 aa
[34m[47m   [m-1
[34m[47m   [m3 cc[16;7H[?12l[?25h[17;4H[?25l[25;1H:[?12l[?25hcall append("$", getline("."))[?25l[17;4H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" test expression folding[?25l[17;4H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfun Flvl()[?25l
:  [?12l[?25h  let l = getline(v:lnum)
[?25l:  [?12l[?25h  if l =~ "bb$"
[?25l:    [?12l[?25h    return 2
[?25l:    [?12l[?25h  elseif l =~ "gg$"
[?25l:    [?12l[?25h    return "s1"
[?25l:    [?12l[?25h  elseif l =~ "ii$"
[?25l:    [?12l[?25h    return ">2"
[?25l:    [?12l[?25h  elseif l =~ "kk$"
[?25l:    [?12l[?25h    return "0"
[?25l:    [?12l[?25h  endif
[?25l:  [?12l[?25h  return "="
[?25l:  [?12l[?25hendfun[1;1H[12L[?25l[1;1H[34m[47m   [m/kk$
[34m[47m   [m:call append("$", foldlevel("."))
[34m[47m   [m:/^last/+1,$w! test.out
[34m[47m   [m:delfun Flvl
[34m[47m   [m:qa!
[34m[47m   [mENDTEST
[34m[47m   
   [m1 aa
[34m[47m   [m  2 bb
[34m[47m   [m    3 cc
[34m[47m-  [m4 dd {{{commentstart  commentend
[34m[47m|- [m5 ee {{{ }}}[25;1H[K[17;4H[?12l[?25h[?25l[25;1H:[?12l[?25hset fdm=expr fde=Flvl()[?25l[9;1H[34m[47m+  +-- 11 lines: 2 bb-----------------------------------------------------------[m[10;4Hb kk[10;8H[K[11;1H[34m[47m [m[2Clast[11;9H[K[12;1H[34m[47m  [m[1Cmanual 1 aa[12;15H[K[13;1H[34m[47m  [m[1C-1[13;6H[K[14;1H[34m[47m  [m[1C3 cc[14;9H[K[15;1H[34m[47m [m[2C1 aa[15;9H[K[16;1H[34m[47m  [m[1Cmarker 2
[34m[47m  [m[1C1[17;6H[K[18;1H[34m[47m [m[2C1[18;6H[K[19;4H0[19;6H[K[20;4Hindent 2[21;4H1[21;5H[K[22;1H[34m[47m+  +--  4 lines: folding 9 ii---------------------------------------------------[m[23;4H[1m[34m~                                                                            [24;4H~                                                                            [9;4H[?12l[?25h[?25l[m[25;1H[K[25;1H/[?12l[?25hbb$[?25l[31msearch hit BOTTOM, continuing at TOP[m[9;1H[34m[47m--[m[1C  2 bb[9;10H[K[10;1H[34m[47m||[m[1C    3 cc
[34m[47m||[m[1C4 dd {{{commentstart  commentend
[34m[47m||[m[1C5 ee {{{ }}}
[34m[47m||[m[1C{{{
[34m[47m||[m[1C6 ff }}}
[34m[47m||[m[1C6 ff }}}
[34m[47m||[m[1C7 gg[16;8H[K[17;1H[34m[47m|[m[2C8 hh
[34m[47m|+ +---  2 lines: 9 ii----------------------------------------------------------[m[19;4Hb kk[20;4Hlast[20;8H[K[21;4Hmanual 1 aa
[34m[47m [m[2C-1[22;6H[K[23;4H3 cc[23;8H[K[24;4H1 aa[24;8H[K[9;8H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall append("$", "expr " . foldlevel("."))[?25l[9;8H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25hhh$[?25l[17;6H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall append("$", foldlevel("."))[?25l[17;6H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25hii$[?25l[18;2H[34m[47m-[m[1C9 ii[18;8H[K[19;1H[34m[47m||[m[1Ca jj[20;4Hb kk[21;4Hlast[21;8H[K[22;4Hmanual 1 aa[23;4H-1[23;6H[K[24;4H3 cc[18;6H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall append("$", foldlevel("."))[?25l[18;6H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25hkk$[?25l[20;6H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall append("$", foldlevel("."))[?25l[20;6H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^last/+1,$w! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 18 lines, 96 characters written[20;6H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hdelfun Flvl[?25l[20;6H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test46.failed test.ok test.out X* viminfo
cp test46.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test46.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test46.in" 27 lines, 431 characters[1;1HTests for multi-line regexps with ":s". vim: set ft=vim :

STARTTEST
:" test if replacing a line break works with a back reference
:/^1/,/^2/s/\n\(.\)/ \1/
:" test if inserting a line break works with a back reference
:/^3/,/^4/s/\(.\)$/\r\1/
:" test if replacing a line break with another line break works
:/^5/,/^6/s/\(\_d\{3}\)/x\1x/
:/^1/,$w! test.out
:qa!
ENDTEST

1 aa
bb
cc
2 dd
ee
3 ef
gh
4 ij
5 a8
8b c9
9d[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for multi-line regexps with ":s". vim: set ft=vim :[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 8 lines, 292 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[12;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" test if replacing a line break works with a back reference[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^1/,/^2/s/\n\(.\)/ \1/[?25l4 substitutions on 1 line[14;24r[14;1H[4M[1;25r[14;1H1 aa bb cc 2 dd ee[21;1H6 e7
77f
xxxxx
[1m[34m~                                                                               [m[25;1H[K[25;1H4 substitutions on 1 line[14;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" test if inserting a line break works with a back reference[?25l[14;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^3/,/^4/s/\(.\)$/\r\1/[?25l3 substitutions on 3 lines[18;24r[18;1H[3L[1;25r[15;4H[K[16;1Hf[16;2H[K[17;1Hg[17;3H[K[18;1Hh
4 i
j[25;1H[K[25;1H3 substitutions on 3 lines[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" test if replacing a line break with another line break works[?25l[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^5/,/^6/s/\(\_d\{3}\)/x\1x/[?25l3 substitutions on 2 lines[25;27H[K[1;24r[24;1H
[1;25r[20;4Hx8
8xb cx9
9xd
6 ex7
7x7f[25;1H[K[25;1H3 substitutions on 2 lines[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^1/,$w! test.out[?25l[31msearch hit BOTTOM, continuing at TOP[m"test.out" [25;12H[K[25;12H[New File] 13 lines, 70 characters written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test47.failed test.ok test.out X* viminfo
cp test47.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test47.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test47.in" 47 lines, 1140 characters[1;1HTests for vertical splits and filler lines in diff mode

STARTTEST
:so small.vim
:" Disable the title to avoid xterm keeping the wrong one.
:set notitle noicon
/^1
yG:new
pkdd:w! Xtest
ddGpkkrXoxxx[34m^[[m:w! Xtest2
:file Nop
ggoyyy[34m^[[mjjjozzzz[34m^[[m
:vert diffsplit Xtest
:vert diffsplit Xtest2
:" jump to second window for a moment to have filler line appear at start of
:" first window
[34m^W^W[mgg[34m^W[mpgg:let one = winline()
j:let one = one . "-" . winline()
j:let one = one . "-" . winline()
j:let one = one . "-" . winline()
j:let one = one . "-" . winline()
j:let one = one . "-" . winline()
[34m^W^W[mgg:let two = winline()
j:let two = two . "-" . winline()[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for vertical splits and filler lines in diff mode[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 37 lines, 1039 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[17M[1;25r[8;1Hj:let two = two . "-" . winline()
j:let two = two . "-" . winline()
j:let two = two . "-" . winline()
[34m^W^W[mgg:let three = winline()
j:let three = three . "-" . winline()
j:let three = three . "-" . winline()
j:let three = three . "-" . winline()
j:let three = three . "-" . winline()
j:let three = three . "-" . winline()
j:let three = three . "-" . winline()
[34m^W^W[m:call append("$", one)
:call append("$", two)
:call append("$", three)
:$-2,$w! test.out
:unlet one two three
:qa!
ENDTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Disable the title to avoid xterm keeping the wrong one.[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset notitle noicon[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^1[?25l[1;24r[24;1H
[1;25r[24;1H1 aa[25;1H[K[24;1H[?12l[?25h[?25l
5 lines yanked[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hnew[?25l[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [m[12;1H[1m[7m[No Name]                                                                       [m[15;1H[34m^W^W[m:call append("$", one)[15;27H[K[16;1H:call append("$", two)[16;23H[K[17;20Hhree)
:$-2,$w! test.out[18;19H[K[19;2Hunlet one two three
:qa![20;5H[K[21;1HENDTEST[22;1H[K[23;1H1 aa
[7mtest47.in                                                                       [1;1H[?12l[?25h[?25l[m[25;1H5 more lines[2;1H1 aa[2;5H[K[3;1H2 bb[3;5H[K[4;1H3 cc[4;5H[K[5;1H4 dd[5;5H[K[6;1H5 ee[6;5H[K[12;11H[1m[7m[+][2;1H[?12l[?25h[1;1H[?25l[1;11r[m[11;1H
[1;25r[11;1H[1m[34m~                                                                               [m[25;1H[K[1;1H[?12l[?25h[?25l[25;1H:[?12l[?25hw! Xtest[?25l"Xtest" [25;9H[K[25;9H[New File] 5 lines, 25 characters written[12;1H[1m[7mXtesta         [1;1H[?12l[?25h[?25l[1;11r[m[11;1H
[1;25r[11;1H[1m[34m~                                                                               [m[12;7H[1m[7m[+][m[25;1H[K[1;1H[?12l[?25h


[?25l
1 aa[5;5H[K[5;1H[?12l[?25h[4;1H[3;1H[?25lX[?12l[?25h[?25l[4;11r[4;1H[L[1;25r[4;1Hxxx[?12l[?25h[?25l[25;1H:[?12l[?25hw! Xtest2[?25l"Xtest2" [25;10H[K[25;10H[New File] 6 lines, 29 characters written[12;7H[1m[7m    [4;3H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hfile Nop[?25l"Nop" [Not edited] line 4 of 6 --66%-- col 3[12;1H[1m[7mNops   [4;3H[?12l[?25h[1;1H[?25l[2;11r[m[2;1H[L[1;25r[2;1Hyyy[12;5H[1m[7m[+][m[25;1H[K[2;3H[?12l[?25h
3 
X 
xx[?25l[6;11r[6;1H[L[1;25r[6;1Hzzzz[?12l[?25h
5 e[?25l[25;1H:[?12l[?25hvert diffsplit Xtest[?25l"Xtest" [25;9H[K[25;9H5 lines, 25 characters[1;1H[34m[47m  [m[44m1 aa                                  [m[7m|[m
[34m[47m  [m2 bb[34C[7m|[m
[34m[47m  [m[1m[34m[46m--------------------------------------[m[7m|[m
[34m[47m  [m3 cc[34C[7m|[m
[34m[47m  [m[1m[41m4[m[45m dd                                  [m[7m|[m
[34m[47m  [m[1m[34m[46m--------------------------------------[m[7m|[m
[34m[47m  [m[1m[34m[46m--------------------------------------[m[7m|[m
[34m[47m  [m5 ee[34C[7m|[9;41H|[10;41H|[11;41H|[m[9;1H[34m[47m  [m[1m[34m[46m--------------------------------------[m
[34m[47m  
  [m[10;3H[1m[34m~[11;3H~[m
[1m[7mXtest+   [m[1;42H[34m[47m  [m[1m[34m[46m-------------------------------------[m[2;42H[34m[47m  [m2 bb[3;42H[34m[47m  [m[44myyy                                  [m[4;42H[34m[47m  [m3 cc[5;42H[34m[47m  [m[1m[41mX[m[45m dd                                 [m[6;42H[34m[47m  [m[44mxxx                                  [m[7;42H[34m[47m  [m[44mzzzz                                 [m[8;42H[34m[47m  [m5 ee[9;42H[34m[47m  [m[44m1 aa                                 [m[10;42H[34m[47m  [11;42H  [m[10;44H[1m[34m~[11;44H~[m[12;42H[7mNop [+]                                [1;3H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hvert diffsplit Xtest2[?25l"Xtest2" [25;10H[K[25;10H6 lines, 29 characters[27m[m[H[2J[1;1H[34m[47m  [m2 bb[20C[7m|[m
[34m[47m  [m[1m[34m[46m------------------------[m[7m|[m
[34m[47m  [m3 cc[20C[7m|[m
[34m[47m  [m[1m[41mX[m[45m dd                    [m[7m|[m
[34m[47m  [m[45mxxx                     [m[7m|[m
[34m[47m  [m[1m[34m[46m------------------------[m[7m|[m
[34m[47m  [m5 ee[20C[7m|[m
[34m[47m  [m[44m1 aa                    [m[7m|[9;27H|[10;27H|[11;27H|[m[9;1H[34m[47m  
  
  [m[9;3H[1m[34m~                       [10;3H~                       [11;3H~                       [m
[1m[7mXtest2                     [m[1;28H[34m[47m  [m2 bb[20C[7m|[m[2;28H[34m[47m  [m[1m[34m[46m------------------------[m[7m|[m[3;28H[34m[47m  [m3 cc[20C[7m|[m[4;28H[34m[47m  [m[1m[41m4[m[45m dd                    [m[7m|[m[5;28H[34m[47m  [m[1m[34m[46m------------------------[m[7m|[m[6;28H[34m[47m  [m[1m[34m[46m------------------------[m[7m|[m[7;28H[34m[47m  [m5 ee[20C[7m|[8;54H|[9;54H|[10;54H|[11;54H|[m[8;28H[34m[47m  [m[1m[34m[46m------------------------[m[9;28H[34m[47m  [10;28H  [11;28H  [m[9;30H[1m[34m~                       [10;30H~                       [11;30H~                       [m[12;28H[7mXtest                      [m[1;55H[34m[47m  [m2 bb[2;55H[34m[47m  [m[44myyy                     [m[3;55H[34m[47m  [m3 cc[4;55H[34m[47m  [m[1m[41mX[m[45m dd                    [m[5;55H[34m[47m  [m[45mxxx                     [m[6;55H[34m[47m  [m[44mzzzz                    [m[7;55H[34m[47m  [m5 ee[8;55H[34m[47m  [m[44m1 aa                    [m[9;55H[34m[47m  [10;55H  [11;55H  [m[9;57H[1m[34m~                       [10;57H~                       [11;57H~                       [m[12;55H[7mNop [+]                   [m[13;1Hj:let three = three . "-" . winline()
j:let three = three . "-" . winline()
[34m^W^W[m:call append("$", one)
:call append("$", two)
:call append("$", three)
:$-2,$w! test.out
:unlet one two three
:qa!
ENDTEST

1 aa
[7mtest47.in                                                                       [1;3H[?12l[?25h[?25l[25;1H[m:[?12l[?25h" jump to second window for a moment to have filler line appear at start of[?25l[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" first window[?25l[1;3H[?12l[?25h[?25l[12;1H[7mXtest2[m[1m[7m [m[7m                     [m[1m[7mXtest                      [1;30H[?12l[?25h[?25l[m[1;3H[1m[34m[46m------------------------[m[2;3H2 bb                    [3;3H[1m[34m[46m------------------------[m[4;3H3 cc                    [5;3H[1m[41mX[m[45m dd[6;3Hxxx                     [m[7;3H[1m[34m[46m------------------------[m[8;3H5 ee                    [9;3H[44m1 aa                    [m[1;1H[27C                          [2;28H[34m[47m  [m2 bb                    [3;28H[34m[47m  [m[1m[34m[46m------------------------[m[4;28H[34m[47m  [m3 cc                    [5;28H[34m[47m  [m[1m[41m4[m[45m dd                    [m[6;28H[34m[47m  [m[1m[34m[46m------------------------[m[7;28H[34m[47m  [m[1m[34m[46m------------------------[m[8;28H[34m[47m  [m5 ee                    [9;28H[34m[47m  [m[1m[34m[46m------------------------[m[10;28H[34m[47m  [m[1m[34m~                       [m[11;28H[34m[47m  [m[1m[34m~                       [m[1;28H[34m[47m  [m[44m1 aa                    [m[3C[1m[34m[46m------------------------[m[2;57H2 bb[2;61H[K[3;57H[44myyy                     [m[4;57H3 cc[4;61H[K[5;57H[1m[41mX[m[45m dd[6;57Hxxx                     [m[7;57H[44mzzzz                    [m[8;57H5 ee[8;61H[K[9;57H[44m1 aa                    [m[25;1H[K[1;30H[?12l[?25h[?25l[12;1H[1m[7mXtest2                     [m[7mXtest[m[1m[7m [m[7m                      [2;3H[?12l[?25h[?25l[?12l[?25h[?25l[25;1H[m:[?12l[?25hlet one = winline()[?25l[2;3H[?12l[?25h[?25l[4;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet one = one . "-" . winline()[?25l[4;3H[?12l[?25h[?25l[5;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet one = one . "-" . winline()[?25l[5;3H[?12l[?25h[?25l[6;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet one = one . "-" . winline()[?25l[6;3H[?12l[?25h[?25l[8;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet one = one . "-" . winline()[?25l[8;3H[?12l[?25h[?25l[9;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet one = one . "-" . winline()[?25l[9;3H[?12l[?25h[?25l


[7mXtest2[m[1m[7m [m[7m                     [m[1m[7mXtest                      [8;30H[?12l[?25h[?25l[1;30H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hlet two = winline()[?25l[1;30H[?12l[?25h[?25l[2;30H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet two = two . "-" . winline()[?25l[2;30H[?12l[?25h[?25l[4;30H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet two = two . "-" . winline()[?25l[4;30H[?12l[?25h[?25l[5;30H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet two = two . "-" . winline()[?25l[5;30H[?12l[?25h[?25l[8;30H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet two = two . "-" . winline()[?25l[8;30H[?12l[?25h[?25l[12;28H[7mXtest[m[1m[7m [m[7m                      [m[1m[7mNop [+]                   [8;57H[?12l[?25h[?25l[2;57H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hlet three = winline()[?25l[2;57H[?12l[?25h[?25l[3;57H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet three = three . "-" . winline()[?25l[3;57H[?12l[?25h[?25l[4;57H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet three = three . "-" . winline()[?25l[4;57H[?12l[?25h[?25l[5;57H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet three = three . "-" . winline()[?25l[5;57H[?12l[?25h[?25l[6;57H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet three = three . "-" . winline()[?25l[6;57H[?12l[?25h[?25l[7;57H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet three = three . "-" . winline()[?25l[7;57H[?12l[?25h[?25l[8;57H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet three = three . "-" . winline()[?25l[8;57H[?12l[?25h[12;55H[7mNop [+][m[1m[7m [m[7m                   [m[24;1H[1m[7mtest47.in                                                                       [23;1H[?25l[m[25;1H[K[25;1H:[?12l[?25hcall append("$", one)[?25l[24;11H[1m[7m[+][23;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hcall append("$", two)[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall append("$", three)[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$-2,$w! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 3 lines, 36 characters written[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hunlet one two three[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test48.failed test.ok test.out X* viminfo
cp test48.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test48.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test48.in" 74 lines, 1452 characters[1;1HThis is a test of 'virtualedit'.

STARTTEST
:so small.vim
:set noswf
:set ve=all
-dgg
:"
:"   Insert "keyword keyw", ESC, C CTRL-N, shows "keyword ykeyword".
:"    Repeating CTRL-N fixes it. (Mary Ellen Foster)
2/w
C[34m^N^[[m
:"
:"   Using "C" then then <CR> moves the last remaining character to the next
:"    line.  (Mary Ellen Foster)
j^/are
C[34m^M[mare belong to vim[34m^[[m
:"
:"   When past the end of a line that ends in a single character "b" skips
:"    that word.
^$15lbC7[34m^[[m
:"
:"   Make sure 'i' works
$4li<-- should be 3 ' '[34m^[[1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HThis is a test of 'virtualedit'.[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 54 lines, 1250 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;1H:"   Test to make sure 'x' can delete control characters
:set display=uhex
^xxxxxxi[This line should contain only the text between the brackets.][34m^[[m
:set display=
:"
:"   Test for ^Y/^E due to bad w_virtcol value, reported by
:"   Roy <royl@netropolis.net>.
^O[34m^[[m3li[34m^E^[[m4li[34m^E^[[m4li[34m^E[m   <-- should show the name of a noted text editor[34m^[[m
^o[34m^[[m4li[34m^Y^[[m4li[34m^Y^[[m4li[34m^Y[m   <-- and its version number[34m^[[m-dd
:"
:wq! test.out
ENDTEST
keyword keyw
all your base are belong to us
1 2 3 4 5 6
'i'
'C'
'a'
'A'
'D'
this is a test
this is a test
this is a test
"r"[12;1H[?12l[?25h
[?25l[25;1H:so! Xdotest[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset noswf[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset ve=all[?25l[13;1H[?12l[?25h[12;1H[?25l[25;1H58 fewer lines[1;24r[1;1H[12M[1;25r[13;1Ha[34m^V[mb[34m^M[msd
abcv6efi.him0kl


[1m[34m~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [m[25;1H[K[25;1H58 fewer lines[1;1H[?12l[?25h
[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[2;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"   Insert "keyword keyw", ESC, C CTRL-N, shows "keyword ykeyword".[?25l[2;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"    Repeating CTRL-N fixes it. (Mary Ellen Foster)[?25l[2;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25hw[?25l[31msearch hit BOTTOM, continuing at TOP[1;12H[?12l[?25h[?25l[m$[25;1H[32mScanning tags.[m[25;15H[K[25;1HThe only match[1;16H[25;1H[K[1;12Hword[?12l[?25h[2;15H[?25l[25;1H:[?12l[?25h"[?25l[2;15H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"   Using "C" then then <CR> moves the last remaining character to the next[?25l[2;15H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"    line.  (Mary Ellen Foster)[?25l[2;15H[?12l[?25h[3;15H[?25l[25;1H[K[25;1H/[?12l[?25hare[?25l[31msearch hit BOTTOM, continuing at TOP[2;15H[?12l[?25h[?25l[m[15C$[2;15H[K[3;1Hare belong to vim
1 2 3 4 5 6
'i
'C
'a
'A
'D'[9;4H[K[12;1Hthis is a test
"r"[13;4H[K[14;2H[34m^V[mb[34m^M[msd[14;9H[K[15;1Habcv6efi.him0kl[17;1H[K[3;17H[?12l[?25h[4;17H[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[4;17H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"   When past the end of a line that ends in a single character "b" skips[?25l[4;17H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"    that word.[?25l[4;17H[?12l[?25h[10C[15C[4;11H[?25l$7[?12l[?25h[5;11H[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[5;11H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"   Make sure 'i' works[?25l[5;11H[?12l[?25h'i'   [?25l<-- should be 3 ' '[?12l[?25h[6;25H[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[6;25H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"   Make sure 'C' works[?25l[6;25H[?12l[?25h'C'   [?25l$<-- should be 3 ' '[?12l[?25h[7;25H[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[7;25H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"   Make sure 'a' works[?25l[7;25H[?12l[?25h'a'   [?25l <-- should be 4 ' '[?12l[?25h[8;26H[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[8;26H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"   Make sure 'A' works[?25l[8;26H[?12l[?25h'A'   [?25l<-- should be 0 ' '[?12l[?25h[9;22H[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[9;22H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"   Make sure 'D' works[?25l[9;22H[?12l[?25h'D'   [?25l<-- 'D' should be intact[?12l[?25h[10;30H[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[10;30H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"   Test for yank bug reported by Mark Waggoner.[?25l[10;30H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset ve=block[?25l[10;14H[?12l[?25h[8C[?25l[?12l[?25h[?25l[7ma[11;9Ha[12;9Ha[13;9H[?12l[?25h[?25l[m[10;9Ha[11;9Ha[12;9Ha[25;1Hblock of 4 lines yanked[10;9H[?12l[?25h[17;1H[?25l[25;1H3 more lines[25;13H[K[17;1Ha
a[18;2H[K[19;1Ha[19;2H[K[20;1H [20;2H[K[17;1H[?12l[?25h
[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[18;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Test "r" beyond the end of the line[?25l[18;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset ve=all[?25l[18;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^"r"[?25l[31msearch hit BOTTOM, continuing at TOP[13;1H[?12l[?25h[m"r"    [?25lx[?12l[?25h[?25lx<-- should be 'x'[?12l[?25h[14;25H[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[14;25H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"   Test to make sure 'x' can delete control characters[?25l[14;25H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset display=uhex[?25l[14;2H[34m<16>[mb[34m<0d>[msd[16C[?12l[?25h[?25l[34m<16>[mb[34m<0d>[msd[14;12H[K[14;1H[?12l[?25h[?25lb[34m<0d>[msd[14;8H[K[14;1H[?12l[?25h[?25l[34m<0d>[msd[14;7H[K[14;1H[?12l[?25h[?25lsd[14;3H[K[14;1H[?12l[?25h[?25ld[14;2H[K[14;1H[?12l[?25h[?25l[14;1H[K[14;1H[?12l[?25h[?25l[This line should contain only the text between the brackets.][?12l[?25h[15;62H[?25l[25;1H[K[25;1H:[?12l[?25hset display=[?25l[15;62H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[15;62H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"   Test for ^Y/^E due to bad w_virtcol value, reported by[?25l[15;62H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"   Roy <royl@netropolis.net>.[?25l[15;62H[?12l[?25h[?25l[15;24r[15;1H[L[1;25r[25;1H[K[15;1H[?12l[?25h   [?25lv[?12l[?25hv   [?25li[?12l[?25hi   [?25lm   <-- should show the name of a noted text editor[?12l[?25h[16;62H[?25l[17;24r[17;1H[L[1;25r[17;1H[?12l[?25h    [?25l6[?12l[?25h6   [?25l.[?12l[?25h.   [?25l0   <-- and its version number[?12l[?25h[16;1H[?25l[16;24r[24;1H
[1;25r[24;1H[1m[34m~                                                                               [16;5H[?12l[?25h
[m    [?25l[25;1H:[?12l[?25h"[?25l[17;5H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hwq! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 21 lines, 443 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test49.failed test.ok test.out X* viminfo
cp test49.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test49.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test49.in" 30 lines, 632 characters[1;1HThis is a test of the script language.

If after adding a new test, the test output doesn't appear properly in
test49.failed, try to add one ore more "G"s at the line ending in "test.out"

STARTTEST
:so small.vim
:se nocp nomore viminfo+=nviminfo
:lang mess C
:so test49.vim
GGGGGGGGGGGGGG"rp:.-,$w! test.out
:"
:" make valgrind happy
:redir => funclist
:silent func
:redir END
:for line in split(funclist, "\n")
:  let name = matchstr(line, 'function \zs[A-Z]\w*\ze(')
:  if name != ''
:    exe "delfunc " . name
:  endif
:endfor
:for v in keys(g:)
:  silent! exe "unlet " . v[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HThis is a test of the script language.[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[6;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[7;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 21 lines, 401 characters written[7;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[7;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[4M[1;25r[21;1H:endfor
:unlet v
:qa!
ENDTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hse nocp nomore viminfo+=nviminfo[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlang mess C[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso test49.vim[?25l[1m[37m[41mError detected while processing function G:[m
[33mline   16:[m
[1m[37m[41mE171: Missing :endif:     endwhile[m
*** Test   1: OK (34695)
   function F()
1      Xpath 1[37C" X: 1
2      let first = 1
3      XloopINIT 2 8
4      while 1
5[10CXloop 1[33C" X: 2      + 0 * 16
6[10Cif first
7[14CXloop 2[29C" X: 4      + 0 * 32
8[14Clet first = 0
9[14CXloopNEXT
10[13Cbreak
11[9Celse
12[13CXloop 4[29C" X: 0      + 0 * 64
13[13Creturn
14[9Cendif
15     endwhile
   endfunction[9;1H"/tmp/vbWsZdC/0"[10;1H[K[11;1H[K[12;1H[K[13;1H[K[14;1H[K[15;1H[K[16;1H[K[17;1H[K[18;1H[K[19;1H[K[20;1H[K[21;1H[K[22;1H[K[23;1H[K[24;1H[K[25;4H[K[9;18H[noeol] 18L, 528C
15 substitutions on 15 lines
E486: Pattern not found: ^\s*$"/tmp/vbWsZdC/0" [11;19H[K[11;18H15L, 476C written"test49.in" [11;13H[K[11;13H30L, 632C
   function G()
1      Xpath 256[35C" X: 256    + 0 * 2048
2      let first = 1
3      XloopINIT 512 8
4      while 1
5[10CXloop 1[33C" X: 512    + 0 * 4096
6[10Cif first
7[14CXloop 2[29C" X: 1024   + 0 * 8192
8[14Clet first = 0
9[14CXloopNEXT
10[13Cbreak
11[9Celse
12[13CXloop 4[29C" X: 0      + 0 * 16384
13[13Creturn
14[9Cendif
15[9Cif 1    " unmatched :if
16     endwhile
   endfunction[8;1H"/tmp/vbWsZdC/1"[9;1H[K[10;1H[K[11;1H[K[12;1H[K[13;1H[K[14;1H[K[15;1H[K[16;1H[K[17;1H[K[18;1H[K[19;1H[K[20;1H[K[21;1H[K[22;1H[K[23;1H[K[24;1H[K[25;4H[K[8;18H[noeol] 19L, 588C
16 substitutions on 16 lines
E486: Pattern not found: ^\s*$"/tmp/vbWsZdC/1" [10;19H[K[10;18H16L, 534C written"test49.in" [10;13H[K[10;13H30L, 632C
[1m[37m[41mError detected while processing /tmp/vbWsZdC/1:[m
[33mline   16:[m
[1m[37m[41mE171: Missing :endif:      endwhile[m
*** Test   2: OK (34695)
*** Test   3: OK (1384648195)
*** Test   4: OK (32883)
   function F()
1      if 1
2[10CXpath 1[33C" X: 1
3[10Clet loops = 3
4[10CXloopINIT 2 16
5[10Cwhile loops > 0[25C"    3:  2:     1:
6[14CXloop 1[29C" X: 2 + 2*16 + 0*16*16
7[14Cif (loops == 2)
8[18CXloop 2[25C" X:     4*16
9[18Creturn
10[17CXloop 4[25C" X:     0
11[13Cendif
12[13CXloop 8[29C" X: 16
13[13Clet loops = loops - 1
14[13CXloopNEXT
15[9Cendwhile
16[9CXpath 8192[30C" X: 0
17     else
18[9CXpath 16384[29C" X: 0
19     endif
   endfunction[5;1H"/tmp/vbWsZdC/2"[6;1H[K[7;1H[K[8;1H[K[9;1H[K[10;1H[K[11;1H[K[12;1H[K[13;1H[K[14;1H[K[15;1H[K[16;1H[K[17;1H[K[18;1H[K[19;1H[K[20;1H[K[21;1H[K[22;1H[K[23;1H[K[24;1H[K[25;4H[K[5;18H[noeol] 22L, 784C
19 substitutions on 19 lines
E486: Pattern not found: ^\s*$"/tmp/vbWsZdC/2" [7;19H[K[7;18H19L, 724C written"test49.in" [7;13H[K[7;13H30L, 632C
*** Test   5: OK (32883)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"/tmp/vbWsZdC/3" [8;18H[K[8;18H[New] 53L, 1582C written[8;18H[K[8;18H14L, 358C appended[8;18H[K[8;18H26L, 824C appended[8;18H[K[8;18H34L, 986C appended
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/4[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[9;1H[K[9;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/4" [9;18H[K[9;18H130L, 2431C appended[9;18H[K[9;18H131L, 2453C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/5[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[11;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'l[12;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/5"' -S /tmp/vbWsZdC[13;1H/4[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[11;1H"/tmp/vbWsZdC/5" [11;18H[K[12;1H[K[13;1H[K[11;18H21L, 130C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [11;13H[K[11;13H30L, 632C
*** Test   6: OK (603978947)
[1m[37m[41mError detected while processing /sources/vim73/src/testdir/test49.vim:[m
[33mline  976:[m
[1m[37m[41mE492: Not an editor command: ^Iasdf[m
[33mline  988:[m
[1m[37m[41mE492: Not an editor command: ^Iasdf[m
[33mline  996:[m
[1m[37m[41mE492: Not an editor command: asdf[m
[33mline  999:[m
[1m[37m[41mE492: Not an editor command: asdf | Xpath 32768^I^I^I^I" X: 0[m
*** Test   7: OK (90563)
[1m[37m[41mError detected while processing function F:[m
[33mline    5:[m
[1m[37m[41mE492: Not an editor command: ^I    asdf[m
[33mline    7:[m
[1m[37m[41mE492: Not an editor command: ^I    asdf | Xpath 8^I^I^I" X: 0[m
[33mline   19:[m
[1m[37m[41mE492: Not an editor command: ^I    asdf[m
[33mline   21:[m
[1m[37m[41mE492: Not an editor command: ^I    asdf | Xpath 2048^I^I^I" X: 0[m
[33mline   29:[m
[1m[37m[41mE121: Undefined variable: novar[m
[1m[37m[41mE15: Invalid expression: novar^I^I" returns (default return value 0)[m
[1m[37m[41mError detected while processing function G:[m
[33mline    5:[m
[1m[37m[41mE492: Not an editor command: ^I    asdf^I^I" returns -1[m
[1m[37m[41mError detected while processing function H:[m
[33mline    5:[m
[1m[37m[41mE492: Not an editor command: ^I    asdf^I^I" returns -1[m
*** Test   8: OK (562493431)
[1m[37m[41mError detected while processing function F..G..H..I:[m
[33mline    2:[m
[1m[37m[41mE492: Not an editor command:     asdf^I^I" error[m
*** Test   9: OK (363)
[1m[37m[41mError detected while processing /sources/vim73/src/testdir/test49.vim:[m
[33mline 1201:[m
[1m[37m[41mE15: Invalid expression: | strlen("\"") | Xpath 512^I^I" X: 0[m
[1m[37m[41mE15: Invalid expression: 1 ||| strlen("\"") | Xpath 512^I^I" X: 0[m
[33mline 1211:[m
[1m[37m[41mE15: Invalid expression: | strlen("\"") | Xpath 8192^I^I" X: 0[m
[1m[37m[41mE15: Invalid expression: 1 ||| strlen("\"") | Xpath 8192^I^I" X: 0[m
[33mline 1220:[m
[1m[37m[41mE15: Invalid expression: | strlen("\"") | Xpath 131072^I^I" X: 0[m
[1m[37m[41mE15: Invalid expression: 1 ||| strlen("\"") | Xpath 131072^I^I" X: 0[m
*** Test  10: OK (559615)
[33mline 1252:[m
[1m[37m[41mE492: Not an editor command:     asdf^I^I" error[m
*** Test  11: OK (2049)
1
[33mline 1330:[m
[1m[37m[41mE492: Not an editor command:     asdf^I^I" error[m
[33mline 1338:[m
[1m[37m[41mE492: Not an editor command:     asdf^I^I" error[m
*** Test  12: OK (352256)
[33mline 1357:[m
[1m[37m[41mE121: Undefined variable: asdf[m
[1m[37m[41mE15: Invalid expression: asdf[m
[33mline 1368:[m
[1m[37m[41mE121: Undefined variable: asdf[m
[1m[37m[41mE15: Invalid expression: asdf | Xpath 32 | endwhile | Xpath 64^I" X: 0[m
*** Test  13: OK (145)
[1m[37m[41mError detected while processing function F:[m
[33mline    8:[m
[1m[37m[41mE121: Undefined variable: g:boolvar[m
[1m[37m[41mE15: Invalid expression: g:boolvar^I" possibly undefined[m
*** Test  14: OK (42413)
[1m[37m[41mE121: Undefined variable: g:boolvar[m
[1m[37m[41mE15: Invalid expression: g:boolvar | Xloop 8 | else | Xloop 16 | endif    " X: [m
[24;80H[1m[37m[41m8[m[25;1H
*** Test  15: OK (42413)
[33mline    5:[m
[1m[37m[41mE583: multiple :else:     else^I^I[m
[1m[37m[41mError detected while processing function G:[m
[33mline    5:[m
[1m[37m[41mE584: :elseif after :else:     elseif 1^I^I" aborts function[m
[1m[37m[41mError detected while processing function H:[m
[33mline    7:[m
[1m[37m[41mE583: multiple :else:     else^I^I[m
[1m[37m[41mError detected while processing function I:[m
[33mline    7:[m
[1m[37m[41mE584: :elseif after :else:     elseif 1^I^I" aborts function[m
*** Test  16: OK (8722)
[1m[37m[41mError detected while processing function F:[m
[33mline   18:[m
[1m[37m[41mE171: Missing :endif:     endwhile^I[m
[1m[37m[41mE171: Missing :endif:     endwhile^I[m
[33mline   34:[m
[1m[37m[41mE171: Missing :endif:     endwhile^I[m
[1m[37m[41mE171: Missing :endif:     endwhile^I[m
[1m[37m[41mE171: Missing :endif:     endwhile^I[m
[33mline   47:[m
[1m[37m[41mE580: :endif without :if: ^Iendif^I[m
[1m[37m[41mE580: :endif without :if: ^Iendif^I[m
[1m[37m[41mE580: :endif without :if: ^Iendif^I[m
[1m[37m[41mError detected while processing /sources/vim73/src/testdir/test49.vim:[m
[33mline 1626:[m
[1m[37m[41mE171: Missing :endif: endwhile [m
*** Test  17: OK (285127993)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/6[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/6" [25;18H[K[25;18H16L, 304C appended[25;18H[K[25;18H17L, 326C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/7[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[24;80Hc[25;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/7"' -c 'breakad
[24;80Hd[25;2Hfile 8 /tmp/vbWsZdC/6' -S /tmp/vbWsZdC/6[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/7" [23;18H[K[24;2H[K[25;2H[K[23;18H3L, 6C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/8[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/8" [24;18H[K[24;18H6L, 127C appended[24;18H[K[24;18H7L, 149C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/9[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[24;80Hc[25;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/9"' -c 'breakad
[24;80Hd[25;2Hfile 4 /tmp/vbWsZdC/8' -S /tmp/vbWsZdC/8[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/9" [23;18H[K[24;2H[K[25;2H[K[23;18H1L, 5C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/10[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/10" [24;19H[K[24;19H21L, 486C appended[24;19H[K[24;19H22L, 508C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/11[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[24;80Hc[25;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/11"' -c 'breaka
[24;80Hd[25;1Hd func 7 F' -S /tmp/vbWsZdC/10[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/11" [23;19H[K[24;2H[K[25;1H[K[23;19H3L, 18C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/12[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/12" [24;19H[K[24;19H13L, 364C appended[24;19H[K[24;19H14L, 386C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/13[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[24;80Hc[25;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/13"' -c 'breaka
[24;80Hd[25;1Hd func 3 G' -S /tmp/vbWsZdC/12[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/13" [23;19H[K[24;2H[K[25;1H[K[23;19H1L, 9C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  18: OK (67224583)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/14[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/14" [25;19H[K[25;19H12L, 201C appended[25;19H[K[25;19H13L, 223C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/15[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/15"' -S /tmp/vbWsZ
[24;80Hd[25;1HC/14[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/15" [23;19H[K[24;1H[K[25;1H[K[23;19H2L, 4C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/16[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/16" [24;19H[K[24;19H12L, 205C appended[24;19H[K[24;19H13L, 227C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/17[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/17"' -S /tmp/vbWsZ
[24;80Hd[25;1HC/16[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/17" [23;19H[K[24;1H[K[25;1H[K[23;19H2L, 7C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/18[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/18" [24;19H[K[24;19H6L, 122C appended[24;19H[K[24;19H7L, 144C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/19[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/19"' -S /tmp/vbWsZ
[24;80Hd[25;1HC/18[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/19" [23;19H[K[24;1H[K[25;1H[K[23;19H1L, 5C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/20[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/20" [24;19H[K[24;19H8L, 176C appended[24;19H[K[24;19H9L, 198C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/21[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/21"' -S /tmp/vbWsZ
[24;80Hd[25;1HC/20[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/21" [23;19H[K[24;1H[K[25;1H[K[23;19H1L, 6C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/22[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/22" [24;19H[K[24;19H10L, 215C appended[24;19H[K[24;19H11L, 237C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/23[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/23"' -S /tmp/vbWsZ
[24;80Hd[25;1HC/22[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/23" [23;19H[K[24;1H[K[25;1H[K[23;19H1L, 8C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/24[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/24" [24;19H[K[24;19H7L, 149C appended[24;19H[K[24;19H8L, 171C[24;19H[K[24;19H8L, 170C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/25[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/25"' -S /tmp/vbWsZ
[24;80Hd[25;1HC/24[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/25" [23;19H[K[24;1H[K[25;1H[K[23;19H1L, 9C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  19: OK (69275973)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/26[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/26" [25;19H[K[25;19H9L, 135C appended[25;19H[K[25;19H10L, 157C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/27[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/27"' -S /tmp/vbWsZ
[24;80Hd[25;1HC/26[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/27" [23;19H[K[24;1H[K[25;1H[K[23;19H2L, 4C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/28[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/28" [24;19H[K[24;19H10L, 155C appended[24;19H[K[24;19H11L, 177C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/29[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/29"' -S /tmp/vbWsZ
[24;80Hd[25;1HC/28[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/29" [23;19H[K[24;1H[K[25;1H[K[23;19H3L, 8C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/30[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/30" [24;19H[K[24;19H12L, 204C appended[24;19H[K[24;19H13L, 226C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/31[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/31"' -S /tmp/vbWsZ
[24;80Hd[25;1HC/30[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/31" [23;19H[K[24;1H[K[25;1H[K[23;19H4L, 18C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/32[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/32" [24;19H[K[24;19H12L, 214C appended[24;19H[K[24;19H13L, 236C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/33[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/33"' -S /tmp/vbWsZ
[24;80Hd[25;1HC/32[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/33" [23;19H[K[24;1H[K[25;1H[K[23;19H4L, 22C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/34[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/34" [24;19H[K[24;19H12L, 211C appended[24;19H[K[24;19H13L, 233C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/35[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/35"' -S /tmp/vbWsZ
[24;80Hd[25;1HC/34[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/35" [23;19H[K[24;1H[K[25;1H[K[23;19H3L, 22C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/36[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/36" [24;19H[K[24;19H14L, 263C appended[24;19H[K[24;19H15L, 285C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/37[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/37"' -S /tmp/vbWsZ
[24;80Hd[25;1HC/36[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/37" [23;19H[K[24;1H[K[25;1H[K[23;19H4L, 34C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/38[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/38" [24;19H[K[24;19H14L, 277C appended[24;19H[K[24;19H15L, 299C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/39[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/39"' -S /tmp/vbWsZ
[24;80Hd[25;1HC/38[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/39" [23;19H[K[24;1H[K[25;1H[K[23;19H4L, 40C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  20: OK (1874575085)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/40[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/40" [25;19H[K[25;19H58L, 1022C appended[25;19H[K[25;19H59L, 1044C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/41[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/41"' -S /tmp/vbWsZ
[24;80Hd[25;1HC/40[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/41" [23;19H[K[24;1H[K[25;1H[K[23;19H9L, 56C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  21: OK (147932225)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/42[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/42" [25;19H[K[25;19H23L, 418C appended[25;19H[K[25;19H24L, 440C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/43[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/43"' -S /tmp/vbWsZ
[24;80Hd[25;1HC/42[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/43" [23;19H[K[24;1H[K[25;1H[K[23;19H1L, 2C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/44[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/44" [24;19H[K[24;19H23L, 437C appended[24;19H[K[24;19H24L, 459C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/45[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[24;80Hc[25;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/45"' -c 'breaka
[24;80Hd[25;1Hd func 2 Interrupt' -S /tmp/vbWsZdC/44[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/45" [23;19H[K[24;2H[K[25;1H[K[23;19H1L, 3C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/46[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/46" [24;19H[K[24;19H21L, 386C appended[24;19H[K[24;19H22L, 408C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/47[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/47"' -S /tmp/vbWsZ
[24;80Hd[25;1HC/46[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/47" [23;19H[K[24;1H[K[25;1H[K[23;19H1L, 5C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  22: OK (4161)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/48[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/48" [25;19H[K[25;19H25L, 432C appended[25;19H[K[25;19H26L, 454C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/49[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/49"' -S /tmp/vbWsZ
[24;80Hd[25;1HC/48[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/49" [23;19H[K[24;1H[K[25;1H[K[23;19H3L, 8C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  23: OK (49)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/50[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/50" [25;19H[K[25;19H16L, 392C appended[25;19H[K[25;19H17L, 414C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/51[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/51"' -S /tmp/vbWsZ
[24;80Hd[25;1HC/50[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/51" [23;19H[K[24;1H[K[25;1H[K[23;19H3L, 7C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  24: OK (41)
*** Test  25: OK (260177811)
*** Test  26: OK (1681500476)
*** Test  27: OK (1996459)
   function F()
1      try
2[10CXpath 1[33C" X: 1
3[10Ctry
4[14CXpath 2[29C" X: 2
5[14Creturn
6[14CXpath 4[29C" X: 0
7[10Cfinally
8[14CXpath 8[29C" X: 8
9[10Cendtry
10[9CXpath 16[32C" X: 0
11     finally
12[9CXpath 32[32C" X: 32
13     endtry
14     Xpath 64[36C" X: 0
   endfunction[10;1H"/tmp/vbWsZdC/52"[11;1H[K[12;1H[K[13;1H[K[14;1H[K[15;1H[K[16;1H[K[17;1H[K[18;1H[K[19;1H[K[20;1H[K[21;1H[K[22;1H[K[23;1H[K[24;1H[K[25;4H[K[10;19H[noeol] 17L, 552C
14 substitutions on 14 lines
E486: Pattern not found: ^\s*$"/tmp/vbWsZdC/52"[12;19H[K[12;19H14L, 502C written"test49.in" [12;13H[K[12;13H30L, 632C
   function G()
1      try
2[10CXpath 128[31C" X: 128
3[10Creturn
4[10CXpath 256[31C" X: 0
5      finally
6[10CXpath 512[31C" X: 512
7[10Ccall F()
8[10CXpath 1024[30C" X: 1024
9      endtry
10     Xpath 2048[34C" X: 0
   endfunction[13;1H"/tmp/vbWsZdC/53"[14;1H[K[15;1H[K[16;1H[K[17;1H[K[18;1H[K[19;1H[K[20;1H[K[21;1H[K[22;1H[K[23;1H[K[24;4H[K[13;19H[noeol] 13L, 406C
10 substitutions on 10 lines
E486: Pattern not found: ^\s*$"/tmp/vbWsZdC/53"[15;19H[K[15;19H10L, 378C written"test49.in" [15;13H[K[15;13H30L, 632C
   function H()
1      try
2[10CXpath 4096[30C" X: 4096
3[10Ccall G()
4[10CXpath 8192[30C" X: 8192
5      finally
6[10CXpath 16384[29C" X: 16384
7[10Creturn
8[10CXpath 32768[29C" X: 0
9      endtry
10     Xpath 65536[33C" X: 0
   endfunction[14;1H"/tmp/vbWsZdC/54"[15;1H[K[16;1H[K[17;1H[K[18;1H[K[19;1H[K[20;1H[K[21;1H[K[22;1H[K[23;1H[K[24;1H[K[25;4H[K[14;19H[noeol] 13L, 409C
10 substitutions on 10 lines
E486: Pattern not found: ^\s*$"/tmp/vbWsZdC/54"[16;19H[K[16;19H10L, 381C written"test49.in" [16;13H[K[16;13H30L, 632C
*** Test  28: OK (1996459)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/55[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[18;1H[K[18;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/55" [18;19H[K[18;19H39L, 721C appended[18;19H[K[18;19H40L, 743C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/56[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'l[21;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/56"' -S /tmp/vbWsZd[22;1HC/55[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/vbWsZdC/56" [20;19H[K[21;1H[K[22;1H[K[20;19H6L, 21C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/57[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/57" [21;19H[K[21;19H23L, 509C appended[21;19H[K[21;19H24L, 531C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/58[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'l[24;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/58"' -S /tmp/vbWsZd[25;1HC/57[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/58" [23;19H[K[24;1H[K[25;1H[K[23;19H4L, 34C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  29: OK (170428555)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/59[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/59" [25;19H[K[25;19H60L, 1101C appended[25;19H[K[25;19H61L, 1123C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/60[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nv
[24;80Hi[25;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/60"' -
[24;80Hc[25;2H'breakadd func 3 F' -c 'breakadd file 19 /tmp/vbWsZdC/59' -c 'breakadd file 31
/tmp/vbWsZdC/59' -S /tmp/vbWsZdC/59[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H"/tmp/vbWsZdC/60" [22;19H[K[23;1H[K[24;2H[K[25;1H[K[22;19H16L, 89C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [22;13H[K[22;13H30L, 632C
*** Test  30: OK (190905173)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/61[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/61" [24;19H[K[24;19H60L, 1122C appended[24;19H[K[24;19H61L, 1144C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/62[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/62"' -S /tmp/vbWsZ
[24;80Hd[25;1HC/61[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/62" [23;19H[K[24;1H[K[25;1H[K[23;19H16L, 89C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  31: OK (190905173)
*** Test  32: OK (354833067)
*** Test  33: OK (1216907538)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/63[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/63" [25;19H[K[25;19H63L, 1288C appended[25;19H[K[25;19H64L, 1310C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/64[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set vi
[24;80Hm[25;1Hinfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZ
[24;80Hd[25;1HC/64"' -c 'breakadd func 16 C' -S /tmp/vbWsZdC/63[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/64" [23;19H[K[24;1H[K[25;1H[K[23;19H17L, 127C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  34: OK (2146584868)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/65[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/65" [25;19H[K[25;19H63L, 1285C appended[25;19H[K[25;19H64L, 1307C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/66[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set vi
[24;80Hm[25;1Hinfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZ
[24;80Hd[25;1HC/66"' -c 'breakadd func 16 B' -S /tmp/vbWsZdC/65[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/66" [23;19H[K[24;1H[K[25;1H[K[23;19H17L, 127C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  35: OK (2146584868)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/67[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/67" [25;19H[K[25;19H66L, 1430C appended[25;19H[K[25;19H67L, 1452C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/68[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set vimin
[24;80Hf[25;1Ho+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/
[24;80H6[25;1H8"' -c 'breakadd func 16 R' -S /tmp/vbWsZdC/67[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/68" [23;19H[K[24;1H[K[25;1H[K[23;19H9L, 81C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  36: OK (1071644672)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/69[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/69" [25;19H[K[25;19H73L, 1488C appended[25;19H[K[25;19H74L, 1510C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/70[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/70"' -c 'breakadd
[24;80Hf[25;1Hunc 16 F' -S /tmp/vbWsZdC/69[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/70" [23;19H[K[24;1H[K[25;1H[K[23;19H9L, 81C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  37: OK (1071644672)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/71[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/71" [25;19H[K[25;19H82L, 1519C appended[25;19H[K[25;19H83L, 1541C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/72[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set vi
[24;80Hm[25;1Hinfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZ
[24;80Hd[25;1HC/72"' -c 'breakadd func 16 E' -S /tmp/vbWsZdC/71[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/72" [23;19H[K[24;1H[K[25;1H[K[23;19H8L, 63C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  38: OK (357908480)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/73[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/73" [25;19H[K[25;19H83L, 1538C appended[25;19H[K[25;19H84L, 1560C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/74[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq' | ../vim -u NONE -N -Xes -
[24;80Hc[25;2H'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVi
[24;80Hm[25;1HResult = "/tmp/vbWsZdC/74"' -c 'breakadd func 16 I' -c 'breakadd func 22 I' -S
[24;80H/[25;1Htmp/vbWsZdC/73[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H"/tmp/vbWsZdC/74" [22;19H[K[23;2H[K[24;1H[K[25;1H[K[22;19H8L, 63C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [22;13H[K[22;13H30L, 632C
*** Test  39: OK (357908480)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/75[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/75" [24;19H[K[24;19H82L, 1519C appended[24;19H[K[24;19H83L, 1541C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/76[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set vi
[24;80Hm[25;1Hinfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZ
[24;80Hd[25;1HC/76"' -c 'breakadd func 16 T' -S /tmp/vbWsZdC/75[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/76" [23;19H[K[24;1H[K[25;1H[K[23;19H8L, 63C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  40: OK (357908480)
*** Test  41: OK (3076095)
*** Test  42: OK (1505155949)
*** Test  43: OK (1157763329)
*** Test  44: OK (1031761407)
*** Test  45: OK (1157763329)
*** Test  46: OK (739407)
*** Test  47: OK (371213935)
*** Test  48: OK (756255461)
*** Test  49: OK (179000669)
   function C()
1      try
2[10CXpath 1[33C" X: 1
3[10Cthrow "arrgh"
4[10CXpath 2[33C" X: 0
5      catch /arrgh/
6[10CXpath 4[33C" X: 4
7      endtry
8      Xpath 8[37C" X: 8
   endfunction[16;1H"/tmp/vbWsZdC/77"[17;1H[K[18;1H[K[19;1H[K[20;1H[K[21;1H[K[22;1H[K[23;1H[K[24;1H[K[25;4H[K[16;19H[noeol] 11L, 334C
8 substitutions on 8 lines
E486: Pattern not found: ^\s*$"/tmp/vbWsZdC/77"[18;19H[K[18;19H8L, 295C written"test49.in" [18;13H[K[18;13H30L, 632C
   function T1()
1      XloopNEXT
2      try
3[10CXloop 1[33C" X: 16 + 16*16
4[10Cthrow "arrgh"
5[10CXloop 2[33C" X: 0
6      finally
7[10CXloop 4[33C" X: 64 + 64*16
8      endtry
9      Xloop 8[37C" X: 0
   endfunction[15;1H"/tmp/vbWsZdC/78"[16;1H[K[17;1H[K[18;1H[K[19;1H[K[20;1H[K[21;1H[K[22;1H[K[23;1H[K[24;1H[K[25;4H[K[15;19H[noeol] 12L, 364C
9 substitutions on 9 lines
E486: Pattern not found: ^\s*$"/tmp/vbWsZdC/78"[17;19H[K[17;19H9L, 323C written"test49.in" [17;13H[K[17;13H30L, 632C
   function T2()
1      try
2[10CXpath 4096[30C" X: 4096
3[10Ccall T1()
4[10CXpath 8192[30C" X: 0
5      finally
6[10CXpath 16384[29C" X: 16384
7      endtry
8      Xpath 32768[33C" X: 0
   endfunction[16;1H"/tmp/vbWsZdC/79"[17;1H[K[18;1H[K[19;1H[K[20;1H[K[21;1H[K[22;1H[K[23;1H[K[24;1H[K[25;4H[K[16;19H[noeol] 11L, 332C
8 substitutions on 8 lines
E486: Pattern not found: ^\s*$"/tmp/vbWsZdC/79"[18;19H[K[18;19H8L, 305C written"test49.in" [18;13H[K[18;13H30L, 632C
*** Test  50: OK (363550045)
*** Test  51: OK (40744667)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/81[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/81" [21;19H[K[21;19H2L, 41C appended[21;19H[K[21;19H3L, 63C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/82[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tm[24;1Hp/vbWsZdC/80' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vbWsZdC/82"' -S /tmp/vbWsZdC/81[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/82" [23;19H[K[24;1H[K[25;1H[K[23;19H1L, 2C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/80" [23;19H[K[23;19H8L, 182C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/83[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/83" [24;19H[K[24;19H7L, 115C appended[24;19H[K[24;19H8L, 137C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/84[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/80' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vbWsZdC/84"' -S /tmp/vbWsZdC/83[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/84" [23;19H[K[24;1H[K[25;1H[K[23;19H1L, 2C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/80" [23;19H[K[23;19H8L, 181C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/85[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/85" [24;19H[K[24;19H12L, 180C appended[24;19H[K[24;19H13L, 202C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/86[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/80' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vbWsZdC/86"' -S /tmp/vbWsZdC/85[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/86" [23;19H[K[24;1H[K[25;1H[K[23;19H2L, 8C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/80" [23;19H[K[23;19H10L, 209C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/87[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/87" [24;19H[K[24;19H8L, 139C appended[24;19H[K[24;19H9L, 161C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/88[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/80' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vbWsZdC/88"' -S /tmp/vbWsZdC/87[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/88" [23;19H[K[24;1H[K[25;1H[K[23;19H2L, 11C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/80" [23;19H[K[23;19H10L, 217C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/89[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/89" [24;19H[K[24;19H5L, 87C appended[24;19H[K[24;19H6L, 109C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/90[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q[34m^M[mq' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir!
[24;80H>[25;1H/tmp/vbWsZdC/80' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin =
1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/90"' -c 'breakadd file 4 /tmp/vbWsZdC
[24;80H/[25;1H89' -S /tmp/vbWsZdC/89[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H"/tmp/vbWsZdC/90" [22;19H[K[23;1H[K[24;1H[K[25;1H[K[22;19H1L, 7C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [22;13H[K[22;13H30L, 632C"/tmp/vbWsZdC/80" [22;19H[K[22;19H[noeol] 9L, 202C"test49.in" [22;13H[K[22;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/91[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H[K[23;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/91" [23;19H[K[23;19H7L, 189C appended[23;19H[K[23;19H8L, 211C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/92[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/80' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vbWsZdC/92"' -S /tmp/vbWsZdC/91[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/92" [23;19H[K[24;1H[K[25;1H[K[23;19H1L, 8C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/80" [23;19H[K[23;19H9L, 252C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/93[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/93" [24;19H[K[24;19H7L, 199C appended[24;19H[K[24;19H8L, 221C[24;19H[K[24;19H8L, 220C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/94[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/80' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vbWsZdC/94"' -S /tmp/vbWsZdC/93[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/94" [23;19H[K[24;1H[K[25;1H[K[23;19H1L, 10C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/80" [23;19H[K[23;19H9L, 214C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  52: OK (1247112011)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/96[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/96" [25;19H[K[25;19H1L, 10C appended[25;19H[K[25;19H2L, 32C[25;19H[K[25;19H2L, 31C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/97[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vbWsZdC/97"' -S /tmp/vbWsZdC/96[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/97" [23;19H[K[24;1H[K[25;1H[K[23;19H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/95" [23;19H[K[23;19H6L, 154C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/98[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/98" [24;19H[K[24;19H3L, 39C appended[24;19H[K[24;19H4L, 61C
3 substitutions on 3 lines"/tmp/vbWsZdC/98" [25;20H[K[25;19H4L, 58C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/99[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vbWsZdC/99"' -S /tmp/vbWsZdC/98[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/99" [23;19H[K[24;1H[K[25;1H[K[23;19H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/95" [23;19H[K[23;19H6L, 158C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/100[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/100" [24;20H[K[24;20H4L, 45C appended[24;20H[K[24;20H5L, 67C
4 substitutions on 4 lines"/tmp/vbWsZdC/100"[25;20H[K[25;20H5L, 63C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/101[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vbWsZdC/101"' -S /tmp/vbWsZdC/100[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/101" [23;21H[K[24;1H[K[25;1H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/95" [23;19H[K[23;19H6L, 159C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/102[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/102" [24;20H[K[24;20H3L, 33C appended[24;20H[K[24;20H4L, 55C
3 substitutions on 3 lines"/tmp/vbWsZdC/102"[25;20H[K[25;20H4L, 52C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/103[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vbWsZdC/103"' -S /tmp/vbWsZdC/102[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/103" [23;21H[K[24;1H[K[25;1H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/95" [23;19H[K[23;19H6L, 159C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/104[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/104" [24;20H[K[24;20H5L, 65C appended[24;20H[K[24;20H6L, 87C
5 substitutions on 5 lines"/tmp/vbWsZdC/104"[25;20H[K[25;20H6L, 82C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/105[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vbWsZdC/105"' -S /tmp/vbWsZdC/104[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/105" [23;21H[K[24;1H[K[25;1H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/95" [23;19H[K[23;19H6L, 159C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/106[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/106" [24;20H[K[24;20H1L, 9C appended[24;20H[K[24;20H2L, 31C[24;20H[K[24;20H2L, 30C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/107[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vbWsZdC/107"' -S /tmp/vbWsZdC/106[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/107" [23;21H[K[24;1H[K[25;1H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/95" [23;19H[K[23;19H6L, 153C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/108[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/108" [24;20H[K[24;20H3L, 38C appended[24;20H[K[24;20H4L, 60C
3 substitutions on 3 lines"/tmp/vbWsZdC/108"[25;20H[K[25;20H4L, 57C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/109[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vbWsZdC/109"' -S /tmp/vbWsZdC/108[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/109" [23;21H[K[24;1H[K[25;1H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/95" [23;19H[K[23;19H6L, 157C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/110[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/110" [24;20H[K[24;20H4L, 44C appended[24;20H[K[24;20H5L, 66C
4 substitutions on 4 lines"/tmp/vbWsZdC/110"[25;20H[K[25;20H5L, 62C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/111[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vbWsZdC/111"' -S /tmp/vbWsZdC/110[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/111" [23;21H[K[24;1H[K[25;1H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/95" [23;19H[K[23;19H6L, 157C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/112[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/112" [24;20H[K[24;20H3L, 32C appended[24;20H[K[24;20H4L, 54C
3 substitutions on 3 lines"/tmp/vbWsZdC/112"[25;20H[K[25;20H4L, 51C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/113[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vbWsZdC/113"' -S /tmp/vbWsZdC/112[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/113" [23;21H[K[24;1H[K[25;1H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/95" [23;19H[K[23;19H6L, 157C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/114[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/114" [24;20H[K[24;20H5L, 64C appended[24;20H[K[24;20H6L, 86C
5 substitutions on 5 lines"/tmp/vbWsZdC/114"[25;20H[K[25;20H6L, 81C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/115[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vbWsZdC/115"' -S /tmp/vbWsZdC/114[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/115" [23;21H[K[24;1H[K[25;1H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/95" [23;19H[K[23;19H6L, 157C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/116[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/116" [24;20H[K[24;20H1L, 11C appended[24;20H[K[24;20H2L, 33C[24;20H[K[24;20H2L, 32C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/117[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vbWsZdC/117"' -S /tmp/vbWsZdC/116[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/117" [23;21H[K[24;1H[K[25;1H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/95" [23;19H[K[23;19H6L, 157C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/118[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/118" [24;20H[K[24;20H3L, 40C appended[24;20H[K[24;20H4L, 62C
3 substitutions on 3 lines"/tmp/vbWsZdC/118"[25;20H[K[25;20H4L, 59C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/119[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vbWsZdC/119"' -S /tmp/vbWsZdC/118[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/119" [23;21H[K[24;1H[K[25;1H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/95" [23;19H[K[23;19H6L, 161C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/120[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/120" [24;20H[K[24;20H4L, 46C appended[24;20H[K[24;20H5L, 68C
4 substitutions on 4 lines"/tmp/vbWsZdC/120"[25;20H[K[25;20H5L, 64C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/121[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vbWsZdC/121"' -S /tmp/vbWsZdC/120[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/121" [23;21H[K[24;1H[K[25;1H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/95" [23;19H[K[23;19H6L, 161C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/122[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/122" [24;20H[K[24;20H3L, 34C appended[24;20H[K[24;20H4L, 56C
3 substitutions on 3 lines"/tmp/vbWsZdC/122"[25;20H[K[25;20H4L, 53C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/123[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vbWsZdC/123"' -S /tmp/vbWsZdC/122[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/123" [23;21H[K[24;1H[K[25;1H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/95" [23;19H[K[23;19H6L, 161C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/124[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/124" [24;20H[K[24;20H5L, 66C appended[24;20H[K[24;20H6L, 88C
5 substitutions on 5 lines"/tmp/vbWsZdC/124"[25;20H[K[25;20H6L, 83C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/125[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vbWsZdC/125"' -S /tmp/vbWsZdC/124[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/125" [23;21H[K[24;1H[K[25;1H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/95" [23;19H[K[23;19H6L, 161C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/126[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/126" [24;20H[K[24;20H4L, 37C appended[24;20H[K[24;20H5L, 59C
4 substitutions on 4 lines"/tmp/vbWsZdC/126"[25;20H[K[25;20H5L, 55C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/127[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vbWsZdC/127"' -S /tmp/vbWsZdC/126[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/127" [23;21H[K[24;1H[K[25;1H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/95" [23;19H[K[23;19H6L, 150C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/128[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/128" [24;20H[K[24;20H4L, 41C appended[24;20H[K[24;20H5L, 63C
4 substitutions on 4 lines"/tmp/vbWsZdC/128"[25;20H[K[25;20H5L, 59C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/129[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vbWsZdC/129"' -S /tmp/vbWsZdC/128[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/129" [23;21H[K[24;1H[K[25;1H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/95" [23;19H[K[23;19H6L, 159C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  53: OK (131071)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/131[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/131" [25;20H[K[25;20H1L, 13C appended[25;20H[K[25;20H2L, 35C[25;20H[K[25;20H2L, 34C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/132[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vbWsZdC/132"' -S /tmp/vbWsZdC/131[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/132" [23;21H[K[24;1H[K[25;2H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/130" [23;20H[K[23;20H6L, 164C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/133[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/133" [24;20H[K[24;20H3L, 36C appended[24;20H[K[24;20H4L, 58C
3 substitutions on 3 lines"/tmp/vbWsZdC/133"[25;20H[K[25;20H4L, 55C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/134[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vbWsZdC/134"' -S /tmp/vbWsZdC/133[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/134" [23;21H[K[24;1H[K[25;2H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/130" [23;20H[K[23;20H6L, 168C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/135[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/135" [24;20H[K[24;20H3L, 38C appended[24;20H[K[24;20H4L, 60C
3 substitutions on 3 lines"/tmp/vbWsZdC/135"[25;20H[K[25;20H4L, 57C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/136[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vbWsZdC/136"' -S /tmp/vbWsZdC/135[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/136" [23;21H[K[24;1H[K[25;2H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/130" [23;20H[K[23;20H6L, 154C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/137[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/137" [24;20H[K[24;20H4L, 48C appended[24;20H[K[24;20H5L, 70C
4 substitutions on 4 lines"/tmp/vbWsZdC/137"[25;20H[K[25;20H5L, 66C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/138[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vbWsZdC/138"' -S /tmp/vbWsZdC/137[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/138" [23;21H[K[24;1H[K[25;2H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/130" [23;20H[K[23;20H6L, 168C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/139[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/139" [24;20H[K[24;20H4L, 53C appended[24;20H[K[24;20H5L, 75C
4 substitutions on 4 lines"/tmp/vbWsZdC/139"[25;20H[K[25;20H5L, 71C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/140[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vbWsZdC/140"' -S /tmp/vbWsZdC/139[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/140" [23;21H[K[24;1H[K[25;2H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/130" [23;20H[K[23;20H6L, 155C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/141[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/141" [24;20H[K[24;20H5L, 62C appended[24;20H[K[24;20H6L, 84C
5 substitutions on 5 lines"/tmp/vbWsZdC/141"[25;20H[K[25;20H6L, 79C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/142[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vbWsZdC/142"' -S /tmp/vbWsZdC/141[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/142" [23;21H[K[24;1H[K[25;2H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/130" [23;20H[K[23;20H6L, 155C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/143[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/143" [24;20H[K[24;20H5L, 64C appended[24;20H[K[24;20H6L, 86C
5 substitutions on 5 lines"/tmp/vbWsZdC/143"[25;20H[K[25;20H6L, 81C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/144[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vbWsZdC/144"' -S /tmp/vbWsZdC/143[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/144" [23;21H[K[24;1H[K[25;2H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/130" [23;20H[K[23;20H6L, 154C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/145[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/145" [24;20H[K[24;20H3L, 36C appended[24;20H[K[24;20H4L, 58C
3 substitutions on 3 lines"/tmp/vbWsZdC/145"[25;20H[K[25;20H4L, 55C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/146[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vbWsZdC/146"' -S /tmp/vbWsZdC/145[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/146" [23;21H[K[24;1H[K[25;2H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/130" [23;20H[K[23;20H6L, 168C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/147[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/147" [24;20H[K[24;20H5L, 67C appended[24;20H[K[24;20H6L, 89C
5 substitutions on 5 lines"/tmp/vbWsZdC/147"[25;20H[K[25;20H6L, 84C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/148[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vbWsZdC/148"' -S /tmp/vbWsZdC/147[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/148" [23;21H[K[24;1H[K[25;2H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/130" [23;20H[K[23;20H6L, 167C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/149[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/149" [24;20H[K[24;20H5L, 68C appended[24;20H[K[24;20H6L, 90C
5 substitutions on 5 lines"/tmp/vbWsZdC/149"[25;20H[K[25;20H6L, 85C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/150[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vbWsZdC/150"' -S /tmp/vbWsZdC/149[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/150" [23;21H[K[24;1H[K[25;2H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/130" [23;20H[K[23;20H6L, 168C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/151[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/151" [24;20H[K[24;20H7L, 95C appended[24;20H[K[24;20H8L, 117C
7 substitutions on 7 lines"/tmp/vbWsZdC/151"[25;20H[K[25;20H8L, 110C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/152[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vbWsZdC/152"' -S /tmp/vbWsZdC/151[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/152" [23;21H[K[24;1H[K[25;2H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/130" [23;20H[K[23;20H6L, 167C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  54: OK (2047)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/154[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/154" [25;20H[K[25;20H1L, 13C appended[25;20H[K[25;20H2L, 35C[25;20H[K[25;20H2L, 34C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/155[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/153' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vbWsZdC/155"' -S /tmp/vbWsZdC/154[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/155" [23;21H[K[24;1H[K[25;2H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/153" [23;20H[K[23;20H6L, 172C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/156[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/156" [24;20H[K[24;20H3L, 36C appended[24;20H[K[24;20H4L, 58C
3 substitutions on 3 lines"/tmp/vbWsZdC/156"[25;20H[K[25;20H4L, 55C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/157[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/153' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vbWsZdC/157"' -S /tmp/vbWsZdC/156[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/157" [23;21H[K[24;1H[K[25;2H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/153" [23;20H[K[23;20H6L, 176C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/158[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/158" [24;20H[K[24;20H4L, 48C appended[24;20H[K[24;20H5L, 70C
4 substitutions on 4 lines"/tmp/vbWsZdC/158"[25;20H[K[25;20H5L, 66C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/159[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/153' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vbWsZdC/159"' -S /tmp/vbWsZdC/158[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/159" [23;21H[K[24;1H[K[25;2H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/153" [23;20H[K[23;20H6L, 176C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/160[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/160" [24;20H[K[24;20H3L, 36C appended[24;20H[K[24;20H4L, 58C
3 substitutions on 3 lines"/tmp/vbWsZdC/160"[25;20H[K[25;20H4L, 55C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/161[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/153' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vbWsZdC/161"' -S /tmp/vbWsZdC/160[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/161" [23;21H[K[24;1H[K[25;2H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/153" [23;20H[K[23;20H6L, 176C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/162[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/162" [24;20H[K[24;20H5L, 68C appended[24;20H[K[24;20H6L, 90C
5 substitutions on 5 lines"/tmp/vbWsZdC/162"[25;20H[K[25;20H6L, 85C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/163[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/153' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vbWsZdC/163"' -S /tmp/vbWsZdC/162[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/163" [23;21H[K[24;1H[K[25;2H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/153" [23;20H[K[23;20H6L, 176C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/164[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/164" [24;20H[K[24;20H1L, 10C appended[24;20H[K[24;20H2L, 32C[24;20H[K[24;20H2L, 31C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/165[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/153' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vbWsZdC/165"' -S /tmp/vbWsZdC/164[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/165" [23;21H[K[24;1H[K[25;2H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/153" [23;20H[K[23;20H6L, 166C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/166[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/166" [24;20H[K[24;20H3L, 33C appended[24;20H[K[24;20H4L, 55C
3 substitutions on 3 lines"/tmp/vbWsZdC/166"[25;20H[K[25;20H4L, 52C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/167[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/153' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vbWsZdC/167"' -S /tmp/vbWsZdC/166[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/167" [23;21H[K[24;1H[K[25;2H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/153" [23;20H[K[23;20H6L, 170C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/168[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/168" [24;20H[K[24;20H4L, 45C appended[24;20H[K[24;20H5L, 67C
4 substitutions on 4 lines"/tmp/vbWsZdC/168"[25;20H[K[25;20H5L, 63C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/169[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/153' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vbWsZdC/169"' -S /tmp/vbWsZdC/168[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/169" [23;21H[K[24;1H[K[25;2H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/153" [23;20H[K[23;20H6L, 170C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/170[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/170" [24;20H[K[24;20H3L, 33C appended[24;20H[K[24;20H4L, 55C
3 substitutions on 3 lines"/tmp/vbWsZdC/170"[25;20H[K[25;20H4L, 52C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/171[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/153' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vbWsZdC/171"' -S /tmp/vbWsZdC/170[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/171" [23;21H[K[24;1H[K[25;2H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/153" [23;20H[K[23;20H6L, 170C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/172[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/172" [24;20H[K[24;20H5L, 65C appended[24;20H[K[24;20H6L, 87C
5 substitutions on 5 lines"/tmp/vbWsZdC/172"[25;20H[K[25;20H6L, 82C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/173[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/153' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vbWsZdC/173"' -S /tmp/vbWsZdC/172[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/173" [23;21H[K[24;1H[K[25;2H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/153" [23;20H[K[23;20H6L, 170C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  55: OK (1023)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/175[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/175" [25;20H[K[25;20H1L, 11C appended[25;20H[K[25;20H2L, 33C[25;20H[K[25;20H2L, 32C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/176[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/174' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vbWsZdC/176"' -S /tmp/vbWsZdC/175[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/176" [23;21H[K[24;1H[K[25;2H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/174" [23;20H[K[23;20H6L, 158C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/177[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/177" [24;20H[K[24;20H3L, 34C appended[24;20H[K[24;20H4L, 56C
3 substitutions on 3 lines"/tmp/vbWsZdC/177"[25;20H[K[25;20H4L, 53C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/178[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/174' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vbWsZdC/178"' -S /tmp/vbWsZdC/177[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/178" [23;21H[K[24;1H[K[25;2H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/174" [23;20H[K[23;20H6L, 162C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/179[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/179" [24;20H[K[24;20H3L, 40C appended[24;20H[K[24;20H4L, 62C
3 substitutions on 3 lines"/tmp/vbWsZdC/179"[25;20H[K[25;20H4L, 59C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/180[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/174' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vbWsZdC/180"' -S /tmp/vbWsZdC/179[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/180" [23;21H[K[24;1H[K[25;2H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/174" [23;20H[K[23;20H6L, 162C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/181[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/181" [24;20H[K[24;20H3L, 32C appended[24;20H[K[24;20H4L, 54C
3 substitutions on 3 lines"/tmp/vbWsZdC/181"[25;20H[K[25;20H4L, 51C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/182[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/174' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vbWsZdC/182"' -S /tmp/vbWsZdC/181[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/182" [23;21H[K[24;1H[K[25;2H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/174" [23;20H[K[23;20H6L, 152C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/183[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/183" [24;20H[K[24;20H3L, 35C appended[24;20H[K[24;20H4L, 57C
3 substitutions on 3 lines"/tmp/vbWsZdC/183"[25;20H[K[25;20H4L, 54C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/184[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/174' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vbWsZdC/184"' -S /tmp/vbWsZdC/183[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/184" [23;21H[K[24;1H[K[25;2H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/174" [23;20H[K[23;20H6L, 155C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/185[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/185" [24;20H[K[24;20H4L, 44C appended[24;20H[K[24;20H5L, 66C
4 substitutions on 4 lines"/tmp/vbWsZdC/185"[25;20H[K[25;20H5L, 62C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/186[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/174' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vbWsZdC/186"' -S /tmp/vbWsZdC/185[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/186" [23;21H[K[24;1H[K[25;2H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/174" [23;20H[K[23;20H6L, 152C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/187[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/187" [24;20H[K[24;20H4L, 47C appended[24;20H[K[24;20H5L, 69C
4 substitutions on 4 lines"/tmp/vbWsZdC/187"[25;20H[K[25;20H5L, 65C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/188[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/174' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vbWsZdC/188"' -S /tmp/vbWsZdC/187[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/188" [23;21H[K[24;1H[K[25;2H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/174" [23;20H[K[23;20H6L, 155C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/189[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/189" [24;20H[K[24;20H5L, 64C appended[24;20H[K[24;20H6L, 86C
5 substitutions on 5 lines"/tmp/vbWsZdC/189"[25;20H[K[25;20H6L, 81C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/190[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/174' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vbWsZdC/190"' -S /tmp/vbWsZdC/189[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/190" [23;21H[K[24;1H[K[25;2H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/174" [23;20H[K[23;20H6L, 152C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/191[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/191" [24;20H[K[24;20H5L, 67C appended[24;20H[K[24;20H6L, 89C
5 substitutions on 5 lines"/tmp/vbWsZdC/191"[25;20H[K[25;20H6L, 84C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/192[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vbWsZdC/174' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vbWsZdC/192"' -S /tmp/vbWsZdC/191[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/192" [23;21H[K[24;1H[K[25;2H[K[23;20H0L, 0C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/tmp/vbWsZdC/174" [23;20H[K[23;20H6L, 155C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  56: OK (511)
   function FuncException()
1      let g:exception = v:exception
   endfunction[23;1H"/tmp/vbWsZdC/193" [23;20H[K[24;1H[K[25;4H[K[23;20H[noeol] 4L, 80C
E486: Pattern not found: ^\s*$"/tmp/vbWsZdC/193" [24;20H[K[24;20H1L, 36C written"test49.in" [24;13H[K[24;13H30L, 632C
   function FuncThrowpoint()
1      let g:throwpoint = v:throwpoint
   endfunction[23;1H"/tmp/vbWsZdC/194" [23;20H[K[24;1H[K[25;4H[K[23;20H[noeol] 4L, 83C
E486: Pattern not found: ^\s*$"/tmp/vbWsZdC/194" [24;20H[K[24;20H1L, 38C written"test49.in" [24;13H[K[24;13H30L, 632C
   function T(arg, line)
1      if a:line == 2
2[10Cthrow a:arg[13C" in line 2
3      elseif a:line == 4
4[10Cthrow a:arg[13C" in line 4
5      elseif a:line == 6
6[10Cthrow a:arg[13C" in line 6
7      elseif a:line == 8
8[10Cthrow a:arg[13C" in line 8
9      endif
   endfunction[15;1H"/tmp/vbWsZdC/195"[15;20H[K[16;1H[K[17;1H[K[18;1H[K[19;1H[K[20;1H[K[21;1H[K[22;1H[K[23;1H[K[24;1H[K[25;4H[K[15;20H[noeol] 12L, 341C
9 substitutions on 9 lines
8 substitutions on 8 lines
E486: Pattern not found: ^\s*$"/tmp/vbWsZdC/195" [18;20H[K[18;20H9L, 292C written"test49.in" [18;13H[K[18;13H30L, 632C
   function G(arg, line)
1      call T(a:arg, a:line)
   endfunction[19;1H"/tmp/vbWsZdC/196"[19;20H[K[20;1H[K[21;4H[K[19;20H[noeol] 4L, 69C
E486: Pattern not found: ^\s*$"/tmp/vbWsZdC/196" [20;20H[K[20;20H1L, 30C written"test49.in" [20;13H[K[20;13H30L, 632C
   function F(arg, line)
1      call G(a:arg, a:line)
   endfunction[21;1H"/tmp/vbWsZdC/197"[21;20H[K[22;1H[K[23;4H[K[21;20H[noeol] 4L, 69C
E486: Pattern not found: ^\s*$"/tmp/vbWsZdC/197" [22;20H[K[22;20H1L, 30C written"test49.in" [22;13H[K[22;13H30L, 632C
*** Test  57: OK (2147450880)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/198[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/198" [24;20H[K[24;20H87L, 1700C appended[24;20H[K[24;20H88L, 1722C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/199[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[24;80Hc[25;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/199"' -c 'break
[24;80Ha[25;1Hdd func 4 T' -S /tmp/vbWsZdC/198[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/199" [23;20H[K[24;2H[K[25;1H[K[23;20H8L, 36C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  58: OK (624945)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/200[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/200" [25;20H[K[25;20H293L, 5789C appended[25;20H[K[25;20H294L, 5811C
3 substitutions on 3 lines"/tmp/vbWsZdC/200"[25;20H[K[25;20H294L, 5808C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/201[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q[34m^M[mq[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo
[24;80H'[25;2H-c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/201"' -c 'br
[24;80He[25;1Hakadd file 115 /tmp/vbWsZdC/200' -c 'breakadd file 225 /tmp/vbWsZdC/200' -S /tm
[24;80Hp[25;1H/vbWsZdC/200[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H"/tmp/vbWsZdC/201"[22;20H[K[23;2H[K[24;1H[K[25;1H[K[22;20H28L, 162C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [22;13H[K[22;13H30L, 632C
*** Test  59: OK (2038431743)"/n/o/n/w/r/i/t/a/b/l/e/_/f/i/l/e""/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/202[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/202" [24;20H[K[24;20H33L, 765C appended[24;20H[K[24;20H34L, 787C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/203[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[24;80Hc[25;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/203"' -c 'break
[24;80Ha[25;1Hdd file 7 /tmp/vbWsZdC/202' -S /tmp/vbWsZdC/202[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/203" [23;20H[K[24;2H[K[25;1H[K[23;20H3L, 27C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  60: OK (311511339)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/204[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/204" [25;20H[K[25;20H115L, 2272C appended[25;20H[K[25;20H116L, 2294C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/205[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set vimin
[24;80Hf[25;1Ho+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/
[24;80H2[25;1H05"' -c 'breakadd file 8 /tmp/vbWsZdC/204' -c 'breakadd file 36 /tmp/vbWsZdC/20
[24;80H4[25;1H' -c 'breakadd file 40 /tmp/vbWsZdC/204' -c 'breakadd file 69 /tmp/vbWsZdC/204'
-c 'breakadd file 95 /tmp/vbWsZdC/204' -c 'breakadd file 97 /tmp/vbWsZdC/204' -
[24;80HS[25;2H/tmp/vbWsZdC/204[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/vbWsZdC/205" [20;20H[K[21;1H[K[22;1H[K[23;1H[K[24;1H[K[25;2H[K[20;20H14L, 81C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H30L, 632C
*** Test  61: OK (374889517)
   function F()
1      while 1
2      " Missing :endwhile
   endfunction[22;1H"/tmp/vbWsZdC/206"[23;1H[K[24;1H[K[25;4H[K[22;20H[noeol] 5L, 73C
E486: Pattern not found: ^\s*$"/tmp/vbWsZdC/206" [23;20H[K[23;20H2L, 40C written"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  62: OK (286331153)"/i/m/p/o/s/s/i/b/l/e" [24;24H[K[25;1H[1m[37m[41mError detected while processing /sources/vim73/src/testdir/test49.vim:[m
[33mline 6342:[m
[1m[37m[41m"/i/m/p/o/s/s/i/b/l/e" E212: Can't open file for writing[m
*** Test  63: OK (236978127)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/207[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/207" [25;20H[K[25;20H149L, 2828C appended[25;20H[K[25;20H150L, 2850C
6 substitutions on 6 lines"/tmp/vbWsZdC/207"[25;20H[K[25;20H150L, 2844C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/208[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[24;80Hc[25;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/208"' -c 'break
[24;80Ha[25;1Hdd file 63 /tmp/vbWsZdC/207' -S /tmp/vbWsZdC/207[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/208" [23;20H[K[24;2H[K[25;1H[K[23;20H16L, 97C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  64: OK (1499645335)
*** Test  65: OK (70187)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/209[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/209" [25;20H[K[25;20H78L, 1520C appended[25;20H[K[25;20H79L, 1542C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/210[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[24;80Hc[25;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/210"' -c 'break
[24;80Ha[25;1Hdd func 8 F' -S /tmp/vbWsZdC/209[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/210" [23;20H[K[24;2H[K[25;1H[K[23;20H6L, 22C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  66: OK (5464)
*** Test  67: OK (212514423)
*** Test  68: OK (212514423)
*** Test  69: OK (8995471)
*** Test  70: OK (69544277)
*** Test  71: OK (34886997)
*** Test  72: OK (1789569365)
   function F0()
   endfunction
   function F1()
   endfunction
*** Test  73: OK (9032615)"/tmp/vbWsZdC/211" [New File]"test49.in" [25;13H[K[25;13H30L, 632C"/tmp/vbWsZdC/212" [New File]"test49.in" [25;13H[K[25;13H30L, 632C
*** Test  74: OK (224907669)
*** Test  75: OK (2000403408)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/213[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/213" [25;20H[K[25;20H253L, 6369C appended[25;20H[K[25;20H254L, 6391C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/214[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|
[24;80Hs[25;1Het viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp
[24;80H/[25;1HvbWsZdC/214"' -c 'breakadd func 2 INT' -S /tmp/vbWsZdC/213[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/214" [23;20H[K[24;1H[K[25;1H[K[23;20H28L, 167C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  76: OK (1610087935)
[1m[37m[41mError detected while processing function ERR:[m
[33mline    2:[m
[1m[37m[41mE492: Not an editor command:     asdf[m
[1m[37m[41mE492: Not an editor command:     asdf[m
[1m[37m[41mE492: Not an editor command:     asdf[m
*** Test  77: OK (1388671)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/215[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/215" [25;20H[K[25;20H161L, 4543C appended[25;20H[K[25;20H162L, 4565C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/216[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/216"' -S /tmp/vbWs
[24;80HZ[25;1HdC/215[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/216" [23;21H[K[24;1H[K[25;1H[K[23;20H1L, 10C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  78: OK (134217728)
[1m[37m[41mError detected while processing function NEXT:[m
[33mline    1:[m
[1m[37m[41mE121: Undefined variable: novar[m
[1m[37m[41mE15: Invalid expression: novar | Xloop 1[m
[1m[37m[41mE121: Undefined variable: novar[m
[1m[37m[41mE488: Trailing characters[m
[1m[37m[41mE108: No such variable: "novar"[m
[1m[37m[41mE488: Trailing characters[m
[1m[37m[41mE121: Undefined variable: novar[m
[1m[37m[41mE15: Invalid expression: novar[m
[1m[37m[41mE475: Invalid argument: {novar} | Xloop 1[m
[1m[37m[41mE121: Undefined variable: novar[m
[1m[37m[41mE15: Invalid expression:  novar[m
[1m[37m[41mE475: Invalid argument: { novar} | Xloop 1[m
*** Test  79: OK (70288929)
[1m[37m[41mError detected while processing /sources/vim73/src/testdir/test49.vim:[m
[33mline 8828:[m
[1m[37m[41mE584: :elseif after :else: elseif 1 ||| 2[m
[33mline 8838:[m
[1m[37m[41mE584: :elseif after :else: elseif 1 ||| 2[m
[33mline 8846:[m
[1m[37m[41mE582: :elseif without :if: elseif 1 ||| 2[m
[33mline 8854:[m
[1m[37m[41mE582: :elseif without :if:     elseif 1 ||| 2[m
*** Test  80: OK (17895765)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/217[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/217" [25;20H[K[25;20H15L, 272C appended[25;20H[K[25;20H16L, 294C[25;20H[K[25;20H16L, 293C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/218[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/218"' -S /tmp/vbWs
[24;80HZ[25;1HdC/217[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/218" [23;21H[K[24;1H[K[25;1H[K[23;20H2L, 4C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/219[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/219" [24;20H[K[24;20H12L, 227C appended[24;20H[K[24;20H13L, 249C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/220[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[24;80Hc[25;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/220"' -c 'break
[24;80Ha[25;1Hdd file 8 /tmp/vbWsZdC/219' -S /tmp/vbWsZdC/219[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/220" [23;20H[K[24;2H[K[25;1H[K[23;20H2L, 8C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  81: OK (387)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/221[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/221" [25;20H[K[25;20H20L, 417C appended[25;20H[K[25;20H21L, 439C[25;20H[K[25;20H21L, 438C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/222[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/222"' -S /tmp/vbWs
[24;80HZ[25;1HdC/221[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/222" [23;21H[K[24;1H[K[25;1H[K[23;20H1L, 2C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/223[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/223" [24;20H[K[24;20H24L, 480C appended[24;20H[K[24;20H25L, 502C[24;20H[K[24;20H25L, 501C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/224[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/224"' -S /tmp/vbWs
[24;80HZ[25;1HdC/223[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/224" [23;21H[K[24;1H[K[25;1H[K[23;20H1L, 4C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/225[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/225" [24;20H[K[24;20H17L, 390C appended[24;20H[K[24;20H18L, 412C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/226[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[24;80Hc[25;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/226"' -c 'break
[24;80Ha[25;1Hdd file 7 /tmp/vbWsZdC/225' -S /tmp/vbWsZdC/225[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/226" [23;20H[K[24;2H[K[25;1H[K[23;20H1L, 6C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/227[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/227" [24;20H[K[24;20H21L, 444C appended[24;20H[K[24;20H22L, 466C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/228[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[24;80Hc[25;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/228"' -c 'break
[24;80Ha[25;1Hdd func 6 I' -S /tmp/vbWsZdC/227[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/228" [23;20H[K[24;2H[K[25;1H[K[23;20H1L, 8C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  82: OK (8454401)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/229[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/229" [25;20H[K[25;20H17L, 307C appended[25;20H[K[25;20H18L, 329C[25;20H[K[25;20H18L, 328C written"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/230[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/230"' -S /tmp/vbWs
[24;80HZ[25;1HdC/229[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/230" [23;21H[K[24;1H[K[25;1H[K[23;20H3L, 7C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/231[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[24;1H[K[24;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/231" [24;20H[K[24;20H14L, 266C appended[24;20H[K[24;20H15L, 288C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/232[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[24;80Hc[25;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/232"' -c 'break
[24;80Ha[25;1Hdd file 8 /tmp/vbWsZdC/231' -S /tmp/vbWsZdC/231[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/232" [23;20H[K[24;2H[K[25;1H[K[23;20H3L, 13C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  83: OK (2835)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/233[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/233" [25;20H[K[25;20H154L, 3580C appended[25;20H[K[25;20H155L, 3602C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/234[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q[34m^M[mq[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo
[24;80H'[25;2H-c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/234"' -c 'br
[24;80He[25;1Hakadd func 1 INT' -S /tmp/vbWsZdC/233[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/234"[23;20H[K[24;2H[K[25;1H[K[23;20H18L, 118C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  84: OK (934782101)
TMP"/tmp/vbWsZdC/235" [noeol] 2L, 6C[25;1H[K[25;1H/  "test49.in" 30L, 632C"/n/o/n/e/x/i/s/t/e/n/t"
"/tmp/vbWsZdC/237" 1L, 1C"test49.in" [25;13H[K[25;13H30L, 632C
:!echo XYZ >/tmp/vbWsZdC/238[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H"/tmp/vbWsZdC/239" [New File]"test49.in" [25;13H[K[25;13H30L, 632C
*** Test  85: OK (198689)"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/vbWsZdC/3' >/tmp/vbWsZdC/240[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[25;1H[K[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vbWsZdC/240" [25;20H[K[25;20H151L, 3929C appended[25;20H[K[25;20H152L, 3951C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/vbWsZdC/241[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:!echo 'q[34m^M[mq[34m^M[mq[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nvimi
[24;80Hn[25;1Hfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vbWsZdC/241"' -c
[24;80H'[25;1Hbreakadd func 5 ThrowOnInterrupt' -S /tmp/vbWsZdC/240[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[23;1H"/tmp/vbWsZdC/241" [23;21H[K[24;1H[K[25;1H[K[23;20H16L, 281C"/sources/vim73/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [23;13H[K[23;13H30L, 632C
*** Test  86: OK (50443995)
[32mPress ENTER or type command to continue[27m[m[H[2J[1;1H:so small.vim
:se nocp nomore viminfo+=nviminfo
:lang mess C
:so test49.vim
GGGGGGGGGGGGGG"rp:.-,$w! test.out
:"
:" make valgrind happy
:redir => funclist
:silent func
:redir END
:for line in split(funclist, "\n")
:  let name = matchstr(line, 'function \zs[A-Z]\w*\ze(')
:  if name != ''
:    exe "delfunc " . name
:  endif
:endfor
:for v in keys(g:)
:  silent! exe "unlet " . v
:endfor
:unlet v
:qa!
ENDTEST

Results of test49.vim:[23;1H[?12l[?25h
[?25l
91 more lines[1;24r[24;1H
[1;25r[24;1H*** Test   1: OK (34695)[25;1H[K[25;1H91 more lines[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.-,$w! test.out[?25l"test.out" [25;12H[K[25;12H[New] 92L, 2672C written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" make valgrind happy[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hredir => funclist[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hsilent func[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hredir END[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfor line in split(funclist, "\n")[?25l
:  [?12l[?25h:  let name = matchstr(line, 'function \zs[A-Z]\w*\ze(')
[?25l:  [?12l[?25h:  if name != ''
[?25l:    [?12l[?25h:    exe "delfunc " . name
[?25l:    [?12l[?25h:  endif
[?25l:  [?12l[?25h:endfor[1;1H[5L[?25l[1;1H:se nocp nomore viminfo+=nviminfo
:lang mess C
:so test49.vim
GGGGGGGGGGGGGG"rp:.-,$w! test.out
:"[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hfor v in keys(g:)[?25l
:  [?12l[?25h:  silent! exe "unlet " . v
[?25l:  [?12l[?25h:endfor[1;1H[2L[?25l[1;1H:se nocp nomore viminfo+=nviminfo
:lang mess C[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hunlet v[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[?1l>[?12l[?25h[?1049l
rm -rf X* test.ok viminfo
rm -rf test51.failed test.ok test.out X* viminfo
cp test51.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test51.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test51.in" 36 lines, 808 characters[1;1HTests for ":highlight". vim: set ft=vim :

STARTTEST
:so small.vim
:" basic test if ":highlight" doesn't crash
:highlight
:hi Search
:" test setting colors.
:" test clearing one color and all doesn't generate error or warning
:hi NewGroup term=bold cterm=italic ctermfg=DarkBlue ctermbg=Grey gui= guifg=#000[11;1Hff00 guibg=Cyan
:hi Group2 term= cterm=
:hi Group3 term=underline cterm=bold
:redir! >test.out
:hi NewGroup
:hi Group2
:hi Group3
:hi clear NewGroup
:hi NewGroup
:hi Group2
:hi Group2 NONE
:hi Group2
:hi clear
:hi Group3[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for ":highlight". vim: set ft=vim :[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 31 lines, 746 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[12M[1;25r[13;1H:hi Crash term='asdf
:redir END
:" filter ctermfg and ctermbg, the numbers depend on the terminal
:e test.out
:%s/ctermfg=\d*/ctermfg=2/
:%s/ctermbg=\d*/ctermbg=3/
:" filter out possibly translated error message
:%s/E475: [^:]*:/E475:/
:" fix the fileformat
:set ff&
:wq!
ENDTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" basic test if ":highlight" doesn't crash[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hhighlight[?25l
SpecialKey     [34mxxx[m [34mterm=[mbold [34mctermfg=[m4 [34mguifg=[mBlue
NonText[8C[1m[34mxxx[m [34mterm=[mbold [34mcterm=[mbold [34mctermfg=[m4 [34mgui=[mbold [34mguifg=[mBlue
Directory      [34mxxx[m [34mterm=[mbold [34mctermfg=[m4 [34mguifg=[mBlue
ErrorMsg[7C[1m[37m[41mxxx[m [34mterm=[mstandout [34mcterm=[mbold [34mctermfg=[m7 [34mctermbg=[m1 [34mguifg=[mWhite
[19C[34mguibg=[mRed
IncSearch      [7mxxx[m [34mterm=[mreverse [34mcterm=[mreverse [34mgui=[mreverse
Search[9C[30m[43mxxx[m [34mterm=[mreverse [34mctermfg=[m0 [34mctermbg=[m3 [34mguibg=[mYellow
MoreMsg[8C[32mxxx[m [34mterm=[mbold [34mctermfg=[m2 [34mgui=[mbold [34mguifg=[mSeaGreen
ModeMsg[8C[1mxxx[m [34mterm=[mbold [34mcterm=[mbold [34mgui=[mbold
LineNr[9C[33mxxx[m [34mterm=[munderline [34mctermfg=[m3 [34mguifg=[mBrown
Question[7C[32mxxx[m [34mterm=[mstandout [34mctermfg=[m2 [34mgui=[mbold [34mguifg=[mSeaGreen
StatusLine     [1m[7mxxx[m [34mterm=[mbold,reverse [34mcterm=[mbold,reverse [34mgui=[mbold,reverse
StatusLineNC   [7mxxx[m [34mterm=[mreverse [34mcterm=[mreverse [34mgui=[mreverse
VertSplit      [7mxxx[m [34mterm=[mreverse [34mcterm=[mreverse [34mgui=[mreverse
Title[10C[35mxxx[m [34mterm=[mbold [34mctermfg=[m5 [34mgui=[mbold [34mguifg=[mMagenta
Visual[9C[7mxxx[m [34mterm=[mreverse [34mcterm=[mreverse [34mguibg=[mLightGrey
VisualNOS      xxx cleared
WarningMsg     [31mxxx[m [34mterm=[mstandout [34mctermfg=[m1 [34mguifg=[mRed
WildMenu[7C[30m[43mxxx[m [34mterm=[mstandout [34mctermfg=[m0 [34mctermbg=[m3 [34mguifg=[mBlack [34mguibg=[mYellow
Folded[9C[34m[47mxxx[m [34mterm=[mstandout [34mctermfg=[m4 [34mctermbg=[m7 [34mguifg=[mDarkBlue
[19C[34mguibg=[mLightGrey
FoldColumn     [34m[47mxxx[m [34mterm=[mstandout [34mctermfg=[m4 [34mctermbg=[m7 [34mguifg=[mDarkBlue [34mguibg=[mGrey
DiffAdd[8C[44mxxx[m [34mterm=[mbold [34mctermbg=[m4 [34mguibg=[mLightBlue
DiffChange     [45mxxx[m [34mterm=[mbold [34mctermbg=[m5 [34mguibg=[mLightMagenta
DiffDelete     [1m[34m[46mxxx[m [34mterm=[mbold [34mcterm=[mbold [34mctermfg=[m4 [34mctermbg=[m6 [34mgui=[mbold [34mguifg=[mBlue
[19C[34mguibg=[mLightCyan
DiffText[7C[1m[41mxxx[m [34mterm=[mreverse [34mcterm=[mbold [34mctermbg=[m1 [34mgui=[mbold [34mguibg=[mRed
SignColumn     [34m[47mxxx[m [34mterm=[mstandout [34mctermfg=[m4 [34mctermbg=[m7 [34mguifg=[mDarkBlue [34mguibg=[mGrey
Conceal[8Cxxx cleared
SpellBad[7C[41mxxx[m [34mterm=[mreverse [34mctermbg=[m1 [34mgui=[mundercurl [34mguisp=[mRed
SpellCap[7C[44mxxx[m [34mterm=[mreverse [34mctermbg=[m4 [34mgui=[mundercurl [34mguisp=[mBlue
SpellRare      [45mxxx[m [34mterm=[mreverse [34mctermbg=[m5 [34mgui=[mundercurl [34mguisp=[mMagenta
SpellLocal     [46mxxx[m [34mterm=[munderline [34mctermbg=[m6 [34mgui=[mundercurl [34mguisp=[mDarkCyan
Pmenu[10C[45mxxx[m [34mctermbg=[m5 [34mguibg=[mLightMagenta
PmenuSel[7C[47mxxx[m [34mctermbg=[m7 [34mguibg=[mGrey
PmenuSbar      [47mxxx[m [34mctermbg=[m7 [34mguibg=[mGrey
PmenuThumb     [7mxxx[m [34mcterm=[mreverse [34mgui=[mreverse
TabLine[8C[4m[30m[47mxxx[m [34mterm=[munderline [34mcterm=[munderline [34mctermfg=[m0 [34mctermbg=[m7
[19C[34mgui=[munderline [34mguibg=[mLightGrey
TabLineSel     [1mxxx[m [34mterm=[mbold [34mcterm=[mbold [34mgui=[mbold
TabLineFill    [7mxxx[m [34mterm=[mreverse [34mcterm=[mreverse [34mgui=[mreverse
CursorColumn   [47mxxx[m [34mterm=[mreverse [34mctermbg=[m7 [34mguibg=[mGrey90
CursorLine     [4mxxx[m [34mterm=[munderline [34mcterm=[munderline [34mguibg=[mGrey90
ColorColumn    [41mxxx[m [34mterm=[mreverse [34mctermbg=[m1 [34mguibg=[mLightRed
MatchParen     [46mxxx[m [34mterm=[mreverse [34mctermbg=[m6 [34mguibg=[mCyan
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hhi Search[?25l
Search[9C[30m[43mxxx[m [34mterm=[mreverse [34mctermfg=[m0 [34mctermbg=[m3 [34mguibg=[mYellow
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h" test setting colors.[?25l[27m[m[H[2J[1;1H:redir! >test.out
:hi NewGroup
:hi Group2
:hi Group3
:hi clear NewGroup
:hi NewGroup
:hi Group2
:hi Group2 NONE
:hi Group2
:hi clear
:hi Group3
:hi Crash term='asdf
:redir END
:" filter ctermfg and ctermbg, the numbers depend on the terminal
:e test.out
:%s/ctermfg=\d*/ctermfg=2/
:%s/ctermbg=\d*/ctermbg=3/
:" filter out possibly translated error message
:%s/E475: [^:]*:/E475:/
:" fix the fileformat
:set ff&
:wq!
ENDTEST
[?12l[?25h[?25l
:[?12l[?25h" test clearing one color and all doesn't generate error or warning[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hhi NewGroup term=bold cterm=italic ctermfg=DarkBlue ctermbg=Grey gui= guifg=#0
[24;80H0[25;1Hff00 guibg=Cyan[?25l[24;1H[1m[37m[41mE418: Illegal value: guifg=#00ff00[m[24;35H[K[25;1H[K[25;1H[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hhi Group2 term= cterm=[?25l[1m[37m[41mE418: Illegal value: cterm=[m
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hhi Group3 term=underline cterm=bold[?25l[1;1H[2L[1;1H:redir! >test.out
:hi NewGroup[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hredir! >test.out[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hhi NewGroup[?25l
NewGroup[7C[7m[34m[47mxxx[m [34mterm=[mbold [34mcterm=[mitalic [34mctermfg=[m4 [34mctermbg=[m7
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hhi Group2[?25l
Group2[9Cxxx cleared
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hhi Group3[?25l
Group3[9C[1mxxx[m [34mterm=[munderline [34mcterm=[mbold
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hhi clear NewGroup[?25l[1;1H[6L[1;1H:redir! >test.out
:hi NewGroup
:hi Group2
:hi Group3
:hi clear NewGroup
:hi NewGroup[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hhi NewGroup[?25l
NewGroup[7Cxxx cleared
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hhi Group2[?25l
Group2[9Cxxx cleared
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hhi Group2 NONE[?25l[1;1H[4L[1;1H:redir! >test.out
:hi NewGroup
:hi Group2
:hi Group3[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hhi Group2[?25l
Group2[9Cxxx cleared
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hhi clear[?25l[27m[m[H[2J[1;1H:redir! >test.out
:hi NewGroup
:hi Group2
:hi Group3
:hi clear NewGroup
:hi NewGroup
:hi Group2
:hi Group2 NONE
:hi Group2
:hi clear
:hi Group3
:hi Crash term='asdf
:redir END
:" filter ctermfg and ctermbg, the numbers depend on the terminal
:e test.out
:%s/ctermfg=\d*/ctermfg=2/
:%s/ctermbg=\d*/ctermbg=3/
:" filter out possibly translated error message
:%s/E475: [^:]*:/E475:/
:" fix the fileformat
:set ff&
:wq!
ENDTEST
[?12l[?25h[?25l
:[?12l[?25hhi Group3[?25l
Group3[9Cxxx cleared
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hhi Crash term='asdf[?25l[1m[37m[41mE475: Invalid argument: term='asdf[m
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hredir END[?25l[1;1H[3L[1;1H:redir! >test.out
:hi NewGroup
:hi Group2[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h" filter ctermfg and ctermbg, the numbers depend on the terminal[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he test.out[?25l"test.out" 20 lines, 289 characters[1;1H[K[2;1H[K[3;1HNewGroup       xxx term=bold cterm=italic ctermfg=4 ctermbg=7[4;1H[K[5;1HGroup2         xxx cleared[6;1H[K[7;1HGroup3         xxx term=underline cterm=bold[8;1H[K[9;1H[K[10;1HNewGroup       xxx cleared[11;1H[K[12;1HGroup2         xxx cleared[13;1H[K[14;1H[K[15;1HGroup2         xxx cleared[16;1H[K[17;1H[K[18;1HGroup3         xxx cleared[18;27H[K[19;1H[K[20;1HE475: Invalid argument: term='asdf
[1m[34m~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h%s/ctermfg=\d*/ctermfg=2/[?25l[3;51H2[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h%s/ctermbg=\d*/ctermbg=3/[?25l[3;61H3[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" filter out possibly translated error message[?25l[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h%s/E475: [^:]*:/E475:/[?25l[20;7Hterm='asdf[20;17H[K[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" fix the fileformat[?25l[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset ff&[?25l[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hwq![?25l"test.out" 20 lines, 271 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test52.failed test.ok test.out X* viminfo
cp test52.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test52.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test52.in" 65 lines, 1645 characters[1;1HTests for reading and writing files with conversion for Win32.

STARTTEST
:so mbyte.vim
:" make this a dummy test for non-Win32 systems
:if !has("win32") | e! test.ok | wq! test.out | endif
:"
:" write tests:
:" combine three values for 'encoding' with three values for 'fileencoding'
:" also write files for read tests
/^1
:set encoding=utf-8
:.w! ++enc=utf-8 test.out
:.w ++enc=cp1251 >>test.out
:.w ++enc=cp866 >>test.out
:.w! ++enc=utf-8 Xutf8
/^2
:set encoding=cp1251
:.w ++enc=utf-8 >>test.out
:.w ++enc=cp1251 >>test.out
:.w ++enc=cp866 >>test.out
:.w! ++enc=cp1251 Xcp1251
/^3
:set encoding=cp866[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for reading and writing files with conversion for Win32.[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 57 lines, 1333 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;1H:.w ++enc=cp1251 >>test.out
:e Xcp1251
:.w ++enc=cp1251 >>test.out
:set fencs=utf-8,cp866
:e Xcp866
:.w ++enc=cp1251 >>test.out
:"
:" read three 'fileencoding's with cp866 'encoding'
:set encoding=cp866 fencs=utf-8,cp1251
:e Xutf8
:.w ++enc=cp866 >>test.out
:e Xcp1251
:.w ++enc=cp866 >>test.out
:set fencs=utf-8,cp866
:e Xcp866
:.w ++enc=cp866 >>test.out
:"
:qa!
ENDTEST

1 utf-8 text: [34m~T[mл[34m~O[m Vim version 6.2.  [34m~_[mо[34m~A[mледнее изменение[22;1H: 1970 Jan 01
2 cp1251 text:  Vim version 6.2.   : 1970 Jan 01
3 cp866 text: [34m~D[m Vim version 6.2.  [34m~O[m᫥ : 1970 Jan 01[19;1H[?12l[?25h
[?25l[25;1H:so! Xdotest[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso mbyte.vim[?25l[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" make this a dummy test for non-Win32 systems[?25l[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hif !has("win32") | e! test.ok | wq! test.out | endif[?25l"test.ok" [25;11H[K[25;11H18 lines, 1374 characters
"test.out" [New File] 18 lines, 1374 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test53.failed test.ok test.out X* viminfo
cp test53.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test53.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test53.in" 48 lines, 952 characters[1;1HTests for string and html text objects. vim: set ft=vim :

Note that the end-of-line moves the cursor to the next test line.

Also test match() and matchstr()

STARTTEST
:so small.vim
/^start:/
da"
0va'a'rx
02f`da`
0fXdi"
03f'vi'ry
:set quoteescape=+*-
di`
$F"va"oha"i"rz
:"
/^<begin
jfXdit
0fXdit
fXdat
0fXdat
:"[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for string and html text objects. vim: set ft=vim :[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[7;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[8;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 24 lines, 461 characters written[8;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[8;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[8M[1;25r[17;1H:put =matchstr(\"abcd\", \".\", 0, 2) " b
:put =matchstr(\"abcd\", \"..\", 0, 2) " bc
:put =matchstr(\"abcd\", \".\", 2, 0) " c (zero and negative -> first match)
:put =matchstr(\"abcd\", \".\", 0, -1) " a
:put =match(\"abcd\", \".\", 0, 5) " -1
:put =match(\"abcd\", \".\", 0, -1) " 0
:/^start:/,/^end:/wq! test.out
ENDTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^start:/[?25l[25;9H[K[25;1H[1;24r[24;1H
[1;25r[24;1Hstart: "wo\"rd\\" foo[25;1H[K[24;1H[?12l[?25h[?25l[7Cfo[24;11H[K[24;8H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H'foo' 'bar' 'piep'[24;8H[?12l[?25h[?25l[?12l[?25h[?25l[7m'foo'[?12l[?25h[?25l 'bar'[?12l[?25h[?25l[mxxxxxxxxxxxx[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hbla bla `quote` blah[?12l[?25h[14C[?25lblah[24;13H[K[24;9H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hout " in "noXno"[24;9H[?12l[?25h[12C[?25l"[24;12H[K[24;11H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H"'" 'blah' rep 'buh'[24;11H[?12l[?25h[9C[?25l[?12l[?25h[?25l'[7m rep[?12l[?25h[?25l[myyyyy[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hbla `s*`d-`+++`l**` b`la[24;11H[?12l[?25h[?25l
:[?12l[?25hset quoteescape=+*-[?25l[24;11H[?12l[?25h[?25l` b`la[24;12H[K[24;6H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hvoo "nah" sdf " asdf" sdf " sdf" sd[25;1H[K[24;6H[?12l[?25h[29C[?25l[?12l[?25h[?25l[7m" sdf"[?12l[?25h[?25l[m"[5C[7m [24;27H[?12l[?25h[?25l"[?12l[?25h[?25l[24;16H asdf" sdf [24;15H[?12l[?25h[?25l[24;7Hah" sdf "[mvoo "[?12l[?25h[?25lzzzzzzzzzzzzzzzzzzzzzzzzzzzzvoo "[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H[?12l[?25h[?25l
:[?12l[?25h"[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^<begin[?25l[1;24r[24;1H
[1;25r[24;1H<begin>[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H-<b>asdf<i>Xasdf</i>asdf</b>-[?12l[?25h[11C[?25l</i>asdf</b>-[24;25H[K[24;12H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H-<b>asdX<i>a<i />sdf</i>asdf</b>-[24;12H[?12l[?25h[7C[?25l</b>-[24;10H[K[24;5H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H-<b>asdf<i>Xasdf</i>asdf</b>--<b>[?12l[?25h[7C[?25lasdf</b>-[24;18H[K[24;9H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H-<b>asdX<i>as<b />df</i>asdf</b>-[24;9H[?12l[?25h[7C[?25l--[24;3H[K[24;2H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H</begin><[?12l[?25h[?25l
:[?12l[?25h"[?25l[24;2H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hput =matchstr(\"abcd\", \".\", 0, 2) " b[?25l[1;24r[24;1H
[1;25r[24;1Hb[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hput =matchstr(\"abcd\", \"..\", 0, 2) " bc[?25l[1;24r[24;1H
[1;25r[24;1Hbc[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hput =matchstr(\"abcd\", \".\", 2, 0) " c (zero and negative -> first match)[?25l[1;24r[24;1H
[1;25r[24;1Hc[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hput =matchstr(\"abcd\", \".\", 0, -1) " a[?25l[1;24r[24;1H
[1;25r[24;1Ha[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hput =match(\"abcd\", \".\", 0, 5) " -1[?25l[1;24r[24;1H
[1;25r[24;1H-1[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hput =match(\"abcd\", \".\", 0, -1) " 0[?25l[1;24r[24;1H
[1;25r[24;1H0[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h/^start:/,/^end:/wq! test.out[?25l[31msearch hit BOTTOM, continuing at TOP[m"test.out" [25;12H[K[25;12H[New File] 21 lines, 217 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test54.failed test.ok test.out X* viminfo
cp test54.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test54.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test54.in" 22 lines, 658 characters[1;1HSome tests for buffer-local autocommands

STARTTEST
:so small.vim
:e xx
:if has("vms")
: !del test.out.*
: au BufLeave <buffer> :!write sys$output "buffer-local autommand in %" > test.oo[9;1Hut
:else
: !rm -f test.out
: au BufLeave <buffer> :!echo buffer-local autommand in %>> test.out
:endif
:e somefile[11C" here, autocommand for xx shall write test.out
:[21C" but autocommand shall not apply to buffer named <buffer>[16;1H:bwipe xx[13C" here, autocommand shall be auto-deleted
:e xx[17C" nothing shall be written
:e somefile[11C" nothing shall be written
:qa!
ENDTEST

start of test file xx
end of test file xx
[1m[34m~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HSome tests for buffer-local autocommands[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 15 lines, 555 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[20;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[21;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[21;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he xx[?25l"xx" [New File][1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hif has("vms")[?25l
:  [?12l[?25h: !del test.out.*
[?25l:  [?12l[?25h: au BufLeave <buffer> :!write sys$output "buffer-local autommand in %" > te
[24;80Hs[25;1Ht.out
[?25l:  [?12l[?25h:else
[?25l:  [?12l[?25h: !rm -f test.out
[?25l:!rm -f test.out[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[25;1H
[?25l:  :[?12l[?25h au BufLeave <buffer> :!echo buffer-local autommand in %>> test.out
[?25l:  [?12l[?25h:endif[?25l[25;1H[K[25;1H:[?12l[?25he somefile           " here, autocommand for xx shall write test.out [?25l:!echo buffer-local autommand in xx>> test.out[25;47H[K[25;47H
[?12l[?25h[?25l[m"somefile" [New File]
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h                     " but autocommand shall not apply to buffer named <buffer
[24;80H>[25;1H[?25l[27m[m[H[2J[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[25;1H[m:[?12l[?25hbwipe xx             " here, autocommand shall be auto-deleted[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he xx                 " nothing shall be written[?25l"xx" [New File][25;23H[K[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he somefile           " nothing shall be written[?25l"somefile" [New File][25;23H[K[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[?1l>[?12l[?25h[?1049l
rm -rf X* test.ok viminfo
rm -rf test55.failed test.ok test.out X* viminfo
cp test55.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test55.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test55.in" 355 lines, 7272 characters[1;1HTests for List and Dictionary types.     vim: set ft=vim :

STARTTEST
:so small.vim
:fun Test(...)
:" Creating List directly with different types
:let l = [1, 'as''d', [1, 2, function("strlen")], {'a': 1},]
:$put =string(l)
:$put =string(l[-1])
:$put =string(l[-4])
:try
:  $put =string(l[-5])
:catch
:  $put =v:exception[:14]
:endtry
:" List slices
:$put =string(l[:])
:$put =string(l[1:])
:$put =string(l[:-2])
:$put =string(l[0:8])
:$put =string(l[8:-1])
:"
:" List identity
:let ll = l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for List and Dictionary types.     vim: set ft=vim :[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 349 lines, 7186 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;1H:$put =string(split(':aa::bb:', ':', 1))
:$put =string(split('aa,,bb, cc,', ',\s*', 1))
:$put =string(split('abc', '\zs'))
:$put =string(split('abc', '\zs', 1))
:"
:" compare recursively linked list and dict
:let l = [1, 2, 3, 4]
:let d = {'1': 1, '2': l, '3': 3}
:let l[1] = d
:$put =(l == l)
:$put =(d == d)
:$put =(l != deepcopy(l))
:$put =(d != deepcopy(d))
:endfun
:call Test(1, 2, [3, 4], {5: 6})  " This may take a while
:"
:delfunc Test
:unlet dict
:call garbagecollect(1)
:"
:/^start:/,$wq! test.out
ENDTEST

start:[22;1H[?12l[?25h
[?25l

:so! Xdotest[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfun Test(...)[?25l
:  [?12l[?25h:" Creating List directly with different types
[?25l:  [?12l[?25h:let l = [1, 'as''d', [1, 2, function("strlen")], {'a': 1},]
[?25l:  [?12l[?25h:$put =string(l)
[?25l:  [?12l[?25h:$put =string(l[-1])
[?25l:  [?12l[?25h:$put =string(l[-4])
[?25l:  [?12l[?25h:try
[?25l:    [?12l[?25h:  $put =string(l[-5])
[?25l:    [?12l[?25h:catch
[?25l:    [?12l[?25h:  $put =v:exception[:14]
[?25l:    [?12l[?25h:endtry
[?25l:  [?12l[?25h:" List slices
[?25l:  [?12l[?25h:$put =string(l[:])
[?25l:  [?12l[?25h:$put =string(l[1:])
[?25l:  [?12l[?25h:$put =string(l[:-2])
[?25l:  [?12l[?25h:$put =string(l[0:8])
[?25l:  [?12l[?25h:$put =string(l[8:-1])
[?25l:  [?12l[?25h:"
[?25l:  [?12l[?25h:" List identity
[?25l:  [?12l[?25h:let ll = l
[?25l:  [?12l[?25h:let lx = copy(l)
[?25l:  [?12l[?25h:try
[?25l:    [?12l[?25h:  $put =(l == ll) . (l isnot ll) . (l is ll) . (l == lx) . (l is lx) . (l
isnot lx)
[?25l:    [?12l[?25h:catch
[?25l:    [?12l[?25h:  $put =v:exception
[?25l:    [?12l[?25h:endtry
[?25l:  [?12l[?25h:"
[?25l:  [?12l[?25h:" Creating Dictionary directly with different types
[?25l:  [?12l[?25h:let d = {001: 'asd', 'b': [1, 2, function('strlen')], -1: {'a': 1},}
[?25l:  [?12l[?25h:$put =string(d) . d.1
[?25l:  [?12l[?25h:$put =string(sort(keys(d)))
[?25l:  [?12l[?25h:$put =string (values(d))
[?25l:  [?12l[?25h:for [key, val] in items(d)
[?25l:    [?12l[?25h:  $put =key . ':' . string(val)
[?25l:    [?12l[?25h:  unlet key val
[?25l:    [?12l[?25h:endfor
[?25l:  [?12l[?25h:call extend  (d, {3:33, 1:99})
[?25l:  [?12l[?25h:call extend(d, {'b':'bbb', 'c':'ccc'}, "keep")
[?25l:  [?12l[?25h:try
[?25l:    [?12l[?25h:  call extend(d, {3:333,4:444}, "error")
[?25l:    [?12l[?25h:catch
[?25l:    [?12l[?25h:  $put =v:exception[:15] . v:exception[-1:-1]
[?25l:    [?12l[?25h:endtry
[?25l:  [?12l[?25h:$put =string(d)
[?25l:  [?12l[?25h:call filter(d, 'v:key =~ ''[ac391]''')
[?25l:  [?12l[?25h:$put =string(d)
[?25l:  [?12l[?25h:"
[?25l:  [?12l[?25h:" Dictionary identity
[?25l:  [?12l[?25h:let dd = d
[?25l:  [?12l[?25h:let dx = copy(d)
[?25l:  [?12l[?25h:try
[?25l:    [?12l[?25h:  $put =(d == dd) . (d isnot dd) . (d is dd) . (d == dx) . (d is dx) . (d
isnot dx)
[?25l:    [?12l[?25h:catch
[?25l:    [?12l[?25h:  $put =v:exception
[?25l:    [?12l[?25h:endtry
[?25l:  [?12l[?25h:"
[?25l:  [?12l[?25h:" Changing var type should fail
[?25l:  [?12l[?25h:try
[?25l:    [?12l[?25h:  let d = []
[?25l:    [?12l[?25h:catch
[?25l:    [?12l[?25h:  $put =v:exception[:14] . v:exception[-1:-1]
[?25l:    [?12l[?25h:endtry
[?25l:  [?12l[?25h:try
[?25l:    [?12l[?25h:  let l = {}
[?25l:    [?12l[?25h:catch
[?25l:    [?12l[?25h:  $put =v:exception[:14] . v:exception[-1:-1]
[?25l:    [?12l[?25h:endtry
[?25l:  [?12l[?25h:"
[?25l:  [?12l[?25h:" removing items with :unlet
[?25l:  [?12l[?25h:unlet l[2]
[?25l:  [?12l[?25h:$put =string(l)
[?25l:  [?12l[?25h:let l = range(8)
[?25l:  [?12l[?25h:try
[?25l:    [?12l[?25h:unlet l[:3]
[?25l:    [?12l[?25h:unlet l[1:]
[?25l:    [?12l[?25h:catch
[?25l:    [?12l[?25h:$put =v:exception
[?25l:    [?12l[?25h:endtry
[?25l:  [?12l[?25h:$put =string(l)
[?25l:  [?12l[?25h:"
[?25l:  [?12l[?25h:unlet d.c
[?25l:  [?12l[?25h:unlet d[-1]
[?25l:  [?12l[?25h:$put =string(d)
[?25l:  [?12l[?25h:"
[?25l:  [?12l[?25h:" removing items out of range: silently skip items that don't exist
[?25l:  [?12l[?25hlet l = [0, 1, 2, 3]
[?25l:  [?12l[?25h:unlet l[2:1]
[?25l:  [?12l[?25h:$put =string(l)
[?25l:  [?12l[?25hlet l = [0, 1, 2, 3]
[?25l:  [?12l[?25h:unlet l[2:2]
[?25l:  [?12l[?25h:$put =string(l)
[?25l:  [?12l[?25hlet l = [0, 1, 2, 3]
[?25l:  [?12l[?25h:unlet l[2:3]
[?25l:  [?12l[?25h:$put =string(l)
[?25l:  [?12l[?25hlet l = [0, 1, 2, 3]
[?25l:  [?12l[?25h:unlet l[2:4]
[?25l:  [?12l[?25h:$put =string(l)
[?25l:  [?12l[?25hlet l = [0, 1, 2, 3]
[?25l:  [?12l[?25h:unlet l[2:5]
[?25l:  [?12l[?25h:$put =string(l)
[?25l:  [?12l[?25hlet l = [0, 1, 2, 3]
[?25l:  [?12l[?25h:unlet l[-1:2]
[?25l:  [?12l[?25h:$put =string(l)
[?25l:  [?12l[?25hlet l = [0, 1, 2, 3]
[?25l:  [?12l[?25h:unlet l[-2:2]
[?25l:  [?12l[?25h:$put =string(l)
[?25l:  [?12l[?25hlet l = [0, 1, 2, 3]
[?25l:  [?12l[?25h:unlet l[-3:2]
[?25l:  [?12l[?25h:$put =string(l)
[?25l:  [?12l[?25hlet l = [0, 1, 2, 3]
[?25l:  [?12l[?25h:unlet l[-4:2]
[?25l:  [?12l[?25h:$put =string(l)
[?25l:  [?12l[?25hlet l = [0, 1, 2, 3]
[?25l:  [?12l[?25h:unlet l[-5:2]
[?25l:  [?12l[?25h:$put =string(l)
[?25l:  [?12l[?25hlet l = [0, 1, 2, 3]
[?25l:  [?12l[?25h:unlet l[-6:2]
[?25l:  [?12l[?25h:$put =string(l)
[?25l:  [?12l[?25h:"
[?25l:  [?12l[?25h:" assignment to a list
[?25l:  [?12l[?25h:let l = [0, 1, 2, 3]
[?25l:  [?12l[?25h:let [va, vb] = l[2:3]
[?25l:  [?12l[?25h:$put =va
[?25l:  [?12l[?25h:$put =vb
[?25l:  [?12l[?25h:try
[?25l:    [?12l[?25h:  let [va, vb] = l
[?25l:    [?12l[?25h:catch
[?25l:    [?12l[?25h:  $put =v:exception[:14]
[?25l:    [?12l[?25h:endtry
[?25l:  [?12l[?25h:try
[?25l:    [?12l[?25h:  let [va, vb] = l[1:1]
[?25l:    [?12l[?25h:catch
[?25l:    [?12l[?25h:  $put =v:exception[:14]
[?25l:    [?12l[?25h:endtry
[?25l:  [?12l[?25h:"
[?25l:  [?12l[?25h:" manipulating a big Dictionary (hashtable.c has a border of 1000 entries)
[?25l:  [?12l[?25h:let d = {}
[?25l:  [?12l[?25h:for i in range(1500)
[?25l:    [?12l[?25h: let d[i] = 3000 - i
[?25l:    [?12l[?25h:endfor
[?25l:  [?12l[?25h:$put =d[0] . ' ' . d[100] . ' ' . d[999] . ' ' . d[1400] . ' ' . d[1499]
[?25l:  [?12l[?25h:try
[?25l:    [?12l[?25h:  let n = d[1500]
[?25l:    [?12l[?25h:catch
[?25l:    [?12l[?25h:  $put =substitute(v:exception, '\v(.{14}).*( \d{4}).*', '\1\2', '')
[?25l:    [?12l[?25h:endtry
[?25l:  [?12l[?25h:" lookup each items
[?25l:  [?12l[?25h:for i in range(1500)
[?25l:    [?12l[?25h: if d[i] != 3000 - i
[?25l:      [?12l[?25h:  $put =d[i]
[?25l:      [?12l[?25h: endif
[?25l:    [?12l[?25h:endfor
[?25l:  [?12l[?25h: let i += 1
[?25l:  [?12l[?25h:" delete even items
[?25l:  [?12l[?25h:while i >= 2
[?25l:    [?12l[?25h: let i -= 2
[?25l:    [?12l[?25h: unlet d[i]
[?25l:    [?12l[?25h:endwhile
[?25l:  [?12l[?25h:$put =get(d, 1500 - 100, 'NONE') . ' ' . d[1]
[?25l:  [?12l[?25h:" delete odd items, checking value, one intentionally wrong
[?25l:  [?12l[?25h:let d[33] = 999
[?25l:  [?12l[?25h:let i = 1
[?25l:  [?12l[?25h:while i < 1500
[?25l:    [?12l[?25h: if d[i] != 3000 - i
[?25l:      [?12l[?25h:  $put =i . '=' . d[i]
[?25l:      [?12l[?25h: else
[?25l:      [?12l[?25h:  unlet d[i]
[?25l:      [?12l[?25h: endif
[?25l:    [?12l[?25h: let i += 2
[?25l:    [?12l[?25h:endwhile
[?25l:  [?12l[?25h:$put =string(d)  " must be almost empty now
[?25l:  [?12l[?25h:unlet d
[?25l:  [?12l[?25h:"
[?25l:  [?12l[?25h:" Dictionary function
[?25l:  [?12l[?25h:let dict = {}
[?25l:  [?12l[?25h:func dict.func(a) dict
[?25l:    [?12l[?25h:  $put =a:a . len(self.data)
[?25l:    [?12l[?25h:endfunc
[?25l:    [?12l[?25h:let dict.data = [1,2,3]
[?25l:    [?12l[?25h:call dict.func("len: ")
[?25l:    [?12l[?25h:let x = dict.func("again: ")
[?25l:    [?12l[?25h:try
[?25l:      [?12l[?25h:  let Fn = dict.func
[?25l:      [?12l[?25h:  call Fn('xxx')
[?25l:      [?12l[?25h:catch
[?25l:      [?12l[?25h:  $put =v:exception[:15]
[?25l:      [?12l[?25h:endtry
[?25l:    [?12l[?25h:" 
[?25l:    [?12l[?25h:" Function in script-local List or Dict
[?25l:    [?12l[?25h:let g:dict = {}
[?25l:    [?12l[?25h:function g:dict.func() dict
[?25l:      [?12l[?25h:  $put ='g:dict.func'.self.foo[1].self.foo[0]('asdf')
[?25l:      [?12l[?25h:endfunc
[?25l:      [?12l[?25h:let g:dict.foo = ['-', 2, 3]
[?25l:      [?12l[?25h:call insert(g:dict.foo, function('strlen'))
[?25l:      [?12l[?25h:call g:dict.func()
[?25l:      [?12l[?25h:" 
[?25l:      [?12l[?25h:" Nasty: remove func from Dict that's being called (works)
[?25l:      [?12l[?25h:let d = {1:1}
[?25l:      [?12l[?25h:func d.func(a)
[?25l:[8C[?12l[?25h:  return "a:". a:a
[?25l:[8C[?12l[?25h:endfunc
[?25l:[8C[?12l[?25h:$put =d.func(string(remove(d, 'func')))
[?25l:[8C[?12l[?25h:"
[?25l:[8C[?12l[?25h:" Nasty: deepcopy() dict that refers to itself (fails when noref used
[24;80H)[25;1H
[?25l:[8C[?12l[?25h:let d = {1:1, 2:2}
[?25l:[8C[?12l[?25h:let l = [4, d, 6]
[?25l:[8C[?12l[?25h:let d[3] = l
[?25l:[8C[?12l[?25h:let dc = deepcopy(d)
[?25l:[8C[?12l[?25h:try
[?25l:[10C[?12l[?25h:  let dc = deepcopy(d, 1)
[?25l:[10C[?12l[?25h:catch
[?25l:[10C[?12l[?25h:  $put =v:exception[:14]
[?25l:[10C[?12l[?25h:endtry
[?25l:[8C[?12l[?25h:let l2 = [0, l, l, 3]
[?25l:[8C[?12l[?25h:let l[1] = l2
[?25l:[8C[?12l[?25h:let l3 = deepcopy(l2)
[?25l:[8C[?12l[?25h:$put ='same list: ' . (l3[1] is l3[2])
[?25l:[8C[?12l[?25h:"
[?25l:[8C[?12l[?25h:" Locked variables
[?25l:[8C[?12l[?25h:for depth in range(5)
[?25l:[10C[?12l[?25h:  $put ='depth is ' . depth
[?25l:[10C[?12l[?25h:  for u in range(3)
[?25l:[12C[?12l[?25h:    unlet l
[?25l:[12C[?12l[?25h:    let l = [0, [1, [2, 3]], {4: 5, 6: {7: 8}}]
[?25l:[12C[?12l[?25h:    exe "lockvar " . depth . " l"
[?25l:[12C[?12l[?25h:    if u == 1
[?25l:[14C[?12l[?25h:      exe "unlockvar l"
[?25l:[14C[?12l[?25h:    elseif u == 2
[?25l:[14C[?12l[?25h:      exe "unlockvar " . depth . " l"
[?25l:[14C[?12l[?25h:    endif
[?25l:[12C[?12l[?25h:    let ps = islocked("l").islocked("l[1]").islocked("l[1][1]").i
[24;80Hs[25;1Hlocked("l[1][1][0]").'-'.islocked("l[2]").islocked("l[2]['6']").islocked("l[2][
[24;80H'[25;1H6'][7]")
[?25l:[12C[?12l[?25h:    $put =ps
[?25l:[12C[?12l[?25h:    let ps = ''
[?25l:[12C[?12l[?25h:    try
[?25l:[14C[?12l[?25h:      let l[1][1][0] = 99
[?25l:[14C[?12l[?25h:      let ps .= 'p'
[?25l:[14C[?12l[?25h:    catch
[?25l:[14C[?12l[?25h:      let ps .= 'F'
[?25l:[14C[?12l[?25h:    endtry
[?25l:[12C[?12l[?25h:    try
[?25l:[14C[?12l[?25h:      let l[1][1] = [99]
[?25l:[14C[?12l[?25h:      let ps .= 'p'
[?25l:[14C[?12l[?25h:    catch
[?25l:[14C[?12l[?25h:      let ps .= 'F'
[?25l:[14C[?12l[?25h:    endtry
[?25l:[12C[?12l[?25h:    try
[?25l:[14C[?12l[?25h:      let l[1] = [99]
[?25l:[14C[?12l[?25h:      let ps .= 'p'
[?25l:[14C[?12l[?25h:    catch
[?25l:[14C[?12l[?25h:      let ps .= 'F'
[?25l:[14C[?12l[?25h:    endtry
[?25l:[12C[?12l[?25h:    try
[?25l:[14C[?12l[?25h:      let l[2]['6'][7] = 99
[?25l:[14C[?12l[?25h:      let ps .= 'p'
[?25l:[14C[?12l[?25h:    catch
[?25l:[14C[?12l[?25h:      let ps .= 'F'
[?25l:[14C[?12l[?25h:    endtry
[?25l:[12C[?12l[?25h:    try
[?25l:[14C[?12l[?25h:      let l[2][6] = {99: 99}
[?25l:[14C[?12l[?25h:      let ps .= 'p'
[?25l:[14C[?12l[?25h:    catch
[?25l:[14C[?12l[?25h:      let ps .= 'F'
[?25l:[14C[?12l[?25h:    endtry
[?25l:[12C[?12l[?25h:    try
[?25l:[14C[?12l[?25h:      let l[2] = {99: 99}
[?25l:[14C[?12l[?25h:      let ps .= 'p'
[?25l:[14C[?12l[?25h:    catch
[?25l:[14C[?12l[?25h:      let ps .= 'F'
[?25l:[14C[?12l[?25h:    endtry
[?25l:[12C[?12l[?25h:    try
[?25l:[14C[?12l[?25h:      let l = [99]
[?25l:[14C[?12l[?25h:      let ps .= 'p'
[?25l:[14C[?12l[?25h:    catch
[?25l:[14C[?12l[?25h:      let ps .= 'F'
[?25l:[14C[?12l[?25h:    endtry
[?25l:[12C[?12l[?25h:    $put =ps
[?25l:[12C[?12l[?25h:  endfor
[?25l:[10C[?12l[?25h:endfor
[?25l:[8C[?12l[?25h:"
[?25l:[8C[?12l[?25h:" a:000 function argument
[?25l:[8C[?12l[?25h:" first the tests that should fail
[?25l:[8C[?12l[?25h:try
[?25l:[10C[?12l[?25h:  let a:000 = [1, 2]
[?25l:[10C[?12l[?25h:catch
[?25l:[10C[?12l[?25h:  $put ='caught a:000'
[?25l:[10C[?12l[?25h:endtry
[?25l:[8C[?12l[?25h:try
[?25l:[10C[?12l[?25h:  let a:000[0] = 9
[?25l:[10C[?12l[?25h:catch
[?25l:[10C[?12l[?25h:  $put ='caught a:000[0]'
[?25l:[10C[?12l[?25h:endtry
[?25l:[8C[?12l[?25h:try
[?25l:[10C[?12l[?25h:  let a:000[2] = [9, 10]
[?25l:[10C[?12l[?25h:catch
[?25l:[10C[?12l[?25h:  $put ='caught a:000[2]'
[?25l:[10C[?12l[?25h:endtry
[?25l:[8C[?12l[?25h:try
[?25l:[10C[?12l[?25h:  let a:000[3] = {9: 10}
[?25l:[10C[?12l[?25h:catch
[?25l:[10C[?12l[?25h:  $put ='caught a:000[3]'
[?25l:[10C[?12l[?25h:endtry
[?25l:[8C[?12l[?25h:" now the tests that should pass
[?25l:[8C[?12l[?25h:try
[?25l:[10C[?12l[?25h:  let a:000[2][1] = 9
[?25l:[10C[?12l[?25h:  call extend(a:000[2], [5, 6])
[?25l:[10C[?12l[?25h:  let a:000[3][5] = 8
[?25l:[10C[?12l[?25h:  let a:000[3]['a'] = 12
[?25l:[10C[?12l[?25h:  $put =string(a:000)
[?25l:[10C[?12l[?25h:catch
[?25l:[10C[?12l[?25h:  $put ='caught ' . v:exception
[?25l:[10C[?12l[?25h:endtry
[?25l:[8C[?12l[?25h:"
[?25l:[8C[?12l[?25h:" reverse() and sort()
[?25l:[8C[?12l[?25h:let l = ['-0', 'A11', 2, 'xaaa', 4, 'foo', 'foo6', [0, 1, 2], 'x8']
[?25l:[8C[?12l[?25h:$put =string(reverse(l))
[?25l:[8C[?12l[?25h:$put =string(reverse(reverse(l)))
[?25l:[8C[?12l[?25h:$put =string(sort(l))
[?25l:[8C[?12l[?25h:$put =string(reverse(sort(l)))
[?25l:[8C[?12l[?25h:$put =string(sort(reverse(sort(l))))
[?25l:[8C[?12l[?25h:"
[?25l:[8C[?12l[?25h:" splitting a string to a List
[?25l:[8C[?12l[?25h:$put =string(split('  aa  bb '))
[?25l:[8C[?12l[?25h:$put =string(split('  aa  bb  ', '\W\+', 0))
[?25l:[8C[?12l[?25h:$put =string(split('  aa  bb  ', '\W\+', 1))
[?25l:[8C[?12l[?25h:$put =string(split('  aa  bb  ', '\W', 1))
[?25l:[8C[?12l[?25h:$put =string(split(':aa::bb:', ':', 0))
[?25l:[8C[?12l[?25h:$put =string(split(':aa::bb:', ':', 1))
[?25l:[8C[?12l[?25h:$put =string(split('aa,,bb, cc,', ',\s*', 1))
[?25l:[8C[?12l[?25h:$put =string(split('abc', '\zs'))
[?25l:[8C[?12l[?25h:$put =string(split('abc', '\zs', 1))
[?25l:[8C[?12l[?25h:"
[?25l:[8C[?12l[?25h:" compare recursively linked list and dict
[?25l:[8C[?12l[?25h:let l = [1, 2, 3, 4]
[?25l:[8C[?12l[?25h:let d = {'1': 1, '2': l, '3': 3}
[?25l:[8C[?12l[?25h:let l[1] = d
[?25l:[8C[?12l[?25h:$put =(l == l)
[?25l:[8C[?12l[?25h:$put =(d == d)
[?25l:[8C[?12l[?25h:$put =(l != deepcopy(l))
[?25l:[8C[?12l[?25h:$put =(d != deepcopy(d))
[?25l:[8C[?12l[?25h:endfun[27m[m[H[2J[?25l[1;1H:$put =string(split(':aa::bb:', ':', 1))
:$put =string(split('aa,,bb, cc,', ',\s*', 1))
:$put =string(split('abc', '\zs'))
:$put =string(split('abc', '\zs', 1))
:"
:" compare recursively linked list and dict
:let l = [1, 2, 3, 4]
:let d = {'1': 1, '2': l, '3': 3}
:let l[1] = d
:$put =(l == l)
:$put =(d == d)
:$put =(l != deepcopy(l))
:$put =(d != deepcopy(d))
:endfun
:call Test(1, 2, [3, 4], {5: 6})  " This may take a while
:"
:delfunc Test
:unlet dict
:call garbagecollect(1)
:"
:/^start:/,$wq! test.out
ENDTEST

start:[23;1H[?12l[?25h[?25l

:[?12l[?25hcall Test(1, 2, [3, 4], {5: 6})  " This may take a while[?25l[1;1Hppppppp[1;8H[K[2;1Hcaught a:000[2;13H[K[3;1Hcaught a:000[0][3;16H[K[4;1Hcaught a:000[2][4;16H[K[5;1Hcaught a:000[3]
[1, 2, [3, 9, 5, 6], {'a': 12, '5': 8}][6;40H[K[7;1H['x8', [0, 1, 2], 'foo6', 'foo', 4, 'xaaa', 2, 'A11', '-0']
['x8', [0, 1, 2], 'foo6', 'foo', 4, 'xaaa', 2, 'A11', '-0']
['-0', 'A11', 'foo', 'foo6', 'x8', 'xaaa', 2, 4, [0, 1, 2]]
[[0, 1, 2], 4, 2, 'xaaa', 'x8', 'foo6', 'foo', 'A11', '-0']
['-0', 'A11', 'foo', 'foo6', 'x8', 'xaaa', 2, 4, [0, 1, 2]]
['aa', 'bb'][12;14H[K[13;1H['aa', 'bb'][13;14H[K[14;1H['', 'aa', 'bb', '']
['', '', 'aa', '', 'bb', '', ''][15;35H[K[16;1H['aa', '', 'bb']
['', 'aa', '', 'bb', '']
['aa', '', 'bb', 'cc', '']
['a', 'b', 'c'][19;16H[K[20;1H['', 'a', '', 'b', '', 'c', '']
1[21;2H[K[22;1H1[22;2H[K[23;1H0
0[24;2H[K[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hdelfunc Test[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hunlet dict[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall garbagecollect(1)[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^start:/,$wq! test.out[?25l[31msearch hit BOTTOM, continuing at TOP[m"test.out" [25;12H[K[25;12H[New File] 111 lines, 1899 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test56.failed test.ok test.out X* viminfo
cp test56.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test56.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test56.in" 21 lines, 457 characters[1;1HTest for script-local function.     vim: set ft=vim :

STARTTEST
:so small.vim
:"
:set nocp viminfo+=nviminfo
:/^start:/+1,/^end:/-1w! Xtest.vim
:source Xtest.vim
_x
:$-1,$wq! test.out
ENDTEST

start:
fun <SID>DoLast()
  call append(line('$'), "last line")
endfun
fun s:DoNothing()
  call append(line('$'), "nothing line")
endfun
nnoremap <buffer> _x    :call <SID>DoNothing()<bar>call <SID>DoLast()<bar>delfunn[21;1Hc <SID>DoNothing<bar>delfunc <SID>DoLast<cr>
end:
[1m[34m~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for script-local function.     vim: set ft=vim :[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 7 lines, 120 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[11;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[12;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[12;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[12;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset nocp viminfo+=nviminfo[?25l[12;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^start:/+1,/^end:/-1w! Xtest.vim[?25l"Xtest.vim" [25;13H[K[25;13H[New] 7L, 251C written[12;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hsource Xtest.vim[?25l[12;1H[?12l[?25h[?25l[25;1H[K[25;1H:call <SNR>3_DoNothing()|call <SNR>3_DoLast()|delfunc <SNR>3_DoNothing|delfunc 
[24;80H<[25;1HSNR>3_DoLast[32mPress ENTER or type command to continue[?12l[?25h[m[1;1H[L[?25l[1;1HTest for script-local function.     vim: set ft=vim :[23;1Hnothing line[23;13H[K[24;1Hlast line[24;10H[K[25;1H[K[12;1H[?12l[?25h[?25l[25;1H:[?12l[?25h$-1,$wq! test.out[?25l"test.out" [25;12H[K[25;12H[New] 2L, 23C written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test57.failed test.ok test.out X* viminfo
cp test57.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test57.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test57.in" 496 lines, 3654 characters[1;1HTests for :sort command.     vim: set ft=vim :

STARTTEST
:so small.vim
:"
:/^t01:/+1,/^t02/-1sort
:/^t02:/+1,/^t03/-1sort n
:/^t03:/+1,/^t04/-1sort x
:/^t04:/+1,/^t05/-1sort u
:/^t05:/+1,/^t06/-1sort!
:/^t06:/+1,/^t07/-1sort! n
:/^t07:/+1,/^t08/-1sort! u
:/^t08:/+1,/^t09/-1sort o
:/^t09:/+1,/^t10/-1sort! x
:/^t10:/+1,/^t11/-1sort/./
:/^t11:/+1,/^t12/-1sort/../
:/^t12:/+1,/^t13/-1sort/../u
:/^t13:/+1,/^t14/-1sort/./n
:/^t14:/+1,/^t15/-1sort/./r
:/^t15:/+1,/^t16/-1sort/../r
:/^t16:/+1,/^t17/-1sort/./rn
:/^t17:/+1,/^t18/-1sort/\d/
:/^t18:/+1,/^t19/-1sort/\d/r
:/^t19:/+1,/^t20/-1sort/\d/n[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for :sort command.     vim: set ft=vim :[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 30 lines, 842 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[10M[1;25r[15;1H:/^t20:/+1,/^t21/-1sort/\d/rn
:/^t21:/+1,/^t22/-1sort/\d\d/
:/^t22:/+1,/^t23/-1sort/\d\d/n
:/^t23:/+1,/^t24/-1sort/\d\d/x
:/^t24:/+1,/^t25/-1sort/\d\d/r
:/^t25:/+1,/^t26/-1sort/\d\d/rn
:/^t26:/+1,/^t27/-1sort/\d\d/rx
:/^t27:/+1,/^t28/-1sort no
:/^t01:/,$wq! test.out
ENDTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^t01:/+1,/^t02/-1sort[?25l[1;24r[1;1H[2M[1;25r[23;1Ht01: alphebetical[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h/^t02:/+1,/^t03/-1sort n[?25l[27m[m[H[2J[1;1Ha321
ab
abc
b123
b321
b321
b321b
b322b
c123d
c321d
t02: numeric
abc
ab
a


a122
a123
b123
c123d
 123b
a321
b321
c321d[12;1H[?12l[?25h[?25l[25;1H:[?12l[?25h/^t03:/+1,/^t04/-1sort x[?25l[1;24r[1;1H[5M[1;25r[20;1Hb321
b321b
b322b
t03: hexadecimal[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h/^t04:/+1,/^t05/-1sort u[?25l[27m[m[H[2J[1;1Ha122
a123
a321
b123
b321
b321
b321b
b322b
c123d
c321d
t04: alpha, unique

 123b
a
a122
a123
a321
ab
abc
b123
b321
b321b
b322b
c123d[12;1H[?12l[?25h[?25l[25;1H:[?12l[?25h/^t05:/+1,/^t06/-1sort![?25l[1;24r[1;1H[3M[1;25r[22;1Hc321d
t05: alpha, reverse
c321d[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h/^t06:/+1,/^t07/-1sort! n        [?25l[27m[m[H[2J[1;1Hb123
abc
ab
a321
a123
a122
a
 123b


t06: numeric, reverse
b322b
b321b
b321
c321d
b321
a321
 123b
c123d
b123
a123
a122[12;1H[?12l[?25h[?25l[25;1H:[?12l[?25h/^t07:/+1,/^t08/-1sort! u[?25l[1;24r[1;1H[5M[1;25r[20;1Ha
ab
abc
t07: unique, reverse
c321d[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h/^t08:/+1,/^t09/-1sort o         [?25l[27m[m[H[2J[1;1Hb321
b123
abc
ab
a321
a123
a122
a
 123b

t08: octal
abc
ab
a


a122
a123
b123
c123d
 123b
a321
b321
c321d[12;1H[?12l[?25h[?25l[25;1H:[?12l[?25h/^t09:/+1,/^t10/-1sort! x        [?25l[1;24r[1;1H[5M[1;25r[20;1Hb321
b321b
b322b
t09: reverse, hexadecimal
c321d[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h/^t10:/+1,/^t11/-1sort/./        [?25l[27m[m[H[2J[1;1Hb123
a321
a123
a122
 123b
abc
ab
a


t10: alpha, skip first character
a


a122
a123
b123
 123b
c123d
a321
b321
b321
b321b
c321d[12;1H[?12l[?25h[?25l[25;1H:[?12l[?25h/^t11:/+1,/^t12/-1sort/../       [?25l[1;24r[1;1H[5M[1;25r[20;1Hb322b
ab
abc
t11: alpha, skip first 2 characters
ab[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h/^t12:/+1,/^t13/-1sort/../u[?25l[27m[m[H[2J[1;1Hb321
b321b
c321d
a122
b322b
a123
b123
 123b
c123d
abc
t12: alpha, unique, skip first 2 characters
ab
a

a321
b321
b321b
c321d
a122
b322b
a123
b123
 123b
c123d[12;1H[?12l[?25h[?25l[25;1H:[?12l[?25h/^t13:/+1,/^t14/-1sort/./n[?25l[1;24r[1;1H[3M[1;25r[22;1Habc
t13: numeric, skip first character
abc[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h/^t14:/+1,/^t15/-1sort/./r[?25l[27m[m[H[2J[1;1Ha123
b123
c123d
 123b
a321
b321
c321d
b321
b321b
b322b
t14: alpha, sort on first character[14;2H123b
abc
ab
a
a321
a123
a122
b321
b123
b322b
b321[12;1H[?12l[?25h[?25l[25;1H:[?12l[?25h/^t15:/+1,/^t16/-1sort/../r[?25l[1;24r[1;1H[5M[1;25r[20;1Hb321b
c123d
c321d
t15: alpha, sort on first 2 characters
a[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h/^t16:/+1,/^t17/-1sort/./rn[?25l[27m[m[H[2J[1;1Ha321
abc
ab
b123
b321
b322b
b321
b321b
c123d
c321d
t16: numeric, sort on first character
abc
ab
a
a321
a123
a122
b321
b123
c123d
 123b
c321d
b322b
b321[12;1H[?12l[?25h[?25l[25;1H:[?12l[?25h/^t17:/+1,/^t18/-1sort/\d/[?25l[1;24r[1;1H[5M[1;25r[20;1Hb321b


t17: alpha, skip past first digit
abc[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h/^t18:/+1,/^t19/-1sort/\d/r[?25l[27m[m[H[2J[1;1Hb321
b321
b321b
c321d
a122
b322b
a123
b123
 123b
c123d
t18: alpha, sort on first digit
abc
ab
a


a123
a122
b123
c123d
 123b
a321
b321
c321d[12;1H[?12l[?25h[?25l[25;1H:[?12l[?25h/^t19:/+1,/^t20/-1sort/\d/n[?25l[1;24r[1;1H[5M[1;25r[20;1Hb322b
b321
b321b
t19: numeric, skip past first digit
abc[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h/^t20:/+1,/^t21/-1sort/\d/rn[?25l[27m[m[H[2J[1;1Hb321
c321d
b321
b321b
a122
b322b
a123
b123
c123d
 123b
t20: numeric, sort on first digit
abc
ab
a


a123
a122
b123
c123d
 123b
a321
b321
c321d[12;1H[?12l[?25h[?25l[25;1H:[?12l[?25h/^t21:/+1,/^t22/-1sort/\d\d/[?25l[1;24r[1;1H[5M[1;25r[20;1Hb322b
b321
b321b
t21: alpha, skip past first 2 digits
abc[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h/^t22:/+1,/^t23/-1sort/\d\d/n[?25l[27m[m[H[2J[1;1Hb321
b321
b321b
c321d
a122
b322b
a123
b123
 123b
c123d
t22: numeric, skip past first 2 digits
abc
ab
a


a321
b321
c321d
b321
b321b
a122
b322b
a123[12;1H[?12l[?25h[?25l[25;1H:[?12l[?25h/^t23:/+1,/^t24/-1sort/\d\d/x[?25l[1;24r[1;1H[5M[1;25r[20;1Hb123
c123d
 123b
t23: hexadecimal, skip past first 2 digits
abc[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h/^t24:/+1,/^t25/-1sort/\d\d/r[?25l[27m[m[H[2J[1;1Hb321
b321
a122
a123
b123
b321b
c321d
b322b
 123b
c123d
t24: alpha, sort on first 2 digits
abc
ab
a


a123
a122
b123
c123d
 123b
a321
b321
c321d[12;1H[?12l[?25h[?25l[25;1H:[?12l[?25h/^t25:/+1,/^t26/-1sort/\d\d/rn[?25l[1;24r[1;1H[5M[1;25r[20;1Hb322b
b321
b321b
t25: numeric, sort on first 2 digits
abc[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h/^t26:/+1,/^t27/-1sort/\d\d/rx[?25l[27m[m[H[2J[1;1Ha122
b123
c123d
 123b
a321
b321
c321d
b322b
b321
b321b
t26: hexadecimal, sort on first 2 digits
abc
ab
a


a123
a122
b123
c123d
 123b
a321
b321
c321d[12;1H[?12l[?25h[?25l[25;1H:[?12l[?25h/^t27:/+1,/^t28/-1sort no[?25l[1m[37m[41mE474: Invalid argument[m[25;23H[K[12;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^t01:/,$wq! test.out[?25l[31msearch hit BOTTOM, continuing at TOP[m"test.out" [25;12H[K[25;12H[New File] 455 lines, 2727 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test58.failed test.ok test.out X* viminfo
cp test58.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test58.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test58.in" 635 lines, 10784 characters[1;1HTests for spell checking.     vim: set ft=vim :

STARTTEST
:so small.vim
:"
:" Don't want to depend on the locale from the environment
:set enc=latin1
:e!
:"
:" Function to test .aff/.dic with list of good and bad words.
:func TestOne(aff, dic)
  set spellfile=
  $put =''
  $put ='test '. a:aff . '-' . a:dic
  " Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
  mkspell! Xtest Xtest
  " use that spell file
  set spl=Xtest.latin1.spl spell
  " list all valid words
  spelldump
  %yank
  quit[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for spell checking.     vim: set ft=vim :[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 105 lines, 2456 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;1H:call TestOne('6', '6')
:call TestOne('7', '7')
:"
:" NOSLITSUGS
:call TestOne('8', '8')
:"
:" clean up for valgrind
:delfunc TestOne
:set spl= enc=latin1
:"
gg:/^test output:/,$wq! test.out
ENDTEST

1affstart
SET ISO8859-1
TRY esianrtolcdugmphbyfvkwjkqxz-'ESIANRTOLCDUGMPHBYFVKWJKQXZ

FOL  
LOW  
UPP  

SOFOFROM abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ[23;1H޿
SOFOTO   ebctefghejklnnepkrstevvkesebctefghejklnnepkrstevvkeseeeeeeeceeeeeeeedne[24;1H[1m[34m@                                                                               [12;1H[?12l[?25h
[?25l[25;1H[m:so! Xdotest[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Don't want to depend on the locale from the environment[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset enc=latin1[?25l[27m[m[H[2J[1;1H:call TestOne('6', '6')
:call TestOne('7', '7')
:"
:" NOSLITSUGS
:call TestOne('8', '8')
:"
:" clean up for valgrind
:delfunc TestOne
:set spl= enc=latin1
:"
gg:/^test output:/,$wq! test.out
ENDTEST

1affstart
SET ISO8859-1
TRY esianrtolcdugmphbyfvkwjkqxz-'ESIANRTOLCDUGMPHBYFVKWJKQXZ

FOL  
LOW  
UPP  

SOFOFROM abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ[23;1H޿
SOFOTO   ebctefghejklnnepkrstevvkesebctefghejklnnepkrstevvkeseeeeeeeceeeeeeeedne[24;1H[1m[34m@                                                                               [13;1H[?12l[?25h[?25l[25;1H[m:[?12l[?25he![?25l"test58.in" 635 lines, 10784 characters[1;1HTests for spell checking.     vim: set ft=vim :[2;1H[K[3;1HSTARTTEST
:so small.vim
:"[5;3H[K[6;4HDon't want to depend on the locale from the environment
:set enc=latin1[7;17H[K[8;2He![8;4H[K[9;2H"[9;3H[K[10;4HFunction to test .aff/.dic with list of good and bad words.
:func TestOne(aff, dic)[11;25H[K[12;1H  set spellfile=
  $put =''
  $put ='test '. a:aff . '-' . a:dic
  " Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
  mkspell! Xtest Xtest[18;23H[K[19;1H  " use that spell file[19;24H[K[20;1H  set spl=Xtest.latin1.spl spell[20;33H[K[21;3H" list all valid words
  spelldump[22;12H[K[23;1H  %yank[23;8H[K[24;1H  quit[24;7H[K[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Function to test .aff/.dic with list of good and bad words.[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfunc TestOne(aff, dic)[?25l
:  [?12l[?25h  set spellfile=
[?25l:  [?12l[?25h  $put =''
[?25l:  [?12l[?25h  $put ='test '. a:aff . '-' . a:dic
[?25l:  [?12l[?25h  " Generate a .spl file from a .dic and .aff file.
[?25l:  [?12l[?25h  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
[?25l:  [?12l[?25h  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
[?25l:  [?12l[?25h  mkspell! Xtest Xtest
[?25l:  [?12l[?25h  " use that spell file
[?25l:  [?12l[?25h  set spl=Xtest.latin1.spl spell
[?25l:  [?12l[?25h  " list all valid words
[?25l:  [?12l[?25h  spelldump
[?25l:  [?12l[?25h  %yank
[?25l:  [?12l[?25h  quit
[?25l:  [?12l[?25h  $put
[?25l:  [?12l[?25h  $put ='-------'
[?25l:  [?12l[?25h  " find all bad words and suggestions for them
[?25l:  [?12l[?25h  exe '1;/^' . a:aff . 'good:'
[?25l:  [?12l[?25h  normal 0f:]s
[?25l:  [?12l[?25h  let prevbad = ''
[?25l:  [?12l[?25h  while 1
[?25l:    [?12l[?25h    let [bad, a] = spellbadword()
[?25l:    [?12l[?25h    if bad == '' || bad == prevbad || bad == 'badend'
[?25l:      [?12l[?25h      break
[?25l:      [?12l[?25h    endif
[?25l:    [?12l[?25h    let prevbad = bad
[?25l:    [?12l[?25h    let lst = spellsuggest(bad, 3)
[?25l:    [?12l[?25h    normal mm
[?25l:    [?12l[?25h    $put =bad
[?25l:    [?12l[?25h    $put =string(lst)
[?25l:    [?12l[?25h    normal `m]s
[?25l:    [?12l[?25h  endwhile
[?25l:  [?12l[?25hendfunc[27m[m[H[2J[?25l[1;1HTests for spell checking.     vim: set ft=vim :

STARTTEST
:so small.vim
:"
:" Don't want to depend on the locale from the environment
:set enc=latin1
:e!
:"
:" Function to test .aff/.dic with list of good and bad words.
:func TestOne(aff, dic)
  set spellfile=
  $put =''
  $put ='test '. a:aff . '-' . a:dic
  " Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
  mkspell! Xtest Xtest
  " use that spell file
  set spl=Xtest.latin1.spl spell
  " list all valid words
  spelldump
  %yank
  quit[1;1H[?12l[?25h[?25l[25;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall TestOne('1', '1')[?25l"Xtest.aff" [25;13H[K[25;13H[New File] 46 lines, 754 characters written
"Xtest.dic" [New File] 11 lines, 71 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - testCompressing word tree...[25;26H[K[25;1H
Compressed 29 of 127 nodes; 98 (77%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 490 bytes
Reading back spell file...
Performing soundfolding...
Total number of words: 16
Number of words after soundfolding: 16
Compressing word tree...
Compressed 39 of 104 nodes; 65 (62%) remaining
Writing suggestion file Xtest.latin1.sug ...
Estimated runtime memory use: 357 bytes
17 lines yanked
17 more lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h$put =soundfold('goobledygoook')[?25l[1;1H[19L[1;1Htestn
the end
uk
wrong
-------
[41mbad[m
['put', 'uk', 'OK']
[41minputs[m
['input', 'puts', 'outputs']
[41mcomment[m
['Comment', 'outtest', 'the end']
[41mok[m
['OK', 'uk', 'put']
[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdl[m
['deol', 'dr', 'test']
[41mend[m[20;4H[K[21;1H['put', 'uk', 'test'][21;22H[K[22;1H[41mthe[m[22;4H[K[23;1H['put', 'uk', 'test']
[41mgebletegek[m[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =soundfold('koprnven')[?25l[1;24r[24;1H
[1;25r[24;1H[41mkepereneven[m[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =soundfold('oeverloos gezwets edale')[?25l[1;24r[24;1H
[1;25r[24;1H[41meverles[m [41mgesvets[m [41metele[m[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h"[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" and now with SAL instead of SOFO items; test automatic reloading[?25l[24;1H[?12l[?25h[?25l[27m[m[H[2J[1;1H[41mTests[m [41mfor[m [41mspell[m [41mchecking[m.     [41mvim[m: [41mset[m [41mft[m=[41mvim[m :

[41mSTARTTEST[m
:[41mso[m [41msmall[m.[41mvim[m
:"
:" [41mDon't[m [41mwant[m [41mto[m [41mdepend[m [41mon[m [41mthe[m [41mlocale[m [41mfrom[m [41mthe[m [41menvironment[m
:[41mset[m [41menc[m=[41mlatin1[m
:[41me[m!
:"
:" [41mFunction[m [41mto[m test .[41maff[m/.[41mdic[m [41mwith[m [41mlist[m [41mof[m [41mgood[m [41mand[m [41mbad[m [41mwords[m.
:[41mfunc[m [41mTestOne[m([41maff[m, [41mdic[m)
  [41mset[m [41mspellfile[m=
  $put =''
  $put ='test '. [41ma[m:[41maff[m . '-' . [41ma[m:[41mdic[m
  " [41mGenerate[m [41ma[m .[41mspl[m [41mfile[m [41mfrom[m [41ma[m .[41mdic[m [41mand[m .[41maff[m [41mfile[m.
  [41mexe[m '1;/^' . [41ma[m:[41maff[m . '[41maffstart[m/+1,/^' . [41ma[m:[41maff[m . '[41maffend[m/-1[41mw[m! [41mXtest[m.[41maff[m'
  [41mexe[m '1;/^' . [41ma[m:[41mdic[m . '[41mdicstart[m/+1,/^' . [41ma[m:[41mdic[m . '[41mdicend[m/-1[41mw[m! [41mXtest[m.[41mdic[m'
  [41mmkspell[m! [41mXtest[m [41mXtest[m
  " [41muse[m [41mthat[m [41mspell[m [41mfile
[m  [41mset[m [41mspl[m=[41mXtest[m.[41mlatin1[m.[41mspl[m [41mspell[m
  " [41mlist[m [41mall[m [41mvalid[m [41mwords
[m  [41mspelldump[m
  %[41myank
[m  [41mquit[1;1H[?12l[?25h[?25l[25;1H[m:[?12l[?25h/^affstart_sal/+1,/^affend_sal/-1w! Xtest.aff[?25l"Xtest.aff" [25;13H[K[25;13H151 lines, 3412 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmkspell! Xtest Xtest[?25lReading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - testCompressing word tree...[25;26H[K[25;1H
Compressed 29 of 127 nodes; 98 (77%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 490 bytes
Performing soundfolding...
Total number of words: 16
Number of words after soundfolding: 15
Compressing word tree...
Compressed 33 of 75 nodes; 42 (56%) remaining
Writing suggestion file Xtest.latin1.sug ...
Estimated runtime memory use: 241 bytes
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h$put =soundfold('goobledygoook')[?25l[1;1H[14L[1;1Hwrong
-------
[41mbad[m
['put', 'uk', 'OK']
[41minputs[m
['input', 'puts', 'outputs']
[41mcomment[m
['Comment', 'outtest', 'the end']
[41mok[m
['OK', 'uk', 'put']
[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdl[m[15;5H[K[16;1H['deol', 'dr', 'test'][16;25H[K[17;1H[41mend[m[17;4H[K[18;1H['put', 'uk', 'test'][18;22H[K[19;1H[41mthe[m[19;5H[K[20;1H['put', 'uk', 'test'][20;22H[K[21;1H[41mgebletegek[m[21;11H[K[22;1H[41mkepereneven
everles[m [41mgesvets[m [41metele
kbltykk[m[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =soundfold('koprnven')[?25l[1;24r[24;1H
[1;25r[24;1H[41mkprnfn[m[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =soundfold('oeverloos gezwets edale')[?25l[1;24r[24;1H
[1;25r[24;1H*[41mfls[m [41mkswts[m [41mtl[m[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h"[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" also use an addition file[?25l[24;1H[?12l[?25h[?25l[27m[m[H[2J[1;1H[41mTests[m [41mfor[m [41mspell[m [41mchecking[m.     [41mvim[m: [41mset[m [41mft[m=[41mvim[m :

[41mSTARTTEST[m
:[41mso[m [41msmall[m.[41mvim[m
:"
:" [41mDon't[m [41mwant[m [41mto[m [41mdepend[m [41mon[m [41mthe[m [41mlocale[m [41mfrom[m [41mthe[m [41menvironment[m
:[41mset[m [41menc[m=[41mlatin1[m
:[41me[m!
:"
:" [41mFunction[m [41mto[m test .[41maff[m/.[41mdic[m [41mwith[m [41mlist[m [41mof[m [41mgood[m [41mand[m [41mbad[m [41mwords[m.
:[41mfunc[m [41mTestOne[m([41maff[m, [41mdic[m)
  [41mset[m [41mspellfile[m=
  $put =''
  $put ='test '. [41ma[m:[41maff[m . '-' . [41ma[m:[41mdic[m
  " [41mGenerate[m [41ma[m .[41mspl[m [41mfile[m [41mfrom[m [41ma[m .[41mdic[m [41mand[m .[41maff[m [41mfile[m.
  [41mexe[m '1;/^' . [41ma[m:[41maff[m . '[41maffstart[m/+1,/^' . [41ma[m:[41maff[m . '[41maffend[m/-1[41mw[m! [41mXtest[m.[41maff[m'
  [41mexe[m '1;/^' . [41ma[m:[41mdic[m . '[41mdicstart[m/+1,/^' . [41ma[m:[41mdic[m . '[41mdicend[m/-1[41mw[m! [41mXtest[m.[41mdic[m'
  [41mmkspell[m! [41mXtest[m [41mXtest[m
  " [41muse[m [41mthat[m [41mspell[m [41mfile
[m  [41mset[m [41mspl[m=[41mXtest[m.[41mlatin1[m.[41mspl[m [41mspell[m
  " [41mlist[m [41mall[m [41mvalid[m [41mwords
[m  [41mspelldump[m
  %[41myank
[m  [41mquit[1;1H[?12l[?25h[?25l[25;1H[m:[?12l[?25h/^addstart/+1,/^addend/-1w! Xtest.latin1.add[?25l"Xtest.latin1.add" [25;20H[K[25;20H[New File] 3 lines, 38 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmkspell! Xtest.latin1.add.spl Xtest.latin1.add[?25lReading word file Xtest.latin1.add ...[25;39H[K[25;1H
Compressing word tree...
Compressed 0 of 29 nodes; 29 (100%) remaining
Writing spell file Xtest.latin1.add.spl ...
Done!
Estimated runtime memory use: 145 bytes
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hset spellfile=Xtest.latin1.add[?25l[1;1H[6L[1;1H[41mTests[m [41mfor[m [41mspell[m [41mchecking[m.     [41mvim[m: [41mset[m [41mft[m=[41mvim[m :

[41mSTARTTEST[m
:[41mso[m [41msmall[m.[41mvim[m
:"
:" [41mDon't[m [41mwant[m [41mto[m [41mdepend[m [41mon[m [41mthe[m [41mlocale[m [41mfrom[m [41mthe[m [41menvironment[m[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/[?12l[?25h^test2:[?25l[27m[m[H[2J[2;1H2[41mgood[m: puts
[41mbad[m: [41minputs[m [41mcomment[m [41mok[m [41mOk[m [41mend[m [41mthe[m. [44mtest[m [41mdl
badend

addstart[m
/[41mregions[m=[41musgbnz[m
elequint/2
elekwint/3
[41maddend

test2[m:
elequint test elekwint test [41melekwent[m [41masdf[m

Test [41mrules[m [41mfor[m [41mcompounding[m.

3[41maffstart
SET[m [41mISO8859-1

COMPOUNDMIN[m 3
[41mCOMPOUNDRULE[m [41mm[m*
[41mNEEDCOMPOUND[m [41mx[m
3[41maffend[12;1H[?12l[?25h[13;29H[?25l[25;1H[m:[?12l[?25hlet [str, a] = spellbadword()[?25l[13;29H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H['put', 'uk', 'OK']
[41minputs[m
['input', 'puts', 'outputs']
[41mcomment[m
['Comment', 'outtest', 'the end']
[41mok[m
['OK', 'uk', 'put']
[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdl[m
['deol', 'dr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent[?12l[?25h[?25l
[m:[?12l[?25hset spl=Xtest_us.latin1.spl[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^test2:[?25l[31msearch hit BOTTOM, continuing at TOP[27m[m[H[2J[2;1H2[41mgood[m: puts
[41mbad[m: [41minputs[m [41mcomment[m [41mok[m [41mOk[m [41mend[m [41mthe[m. [44mtest[m [41mdl
badend

addstart[m
/[41mregions[m=[41musgbnz[m
[46melequint[m/2
[46melekwint[m/3
[41maddend

test2[m:
[46melequint[m test [46melekwint[m test [41melekwent[m [41masdf[m

Test [41mrules[m [41mfor[m [41mcompounding[m.

3[41maffstart
SET[m [41mISO8859-1

COMPOUNDMIN[m 3
[41mCOMPOUNDRULE[m [41mm[m*
[41mNEEDCOMPOUND[m [41mx[m
3[41maffend[m

[31msearch hit BOTTOM, continuing at TOP[12;1H[?12l[?25h
[?25l[m[25;1H[K[25;1H:[?12l[?25hlet [str, a] = spellbadword()[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H[41minputs[m
['input', 'puts', 'outputs']
[41mcomment[m
['Comment', 'outtest', 'the end']
[41mok[m
['OK', 'uk', 'put']
[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdl[m
['deol', 'dr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent[m
[46melequint[?12l[?25h[?25l[27m[m[H[2J[1;1H2[41mgood[m: puts
[41mbad[m: [41minputs[m [41mcomment[m [41mok[m [41mOk[m [41mend[m [41mthe[m. [44mtest[m [41mdl
badend

addstart[m
/[41mregions[m=[41musgbnz[m
[46melequint[m/2
[46melekwint[m/3
[41maddend

test2[m:
[46melequint[m test [46melekwint[m test [41melekwent[m [41masdf[m

Test [41mrules[m [41mfor[m [41mcompounding[m.

3[41maffstart
SET[m [41mISO8859-1

COMPOUNDMIN[m 3
[41mCOMPOUNDRULE[m [41mm[m*
[41mNEEDCOMPOUND[m [41mx[m
3[41maffend[m

3[41mdicstart[12;1H[?12l[?25h[14C[?25l[25;1H[m:[?12l[?25hlet [str, a] = spellbadword()[?25l[12;15H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H['input', 'puts', 'outputs']
[41mcomment[m
['Comment', 'outtest', 'the end']
[41mok[m
['OK', 'uk', 'put']
[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdl[m
['deol', 'dr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent[m
[46melequint
elekwint[?12l[?25h[?25l
[m:[?12l[?25hset spl=Xtest_gb.latin1.spl[?25l[23;1Helequint
[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^test2:[?25l[31msearch hit BOTTOM, continuing at TOP[27m[m[H[2J[2;1H2[41mgood[m: puts
[41mbad[m: [41minputs[m [41mcomment[m [41mok[m [41mOk[m [41mend[m [41mthe[m. [44mtest[m [41mdl
badend

addstart[m
/[41mregions[m=[41musgbnz[m
elequint/2
[46melekwint[m/3
[41maddend

test2[m:
elequint test [46melekwint[m test [41melekwent[m [41masdf[m

Test [41mrules[m [41mfor[m [41mcompounding[m.

3[41maffstart
SET[m [41mISO8859-1

COMPOUNDMIN[m 3
[41mCOMPOUNDRULE[m [41mm[m*
[41mNEEDCOMPOUND[m [41mx[m
3[41maffend[m

[31msearch hit BOTTOM, continuing at TOP[12;1H[?12l[?25h[13;15H[?25l[m[25;1H[K[25;1H:[?12l[?25hlet [str, a] = spellbadword()[?25l[13;15H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H[41mcomment[m
['Comment', 'outtest', 'the end']
[41mok[m
['OK', 'uk', 'put']
[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdl[m
['deol', 'dr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent[m
elequint
[46melekwint
elekwint[?12l[?25h[?25l[27m[m[H[2J[1;1H2[41mgood[m: puts
[41mbad[m: [41minputs[m [41mcomment[m [41mok[m [41mOk[m [41mend[m [41mthe[m. [44mtest[m [41mdl
badend

addstart[m
/[41mregions[m=[41musgbnz[m
elequint/2
[46melekwint[m/3
[41maddend

test2[m:
elequint test [46melekwint[m test [41melekwent[m [41masdf[m

Test [41mrules[m [41mfor[m [41mcompounding[m.

3[41maffstart
SET[m [41mISO8859-1

COMPOUNDMIN[m 3
[41mCOMPOUNDRULE[m [41mm[m*
[41mNEEDCOMPOUND[m [41mx[m
3[41maffend[m

3[41mdicstart[12;15H[?12l[?25h[14C[?25l[25;1H[m:[?12l[?25hlet [str, a] = spellbadword()[?25l[12;29H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H['Comment', 'outtest', 'the end']
[41mok[m
['OK', 'uk', 'put']
[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdl[m
['deol', 'dr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent[m
elequint
[46melekwint
elekwint[m
[41melekwent[?12l[?25h[?25l
[m:[?12l[?25hset spl=Xtest_nz.latin1.spl[?25l[21;1H[46melequint[m
elekwint
elekwint
[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^test2:[?25l[31msearch hit BOTTOM, continuing at TOP[27m[m[H[2J[2;1H2[41mgood[m: puts
[41mbad[m: [41minputs[m [41mcomment[m [41mok[m [41mOk[m [41mend[m [41mthe[m. [44mtest[m [41mdl
badend

addstart[m
/[41mregions[m=[41musgbnz[m
[46melequint[m/2
elekwint/3
[41maddend

test2[m:
[46melequint[m test elekwint test [41melekwent[m [41masdf[m

Test [41mrules[m [41mfor[m [41mcompounding[m.

3[41maffstart
SET[m [41mISO8859-1

COMPOUNDMIN[m 3
[41mCOMPOUNDRULE[m [41mm[m*
[41mNEEDCOMPOUND[m [41mx[m
3[41maffend[m

[31msearch hit BOTTOM, continuing at TOP[12;1H[?12l[?25h
[?25l[m[25;1H[K[25;1H:[?12l[?25hlet [str, a] = spellbadword()[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H[41mok[m
['OK', 'uk', 'put']
[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdl[m
['deol', 'dr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent[m
[46melequint[m
elekwint
elekwint
[41melekwent[m
[46melequint[?12l[?25h[?25l[27m[m[H[2J[1;1H2[41mgood[m: puts
[41mbad[m: [41minputs[m [41mcomment[m [41mok[m [41mOk[m [41mend[m [41mthe[m. [44mtest[m [41mdl
badend

addstart[m
/[41mregions[m=[41musgbnz[m
[46melequint[m/2
elekwint/3
[41maddend

test2[m:
[46melequint[m test elekwint test [41melekwent[m [41masdf[m

Test [41mrules[m [41mfor[m [41mcompounding[m.

3[41maffstart
SET[m [41mISO8859-1

COMPOUNDMIN[m 3
[41mCOMPOUNDRULE[m [41mm[m*
[41mNEEDCOMPOUND[m [41mx[m
3[41maffend[m

3[41mdicstart[12;1H[?12l[?25h[28C[?25l[25;1H[m:[?12l[?25hlet [str, a] = spellbadword()[?25l[12;29H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H['OK', 'uk', 'put']
[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdl[m
['deol', 'dr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent[m
[46melequint[m
elekwint
elekwint
[41melekwent[m
[46melequint[m
[41melekwent[?12l[?25h[?25l
[m:[?12l[?25hset spl=Xtest_ca.latin1.spl[?25l[19;1H[41melequint
elekwint
elekwint

elequint
[?12l[?25h[?25l[m[25;1H[K[25;1H/[?12l[?25h^test2:[?25l[31msearch hit BOTTOM, continuing at TOP[27m[m[H[2J[2;1H2[41mgood[m: puts
[41mbad[m: [41minputs[m [41mcomment[m [41mok[m [41mOk[m [41mend[m [41mthe[m. [44mtest[m [41mdl
badend

addstart[m
/[41mregions[m=[41musgbnz
elequint[m/2
[41melekwint[m/3
[41maddend

test2[m:
[41melequint[m test [41melekwint[m test [41melekwent[m [41masdf[m

Test [41mrules[m [41mfor[m [41mcompounding[m.

3[41maffstart
SET[m [41mISO8859-1

COMPOUNDMIN[m 3
[41mCOMPOUNDRULE[m [41mm[m*
[41mNEEDCOMPOUND[m [41mx[m
3[41maffend[m

[31msearch hit BOTTOM, continuing at TOP[12;1H[?12l[?25h
[?25l[m[25;1H[K[25;1H:[?12l[?25hlet [str, a] = spellbadword()[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdl[m
['deol', 'dr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent
elequint
elekwint
elekwint
elekwent
elequint
elekwent
elequint[?12l[?25h[?25l[27m[m[H[2J[1;1H2[41mgood[m: puts
[41mbad[m: [41minputs[m [41mcomment[m [41mok[m [41mOk[m [41mend[m [41mthe[m. [44mtest[m [41mdl
badend

addstart[m
/[41mregions[m=[41musgbnz
elequint[m/2
[41melekwint[m/3
[41maddend

test2[m:
[41melequint[m test [41melekwint[m test [41melekwent[m [41masdf[m

Test [41mrules[m [41mfor[m [41mcompounding[m.

3[41maffstart
SET[m [41mISO8859-1

COMPOUNDMIN[m 3
[41mCOMPOUNDRULE[m [41mm[m*
[41mNEEDCOMPOUND[m [41mx[m
3[41maffend[m

3[41mdicstart[12;1H[?12l[?25h[14C[?25l[25;1H[m:[?12l[?25hlet [str, a] = spellbadword()[?25l[12;15H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdl[m
['deol', 'dr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent
elequint
elekwint
elekwint
elekwent
elequint
elekwent
elequint
elekwint[?12l[?25h[?25l
[m:[?12l[?25hunlet str a[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Postponed prefixes[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall TestOne('2', '1')[?25l"Xtest.aff" [25;13H[K[25;13H44 lines, 447 characters written
"Xtest.dic" 11 lines, 71 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - testCompressing word tree...[25;26H[K[25;1H
Compressed 10 of 98 nodes; 88 (89%) remaining
Compressed 0 of 13 nodes; 13 (100%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 505 bytes
17 lines yanked
17 more lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h"[?25l[1;1H[12L[1;1H[41mMAP[m [41me
MAP[m [41mi
MAP[m [41mo
MAP[m [41mu
MAP[m [41mn
MAP[m [41mc
MAP[m [41my
MAP[m [41ms[m
2[41maffend[m

2[41mgood[m: puts
[41mbad[m: [41minputs[m [41mcomment[m [41mok[m [41mOk[m [41mend[m [41mthe[m. [44mtest[m [41mdl
badend[m[13;7H[K[14;1H[K[15;1H[41maddstart[m[15;9H[K[16;1H/[41mregions[m=[41musgbnz[m[17;9H/2[18;9H/3
[41maddend[m[19;7H[K[20;1H[K[21;1H[41mtest2[m:[21;7H[K[22;4H[41mqui[m[3Ctest [41melekwint[m test [41melekwent[m [41masdf[m[23;1H[K[24;1HTest [41mrules[m [41mfor[m [41mcompounding[m.[25;1H[K[13;1H[?12l[?25h[?25l[25;1H:[?12l[?25h" Compound words[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall TestOne('3', '3')[?25l"Xtest.aff" [25;13H[K[25;13H5 lines, 60 characters written
"Xtest.dic" 5 lines, 29 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - fooCompressing word tree...[25;26H[K[25;1H
Compressed 6 of 29 nodes; 23 (79%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 115 bytes
3 lines yanked
3 more lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hcall TestOne('4', '4')[?25l"Xtest.aff" [25;13H[K[25;13H45 lines, 559 characters written
"Xtest.dic" 8 lines, 59 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - wordCompressing word tree...[25;26H[K[25;1H
Compressed 2 of 91 nodes; 89 (97%) remaining
Compressed 0 of 15 nodes; 15 (100%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 520 bytes
12 lines yanked
12 more lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hcall TestOne('5', '5')[?25l"Xtest.aff" [25;13H[K[25;13H25 lines, 237 characters written
"Xtest.dic" 6 lines, 57 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - fooCompressing word tree...[25;26H[K[25;1H
Compressed 19 of 105 nodes; 86 (81%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 440 bytes
10 lines yanked
10 more lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hcall TestOne('6', '6')[?25l"Xtest.aff" [25;13H[K[25;13H23 lines, 211 characters written
"Xtest.dic" 6 lines, 53 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - meeCompressing word tree...[25;26H[K[25;1H
Compressed 19 of 87 nodes; 68 (78%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 350 bytes
9 lines yanked
9 more lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hcall TestOne('7', '7')[?25l"Xtest.aff" [25;13H[K[25;13H22 lines, 223 characters written
"Xtest.dic" 6 lines, 67 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - meeCompressing word tree...[25;26H[K[25;1H
Compressed 19 of 89 nodes; 70 (78%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 360 bytes
9 lines yanked
9 more lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h"[?25l[27m[m[H[2J[1;1H1234
[41mmee[m/391,111,9999
bar/17,61003,123
lead/2
tail/123
[41mmiddle[m/77,1
7[41mdicend[m

7[41mgood[m: meea1 meea bar prebar barmeat prebarmeat  leadprebar[10;7Hlead tail leadtail  leadmiddletail
[41mbad[m: [41mmee[m [41mmeea2[m [41mprabar[m [41mprobarmaat[m [41mmiddle[m [41mleadmiddle[m [41mmiddletail[m [41mtaillead[12;9Hleadprobar
badend

Test[m [41mNOSLITSUGS[m

8[41maffstart
SET[m [41mISO8859[m-1

[41mNOSPLITSUGS[m
8[41maffend[m

8[41mdicstart[m
1234[13;1H[?12l[?25h[?25l[25;1H:[?12l[?25h" NOSLITSUGS[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall TestOne('8', '8')[?25l"Xtest.aff" [25;13H[K[25;13H3 lines, 27 characters written
"Xtest.dic" 4 lines, 20 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - fooCompressing word tree...[25;26H[K[25;1H
Compressed 8 of 26 nodes; 18 (69%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 90 bytes
4 lines yanked
4 more lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h"[?25l[1;1H[11L[1;1H[41mNOSPLITSUGS[m
8[41maffend[m

8[41mdicstart[m
1234
foo
bar
faabar
8[41mdicend[m

8[41mgood[m: foo bar faabar
[41mbad[m: [41mfoobar[m [41mbarfoo[m[15;1H[K[16;1H[41mtest[m [41moutput[m:[17;1H[K[18;1H[41mtest[m 1-1[18;9H[K[19;1H# [41mfile[m: [41mXtest[m.[41mlatin1[m.[41mspl
Comment[m[20;8H[K[21;1H[41mdeol[m[21;5H[K[22;1H[41mdr
input[m[23;6H[K[24;1H[41mOK[m[24;3H[K[25;1H[K[13;1H[?12l[?25h[?25l[25;1H:[?12l[?25h" clean up for valgrind[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hdelfunc TestOne[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset spl= enc=latin1[?25l[27m[m[H[2J[1;1HNOSPLITSUGS
8affend

8dicstart
1234
foo
bar
faabar
8dicend

8good: foo bar faabar
bad: foobar barfoo
badend


test output:

test 1-1
# file: Xtest.latin1.spl
Comment
deol
dr
input
OK[13;1H[?12l[?25h[?25l[25;1H:[?12l[?25h"[?25l[13;1H[?12l[?25h[?25l[27m[m[H[2J[1;1HTests for spell checking.     vim: set ft=vim :

STARTTEST
:so small.vim
:"
:" Don't want to depend on the locale from the environment
:set enc=latin1
:e!
:"
:" Function to test .aff/.dic with list of good and bad words.
:func TestOne(aff, dic)
  set spellfile=
  $put =''
  $put ='test '. a:aff . '-' . a:dic
  " Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
  mkspell! Xtest Xtest
  " use that spell file
  set spl=Xtest.latin1.spl spell
  " list all valid words
  spelldump
  %yank
  quit[1;1H[?12l[?25h[?25l[25;1H:[?12l[?25h/^test output:/,$wq! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 283 lines, 3793 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test59.failed test.ok test.out X* viminfo
cp test59.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test59.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test59.in" 626 lines, 10897 characters[1;1HTests for spell checking with 'encoding' set to "utf-8".  vim: set ft=vim :

STARTTEST
:so small.vim
:so mbyte.vim
:"
:" Don't want to depend on the locale from the environment.  The .aff and .dic
:" text is in latin1, the test text is utf-8.
:set enc=latin1
:e!
:set enc=utf-8
:set fenc=
:"
:" Function to test .aff/.dic with list of good and bad words.
:func TestOne(aff, dic)
  set spellfile=
  $put =''
  $put ='test '. a:aff . '-' . a:dic
  " Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
  mkspell! Xtest Xtest
  " use that spell file
  set spl=Xtest.utf-8.spl spell[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for spell checking with 'encoding' set to "utf-8".  vim: set ft=vim :[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 106 lines, 2520 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;1H:call TestOne('3', '3')
:call TestOne('4', '4')
:call TestOne('5', '5')
:call TestOne('6', '6')
:call TestOne('7', '7')
:"
:" clean up for valgrind
:delfunc TestOne
:set spl= enc=latin1
:"
gg:/^test output:/,$wq! test.out
ENDTEST

1affstart
SET ISO8859-1
TRY esianrtolcdugmphbyfvkwjkqxz-'ESIANRTOLCDUGMPHBYFVKWJKQXZ

FOL  
LOW  
UPP  

SOFOFROM abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ[23;1H޿
SOFOTO   ebctefghejklnnepkrstevvkesebctefghejklnnepkrstevvkeseeeeeeeceeeeeeeedne[24;1H[1m[34m@                                                                               [12;1H[?12l[?25h
[?25l[25;1H[m:so! Xdotest[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso mbyte.vim[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Don't want to depend on the locale from the environment.  The .aff and .dic[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" text is in latin1, the test text is utf-8.[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset enc=latin1[?25l[27m[m[H[2J[1;1H:call TestOne('3', '3')
:call TestOne('4', '4')
:call TestOne('5', '5')
:call TestOne('6', '6')
:call TestOne('7', '7')
:"
:" clean up for valgrind
:delfunc TestOne
:set spl= enc=latin1
:"
gg:/^test output:/,$wq! test.out
ENDTEST

1affstart
SET ISO8859-1
TRY esianrtolcdugmphbyfvkwjkqxz-'ESIANRTOLCDUGMPHBYFVKWJKQXZ

FOL  
LOW  
UPP  

SOFOFROM abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ[23;1H޿
SOFOTO   ebctefghejklnnepkrstevvkesebctefghejklnnepkrstevvkeseeeeeeeceeeeeeeedne[24;1H[1m[34m@                                                                               [13;1H[?12l[?25h[?25l[25;1H[m:[?12l[?25he![?25l"test59.in" 626 lines, 10897 characters[1;1HTests for spell checking with 'encoding' set to "utf-8".  vim: set ft=vim :[2;1H[K[3;1HSTARTTEST[3;10H[K[4;2Hso small.vim[4;14H[K[5;2Hso mbyte.vim[5;14H[K[7;4HDon't want to depend on the locale from the environment.  The .aff and .dic
:" text is in latin1, the test text is utf-8.[9;6Henc=latin1[9;16H[K[10;2He!
:set enc=utf-8[11;15H[K[12;1H:set fenc=
:"
:" Function to test .aff/.dic with list of good and bad words.
:func TestOne(aff, dic)
  set spellfile=[16;17H[K[17;3H$put =''
  $put ='test '. a:aff . '-' . a:dic[18;37H[K[19;1H  " Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
  mkspell! Xtest Xtest[22;23H[K[23;1H  " use that spell file[23;24H[K[24;1H  set spl=Xtest.utf-8.spl spell[24;32H[K[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset enc=utf-8[?25l[27m[m[H[2J[1;1HTests for spell checking with 'encoding' set to "utf-8".  vim: set ft=vim :

STARTTEST
:so small.vim
:so mbyte.vim
:"
:" Don't want to depend on the locale from the environment.  The .aff and .dic
:" text is in latin1, the test text is utf-8.
:set enc=latin1
:e!
:set enc=utf-8
:set fenc=
:"
:" Function to test .aff/.dic with list of good and bad words.
:func TestOne(aff, dic)
  set spellfile=
  $put =''
  $put ='test '. a:aff . '-' . a:dic
  " Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
  mkspell! Xtest Xtest
  " use that spell file
  set spl=Xtest.utf-8.spl spell[1;1H[?12l[?25h[?25l[25;1H:[?12l[?25hset fenc=[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Function to test .aff/.dic with list of good and bad words.[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfunc TestOne(aff, dic)[?25l
:  [?12l[?25h  set spellfile=
[?25l:  [?12l[?25h  $put =''
[?25l:  [?12l[?25h  $put ='test '. a:aff . '-' . a:dic
[?25l:  [?12l[?25h  " Generate a .spl file from a .dic and .aff file.
[?25l:  [?12l[?25h  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
[?25l:  [?12l[?25h  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
[?25l:  [?12l[?25h  mkspell! Xtest Xtest
[?25l:  [?12l[?25h  " use that spell file
[?25l:  [?12l[?25h  set spl=Xtest.utf-8.spl spell
[?25l:  [?12l[?25h  " list all valid words
[?25l:  [?12l[?25h  spelldump
[?25l:  [?12l[?25h  %yank
[?25l:  [?12l[?25h  quit
[?25l:  [?12l[?25h  $put
[?25l:  [?12l[?25h  $put ='-------'
[?25l:  [?12l[?25h  " find all bad words and suggestions for them
[?25l:  [?12l[?25h  exe '1;/^' . a:aff . 'good:'
[?25l:  [?12l[?25h  normal 0f:]s
[?25l:  [?12l[?25h  let prevbad = ''
[?25l:  [?12l[?25h  while 1
[?25l:    [?12l[?25h    let [bad, a] = spellbadword()
[?25l:    [?12l[?25h    if bad == '' || bad == prevbad || bad == 'badend'
[?25l:      [?12l[?25h      break
[?25l:      [?12l[?25h    endif
[?25l:    [?12l[?25h    let prevbad = bad
[?25l:    [?12l[?25h    let lst = spellsuggest(bad, 3)
[?25l:    [?12l[?25h    normal mm
[?25l:    [?12l[?25h    $put =bad
[?25l:    [?12l[?25h    $put =string(lst)
[?25l:    [?12l[?25h    normal `m]s
[?25l:    [?12l[?25h  endwhile
[?25l:  [?12l[?25hendfunc[27m[m[H[2J[?25l[1;1HTests for spell checking with 'encoding' set to "utf-8".  vim: set ft=vim :

STARTTEST
:so small.vim
:so mbyte.vim
:"
:" Don't want to depend on the locale from the environment.  The .aff and .dic
:" text is in latin1, the test text is utf-8.
:set enc=latin1
:e!
:set enc=utf-8
:set fenc=
:"
:" Function to test .aff/.dic with list of good and bad words.
:func TestOne(aff, dic)
  set spellfile=
  $put =''
  $put ='test '. a:aff . '-' . a:dic
  " Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
  mkspell! Xtest Xtest
  " use that spell file
  set spl=Xtest.utf-8.spl spell[1;1H[?12l[?25h[?25l[25;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall TestOne('1', '1')[?25l"Xtest.aff" [25;13H[K[25;13H[New File] 48 lines, 768 characters written
"Xtest.dic" [New File] 11 lines, 71 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - testCompressing word tree...[25;26H[K[25;1H
Compressed 29 of 131 nodes; 102 (77%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 510 bytes
Reading back spell file...
Performing soundfolding...
Total number of words: 16
Number of words after soundfolding: 16
Compressing word tree...
Compressed 39 of 104 nodes; 65 (62%) remaining
Writing suggestion file Xtest.utf-8.sug ...
Estimated runtime memory use: 357 bytes
17 lines yanked
17 more lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h$put =soundfold('goobledygoook')[?25l[1;1H[19L[1;1Htestn
the end
uk
wrong
-------
[41mbad[m
['put', 'uk', 'OK']
[41minputs[m
['input', 'puts', 'outputs']
[41mcomment[m
['Comment', 'outtest', 'the end']
[41mok[m
['OK', 'uk', 'put']
[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdéôl[m
['deol', 'déôr', 'test']
[41mend[m[20;4H[K[21;1H['put', 'uk', 'test'][21;22H[K[22;1H[41mthe[m[22;4H[K[23;1H['put', 'uk', 'test'][23;22H[K[24;1H[41mgebletegek[m[24;11H[K[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =soundfold('kóopërÿnôven')[?25l[1;24r[24;1H
[1;25r[24;1H[41mkepereneven[m[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =soundfold('oeverloos gezwets edale')[?25l[1;24r[24;1H
[1;25r[24;1H[41meverles[m [41mgesvets[m [41metele[m[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h"[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" and now with SAL instead of SOFO items; test automatic reloading[?25l[24;1H[?12l[?25h[?25l[27m[m[H[2J[1;1H[41mTests[m [41mfor[m [41mspell[m [41mchecking[m [41mwith[m '[41mencoding[m' [41mset[m [41mto[m "[41mutf-8[m".  [41mvim[m: [41mset[m [41mft[m=[41mvim[m :

[41mSTARTTEST[m
:[41mso[m [41msmall[m.[41mvim[m
:[41mso[m [41mmbyte[m.[41mvim[m
:"
:" [41mDon't[m [41mwant[m [41mto[m [41mdepend[m [41mon[m [41mthe[m [41mlocale[m [41mfrom[m [41mthe[m [41menvironment[m.  [41mThe[m .[41maff[m [41mand[m .[41mdic[m
:" [41mtext[m [41mis[m [41min[m [41mlatin1[m, [41mthe[m test [41mtext[m [41mis[m [41mutf-8[m.
:[41mset[m [41menc[m=[41mlatin1[m
:[41me[m!
:[41mset[m [41menc[m=[41mutf-8[m
:[41mset[m [41mfenc[m=
:"
:" [41mFunction[m [41mto[m test .[41maff[m/.[41mdic[m [41mwith[m [41mlist[m [41mof[m [41mgood[m [41mand[m [41mbad[m [41mwords[m.
:[41mfunc[m [41mTestOne[m([41maff[m, [41mdic[m)
  [41mset[m [41mspellfile[m=
  $put =''
  $put ='test '. [41ma[m:[41maff[m . '-' . [41ma[m:[41mdic[m
  " [41mGenerate[m [41ma[m .[41mspl[m [41mfile[m [41mfrom[m [41ma[m .[41mdic[m [41mand[m .[41maff[m [41mfile[m.
  [41mexe[m '1;/^' . [41ma[m:[41maff[m . '[41maffstart[m/+1,/^' . [41ma[m:[41maff[m . '[41maffend[m/-1[41mw[m! [41mXtest[m.[41maff[m'
  [41mexe[m '1;/^' . [41ma[m:[41mdic[m . '[41mdicstart[m/+1,/^' . [41ma[m:[41mdic[m . '[41mdicend[m/-1[41mw[m! [41mXtest[m.[41mdic[m'
  [41mmkspell[m! [41mXtest[m [41mXtest[m
  " [41muse[m [41mthat[m [41mspell[m [41mfile[m
  [41mset[m [41mspl[m=[41mXtest[m.[41mutf-8[m.[41mspl[m [41mspell[1;1H[?12l[?25h[?25l[25;1H[m:[?12l[?25h/^affstart_sal/+1,/^affend_sal/-1w! Xtest.aff[?25l"Xtest.aff" [25;13H[K[25;13H153 lines, 3426 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmkspell! Xtest Xtest[?25lReading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - testCompressing word tree...[25;26H[K[25;1H
Compressed 29 of 131 nodes; 102 (77%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 510 bytes
Performing soundfolding...
Total number of words: 16
Number of words after soundfolding: 15
Compressing word tree...
Compressed 33 of 75 nodes; 42 (56%) remaining
Writing suggestion file Xtest.utf-8.sug ...
Estimated runtime memory use: 241 bytes
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h$put =soundfold('goobledygoook')[?25l[1;1H[14L[1;1Hwrong
-------
[41mbad[m
['put', 'uk', 'OK']
[41minputs[m
['input', 'puts', 'outputs']
[41mcomment[m
['Comment', 'outtest', 'the end']
[41mok[m
['OK', 'uk', 'put']
[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdéôl[m[15;5H[K[16;1H['deol', 'déôr', 'test']
[41mend[m[17;4H[K[18;1H['put', 'uk', 'test'][18;22H[K[19;1H[41mthe[m[19;5H[K[20;1H['put', 'uk', 'test'][20;22H[K[21;1H[41mgebletegek[m[21;11H[K[22;1H[41mkepereneven[m[22;12H[K[23;1H[41meverles[m [41mgesvets[m [41metele[m[23;22H[K[24;1H[41mkbltykk[m[24;8H[K[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =soundfold('kóopërÿnôven')[?25l[1;24r[24;1H
[1;25r[24;1H[41mkprnfn[m[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =soundfold('oeverloos gezwets edale')[?25l[1;24r[24;1H
[1;25r[24;1H*[41mfls[m [41mkswts[m [41mtl[m[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h"[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" also use an addition file[?25l[24;1H[?12l[?25h[?25l[27m[m[H[2J[1;1H[41mTests[m [41mfor[m [41mspell[m [41mchecking[m [41mwith[m '[41mencoding[m' [41mset[m [41mto[m "[41mutf-8[m".  [41mvim[m: [41mset[m [41mft[m=[41mvim[m :

[41mSTARTTEST[m
:[41mso[m [41msmall[m.[41mvim[m
:[41mso[m [41mmbyte[m.[41mvim[m
:"
:" [41mDon't[m [41mwant[m [41mto[m [41mdepend[m [41mon[m [41mthe[m [41mlocale[m [41mfrom[m [41mthe[m [41menvironment[m.  [41mThe[m .[41maff[m [41mand[m .[41mdic[m
:" [41mtext[m [41mis[m [41min[m [41mlatin1[m, [41mthe[m test [41mtext[m [41mis[m [41mutf-8[m.
:[41mset[m [41menc[m=[41mlatin1[m
:[41me[m!
:[41mset[m [41menc[m=[41mutf-8[m
:[41mset[m [41mfenc[m=
:"
:" [41mFunction[m [41mto[m test .[41maff[m/.[41mdic[m [41mwith[m [41mlist[m [41mof[m [41mgood[m [41mand[m [41mbad[m [41mwords[m.
:[41mfunc[m [41mTestOne[m([41maff[m, [41mdic[m)
  [41mset[m [41mspellfile[m=
  $put =''
  $put ='test '. [41ma[m:[41maff[m . '-' . [41ma[m:[41mdic[m
  " [41mGenerate[m [41ma[m .[41mspl[m [41mfile[m [41mfrom[m [41ma[m .[41mdic[m [41mand[m .[41maff[m [41mfile[m.
  [41mexe[m '1;/^' . [41ma[m:[41maff[m . '[41maffstart[m/+1,/^' . [41ma[m:[41maff[m . '[41maffend[m/-1[41mw[m! [41mXtest[m.[41maff[m'
  [41mexe[m '1;/^' . [41ma[m:[41mdic[m . '[41mdicstart[m/+1,/^' . [41ma[m:[41mdic[m . '[41mdicend[m/-1[41mw[m! [41mXtest[m.[41mdic[m'
  [41mmkspell[m! [41mXtest[m [41mXtest[m
  " [41muse[m [41mthat[m [41mspell[m [41mfile[m
  [41mset[m [41mspl[m=[41mXtest[m.[41mutf-8[m.[41mspl[m [41mspell[1;1H[?12l[?25h[?25l[25;1H[m:[?12l[?25h/^addstart/+1,/^addend/-1w! Xtest.utf-8.add[?25l"Xtest.utf-8.add" [25;19H[K[25;19H[New File] 3 lines, 38 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmkspell! Xtest.utf-8.add.spl Xtest.utf-8.add[?25lReading word file Xtest.utf-8.add ...[25;38H[K[25;1H
Compressing word tree...
Compressed 0 of 29 nodes; 29 (100%) remaining
Writing spell file Xtest.utf-8.add.spl ...
Done!
Estimated runtime memory use: 145 bytes
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hset spellfile=Xtest.utf-8.add[?25l[1;1H[6L[1;1H[41mTests[m [41mfor[m [41mspell[m [41mchecking[m [41mwith[m '[41mencoding[m' [41mset[m [41mto[m "[41mutf-8[m".  [41mvim[m: [41mset[m [41mft[m=[41mvim[m :

[41mSTARTTEST[m
:[41mso[m [41msmall[m.[41mvim[m
:[41mso[m [41mmbyte[m.[41mvim[m
:"[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/[?12l[?25h^test2:[?25l[27m[m[H[2J[1;8H [41mtomato[m [41mtomatotomato[m [41mstartend[m [41mstartword[m [41mstartwordword[m [41mstartwordend[m[2;8H [41mstartwordwordend[m [41mstartwordwordwordend[m [41mprebork[m [41mpreborkbork[m[3;8H [41mpreborkborkbork[m[4;8H [41mnouword
bad[m: [41mwordutilize[m [41mpro[m [41mborkborkborkborkborkbork[m [41mtomatotomatotomato[m[6;8H [41mendstart[m [41mendend[m [41mstartstart[m [41mwordend[m [41mwordstart[m[7;8H [41mpreborkprebork[m  [41mpreborkpreborkbork[m[8;8H [41mstartwordwordwordwordend[m [41mborkpreborkpreborkbork[m[9;8H [41mutilsbork[m  [41mstartnouword
badend

test2[m:
elequint test elekwint test [41melekwent[m [41masdf[m

Test [41maffix[m [41mflags[m [41mwith[m [41mtwo[m [41mcharacters[m

5[41maffstart
SET[m [41mISO8859-1

FLAG[m [41mlong

NEEDAFFIX[m !!

[41mCOMPOUNDRULE[m [41mssmm[m*[41mee[12;1H[?12l[?25h[13;29H[?25l[25;1H[m:[?12l[?25hlet [str, a] = spellbadword()[?25l[13;29H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H['put', 'uk', 'OK']
[41minputs[m
['input', 'puts', 'outputs']
[41mcomment[m
['Comment', 'outtest', 'the end']
[41mok[m
['OK', 'uk', 'put']
[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdéôl[m
['deol', 'déôr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent[?12l[?25h[?25l
[m:[?12l[?25hset spl=Xtest_us.utf-8.spl[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^test2:[?25l[31msearch hit BOTTOM, continuing at TOP[27m[m[H[2J[1;8H [41mtomato[m [41mtomatotomato[m [41mstartend[m [41mstartword[m [41mstartwordword[m [41mstartwordend[m[2;8H [41mstartwordwordend[m [41mstartwordwordwordend[m [41mprebork[m [41mpreborkbork[m[3;8H [41mpreborkborkbork[m[4;8H [41mnouword
bad[m: [41mwordutilize[m [41mpro[m [41mborkborkborkborkborkbork[m [41mtomatotomatotomato[m[6;8H [41mendstart[m [41mendend[m [41mstartstart[m [41mwordend[m [41mwordstart[m[7;8H [41mpreborkprebork[m  [41mpreborkpreborkbork[m[8;8H [41mstartwordwordwordwordend[m [41mborkpreborkpreborkbork[m[9;8H [41mutilsbork[m  [41mstartnouword
badend

test2[m:
[46melequint[m test [46melekwint[m test [41melekwent[m [41masdf[m

Test [41maffix[m [41mflags[m [41mwith[m [41mtwo[m [41mcharacters[m

5[41maffstart
SET[m [41mISO8859-1

FLAG[m [41mlong

NEEDAFFIX[m !!

[41mCOMPOUNDRULE[m [41mssmm[m*[41mee[m
[31msearch hit BOTTOM, continuing at TOP[12;1H[?12l[?25h
[?25l[m[25;1H[K[25;1H:[?12l[?25hlet [str, a] = spellbadword()[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H[41minputs[m
['input', 'puts', 'outputs']
[41mcomment[m
['Comment', 'outtest', 'the end']
[41mok[m
['OK', 'uk', 'put']
[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdéôl[m
['deol', 'déôr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent[m
[46melequint[?12l[?25h[?25l[27m[m[H[2J[1;8H [41mstartwordwordend[m [41mstartwordwordwordend[m [41mprebork[m [41mpreborkbork[m[2;8H [41mpreborkborkbork[m[3;8H [41mnouword
bad[m: [41mwordutilize[m [41mpro[m [41mborkborkborkborkborkbork[m [41mtomatotomatotomato[m[5;8H [41mendstart[m [41mendend[m [41mstartstart[m [41mwordend[m [41mwordstart[m[6;8H [41mpreborkprebork[m  [41mpreborkpreborkbork[m[7;8H [41mstartwordwordwordwordend[m [41mborkpreborkpreborkbork[m[8;8H [41mutilsbork[m  [41mstartnouword
badend

test2[m:
[46melequint[m test [46melekwint[m test [41melekwent[m [41masdf[m

Test [41maffix[m [41mflags[m [41mwith[m [41mtwo[m [41mcharacters[m

5[41maffstart
SET[m [41mISO8859-1

FLAG[m [41mlong

NEEDAFFIX[m !!

[41mCOMPOUNDRULE[m [41mssmm[m*[41mee[12;1H[?12l[?25h[14C[?25l[25;1H[m:[?12l[?25hlet [str, a] = spellbadword()[?25l[12;15H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H['input', 'puts', 'outputs']
[41mcomment[m
['Comment', 'outtest', 'the end']
[41mok[m
['OK', 'uk', 'put']
[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdéôl[m
['deol', 'déôr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent[m
[46melequint
elekwint[?12l[?25h[?25l
[m:[?12l[?25hset spl=Xtest_gb.utf-8.spl[?25l[23;1Helequint
[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^test2:[?25l[31msearch hit BOTTOM, continuing at TOP[27m[m[H[2J[1;8H [41mtomato[m [41mtomatotomato[m [41mstartend[m [41mstartword[m [41mstartwordword[m [41mstartwordend[m[2;8H [41mstartwordwordend[m [41mstartwordwordwordend[m [41mprebork[m [41mpreborkbork[m[3;8H [41mpreborkborkbork[m[4;8H [41mnouword
bad[m: [41mwordutilize[m [41mpro[m [41mborkborkborkborkborkbork[m [41mtomatotomatotomato[m[6;8H [41mendstart[m [41mendend[m [41mstartstart[m [41mwordend[m [41mwordstart[m[7;8H [41mpreborkprebork[m  [41mpreborkpreborkbork[m[8;8H [41mstartwordwordwordwordend[m [41mborkpreborkpreborkbork[m[9;8H [41mutilsbork[m  [41mstartnouword
badend

test2[m:
elequint test [46melekwint[m test [41melekwent[m [41masdf[m

Test [41maffix[m [41mflags[m [41mwith[m [41mtwo[m [41mcharacters[m

5[41maffstart
SET[m [41mISO8859-1

FLAG[m [41mlong

NEEDAFFIX[m !!

[41mCOMPOUNDRULE[m [41mssmm[m*[41mee[m
[31msearch hit BOTTOM, continuing at TOP[12;1H[?12l[?25h[13;15H[?25l[m[25;1H[K[25;1H:[?12l[?25hlet [str, a] = spellbadword()[?25l[13;15H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H[41mcomment[m
['Comment', 'outtest', 'the end']
[41mok[m
['OK', 'uk', 'put']
[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdéôl[m
['deol', 'déôr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent[m
elequint
[46melekwint
elekwint[?12l[?25h[?25l[27m[m[H[2J[1;8H [41mstartwordwordend[m [41mstartwordwordwordend[m [41mprebork[m [41mpreborkbork[m[2;8H [41mpreborkborkbork[m[3;8H [41mnouword
bad[m: [41mwordutilize[m [41mpro[m [41mborkborkborkborkborkbork[m [41mtomatotomatotomato[m[5;8H [41mendstart[m [41mendend[m [41mstartstart[m [41mwordend[m [41mwordstart[m[6;8H [41mpreborkprebork[m  [41mpreborkpreborkbork[m[7;8H [41mstartwordwordwordwordend[m [41mborkpreborkpreborkbork[m[8;8H [41mutilsbork[m  [41mstartnouword
badend

test2[m:
elequint test [46melekwint[m test [41melekwent[m [41masdf[m

Test [41maffix[m [41mflags[m [41mwith[m [41mtwo[m [41mcharacters[m

5[41maffstart
SET[m [41mISO8859-1

FLAG[m [41mlong

NEEDAFFIX[m !!

[41mCOMPOUNDRULE[m [41mssmm[m*[41mee[12;15H[?12l[?25h[14C[?25l[25;1H[m:[?12l[?25hlet [str, a] = spellbadword()[?25l[12;29H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H['Comment', 'outtest', 'the end']
[41mok[m
['OK', 'uk', 'put']
[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdéôl[m
['deol', 'déôr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent[m
elequint
[46melekwint
elekwint[m
[41melekwent[?12l[?25h[?25l
[m:[?12l[?25hset spl=Xtest_nz.utf-8.spl[?25l[21;1H[46melequint[m
elekwint
elekwint
[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^test2:[?25l[31msearch hit BOTTOM, continuing at TOP[27m[m[H[2J[1;8H [41mtomato[m [41mtomatotomato[m [41mstartend[m [41mstartword[m [41mstartwordword[m [41mstartwordend[m[2;8H [41mstartwordwordend[m [41mstartwordwordwordend[m [41mprebork[m [41mpreborkbork[m[3;8H [41mpreborkborkbork[m[4;8H [41mnouword
bad[m: [41mwordutilize[m [41mpro[m [41mborkborkborkborkborkbork[m [41mtomatotomatotomato[m[6;8H [41mendstart[m [41mendend[m [41mstartstart[m [41mwordend[m [41mwordstart[m[7;8H [41mpreborkprebork[m  [41mpreborkpreborkbork[m[8;8H [41mstartwordwordwordwordend[m [41mborkpreborkpreborkbork[m[9;8H [41mutilsbork[m  [41mstartnouword
badend

test2[m:
[46melequint[m test elekwint test [41melekwent[m [41masdf[m

Test [41maffix[m [41mflags[m [41mwith[m [41mtwo[m [41mcharacters[m

5[41maffstart
SET[m [41mISO8859-1

FLAG[m [41mlong

NEEDAFFIX[m !!

[41mCOMPOUNDRULE[m [41mssmm[m*[41mee[m
[31msearch hit BOTTOM, continuing at TOP[12;1H[?12l[?25h
[?25l[m[25;1H[K[25;1H:[?12l[?25hlet [str, a] = spellbadword()[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H[41mok[m
['OK', 'uk', 'put']
[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdéôl[m
['deol', 'déôr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent[m
[46melequint[m
elekwint
elekwint
[41melekwent[m
[46melequint[?12l[?25h[?25l[27m[m[H[2J[1;8H [41mstartwordwordend[m [41mstartwordwordwordend[m [41mprebork[m [41mpreborkbork[m[2;8H [41mpreborkborkbork[m[3;8H [41mnouword
bad[m: [41mwordutilize[m [41mpro[m [41mborkborkborkborkborkbork[m [41mtomatotomatotomato[m[5;8H [41mendstart[m [41mendend[m [41mstartstart[m [41mwordend[m [41mwordstart[m[6;8H [41mpreborkprebork[m  [41mpreborkpreborkbork[m[7;8H [41mstartwordwordwordwordend[m [41mborkpreborkpreborkbork[m[8;8H [41mutilsbork[m  [41mstartnouword
badend

test2[m:
[46melequint[m test elekwint test [41melekwent[m [41masdf[m

Test [41maffix[m [41mflags[m [41mwith[m [41mtwo[m [41mcharacters[m

5[41maffstart
SET[m [41mISO8859-1

FLAG[m [41mlong

NEEDAFFIX[m !!

[41mCOMPOUNDRULE[m [41mssmm[m*[41mee[12;1H[?12l[?25h[28C[?25l[25;1H[m:[?12l[?25hlet [str, a] = spellbadword()[?25l[12;29H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H['OK', 'uk', 'put']
[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdéôl[m
['deol', 'déôr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent[m
[46melequint[m
elekwint
elekwint
[41melekwent[m
[46melequint[m
[41melekwent[?12l[?25h[?25l
[m:[?12l[?25hset spl=Xtest_ca.utf-8.spl[?25l[19;1H[41melequint
elekwint
elekwint

elequint
[?12l[?25h[?25l[m[25;1H[K[25;1H/[?12l[?25h^test2:[?25l[31msearch hit BOTTOM, continuing at TOP[27m[m[H[2J[1;8H [41mtomato[m [41mtomatotomato[m [41mstartend[m [41mstartword[m [41mstartwordword[m [41mstartwordend[m[2;8H [41mstartwordwordend[m [41mstartwordwordwordend[m [41mprebork[m [41mpreborkbork[m[3;8H [41mpreborkborkbork[m[4;8H [41mnouword
bad[m: [41mwordutilize[m [41mpro[m [41mborkborkborkborkborkbork[m [41mtomatotomatotomato[m[6;8H [41mendstart[m [41mendend[m [41mstartstart[m [41mwordend[m [41mwordstart[m[7;8H [41mpreborkprebork[m  [41mpreborkpreborkbork[m[8;8H [41mstartwordwordwordwordend[m [41mborkpreborkpreborkbork[m[9;8H [41mutilsbork[m  [41mstartnouword
badend

test2[m:
[41melequint[m test [41melekwint[m test [41melekwent[m [41masdf[m

Test [41maffix[m [41mflags[m [41mwith[m [41mtwo[m [41mcharacters[m

5[41maffstart
SET[m [41mISO8859-1

FLAG[m [41mlong

NEEDAFFIX[m !!

[41mCOMPOUNDRULE[m [41mssmm[m*[41mee[m
[31msearch hit BOTTOM, continuing at TOP[12;1H[?12l[?25h
[?25l[m[25;1H[K[25;1H:[?12l[?25hlet [str, a] = spellbadword()[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdéôl[m
['deol', 'déôr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent
elequint
elekwint
elekwint
elekwent
elequint
elekwent
elequint[?12l[?25h[?25l[27m[m[H[2J[1;8H [41mstartwordwordend[m [41mstartwordwordwordend[m [41mprebork[m [41mpreborkbork[m[2;8H [41mpreborkborkbork[m[3;8H [41mnouword
bad[m: [41mwordutilize[m [41mpro[m [41mborkborkborkborkborkbork[m [41mtomatotomatotomato[m[5;8H [41mendstart[m [41mendend[m [41mstartstart[m [41mwordend[m [41mwordstart[m[6;8H [41mpreborkprebork[m  [41mpreborkpreborkbork[m[7;8H [41mstartwordwordwordwordend[m [41mborkpreborkpreborkbork[m[8;8H [41mutilsbork[m  [41mstartnouword
badend

test2[m:
[41melequint[m test [41melekwint[m test [41melekwent[m [41masdf[m

Test [41maffix[m [41mflags[m [41mwith[m [41mtwo[m [41mcharacters[m

5[41maffstart
SET[m [41mISO8859-1

FLAG[m [41mlong

NEEDAFFIX[m !!

[41mCOMPOUNDRULE[m [41mssmm[m*[41mee[12;1H[?12l[?25h[14C[?25l[25;1H[m:[?12l[?25hlet [str, a] = spellbadword()[?25l[12;15H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdéôl[m
['deol', 'déôr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent
elequint
elekwint
elekwint
elekwent
elequint
elekwent
elequint
elekwint[?12l[?25h[?25l
[m:[?12l[?25hunlet str a[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Postponed prefixes[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall TestOne('2', '1')[?25l"Xtest.aff" [25;13H[K[25;13H46 lines, 461 characters written
"Xtest.dic" 11 lines, 71 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - testCompressing word tree...[25;26H[K[25;1H
Compressed 10 of 102 nodes; 92 (90%) remaining
Compressed 0 of 13 nodes; 13 (100%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 525 bytes
17 lines yanked
17 more lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h"[?25l[1;1H[12L[1;1H[41maddstart[m
/[41mregions[m=[41musgbnz
elequint[m/2
[41melekwint[m/3
[41maddend[m

1[41mgood[m: wrong OK puts. Test the end
[41mbad[m:  [41minputs[m [41mcomment[m [41mok[m [41mOk[m. [44mtest[m [41mdéôl[m [41mend[m [41mthe
badend[m

2[41mgood[m: puts
[41mbad[m: [41minputs[m [41mcomment[m [41mok[m [41mOk[m [41mend[m [41mthe[m. [44mtest[m [41mdéôl
badend[m[13;7H[K[14;1H[K[15;1HTest [41mrule[m[1C [41mfor[m [41mcompounding[m.[16;1H[K[17;1H3[41maffstart
SET[m [41mISO8859-1[m[19;1H[K[20;1H[41mCOMPOUNDMIN[m 3
[41mCOMPOUNDRULE[m [41mm[m*
[41mNEEDCOMPOUND[m [41mx[m
3[41maffend[m[23;8H[K[24;1H[K[25;1H[K[13;1H[?12l[?25h[?25l[25;1H:[?12l[?25h" Compound words[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall TestOne('3', '3')[?25l"Xtest.aff" [25;13H[K[25;13H5 lines, 60 characters written
"Xtest.dic" 5 lines, 29 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - fooCompressing word tree...[25;26H[K[25;1H
Compressed 6 of 31 nodes; 25 (80%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 125 bytes
3 lines yanked
3 more lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hcall TestOne('4', '4')[?25l"Xtest.aff" [25;13H[K[25;13H45 lines, 559 characters written
"Xtest.dic" 8 lines, 59 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - wordCompressing word tree...[25;26H[K[25;1H
Compressed 2 of 91 nodes; 89 (97%) remaining
Compressed 0 of 15 nodes; 15 (100%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 520 bytes
12 lines yanked
12 more lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hcall TestOne('5', '5')[?25l"Xtest.aff" [25;13H[K[25;13H25 lines, 237 characters written
"Xtest.dic" 6 lines, 57 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - fooCompressing word tree...[25;26H[K[25;1H
Compressed 19 of 107 nodes; 88 (82%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 440 bytes
10 lines yanked
10 more lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hcall TestOne('6', '6')[?25l"Xtest.aff" [25;13H[K[25;13H23 lines, 211 characters written
"Xtest.dic" 6 lines, 53 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - meeCompressing word tree...[25;26H[K[25;1H
Compressed 19 of 89 nodes; 70 (78%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 350 bytes
9 lines yanked
9 more lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hcall TestOne('7', '7')[?25l"Xtest.aff" [25;13H[K[25;13H26 lines, 338 characters written
"Xtest.dic" 6 lines, 67 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - meeCompressing word tree...[25;26H[K[25;1H
Compressed 19 of 91 nodes; 72 (79%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 360 bytes
9 lines yanked
9 more lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h"[?25l[27m[m[H[2J[1;1H1234
[41mmee[m/391,111,9999
bar/17,61003,123
lead/2
tail/123
[41mmiddle[m/77,1
7[41mdicend[m

7[41mgood[m: meea1 meeaé bar prebar barmeat prebarmeat  leadprebar[10;6H lead tail leadtail  leadmiddletail
[41mbad[m: [41mmee[m [41mmeea2[m [41mprabar[m [41mprobarmaat[m [41mmiddle[m [41mleadmiddle[m [41mmiddletail[m [41mtaillead[m[12;8H [41mleadprobar
badend

test[m [41moutput[m:

[41mtest[m 1-1
# [41mfile[m: [41mXtest[m.[41mutf[m-8.[41mspl
Comment
deol
déôr
input
OK
output[13;1H[?12l[?25h[?25l[25;1H[m:[?12l[?25h" clean up for valgrind[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hdelfunc TestOne[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset spl= enc=latin1[?25l[27m[m[H[2J[1;1H1234
mee/391,111,9999
bar/17,61003,123
lead/2
tail/123
middle/77,1
7dicend

7good: meea1 meeaé bar prebar barmeat prebarmeat  leadprebar[10;7Hlead tail leadtail  leadmiddletail
bad: mee meea2 prabar probarmaat middle leadmiddle middletail taillead[12;9Hleadprobar
badend

test output:

test 1-1
# file: Xtest.utf-8.spl
Comment
deol
déôr
input
OK
output[13;1H[?12l[?25h[?25l[25;1H:[?12l[?25h"[?25l[13;1H[?12l[?25h[?25l[27m[m[H[2J[1;1HTests for spell checking with 'encoding' set to "utf-8".  vim: set ft=vim :

STARTTEST
:so small.vim
:so mbyte.vim
:"
:" Don't want to depend on the locale from the environment.  The .aff and .dic
:" text is in latin1, the test text is utf-8.
:set enc=latin1
:e!
:set enc=utf-8
:set fenc=
:"
:" Function to test .aff/.dic with list of good and bad words.
:func TestOne(aff, dic)
  set spellfile=
  $put =''
  $put ='test '. a:aff . '-' . a:dic
  " Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
  mkspell! Xtest Xtest
  " use that spell file
  set spl=Xtest.utf-8.spl spell[1;1H[?12l[?25h[?25l[25;1H:[?12l[?25h/^test output:/,$wq! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 270 lines, 3685 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test60.failed test.ok test.out X* viminfo
cp test60.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test60.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test60.in" 580 lines, 12483 characters[1;1HTests for the exists() function.  vim: set ft=vim :

STARTTEST
:so small.vim
:function! RunTest(str, result)
    if exists(a:str) == a:result[7;9Hecho "OK"
    else[9;9Hecho "FAILED: Checking for " . a:str
    endif
endfunction
:function! TestExists()
    augroup myagroup[14;9Hautocmd! BufEnter *.my echo 'myfile edited'
    augroup END[17;5Hlet test_cases = [][19;5H" valid autocmd group
    let test_cases += [['#myagroup', 1]]
    " valid autocmd group with garbage
    let test_cases += [['#myagroup+b', 0]]
    " Valid autocmd group and event
    let test_cases += [['#myagroup#BufEnter', 1]][1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for the exists() function.  vim: set ft=vim :[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 575 lines, 12411 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;9Hendif[3;9Hecho 'a:2: 0'[4;9Hif !exists('a:2')[5;13Hecho "OK"[6;9Helse[7;13Hecho "FAILED"[8;9Hendif
    endfunction[11;5Hcall TestFuncArg("arg1", "arg2")[13;5Hredir END
endfunction
:call TestExists()
:delfunc TestExists
:delfunc RunTest
:delfunc TestFuncArg
:edit! test.out
:set ff=unix
:w
:qa!
ENDTEST[?12l[?25h
[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfunction! RunTest(str, result)[?25l
:  [?12l[?25h    if exists(a:str) == a:result
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED: Checking for " . a:str
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25hendfunction[1;1H[6L[?25l[1;9Hendif[3;9Hecho 'a:2: 0'[4;9Hif !exists('a:2')[5;13Hecho "OK"[6;9Helse[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hfunction! TestExists()[?25l
:  [?12l[?25h    augroup myagroup
[?25l:  [?12l[?25h[34m^I[mautocmd! BufEnter *.my echo 'myfile edited'
[?25l:  [?12l[?25h    augroup END
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    let test_cases = []
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " valid autocmd group
[?25l:  [?12l[?25h    let test_cases += [['#myagroup', 1]]
[?25l:  [?12l[?25h    " valid autocmd group with garbage
[?25l:  [?12l[?25h    let test_cases += [['#myagroup+b', 0]]
[?25l:  [?12l[?25h    " Valid autocmd group and event
[?25l:  [?12l[?25h    let test_cases += [['#myagroup#BufEnter', 1]]
[?25l:  [?12l[?25h    " Valid autocmd group, event and pattern
[?25l:  [?12l[?25h    let test_cases += [['#myagroup#BufEnter#*.my', 1]]
[?25l:  [?12l[?25h    " Valid autocmd event
[?25l:  [?12l[?25h    let test_cases += [['#BufEnter', 1]]
[?25l:  [?12l[?25h    " Valid autocmd event and pattern
[?25l:  [?12l[?25h    let test_cases += [['#BufEnter#*.my', 1]]
[?25l:  [?12l[?25h    " Non-existing autocmd group or event
[?25l:  [?12l[?25h    let test_cases += [['#xyzagroup', 0]]
[?25l:  [?12l[?25h    " Non-existing autocmd group and valid autocmd event
[?25l:  [?12l[?25h    let test_cases += [['#xyzagroup#BufEnter', 0]]
[?25l:  [?12l[?25h    " Valid autocmd group and event with no matching pattern
[?25l:  [?12l[?25h    let test_cases += [['#myagroup#CmdwinEnter', 0]]
[?25l:  [?12l[?25h    " Valid autocmd group and non-existing autocmd event
[?25l:  [?12l[?25h    let test_cases += [['#myagroup#xyzacmd', 0]]
[?25l:  [?12l[?25h    " Valid autocmd group and event and non-matching pattern
[?25l:  [?12l[?25h    let test_cases += [['#myagroup#BufEnter#xyzpat', 0]]
[?25l:  [?12l[?25h    " Valid autocmd event and non-matching pattern
[?25l:  [?12l[?25h    let test_cases += [['#BufEnter#xyzpat', 0]]
[?25l:  [?12l[?25h    " Empty autocmd group, event and pattern
[?25l:  [?12l[?25h    let test_cases += [['###', 0]]
[?25l:  [?12l[?25h    " Empty autocmd group and event or empty event and pattern
[?25l:  [?12l[?25h    let test_cases += [['##', 0]]
[?25l:  [?12l[?25h    " Valid autocmd event
[?25l:  [?12l[?25h    let test_cases += [['##FileReadCmd', 1]]
[?25l:  [?12l[?25h    " Non-existing autocmd event
[?25l:  [?12l[?25h    let test_cases += [['##MySpecialCmd', 0]]
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing and working option (long form)
[?25l:  [?12l[?25h    let test_cases += [['&textwidth', 1]]
[?25l:  [?12l[?25h    " Existing and working option (short form)
[?25l:  [?12l[?25h    let test_cases += [['&tw', 1]]
[?25l:  [?12l[?25h    " Existing and working option with garbage
[?25l:  [?12l[?25h    let test_cases += [['&tw-', 0]]
[?25l:  [?12l[?25h    " Global option
[?25l:  [?12l[?25h    let test_cases += [['&g:errorformat', 1]]
[?25l:  [?12l[?25h    " Local option
[?25l:  [?12l[?25h    let test_cases += [['&l:errorformat', 1]]
[?25l:  [?12l[?25h    " Negative form of existing and working option (long form)
[?25l:  [?12l[?25h    let test_cases += [['&nojoinspaces', 0]]
[?25l:  [?12l[?25h    " Negative form of existing and working option (short form)
[?25l:  [?12l[?25h    let test_cases += [['&nojs', 0]]
[?25l:  [?12l[?25h    " Non-existing option
[?25l:  [?12l[?25h    let test_cases += [['&myxyzoption', 0]]
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing and working option (long form)
[?25l:  [?12l[?25h    let test_cases += [['+incsearch', 1]]
[?25l:  [?12l[?25h    " Existing and working option with garbage
[?25l:  [?12l[?25h    let test_cases += [['+incsearch!1', 0]]
[?25l:  [?12l[?25h    " Existing and working option (short form)
[?25l:  [?12l[?25h    let test_cases += [['+is', 1]]
[?25l:  [?12l[?25h    " Existing option that is hidden.
[?25l:  [?12l[?25h    let test_cases += [['+autoprint', 0]]
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing environment variable
[?25l:  [?12l[?25h    let $EDITOR_NAME = 'Vim Editor'
[?25l:  [?12l[?25h    let test_cases += [['$EDITOR_NAME', 1]]
[?25l:  [?12l[?25h    " Non-existing environment variable
[?25l:  [?12l[?25h    let test_cases += [['$NON_ENV_VAR', 0]]
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Valid internal function
[?25l:  [?12l[?25h    let test_cases += [['*bufnr', 1]]
[?25l:  [?12l[?25h    " Valid internal function with ()
[?25l:  [?12l[?25h    let test_cases += [['*bufnr()', 1]]
[?25l:  [?12l[?25h    " Non-existing internal function
[?25l:  [?12l[?25h    let test_cases += [['*myxyzfunc', 0]]
[?25l:  [?12l[?25h    " Valid internal function with garbage
[?25l:  [?12l[?25h    let test_cases += [['*bufnr&6', 0]]
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Valid user defined function
[?25l:  [?12l[?25h    let test_cases += [['*TestExists', 1]]
[?25l:  [?12l[?25h    " Non-existing user defined function
[?25l:  [?12l[?25h    let test_cases += [['*MyxyzFunc', 0]]
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    redir! > test.out
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    for [test_case, result] in test_cases
[?25l:    [?12l[?25h      [34m^I[mecho test_case . ": " . result
[?25l:    [?12l[?25h        call RunTest(test_case, result)
[?25l:    [?12l[?25h    endfor
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Valid internal command (full match)
[?25l:  [?12l[?25h    echo ':edit: 2'
[?25l:  [?12l[?25h    if exists(':edit') == 2
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Valid internal command (full match) with garbage
[?25l:  [?12l[?25h    echo ':edit/a: 0'
[?25l:  [?12l[?25h    if exists(':edit/a') == 0
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Valid internal command (partial match)
[?25l:  [?12l[?25h    echo ':q: 1'
[?25l:  [?12l[?25h    if exists(':q') == 1
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing internal command
[?25l:  [?12l[?25h    echo ':invalidcmd: 0'
[?25l:  [?12l[?25h    if !exists(':invalidcmd')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " User defined command (full match)
[?25l:  [?12l[?25h    command! MyCmd :echo 'My command'
[?25l:  [?12l[?25h    echo ':MyCmd: 2'
[?25l:  [?12l[?25h    if exists(':MyCmd') == 2
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " User defined command (partial match)
[?25l:  [?12l[?25h    command! MyOtherCmd :echo 'Another command'
[?25l:  [?12l[?25h    echo ':My: 3'
[?25l:  [?12l[?25h    if exists(':My') == 3
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Command modifier
[?25l:  [?12l[?25h    echo ':rightbelow: 2'
[?25l:  [?12l[?25h    if exists(':rightbelow') == 2
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing user defined command (full match)
[?25l:  [?12l[?25h    delcommand MyCmd
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    echo ':MyCmd: 0'
[?25l:  [?12l[?25h    if !exists(':MyCmd')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing user defined command (partial match)
[?25l:  [?12l[?25h    delcommand MyOtherCmd
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    echo ':My: 0'
[?25l:  [?12l[?25h    if !exists(':My')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Valid local variable
[?25l:  [?12l[?25h    let local_var = 1
[?25l:  [?12l[?25h    echo 'local_var: 1'
[?25l:  [?12l[?25h    if exists('local_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Valid local variable with garbage
[?25l:  [?12l[?25h    let local_var = 1
[?25l:  [?12l[?25h    echo 'local_var%n: 0'
[?25l:  [?12l[?25h    if !exists('local_var%n')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing local variable
[?25l:  [?12l[?25h    unlet local_var
[?25l:  [?12l[?25h    echo 'local_var: 0'
[?25l:  [?12l[?25h    if !exists('local_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Valid local list
[?25l:  [?12l[?25h    let local_list = ["blue", "orange"]
[?25l:  [?12l[?25h    echo 'local_list: 1'
[?25l:  [?12l[?25h    if exists('local_list')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Valid local list item
[?25l:  [?12l[?25h    echo 'local_list[1]: 1'
[?25l:  [?12l[?25h    if exists('local_list[1]')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Valid local list item with garbage
[?25l:  [?12l[?25h    echo 'local_list[1]+5: 0'
[?25l:  [?12l[?25h    if !exists('local_list[1]+5')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Invalid local list item
[?25l:  [?12l[?25h    echo 'local_list[2]: 0'
[?25l:  [?12l[?25h    if !exists('local_list[2]')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing local list
[?25l:  [?12l[?25h    unlet local_list
[?25l:  [?12l[?25h    echo 'local_list: 0'
[?25l:  [?12l[?25h    if !exists('local_list')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Valid local dictionary
[?25l:  [?12l[?25h    let local_dict = {"xcord":100, "ycord":2}
[?25l:  [?12l[?25h    echo 'local_dict: 1'
[?25l:  [?12l[?25h    if exists('local_dict')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing local dictionary
[?25l:  [?12l[?25h    unlet local_dict
[?25l:  [?12l[?25h    echo 'local_dict: 0'
[?25l:  [?12l[?25h    if !exists('local_dict')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing local curly-brace variable
[?25l:  [?12l[?25h    let str = "local"
[?25l:  [?12l[?25h    let curly_{str}_var = 1
[?25l:  [?12l[?25h    echo 'curly_' . str . '_var: 1'
[?25l:  [?12l[?25h    if exists('curly_{str}_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing local curly-brace variable
[?25l:  [?12l[?25h    unlet curly_{str}_var
[?25l:  [?12l[?25h    echo 'curly_' . str . '_var: 0'
[?25l:  [?12l[?25h    if !exists('curly_{str}_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing global variable
[?25l:  [?12l[?25h    let g:global_var = 1
[?25l:  [?12l[?25h    echo 'g:global_var: 1'
[?25l:  [?12l[?25h    if exists('g:global_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing global variable with garbage
[?25l:  [?12l[?25h    echo 'g:global_var-n: 1'
[?25l:  [?12l[?25h    if !exists('g:global_var-n')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing global variable
[?25l:  [?12l[?25h    unlet g:global_var
[?25l:  [?12l[?25h    echo 'g:global_var: 0'
[?25l:  [?12l[?25h    if !exists('g:global_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing global list
[?25l:  [?12l[?25h    let g:global_list = ["blue", "orange"]
[?25l:  [?12l[?25h    echo 'g:global_list: 1'
[?25l:  [?12l[?25h    if exists('g:global_list')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing global list
[?25l:  [?12l[?25h    unlet g:global_list
[?25l:  [?12l[?25h    echo 'g:global_list: 0'
[?25l:  [?12l[?25h    if !exists('g:global_list')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing global dictionary
[?25l:  [?12l[?25h    let g:global_dict = {"xcord":100, "ycord":2}
[?25l:  [?12l[?25h    echo 'g:global_dict: 1'
[?25l:  [?12l[?25h    if exists('g:global_dict')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing global dictionary
[?25l:  [?12l[?25h    unlet g:global_dict
[?25l:  [?12l[?25h    echo 'g:global_dict: 0'
[?25l:  [?12l[?25h    if !exists('g:global_dict')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing global curly-brace variable
[?25l:  [?12l[?25h    let str = "global"
[?25l:  [?12l[?25h    let g:curly_{str}_var = 1
[?25l:  [?12l[?25h    echo 'g:curly_' . str . '_var: 1'
[?25l:  [?12l[?25h    if exists('g:curly_{str}_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing global curly-brace variable
[?25l:  [?12l[?25h    unlet g:curly_{str}_var
[?25l:  [?12l[?25h    echo 'g:curly_' . str . '_var: 0'
[?25l:  [?12l[?25h    if !exists('g:curly_{str}_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing window variable
[?25l:  [?12l[?25h    echo 'w:window_var: 1'
[?25l:  [?12l[?25h    let w:window_var = 1
[?25l:  [?12l[?25h    if exists('w:window_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing window variable
[?25l:  [?12l[?25h    unlet w:window_var
[?25l:  [?12l[?25h    echo 'w:window_var: 0'
[?25l:  [?12l[?25h    if !exists('w:window_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing window list
[?25l:  [?12l[?25h    let w:window_list = ["blue", "orange"]
[?25l:  [?12l[?25h    echo 'w:window_list: 1'
[?25l:  [?12l[?25h    if exists('w:window_list')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing window list
[?25l:  [?12l[?25h    unlet w:window_list
[?25l:  [?12l[?25h    echo 'w:window_list: 0'
[?25l:  [?12l[?25h    if !exists('w:window_list')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing window dictionary
[?25l:  [?12l[?25h    let w:window_dict = {"xcord":100, "ycord":2}
[?25l:  [?12l[?25h    echo 'w:window_dict: 1'
[?25l:  [?12l[?25h    if exists('w:window_dict')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing window dictionary
[?25l:  [?12l[?25h    unlet w:window_dict
[?25l:  [?12l[?25h    echo 'w:window_dict: 0'
[?25l:  [?12l[?25h    if !exists('w:window_dict')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing window curly-brace variable
[?25l:  [?12l[?25h    let str = "window"
[?25l:  [?12l[?25h    let w:curly_{str}_var = 1
[?25l:  [?12l[?25h    echo 'w:curly_' . str . '_var: 1'
[?25l:  [?12l[?25h    if exists('w:curly_{str}_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing window curly-brace variable
[?25l:  [?12l[?25h    unlet w:curly_{str}_var
[?25l:  [?12l[?25h    echo 'w:curly_' . str . '_var: 0'
[?25l:  [?12l[?25h    if !exists('w:curly_{str}_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing buffer variable
[?25l:  [?12l[?25h    echo 'b:buffer_var: 1'
[?25l:  [?12l[?25h    let b:buffer_var = 1
[?25l:  [?12l[?25h    if exists('b:buffer_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing buffer variable
[?25l:  [?12l[?25h    unlet b:buffer_var
[?25l:  [?12l[?25h    echo 'b:buffer_var: 0'
[?25l:  [?12l[?25h    if !exists('b:buffer_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing buffer list
[?25l:  [?12l[?25h    let b:buffer_list = ["blue", "orange"]
[?25l:  [?12l[?25h    echo 'b:buffer_list: 1'
[?25l:  [?12l[?25h    if exists('b:buffer_list')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing buffer list
[?25l:  [?12l[?25h    unlet b:buffer_list
[?25l:  [?12l[?25h    echo 'b:buffer_list: 0'
[?25l:  [?12l[?25h    if !exists('b:buffer_list')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing buffer dictionary
[?25l:  [?12l[?25h    let b:buffer_dict = {"xcord":100, "ycord":2}
[?25l:  [?12l[?25h    echo 'b:buffer_dict: 1'
[?25l:  [?12l[?25h    if exists('b:buffer_dict')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing buffer dictionary
[?25l:  [?12l[?25h    unlet b:buffer_dict
[?25l:  [?12l[?25h    echo 'b:buffer_dict: 0'
[?25l:  [?12l[?25h    if !exists('b:buffer_dict')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing buffer curly-brace variable
[?25l:  [?12l[?25h    let str = "buffer"
[?25l:  [?12l[?25h    let b:curly_{str}_var = 1
[?25l:  [?12l[?25h    echo 'b:curly_' . str . '_var: 1'
[?25l:  [?12l[?25h    if exists('b:curly_{str}_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing buffer curly-brace variable
[?25l:  [?12l[?25h    unlet b:curly_{str}_var
[?25l:  [?12l[?25h    echo 'b:curly_' . str . '_var: 0'
[?25l:  [?12l[?25h    if !exists('b:curly_{str}_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Script-local tests
[?25l:  [?12l[?25h    source test60.vim
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing Vim internal variable
[?25l:  [?12l[?25h    echo 'v:version: 1'
[?25l:  [?12l[?25h    if exists('v:version')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing Vim internal variable
[?25l:  [?12l[?25h    echo 'v:non_exists_var: 0'
[?25l:  [?12l[?25h    if !exists('v:non_exists_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Function arguments
[?25l:  [?12l[?25h    function TestFuncArg(func_arg, ...)
[?25l:    [?12l[?25h        echo 'a:func_arg: 1'
[?25l:    [?12l[?25h        if exists('a:func_arg')
[?25l:      [?12l[?25h            echo "OK"
[?25l:      [?12l[?25h        else
[?25l:      [?12l[?25h            echo "FAILED"
[?25l:      [?12l[?25h        endif
[?25l:    [?12l[?25h
[?25l:    [?12l[?25h        echo 'a:non_exists_arg: 0'
[?25l:    [?12l[?25h        if !exists('a:non_exists_arg')
[?25l:      [?12l[?25h            echo "OK"
[?25l:      [?12l[?25h        else
[?25l:      [?12l[?25h            echo "FAILED"
[?25l:      [?12l[?25h        endif
[?25l:    [?12l[?25h
[?25l:    [?12l[?25h        echo 'a:1: 1'
[?25l:    [?12l[?25h        if exists('a:1')
[?25l:      [?12l[?25h            echo "OK"
[?25l:      [?12l[?25h        else
[?25l:      [?12l[?25h            echo "FAILED"
[?25l:      [?12l[?25h        endif
[?25l:    [?12l[?25h
[?25l:    [?12l[?25h        echo 'a:2: 0'
[?25l:    [?12l[?25h        if !exists('a:2')
[?25l:      [?12l[?25h            echo "OK"
[?25l:      [?12l[?25h        else
[?25l:      [?12l[?25h            echo "FAILED"
[?25l:      [?12l[?25h        endif
[?25l:    [?12l[?25h    endfunction
[?25l:    [?12l[?25h
[?25l:    [?12l[?25h    call TestFuncArg("arg1", "arg2")
[?25l:    [?12l[?25h
[?25l:    [?12l[?25h    redir END
[?25l:    [?12l[?25hendfunction[27m[m[H[2J[?25l[1;9Hendif[3;9Hecho 'a:2: 0'[4;9Hif !exists('a:2')[5;13Hecho "OK"[6;9Helse[7;13Hecho "FAILED"[8;9Hendif
    endfunction[11;5Hcall TestFuncArg("arg1", "arg2")[13;5Hredir END
endfunction
:call TestExists()
:delfunc TestExists
:delfunc RunTest
:delfunc TestFuncArg
:edit! test.out
:set ff=unix
:w
:qa!
ENDTEST
[?12l[?25h[?25l
:[?12l[?25hcall TestExists()[?25l#myagroup: 1[25;13H[K[25;1H
OK
#myagroup+b: 0
OK
#myagroup#BufEnter: 1
OK
#myagroup#BufEnter#*.my: 1
OK
#BufEnter: 1
OK
#BufEnter#*.my: 1
OK
#xyzagroup: 0
OK
#xyzagroup#BufEnter: 0
OK
#myagroup#CmdwinEnter: 0
OK
#myagroup#xyzacmd: 0
OK
#myagroup#BufEnter#xyzpat: 0
OK
#BufEnter#xyzpat: 0
OK
###: 0
OK
##: 0
OK
##FileReadCmd: 1
OK
##MySpecialCmd: 0
OK
&textwidth: 1
OK
&tw: 1
OK
&tw-: 0
OK
&g:errorformat: 1
OK
&l:errorformat: 1
OK
&nojoinspaces: 0
OK
&nojs: 0
OK
&myxyzoption: 0
OK
+incsearch: 1
OK
+incsearch!1: 0
OK
+is: 1
OK
+autoprint: 0
OK
$EDITOR_NAME: 1
OK
$NON_ENV_VAR: 0
OK
*bufnr: 1
OK
*bufnr(): 1
OK
*myxyzfunc: 0
OK
*bufnr&6: 0
OK
*TestExists: 1
OK
*MyxyzFunc: 0
OK
:edit: 2
OK
:edit/a: 0
OK
:q: 1
OK
:invalidcmd: 0
OK
:MyCmd: 2
OK
:My: 3
OK
:rightbelow: 2
OK
:MyCmd: 0
OK
:My: 0
OK
local_var: 1
OK
local_var%n: 0
OK
local_var: 0
OK
local_list: 1
OK
local_list[1]: 1
OK
local_list[1]+5: 0
OK
local_list[2]: 0
OK
local_list: 0
OK
local_dict: 1
OK
local_dict: 0
OK
curly_local_var: 1
OK
curly_local_var: 0
OK
g:global_var: 1
OK
g:global_var-n: 1
OK
g:global_var: 0
OK
g:global_list: 1
OK
g:global_list: 0
OK
g:global_dict: 1
OK
g:global_dict: 0
OK
g:curly_global_var: 1
OK
g:curly_global_var: 0
OK
w:window_var: 1
OK
w:window_var: 0
OK
w:window_list: 1
OK
w:window_list: 0
OK
w:window_dict: 1
OK
w:window_dict: 0
OK
w:curly_window_var: 1
OK
w:curly_window_var: 0
OK
b:buffer_var: 1
OK
b:buffer_var: 0
OK
b:buffer_list: 1
OK
b:buffer_list: 0
OK
b:buffer_dict: 1
OK
b:buffer_dict: 0
OK
b:curly_buffer_var: 1
OK
b:curly_buffer_var: 0
OK
s:script_var: 1
OK
s:script_var: 0
OK
s:script_list: 1
OK
s:script_list: 0
OK
s:script_dict: 1
OK
s:script_dict: 0
OK
s:curly_script_var: 1
OK
s:curly_script_var: 0
OK
*s:my_script_func: 1
OK
*s:my_script_func: 0
OK
v:version: 1
OK
v:non_exists_var: 0
OK
a:func_arg: 1
OK
a:non_exists_arg: 0
OK
a:1: 1
OK
a:2: 0
OK
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hdelfunc TestExists[?25l[27m[m[H[2J[1;9Hendif[3;9Hecho 'a:2: 0'[4;9Hif !exists('a:2')[5;13Hecho "OK"[6;9Helse[7;13Hecho "FAILED"[8;9Hendif
    endfunction[11;5Hcall TestFuncArg("arg1", "arg2")[13;5Hredir END
endfunction
:call TestExists()
:delfunc TestExists
:delfunc RunTest
:delfunc TestFuncArg
:edit! test.out
:set ff=unix
:w
:qa!
ENDTEST
[?12l[?25h[?25l
:[?12l[?25hdelfunc RunTest[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hdelfunc TestFuncArg[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hedit! test.out[?25l"test.out" [25;12H[K[25;12H[Incomplete last line] 197 lines, 1844 characters[1;9H[K[2;1H#myagroup: 1
OK[3;9H[K[4;1H#myagroup+b: 0[4;15H[K[5;1HOK[5;13H[K[6;1H#myagroup#BufEnter: 1
OK[7;13H[K[8;1H#myagroup#BufEnter#*.my: 1
OK[9;5H[K[10;1H#BufEnter: 1
OK[11;5H[K[12;1H#BufEnter#*.my: 1
OK[13;5H[K[14;1H#xyzagroup: 0
OK[15;3H[K[16;1H#xyzagroup#BufEnter: 0
OK[17;3H[K[18;1H#myagroup#CmdwinEnter: 0
OK[19;3H[K[20;1H#myagroup#xyzacmd: 0
OK
#myagroup#BufEnter#xyzpat: 0
OK[23;3H[K[24;1H#BufEnter#xyzpat: 0[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset ff=unix[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw[?25l"test.out" 197 lines, 1845 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test61.failed test.ok test.out X* viminfo
cp test61.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test61.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test61.in" 89 lines, 1511 characters[1;1HTests for undo tree.
Since this script is sourced we need to explicitly break changes up in
undo-able pieces.  Do that by setting 'undolevels'.
Also tests :earlier and :later.

STARTTEST
:" Delete three characters and undo
Gx:set ul=100
x:set ul=100
x:.w! test.out
g-:.w >>test.out
g-:.w >>test.out
g-:.w >>test.out
g-:.w >>test.out
:"
:/^111/w >>test.out
:" Delete three other characters and go back in time step by step
$x:set ul=100
x:set ul=100
x:.w >>test.out
:sleep 1
g-:.w >>test.out
g-:.w >>test.out
g-:.w >>test.out[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for undo tree.[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[6;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[7;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 77 lines, 1282 characters written[7;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[7;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;1H:earlier 1f
:" expect empty line
:%yank c
:later 1f
:" expect "one one one"
:%yank d
:later 1f
:" expect "one one one\ntwo\ntwo"
:%yank e
:later 1f
:" expect "one one one\ntwo\ntwo\nthree"
ggO---[34m^[[m:0put e
ggO---[34m^[[m:0put d
ggO---[34m^[[m:0put c
ggO---[34m^[[m:0put b
ggO---[34m^[[m:0put a
ggO---[34m^[[m:w >>test.out
:qa!
ENDTEST

1111 -----
2222 -----

123456789[19;1H[?12l[?25h
[?25l[25;1H:so! Xdotest[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Delete three characters and undo[?25l[20;1H[?12l[?25h[24;1H[?25l23456789[24;9H[K[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset ul=100[?25l[24;1H[?12l[?25h[?25l3456789[24;8H[K[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset ul=100[?25l[24;1H[?12l[?25h[?25l456789[24;7H[K[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 1 line, 7 characters written[24;1H[?12l[?25h[?25l
1 change; before #3  0 seconds ago[25;35H[K[24;1H3456789[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 8 characters appended[24;1H[?12l[?25h[?25l
1 change; before #2  0 seconds ago[25;35H[K[24;1H23456789[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 9 characters appended[24;1H[?12l[?25h[?25l
1 change; before #1  0 seconds ago[25;35H[K[24;1H123456789[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 10 characters appended[24;1H[?12l[?25h[?25l
Already at oldest change[25;25H[K[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 10 characters appended[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^111/w >>test.out[?25l[31msearch hit BOTTOM, continuing at TOP[m"test.out" [25;12H[K[25;12H1 line, 11 characters appended[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Delete three other characters and go back in time step by step[?25l[24;1H[?12l[?25h[8C[?25l[24;9H[K[24;8H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset ul=100[?25l[24;8H[?12l[?25h[?25l[24;8H[K[24;7H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset ul=100[?25l[24;7H[?12l[?25h[?25l[24;7H[K[24;6H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 7 characters appended[24;6H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hsleep 1[?25l[24;6H[?12l[?25h[?25l
1 change; before #6  1 seconds ago[24;7H7[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 8 characters appended[24;7H[?12l[?25h[?25l
1 change; before #5  1 seconds ago[25;35H[K[24;8H8[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 9 characters appended[24;8H[?12l[?25h[?25l
4 changes; after #3  1 seconds ago[25;35H[K[24;1H456789[24;7H[K[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 7 characters appended[24;1H[?12l[?25h[?25l
1 change; before #3  1 seconds ago[25;35H[K[24;1H3456789[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 8 characters appended[24;1H[?12l[?25h[?25l
1 change; before #2  1 seconds ago[25;35H[K[24;1H23456789[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 9 characters appended[24;1H[?12l[?25h[?25l
1 change; before #1  1 seconds ago[25;35H[K[24;1H123456789[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 10 characters appended[24;1H[?12l[?25h[?25l
Already at oldest change[25;25H[K[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 10 characters appended[24;1H[?12l[?25h[?25l
Already at oldest change[25;25H[K[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 10 characters appended[24;1H[?12l[?25h[?25l
3 changes; after #6  1 seconds ago[25;35H[K[24;7H[K[24;6H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 7 characters appended[24;6H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[24;6H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^222/w >>test.out[?25l[31msearch hit BOTTOM, continuing at TOP[m"test.out" [25;12H[K[25;12H1 line, 11 characters appended[24;6H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Delay for three seconds and go some seconds forward and backward[?25l[24;6H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hsleep 2[?25l[24;6H[?12l[?25h[?25l6a[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset ul=100[?25l[24;7H[?12l[?25h[?25lab[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset ul=100[?25l[24;8H[?12l[?25h[?25lbc[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset ul=100[?25l[24;9H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 10 characters appended[24;9H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hear 1s[?25l3 changes; before #7  0 seconds ago[24;7H[K[24;6H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 7 characters appended[24;6H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hear 3s[?25l3 changes; before #1  3 seconds ago[24;7H789[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 10 characters appended[24;9H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlater 1s[?25l3 changes; after #6  3 seconds ago[24;7H[K[24;6H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 7 characters appended[24;6H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlater 1h[?25l3 changes; after #9  0 seconds ago[24;7Habc[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 10 characters appended[24;9H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[24;9H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" test undojoin[?25l[24;9H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Haaaa[25;1H[K[24;4H[?12l[?25h[?25l
:[?12l[?25hset ul=100[?25l[24;4H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hbbbb[25;1H[K[24;4H[?12l[?25h[?25l
1 line less; before #11  0 seconds ago[24;1H[1m[34m~                                                                               [23;4H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 5 characters appended[23;4H[?12l[?25h[?25l
bbbb[24;5H[K[24;4H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset ul=100[?25l[24;4H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hundojoin[?25l[24;4H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Hcccc[25;1H[K[24;4H[?12l[?25h[?25l
2 fewer lines; before #12  0 seconds ago[23;1H[1m[34m~                                                                               [24;1H~                                                                               [22;4H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1 line, 5 characters appended[22;4H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! Xtest[?25l"Xtest" [New File][1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [1;1H[?12l[?25h[?25l[mone one one[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset ul=100[?25l[1;11H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw![?25l"Xtest" [New File] 1 line, 12 characters written[1;11H[?12l[?25h[?25l
two[2;4H[K[2;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset ul=100[?25l[2;3H[?12l[?25h[?25l
two[3;4H[K[3;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset ul=100[?25l[3;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw[?25l"Xtest" 3 lines, 20 characters written[3;3H[?12l[?25h[?25l
three[4;6H[K[4;5H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hearlier 1f[?25l1 line less; before #4  0 seconds ago[4;1H[1m[34m~                                                                               [3;3H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h" expect "one one one\ntwo\ntwo"[?25l[3;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h%yank a[?25l3 lines yanked[3;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hearlier 1f[?25l2 fewer lines; before #2  0 seconds ago[2;1H[1m[34m~                                                                               [3;1H~                                                                               [1;11H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h" expect "one one one"[?25l[1;11H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h%yank b[?25l[1;11H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hearlier 1f[?25l1 line less; before #1  0 seconds ago[1;1H[K[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" expect empty line[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h%yank c[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlater 1f[?25l1 more line; after #1  0 seconds ago[1;1Hone one one[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" expect "one one one"[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h%yank d[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlater 1f[?25l2 more lines; after #3  0 seconds ago[2;1Htwo[2;4H[K[3;1Htwo[3;4H[K[2;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" expect "one one one\ntwo\ntwo"[?25l[2;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h%yank e[?25l3 lines yanked[2;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlater 1f[?25l1 more line; after #4  0 seconds ago[4;1Hthree[4;6H[K[3;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" expect "one one one\ntwo\ntwo\nthree"[?25l[3;3H[?12l[?25h[1;1H[?25l[1;24r[1;1H[L[1;25r[1;1H---[25;1H[K[1;3H[?12l[?25h[?25l[25;1H:[?12l[?25h0put e[?25l3 more lines[1;24r[1;1H[3L[1;25r[1;1Hone one one
two
two[25;1H[K[25;1H3 more lines[3;1H[?12l[?25h[1;1H[?25l[1;24r[1;1H[L[1;25r[1;1H---[25;1H[K[1;3H[?12l[?25h[?25l[25;1H:[?12l[?25h0put d[?25l[1;24r[1;1H[L[1;25r[1;1Hone one one[25;1H[K[1;1H[?12l[?25h[?25l[1;24r[1;1H[L[1;25r[1;1H---[?12l[?25h[?25l[25;1H:[?12l[?25h0put c[?25l[1;24r[1;1H[L[1;25r[25;1H[K[1;1H[?12l[?25h[?25l[1;24r[1;1H[L[1;25r[1;1H---[?12l[?25h[?25l[25;1H:[?12l[?25h0put b[?25l[1;24r[1;1H[L[1;25r[1;1Hone one one[25;1H[K[1;1H[?12l[?25h[?25l[1;24r[1;1H[L[1;25r[1;1H---[?12l[?25h[?25l[25;1H:[?12l[?25h0put a[?25l3 more lines[1;24r[1;1H[3L[1;25r[1;1Hone one one
two
two[25;1H[K[25;1H3 more lines[3;1H[?12l[?25h[1;1H[?25l[1;24r[1;1H[L[1;25r[1;1H---[25;1H[K[1;3H[?12l[?25h[?25l[25;1H:[?12l[?25hw >>test.out[?25l"test.out" [25;12H[K[25;12H19 lines, 115 characters appended[1;3H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test62.failed test.ok test.out X* viminfo
cp test62.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test62.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test62.in" 57 lines, 1394 characters[1;1HTests for tab pages

STARTTEST
:so small.vim
:" Simple test for opening and closing a tab page
:tabnew
:let nr = tabpagenr()
:q
:call append(line('$'), 'tab page ' . nr)
:unlet nr
:"
:" Open three tab pages and use ":tabdo"
:0tabnew
:1tabnew
:888tabnew
:tabdo call append(line('$'), 'this is tab page ' . tabpagenr())
:tabclose! 2
:tabrewind
:let line1 = getline('$')
:undo
:q
:tablast
:let line2 = getline('$')
:q![1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for tab pages[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 51 lines, 1345 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;1H:call settabvar(2, 'val_list', ['red', 'blue', 'green'])
:"
:let test_status = 'gettabvar: fail'
:if gettabvar(2, 'val_num') == 100 && gettabvar(2, 'val_str') == 'SetTabVar testt[5;1H') && gettabvar(2, 'val_list') == ['red', 'blue', 'green'])
:    let test_status = 'gettabvar: pass'
:endif
:call append(line('$'), test_status)
:"
:tabnext 2
:let test_status = 'settabvar: fail'
:if t:val_num == 100 && t:val_str == 'SetTabVar test'  && t:val_list == ['red',  [13;1H'blue', 'green']
:   let test_status = 'settabvar: pass'
:endif
:tabclose
:call append(line('$'), test_status)
:"
:"
:/^Results/,$w! test.out
:qa!
ENDTEST

Results:[22;1H[?12l[?25h
[?25l

:so! Xdotest[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Simple test for opening and closing a tab page[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25htabnew[?25l[27m[m[H[2J[1;1H[4m[30m[47m test62.in [m[1m [No Name] [m[7m                                                          [m[1;80H[4m[30m[47mX[m[3;1H[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [2;1H[?12l[?25h[?25l[25;1H[m:[?12l[?25hlet nr = tabpagenr()[?25l[2;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hq[?25l[27m[m[H[2J[1;1H:call settabvar(2, 'val_list', ['red', 'blue', 'green'])
:"
:let test_status = 'gettabvar: fail'
:if gettabvar(2, 'val_num') == 100 && gettabvar(2, 'val_str') == 'SetTabVar testt[5;1H') && gettabvar(2, 'val_list') == ['red', 'blue', 'green'])
:    let test_status = 'gettabvar: pass'
:endif
:call append(line('$'), test_status)
:"
:tabnext 2
:let test_status = 'settabvar: fail'
:if t:val_num == 100 && t:val_str == 'SetTabVar test'  && t:val_list == ['red',  [13;1H'blue', 'green']
:   let test_status = 'settabvar: pass'
:endif
:tabclose
:call append(line('$'), test_status)
:"
:"
:/^Results/,$w! test.out
:qa!
ENDTEST

Results:[23;1H[?12l[?25h[?25l

:[?12l[?25hcall append(line('$'), 'tab page ' . nr)[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hunlet nr[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Open three tab pages and use ":tabdo"[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h0tabnew[?25l[27m[m[H[2J[1;1H[1m [No Name] [m[4m[30m[47m + test62.in [m[7m                                                        [m[1;80H[4m[30m[47mX[m[3;1H[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [2;1H[?12l[?25h[?25l[25;1H[m:[?12l[?25h1tabnew[?25l[27m[m[H[2J[1;1H[4m[30m[47m [No Name] [m[1m [No Name] [m[4m[30m[47m + test62.in [m[7m                                             [m[1;80H[4m[30m[47mX[m[3;1H[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [2;1H[?12l[?25h[?25l[25;1H[m:[?12l[?25h888tabnew[?25l[27m[m[H[2J[1;1H[4m[30m[47m [No Name]  [No Name]  + test62.in [m[1m [No Name] [m[7m                                  [m[1;80H[4m[30m[47mX[m[3;1H[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [2;1H[?12l[?25h[?25l[25;1H[m:[?12l[?25htabdo call append(line('$'), 'this is tab page ' . tabpagenr())[?25l[27m[m[H[2J[1;1H[4m[30m[47m + [No Name]  + [No Name]  + test62.in [m[1m + [No Name] [m[7m                            [m[1;80H[4m[30m[47mX[m[3;1Hthis is tab page 4
[1m[34m~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [2;1H[?12l[?25h[?25l[25;1H[m:[?12l[?25htabclose! 2[?25l[1;17H[4m[30m[47mtest62.in[m[1C[1m + [No Name] [m[7m             [27C [m[1;80H[4m[30m[47mX[2;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25htabrewind[?25l[27m[m[H[2J[1;1H[1m + [No Name] [m[4m[30m[47m + test62.in  + [No Name] [m[7m                                         [m[1;80H[4m[30m[47mX[m[3;1Hthis is tab page 1
[1m[34m~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [2;1H[?12l[?25h[?25l[25;1H[m:[?12l[?25hlet line1 = getline('$')[?25l[2;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hundo[?25l2 fewer lines; before #1  0 seconds ago[1;2H[1m[No Name]e ][m[4m[30m[47m [m[1m [m[4m[30m[47m+ test62.in  + [No Name] [m[7m  [40C [m[1;80H[4m[30m[47mX[m[3;1H[1m[34m~                                                                               [2;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hq[?25l[27m[m[H[2J[1;1H[1m + test62.in [m[4m[30m[47m + [No Name] [m[7m                                                      [m[1;80H[4m[30m[47mX[m[2;1H:"
:let test_status = 'gettabvar: fail'
:if gettabvar(2, 'val_num') == 100 && gettabvar(2, 'val_str') == 'SetTabVar testt[5;1H') && gettabvar(2, 'val_list') == ['red', 'blue', 'green'])
:    let test_status = 'gettabvar: pass'
:endif
:call append(line('$'), test_status)
:"
:tabnext 2
:let test_status = 'settabvar: fail'
:if t:val_num == 100 && t:val_str == 'SetTabVar test'  && t:val_list == ['red',  [13;1H'blue', 'green']
:   let test_status = 'settabvar: pass'
:endif
:tabclose
:call append(line('$'), test_status)
:"
:"
:/^Results/,$w! test.out
:qa!
ENDTEST

Results:[23;1H[?12l[?25h[?25l

:[?12l[?25htablast[?25l[27m[m[H[2J[1;1H[4m[30m[47m + test62.in [m[1m + [No Name] [m[7m                                                      [m[1;80H[4m[30m[47mX[m[3;1Hthis is tab page 4
[1m[34m~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [2;1H[?12l[?25h[?25l[25;1H[m:[?12l[?25hlet line2 = getline('$')[?25l[2;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hq![?25l[27m[m[H[2J[1;1H:call settabvar(2, 'val_list', ['red', 'blue', 'green'])
:"
:let test_status = 'gettabvar: fail'
:if gettabvar(2, 'val_num') == 100 && gettabvar(2, 'val_str') == 'SetTabVar testt[5;1H') && gettabvar(2, 'val_list') == ['red', 'blue', 'green'])
:    let test_status = 'gettabvar: pass'
:endif
:call append(line('$'), test_status)
:"
:tabnext 2
:let test_status = 'settabvar: fail'
:if t:val_num == 100 && t:val_str == 'SetTabVar test'  && t:val_list == ['red',  [13;1H'blue', 'green']
:   let test_status = 'settabvar: pass'
:endif
:tabclose
:call append(line('$'), test_status)
:"
:"
:/^Results/,$w! test.out
:qa!
ENDTEST

Results:[23;1H[?12l[?25h[?25l

:[?12l[?25hcall append(line('$'), line1)[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall append(line('$'), line2)[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hunlet line1 line2[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Test for settabvar() and gettabvar() functions. Open a new tab page and [?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" set 3 variables to a number, string and a list. Verify that the variables[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" are correctly set.[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25htabnew[?25l[27m[m[H[2J[1;1H[4m[30m[47m + test62.in [m[1m [No Name] [m[7m                                                        [m[1;80H[4m[30m[47mX[m[3;1H[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [2;1H[?12l[?25h[?25l[25;1H[m:[?12l[?25htabfirst[?25l[27m[m[H[2J[1;1H[1m + test62.in [m[4m[30m[47m [No Name] [m[7m                                                        [m[1;80H[4m[30m[47mX[m[2;1H:"
:let test_status = 'gettabvar: fail'
:if gettabvar(2, 'val_num') == 100 && gettabvar(2, 'val_str') == 'SetTabVar testt[5;1H') && gettabvar(2, 'val_list') == ['red', 'blue', 'green'])
:    let test_status = 'gettabvar: pass'
:endif
:call append(line('$'), test_status)
:"
:tabnext 2
:let test_status = 'settabvar: fail'
:if t:val_num == 100 && t:val_str == 'SetTabVar test'  && t:val_list == ['red',  [13;1H'blue', 'green']
:   let test_status = 'settabvar: pass'
:endif
:tabclose
:call append(line('$'), test_status)
:"
:"
:/^Results/,$w! test.out
:qa!
ENDTEST

Results:[23;1H[?12l[?25h[?25l

:[?12l[?25hcall settabvar(2, 'val_num', 100)[?25l[27m[m[H[2J[1;1H[1m + test62.in [m[4m[30m[47m [No Name] [m[7m                                                        [m[1;80H[4m[30m[47mX[m[2;1H:"
:let test_status = 'gettabvar: fail'
:if gettabvar(2, 'val_num') == 100 && gettabvar(2, 'val_str') == 'SetTabVar testt[5;1H') && gettabvar(2, 'val_list') == ['red', 'blue', 'green'])
:    let test_status = 'gettabvar: pass'
:endif
:call append(line('$'), test_status)
:"
:tabnext 2
:let test_status = 'settabvar: fail'
:if t:val_num == 100 && t:val_str == 'SetTabVar test'  && t:val_list == ['red',  [13;1H'blue', 'green']
:   let test_status = 'settabvar: pass'
:endif
:tabclose
:call append(line('$'), test_status)
:"
:"
:/^Results/,$w! test.out
:qa!
ENDTEST

Results:[23;1H[?12l[?25h[?25l

:[?12l[?25hcall settabvar(2, 'val_str', 'SetTabVar test')[?25l[27m[m[H[2J[1;1H[1m + test62.in [m[4m[30m[47m [No Name] [m[7m                                                        [m[1;80H[4m[30m[47mX[m[2;1H:"
:let test_status = 'gettabvar: fail'
:if gettabvar(2, 'val_num') == 100 && gettabvar(2, 'val_str') == 'SetTabVar testt[5;1H') && gettabvar(2, 'val_list') == ['red', 'blue', 'green'])
:    let test_status = 'gettabvar: pass'
:endif
:call append(line('$'), test_status)
:"
:tabnext 2
:let test_status = 'settabvar: fail'
:if t:val_num == 100 && t:val_str == 'SetTabVar test'  && t:val_list == ['red',  [13;1H'blue', 'green']
:   let test_status = 'settabvar: pass'
:endif
:tabclose
:call append(line('$'), test_status)
:"
:"
:/^Results/,$w! test.out
:qa!
ENDTEST

Results:[23;1H[?12l[?25h[?25l

:[?12l[?25hcall settabvar(2, 'val_list', ['red', 'blue', 'green'])[?25l[27m[m[H[2J[1;1H[1m + test62.in [m[4m[30m[47m [No Name] [m[7m                                                        [m[1;80H[4m[30m[47mX[m[2;1H:"
:let test_status = 'gettabvar: fail'
:if gettabvar(2, 'val_num') == 100 && gettabvar(2, 'val_str') == 'SetTabVar testt[5;1H') && gettabvar(2, 'val_list') == ['red', 'blue', 'green'])
:    let test_status = 'gettabvar: pass'
:endif
:call append(line('$'), test_status)
:"
:tabnext 2
:let test_status = 'settabvar: fail'
:if t:val_num == 100 && t:val_str == 'SetTabVar test'  && t:val_list == ['red',  [13;1H'blue', 'green']
:   let test_status = 'settabvar: pass'
:endif
:tabclose
:call append(line('$'), test_status)
:"
:"
:/^Results/,$w! test.out
:qa!
ENDTEST

Results:[23;1H[?12l[?25h[?25l

:[?12l[?25h"[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet test_status = 'gettabvar: fail'[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hif gettabvar(2, 'val_num') == 100 && gettabvar(2, 'val_str') == 'SetTabVar tes
[24;80Ht[25;1H') && gettabvar(2, 'val_list') == ['red', 'blue', 'green'])[?25l[24;1H[1m[37m[41mE15: Invalid expression: gettabvar(2, 'val_num') == 100 && gettabvar(2, 'val_str[25;1H') == 'SetTabVar test') && gettabvar(2, 'val_list') == ['red', 'blue', 'green'][m
[24;80H[1m[37m[41m)[m[25;1H
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h    let test_status = 'gettabvar: pass'[?25l[1;1H[3L[1;1H[1m + test62.in [m[4m[30m[47m [No Name] [m[7m                                                        [m[1;80H[4m[30m[47mX[m[2;1H:"
:let test_status = 'gettabvar: fail'[25;1H[K[23;1H[?12l[?25h[?25l

:[?12l[?25hendif[?25l[1m[37m[41mE580: :endif without :if[23;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hcall append(line('$'), test_status)[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25htabnext 2[?25l[27m[m[H[2J[1;1H[4m[30m[47m + test62.in [m[1m [No Name] [m[7m                                                        [m[1;80H[4m[30m[47mX[m[3;1H[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [2;1H[?12l[?25h[?25l[25;1H[m:[?12l[?25hlet test_status = 'settabvar: fail'[?25l[2;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hif t:val_num == 100 && t:val_str == 'SetTabVar test'  && t:val_list == ['red',
'blue', 'green'][?25l[25;1H[K[25;1H:  [?12l[?25h:   let test_status = 'settabvar: pass'
[?25l:  [?12l[?25h:endif[1;1H[2L[1;1H[4m[30m[47m + test62.in [m[1m [No Name] [m[7m                                                        [m[1;80H[4m[30m[47mX[?25l[m[25;1H[K[2;1H[?12l[?25h[?25l[25;1H:[?12l[?25htabclose[?25l[27m[m[H[2J[1;1H:call settabvar(2, 'val_list', ['red', 'blue', 'green'])
:"
:let test_status = 'gettabvar: fail'
:if gettabvar(2, 'val_num') == 100 && gettabvar(2, 'val_str') == 'SetTabVar testt[5;1H') && gettabvar(2, 'val_list') == ['red', 'blue', 'green'])
:    let test_status = 'gettabvar: pass'
:endif
:call append(line('$'), test_status)
:"
:tabnext 2
:let test_status = 'settabvar: fail'
:if t:val_num == 100 && t:val_str == 'SetTabVar test'  && t:val_list == ['red',  [13;1H'blue', 'green']
:   let test_status = 'settabvar: pass'
:endif
:tabclose
:call append(line('$'), test_status)
:"
:"
:/^Results/,$w! test.out
:qa!
ENDTEST

Results:[23;1H[?12l[?25h[?25l

:[?12l[?25hcall append(line('$'), test_status)[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^Results/,$w! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 7 lines, 109 characters written[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test63.failed test.ok test.out X* viminfo
cp test63.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test63.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test63.in" 157 lines, 4784 characters[1;1HTest for ":match", ":2match", ":3match", "clearmatches()", "getmatches()",
"matchadd()", "matcharg()", "matchdelete()", and "setmatches()".

STARTTEST
:so small.vim
:" --- Check that "matcharg()" returns the correct group and pattern if a match
:" --- is defined.
:let @r = "*** Test 1: "
:highlight MyGroup1 ctermbg=red
:highlight MyGroup2 ctermbg=green
:highlight MyGroup3 ctermbg=blue
:match MyGroup1 /TODO/
:2match MyGroup2 /FIXME/
:3match MyGroup3 /XXX/
:if matcharg(1) == ['MyGroup1', 'TODO'] && matcharg(2) == ['MyGroup2', 'FIXME']  [16;1H&& matcharg(3) == ['MyGroup3', 'XXX']
:  let @r .= "OK\n"
:else
:  let @r .= "FAILED\n"
:endif
:" --- Check that "matcharg()" returns an empty list if the argument is not 1,
:" --- 2 or 3 (only 0 and 4 are tested).
:let @r .= "*** Test 2: "
:if matcharg(0) == [] && matcharg(4) == [][1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for ":match", ":2match", ":3match", "clearmatches()", "getmatches()",[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[4;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 150 lines, 4605 characters written[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[5;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;1H:let rs2 = setmatches([{'group': 'MyGroup1', 'pattern': 'TODO', 'priority': 10,  [2;1H'id': 1}])
:call clearmatches()
:let rf1 = setmatches(0)
:let rf2 = setmatches([0])
:let rf3 = setmatches([{'wrong key': 'wrong value'}])
:if rs1 == 0 && rs2 == 0 && rf1 == -1 && rf2 == -1 && rf3 == -1
:  let @r .= "OK\n"
:else
:  let @r .= "FAILED\n"
:endif
:unlet rs1
:unlet rs2
:unlet rf1
:unlet rf2
:unlet rf3
:highlight clear MyGroup1
:highlight clear MyGroup2
:highlight clear MyGroup3
G"rp
:/^Results/,$wq! test.out
ENDTEST

Results of test63:[22;1H[?12l[?25h
[?25l

:so! Xdotest[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" --- Check that "matcharg()" returns the correct group and pattern if a match[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" --- is defined.[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet @r = "*** Test 1: "[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hhighlight MyGroup1 ctermbg=red[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hhighlight MyGroup2 ctermbg=green[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hhighlight MyGroup3 ctermbg=blue[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmatch MyGroup1 /TODO/[?25l[1;58H[41mTODO[m[18C  [2;1H'[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h2match MyGroup2 /FIXME/[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h3match MyGroup3 /XXX/[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hif matcharg(1) == ['MyGroup1', 'TODO'] && matcharg(2) == ['MyGroup2', 'FIXME']
&& matcharg(3) == ['MyGroup3', 'XXX'][?25l[25;1H[K[25;1H:  [?12l[?25h:  let @r .= "OK\n"
[?25l:  [?12l[?25h:else
[?25l:  [?12l[?25h:  let @r .= "FAILED\n"
[?25l:  [?12l[?25h:endif[1;1H[4L[?25l[1;1H:let rs2 = setmatches([{'group': 'MyGroup1', 'pattern': '[41mTODO[m', 'priority': 10,  [2;1H'id': 1}])
:call clearmatches()
:let rf1 = setmatches(0)[25;1H[K[23;1H[?12l[?25h[?25l

:[?12l[?25h" --- Check that "matcharg()" returns an empty list if the argument is not 1,[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" --- 2 or 3 (only 0 and 4 are tested).[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet @r .= "*** Test 2: "[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hif matcharg(0) == [] && matcharg(4) == [][?25l
:  [?12l[?25h:  let @r .= "OK\n"
[?25l:  [?12l[?25h:else
[?25l:  [?12l[?25h:  let @r .= "FAILED\n"
[?25l:  [?12l[?25h:endif[1;1H[4L[?25l[1;1H:let rs2 = setmatches([{'group': 'MyGroup1', 'pattern': '[41mTODO[m', 'priority': 10,  [2;1H'id': 1}])
:call clearmatches()
:let rf1 = setmatches(0)[25;1H[K[23;1H[?12l[?25h[?25l

:[?12l[?25h" --- Check that "matcharg()" returns ['', ''] if a match is not defined.[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet @r .= "*** Test 3: "[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmatch[?25l[1;58HTODO[18C  [2;1H'[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h2match[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h3match[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hif matcharg(1) == ['', ''] && matcharg(2) == ['', ''] && matcharg(3) == ['', '
[24;80H'[25;1H][?25l[25;1H[K[25;1H:  [?12l[?25h:  let @r .= "OK\n"
[?25l:  [?12l[?25h:else
[?25l:  [?12l[?25h:  let @r .= "FAILED\n"
[?25l:  [?12l[?25h:endif[1;1H[4L[?25l[1;1H:let rs2 = setmatches([{'group': 'MyGroup1', 'pattern': 'TODO', 'priority': 10,  [2;1H'id': 1}])
:call clearmatches()
:let rf1 = setmatches(0)[25;1H[K[23;1H[?12l[?25h[?25l

:[?12l[?25h" --- Check that "matchadd()" and "getmatches()" agree on added matches and[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" --- that default values apply.[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet @r .= "*** Test 4: "[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet m1 = matchadd("MyGroup1", "TODO")[?25l[1;58H[41mTODO[m[18C  [2;1H'[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet m2 = matchadd("MyGroup2", "FIXME", 42)[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet m3 = matchadd("MyGroup3", "XXX", 60, 17)[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hif getmatches() == [{'group': 'MyGroup1', 'pattern': 'TODO', 'priority': 10, '
[24;80Hi[25;1Hd': 4}, {'group': 'MyGroup2', 'pattern': 'FIXME', 'priority': 42, 'id': 5}, {'g
[24;80Hr[25;1Houp': 'MyGroup3', 'pattern': 'XXX', 'priority': 60, 'id': 17}][?25l[24;1H[K[25;1H[K[24;1H:  [?12l[?25h:  let @r .= "OK\n"[?25l
:  [?12l[?25h:else
[?25l:  [?12l[?25h:  let @r .= "FAILED\n"
[?25l:  [?12l[?25h:endif[1;1H[4L[?25l[1;1H:let rs2 = setmatches([{'group': 'MyGroup1', 'pattern': '[41mTODO[m', 'priority': 10,  [2;1H'id': 1}])
:call clearmatches()
:let rf1 = setmatches(0)[25;1H[K[23;1H[?12l[?25h[?25l

:[?12l[?25h" --- Check that "matchdelete()" deletes the matches defined in the previous[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" --- test correctly.[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet @r .= "*** Test 5: "[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall matchdelete(m1)[?25l[1;58HTODO[18C  [2;1H'[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall matchdelete(m2)[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall matchdelete(m3)[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hunlet m1[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hunlet m2[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hunlet m3[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hif getmatches() == [][?25l
:  [?12l[?25h:  let @r .= "OK\n"
[?25l:  [?12l[?25h:else
[?25l:  [?12l[?25h:  let @r .= "FAILED\n"
[?25l:  [?12l[?25h:endif[1;1H[4L[?25l[1;1H:let rs2 = setmatches([{'group': 'MyGroup1', 'pattern': 'TODO', 'priority': 10,  [2;1H'id': 1}])
:call clearmatches()
:let rf1 = setmatches(0)[25;1H[K[23;1H[?12l[?25h[?25l

:[?12l[?25h" --- Check that "matchdelete()" returns 0 if successful and otherwise -1.[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet @r .= "*** Test 6: "[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet m = matchadd("MyGroup1", "TODO")[?25l[1;58H[41mTODO[m[18C  [2;1H'[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet r1 = matchdelete(m)[?25l[1;58HTODO[18C  [2;1H'[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet r2 = matchdelete(42)[?25l[1m[37m[41mE803: ID not found: 42[m[25;23H[K[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hif r1 == 0 && r2 == -1[?25l
:  [?12l[?25h:  let @r .= "OK\n"
[?25l:  [?12l[?25h:else
[?25l:  [?12l[?25h:  let @r .= "FAILED\n"
[?25l:  [?12l[?25h:endif[1;1H[4L[?25l[1;1H:let rs2 = setmatches([{'group': 'MyGroup1', 'pattern': 'TODO', 'priority': 10,  [2;1H'id': 1}])
:call clearmatches()
:let rf1 = setmatches(0)[25;1H[K[23;1H[?12l[?25h[?25l

:[?12l[?25hunlet m[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hunlet r1[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hunlet r2[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" --- Check that "clearmatches()" clears all matches defined by ":match" and[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" --- "matchadd()".[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet @r .= "*** Test 7: "[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet m1 = matchadd("MyGroup1", "TODO")[?25l[1;58H[41mTODO[m[18C  [2;1H'[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet m2 = matchadd("MyGroup2", "FIXME", 42)[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet m3 = matchadd("MyGroup3", "XXX", 60, 17)[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmatch MyGroup1 /COFFEE/[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h2match MyGroup2 /HUMPPA/[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h3match MyGroup3 /VIM/[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall clearmatches()[?25l[1;58HTODO[18C  [2;1H'[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hif getmatches() == [][?25l
:  [?12l[?25h:  let @r .= "OK\n"
[?25l:  [?12l[?25h:else
[?25l:  [?12l[?25h:  let @r .= "FAILED\n"
[?25l:  [?12l[?25h:endif[1;1H[4L[?25l[1;1H:let rs2 = setmatches([{'group': 'MyGroup1', 'pattern': 'TODO', 'priority': 10,  [2;1H'id': 1}])
:call clearmatches()
:let rf1 = setmatches(0)[25;1H[K[23;1H[?12l[?25h[?25l

:[?12l[?25hunlet m1[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hunlet m2[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hunlet m3[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" --- Check that "setmatches()" restores a list of matches saved by[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" --- "getmatches()" without changes. (Matches with equal priority must also[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" --- remain in the same order.)[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet @r .= "*** Test 8: "[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet m1 = matchadd("MyGroup1", "TODO")[?25l[1;58H[41mTODO[m[18C  [2;1H'[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet m2 = matchadd("MyGroup2", "FIXME", 42)[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet m3 = matchadd("MyGroup3", "XXX", 60, 17)[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmatch MyGroup1 /COFFEE/[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h2match MyGroup2 /HUMPPA/[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h3match MyGroup3 /VIM/[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet ml = getmatches()[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall clearmatches()[?25l[1;58HTODO[18C  [2;1H'[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall setmatches(ml)[?25l[1;58H[41mTODO[m[18C  [2;1H'[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hif getmatches() == ml[?25l
:  [?12l[?25h:  let @r .= "OK\n"
[?25l:  [?12l[?25h:else
[?25l:  [?12l[?25h:  let @r .= "FAILED\n"
[?25l:  [?12l[?25h:endif[1;1H[4L[?25l[1;1H:let rs2 = setmatches([{'group': 'MyGroup1', 'pattern': '[41mTODO[m', 'priority': 10,  [2;1H'id': 1}])
:call clearmatches()
:let rf1 = setmatches(0)[25;1H[K[23;1H[?12l[?25h[?25l

:[?12l[?25hcall clearmatches()[?25l[1;58HTODO[18C  [2;1H'[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hunlet m1[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hunlet m2[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hunlet m3[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hunlet ml[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" --- Check that "setmatches()" will not add two matches with the same ID. The[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" --- expected behaviour (for now) is to add the first match but not the[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" --- second and to return 0 (even though it is a matter of debate whether[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" --- this can be considered successful behaviour).[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet @r .= "*** Test 9: "[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet r1 = setmatches([{'group': 'MyGroup1', 'pattern': 'TODO', 'priority': 10, 
[24;80H'[25;1Hid': 1}, {'group': 'MyGroup2', 'pattern': 'FIXME', 'priority': 10, 'id': 1}])[?25l[24;1H[1m[37m[41mE801: ID already taken: 1[m[24;26H[K[25;1H[K[25;1H[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hif getmatches() == [{'group': 'MyGroup1', 'pattern': 'TODO', 'priority': 10, '
[24;80Hi[25;1Hd': 1}] && r1 == 0[?25l[25;1H[K[25;1H:  [?12l[?25h:  let @r .= "OK\n"
[?25l:  [?12l[?25h:else
[?25l:  [?12l[?25h:  let @r .= "FAILED\n"
[?25l:  [?12l[?25h:endif[1;1H[5L[?25l[1;1H:let rs2 = setmatches([{'group': 'MyGroup1', 'pattern': '[41mTODO[m', 'priority': 10,  [2;1H'id': 1}])
:call clearmatches()
:let rf1 = setmatches(0)
:let rf2 = setmatches([0])[25;1H[K[23;1H[?12l[?25h[?25l

:[?12l[?25hcall clearmatches()[?25l[1;58HTODO[18C  [2;1H'[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hunlet r1[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" --- Check that "setmatches()" returns 0 if successful and otherwise -1.[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" --- (A range of valid and invalid input values are tried out to generate the[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" --- return values.)[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet @r .= "*** Test 10: "[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet rs1 = setmatches([])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet rs2 = setmatches([{'group': 'MyGroup1', 'pattern': 'TODO', 'priority': 10,
'id': 1}])[?25l[1;1H[L[1;1H:let rs2 = setmatches([{'group': 'MyGroup1', 'pattern': '[41mTODO[m', 'priority': 10,  [2;1H'[25;1H[K[23;1H[?12l[?25h[?25l

:[?12l[?25hcall clearmatches()[?25l[1;58HTODO[18C  [2;1H'[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet rf1 = setmatches(0)[?25l[1m[37m[41mE714: List required[m[25;20H[K[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet rf2 = setmatches([0])[?25l[1m[37m[41mE474: Invalid argument[m[25;23H[K[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet rf3 = setmatches([{'wrong key': 'wrong value'}])[?25l[1m[37m[41mE474: Invalid argument[m[25;23H[K[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hif rs1 == 0 && rs2 == 0 && rf1 == -1 && rf2 == -1 && rf3 == -1[?25l
:  [?12l[?25h:  let @r .= "OK\n"
[?25l:  [?12l[?25h:else
[?25l:  [?12l[?25h:  let @r .= "FAILED\n"
[?25l:  [?12l[?25h:endif[1;1H[4L[?25l[1;1H:let rs2 = setmatches([{'group': 'MyGroup1', 'pattern': 'TODO', 'priority': 10,  [2;1H'id': 1}])
:call clearmatches()
:let rf1 = setmatches(0)[25;1H[K[23;1H[?12l[?25h[?25l

:[?12l[?25hunlet rs1[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hunlet rs2[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hunlet rf1[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hunlet rf2[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hunlet rf3[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hhighlight clear MyGroup1[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hhighlight clear MyGroup2[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hhighlight clear MyGroup3[?25l[23;1H[?12l[?25h
[?25l
10 more lines[25;14H[K[1;24r[1;1H[2M[1;25r[23;1H*** Test 1: OK
*** Test 2: OK[25;1H[K[25;1H10 more lines[23;1H[?12l[?25h
[?25l[25;1H[K[25;1H:[?12l[?25h/^Results/,$wq! test.out[?25l[31msearch hit BOTTOM, continuing at TOP[m"test.out" [25;12H[K[25;12H[New File] 11 lines, 170 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test64.failed test.ok test.out X* viminfo
cp test64.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test64.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test64.in" 167 lines, 6276 characters[1;1HTest for regexp patterns.

A pattern that gives the expected result produces OK, so that we know it was
actually tried.

STARTTEST
:so small.vim
:" tl is a List of Lists with:
:"    regexp pattern
:"    text to test the pattern on
:"    expected match (optional)
:"    expected submatch 1 (optional)
:"    expected submatch 2 (optional)
:"    etc.
:"  When there is no match use only the first two items.
:let tl = []
:call add(tl, ['ab', 'aab', 'ab'])
:call add(tl, ['b', 'abcdef', 'b'])
:call add(tl, ['bc*', 'abccccdef', 'bcccc'])
:call add(tl, ['bc\{-}', 'abccccdef', 'b'])
:call add(tl, ['bc\{-}\(d\)', 'abccccdef', 'bccccd', 'd'])
:call add(tl, ['bc*', 'abbdef', 'b'])
:call add(tl, ['c*', 'ccc', 'ccc'])
:call add(tl, ['bc*', 'abdef', 'b'])[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for regexp patterns.[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[6;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[7;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 158 lines, 6117 characters written[7;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[7;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;1H:  else
:    $put ='OK'
:  endif
:  if len(l) > 0
:"   check all the nine submatches
:    for i in range(1, 9)
:      if len(t) <= i + 2
:[8Clet e = ''
:      else
:[8Clet e = t[i + 2]
:      endif
:      if l[i] != e
:[8C$put ='ERROR: pat: \"' . t[0] . '\", text: \"' . t[1] . '\", submatch ''[14;1H . i . ': \"' . l[i] . '\", expected: \"' . e . '\"'
:      endif
:    endfor
:    unlet i
:  endif
:endfor
:unlet t tl e l
:/^Results/,$wq! test.out
ENDTEST

Results of test64:[22;1H[?12l[?25h
[?25l

:so! Xdotest[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" tl is a List of Lists with:[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"    regexp pattern[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"    text to test the pattern on[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"    expected match (optional)[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"    expected submatch 1 (optional)[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"    expected submatch 2 (optional)[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"    etc.[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"  When there is no match use only the first two items.[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet tl = [][?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['ab', 'aab', 'ab'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['b', 'abcdef', 'b'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['bc*', 'abccccdef', 'bcccc'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['bc\{-}', 'abccccdef', 'b'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['bc\{-}\(d\)', 'abccccdef', 'bccccd', 'd'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['bc*', 'abbdef', 'b'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['c*', 'ccc', 'ccc'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['bc*', 'abdef', 'b'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['c*', 'abdef', ''])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['bc\+', 'abccccdef', 'bcccc'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['bc\+', 'abdef']) "no match[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"operator \|[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['a\|ab', 'cabd', 'a']) "alternation is ordered[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['c\?', 'ccb', 'c'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['bc\?', 'abd', 'b'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['bc\?', 'abccd', 'bc'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\va{1}', 'ab', 'a'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\va{2}', 'aa', 'aa'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\va{2}', 'caad', 'aa'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\va{2}', 'aba'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\va{2}', 'ab'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\va{2}', 'abaa', 'aa'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\va{2}', 'aaa', 'aa'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\vb{1}', 'abca', 'b'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\vba{2}', 'abaa', 'baa'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\vba{3}', 'aabaac'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(ab){1}', 'ab', 'ab', 'ab'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(ab){1}', 'dabc', 'ab', 'ab'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(ab){1}', 'acb'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(ab){0,2}', 'acb', "", ""])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(ab){0,2}', 'ab', 'ab', 'ab'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(ab){1,2}', 'ab', 'ab', 'ab'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(ab){1,2}', 'ababc', 'abab', 'ab'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(ab){2,4}', 'ababcab', 'abab', 'ab'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(ab){2,4}', 'abcababa', 'abab', 'ab'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(ab){2}', 'abab', 'abab', 'ab'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(ab){2}', 'cdababe', 'abab', 'ab'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(ab){2}', 'abac'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(ab){2}', 'abacabab', 'abab', 'ab'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v((ab){2}){2}', 'abababab', 'abababab', 'abab', 'ab'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v((ab){2}){2}', 'abacabababab', 'abababab', 'abab', 'ab'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a{1}){1}', 'a', 'a', 'a'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a{2}){1}', 'aa', 'aa', 'aa'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a{2}){1}', 'aaac', 'aa', 'aa'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a{2}){1}', 'daaac', 'aa', 'aa'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a{1}){2}', 'daaac', 'aa', 'a'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a{1}){2}', 'aaa', 'aa', 'a'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a{2})+', 'adaac', 'aa', 'aa'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a{2})+', 'aa', 'aa', 'aa'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a{2}){1}', 'aa', 'aa', 'aa'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a{1}){2}', 'aa', 'aa', 'a'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a{1}){1}', 'a', 'a', 'a'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a{2}){2}', 'aaaa', 'aaaa', 'aa'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a{2}){2}', 'aaabaaaa', 'aaaa', 'aa'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a+){2}', 'dadaac', 'aa', 'a'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a{3}){2}', 'aaaaaaa', 'aaaaaa', 'aaa'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a{1,2}){2}', 'daaac', 'aaa', 'a'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a{1,3}){2}', 'daaaac', 'aaaa', 'a'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a{1,3}){2}', 'daaaaac', 'aaaaa', 'aa'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a{1,3}){3}', 'daac'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a{1,2}){2}', 'dac'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a+)+', 'daac', 'aa', 'aa'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a+)+', 'aaa', 'aaa', 'aaa'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a+){1,2}', 'aaa', 'aaa', 'aaa'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a+)(a+)', 'aaa', 'aaa', 'aa', 'a'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a{3})+', 'daaaac', 'aaa', 'aaa'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a|b|c)+', 'aacb', 'aacb', 'b'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a|b|c){2}', 'abcb', 'ab', 'b'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(abc){2}', 'abcabd', ])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(abc){2}', 'abdabcabc','abcabc', 'abc'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['a*', 'cc', ''])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a*)+', 'cc', ''])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v((ab)+)+', 'ab', 'ab', 'ab', 'ab'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(((ab)+)+)+', 'ab', 'ab', 'ab', 'ab', 'ab'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(((ab)+)+)+', 'dababc', 'abab', 'abab', 'abab', 'ab'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a{0,2})+', 'cc', ''])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a*)+', '', ''])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v((a*)+)+', '', ''])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v((ab)*)+', '', ''])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\va{1,3}', 'aab', 'aa'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\va{2,3}', 'abaa', 'aa'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v((ab)+|c*)+', 'abcccaba', 'abcccab', '', 'ab'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a{2})|(b{3})', 'bbabbbb', 'bbb', '', 'bbb'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\va{2}|b{2}', 'abab'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a)+|(c)+', 'bbacbaacbbb', 'a', 'a'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\vab{2,3}c', 'aabbccccccccccccc', 'abbc'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\vab{2,3}c', 'aabbbccccccccccccc', 'abbbc'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\vab{2,3}cd{2,3}e', 'aabbbcddee', 'abbbcdde'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\va(bc){2}d', 'aabcbfbc' ])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\va*a{2}', 'a', ])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\va*a{2}', 'aa', 'aa' ])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\va*a{2}', 'aaa', 'aaa' ])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\va*a{2}', 'bbbabcc', ])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\va*b*|a*c*', 'a', 'a'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\va{1}b{1}|a{1}b{1}', ''])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"submatches[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a)', 'ab', 'a', 'a'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a)(b)', 'ab', 'ab', 'a', 'b'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(ab)(b)(c)', 'abbc', 'abbc', 'ab', 'b', 'c'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v((a)(b))', 'ab', 'ab', 'ab', 'a', 'b'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a)|(b)', 'ab', 'a', 'a'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['\v(a*)+', 'aaaa', 'aaaa', ''])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(tl, ['x', 'abcdef'])[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfor t in tl[?25l
:  [?12l[?25h:  let l = matchlist(t[1], t[0])
[?25l:  [?12l[?25h:" check the match itself
[?25l:  [?12l[?25h:  if len(l) == 0 && len(t) > 2
[?25l:    [?12l[?25h:    $put ='ERROR: pat: \"' . t[0] . '\", text: \"' . t[1] . '\", did not 
[24;80Hm[25;1Hatch, expected: \"' . t[2] . '\"'
[?25l:    [?12l[?25h:  elseif len(l) > 0 && len(t) == 2
[?25l:    [?12l[?25h:    $put ='ERROR: pat: \"' . t[0] . '\", text: \"' . t[1] . '\", match: \
[24;80H"[25;1H' . l[0] . '\", expected no match'
[?25l:    [?12l[?25h:  elseif len(t) > 2 && l[0] != t[2]
[?25l:    [?12l[?25h:    $put ='ERROR: pat: \"' . t[0] . '\", text: \"' . t[1] . '\", match: \
[24;80H"[25;1H' . l[0] . '\", expected: \"' . t[2] . '\"'
[?25l:    [?12l[?25h:  else
[?25l:    [?12l[?25h:    $put ='OK'
[?25l:    [?12l[?25h:  endif
[?25l:  [?12l[?25h:  if len(l) > 0
[?25l:    [?12l[?25h:"   check all the nine submatches
[?25l:    [?12l[?25h:    for i in range(1, 9)
[?25l:      [?12l[?25h:      if len(t) <= i + 2
[?25l:[8C[?12l[?25h:        let e = ''
[?25l:[8C[?12l[?25h:      else
[?25l:[8C[?12l[?25h:        let e = t[i + 2]
[?25l:[8C[?12l[?25h:      endif
[?25l:      [?12l[?25h:      if l[i] != e
[?25l:[8C[?12l[?25h:        $put ='ERROR: pat: \"' . t[0] . '\", text: \"' . t[1] . '\", ubmatch ' . i . ': \"' . l[i] . '\", expected: \"' . e . '\"'
[?25l:[8C[?12l[?25h:      endif
[?25l:      [?12l[?25h:    endfor
[?25l:    [?12l[?25h:    unlet i
[?25l:    [?12l[?25h:  endif
[?25l:  [?12l[?25h:endfor[27m[m[H[2J[?25l[1;1HOK
OK
OK
OK
OK
OK
OK
OK
OK
OK
OK
OK
OK
OK
OK
OK
OK
OK
OK
OK
OK
OK
OK
OK[?12l[?25h[?25l
:[?12l[?25hunlet t tl e l[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^Results/,$wq! test.out[?25l[31msearch hit BOTTOM, continuing at TOP[m"test.out" [25;12H[K[25;12H[New File] 102 lines, 322 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test65.failed test.ok test.out X* viminfo
cp test65.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test65.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test65.in" 78 lines, 1791 characters[1;1HTest for floating point.

STARTTEST
:so small.vim
:if !has("float")
:  e! test.ok
:  wq! test.out
:endif
:"
:$put =printf('%f', 123.456)
:$put =printf('%e', 123.456)
:$put =printf('%g', 123.456)
:" check we don't crash on division by zero
:echo 1.0 / 0.0
:$put ='+='
:let v = 1.234
:let v += 6.543
:$put =printf('%g', v)
:let v = 1.234
:let v += 5
:$put =printf('%g', v)
:let a = 5
:let a += 3.333
:$put =string(a)[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for floating point.[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 72 lines, 1727 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;1H:$put =printf('%g', log10(0.01000))
:$put ='pow'
:$put =printf('%g', pow(3, 3.0))
:$put =printf('%g', pow(2, 16))
:$put ='round'
:$put =printf('%g', round(0.456))
:$put =printf('%g', round(4.5))
:$put =printf('%g', round(-4.50))
:$put ='sqrt'
:$put =printf('%g', sqrt(100))
:echo sqrt(-4.01)
:$put ='str2float'
:$put =printf('%g', str2float('1e40'))
:$put ='trunc'
:$put =printf('%g', trunc(1.456))
:$put =printf('%g', trunc(-5.456))
:$put =printf('%g', trunc(4.000))
:$put ='float2nr'
:$put =float2nr(123.456)
:$put =float2nr(-123.456)
:/^Results/,$wq! test.out
ENDTEST

Results of test65:[22;1H[?12l[?25h
[?25l

:so! Xdotest[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hif !has("float")[?25l
:  [?12l[?25h:  e! test.ok
[?25l:  [?12l[?25h:  wq! test.out
[?25l:  [?12l[?25h:endif[1;1H[3L[?25l[1;1H:$put =printf('%g', log10(0.01000))
:$put ='pow'
:$put =printf('%g', pow(3, 3.0))[25;1H[K[23;1H[?12l[?25h[?25l

:[?12l[?25h"[?25l[23;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$put =printf('%f', 123.456)[?25l[1;24r[24;1H
[1;25r[24;1H123.456000[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =printf('%e', 123.456)[?25l[1;24r[24;1H
[1;25r[24;1H1.234560e+02[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =printf('%g', 123.456)[?25l[1;24r[24;1H
[1;25r[24;1H123.456[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h" check we don't crash on division by zero[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hecho 1.0 / 0.0[?25linf[25;4H[K[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$put ='+='[?25l[1;24r[24;1H
[1;25r[24;1H+=[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hlet v = 1.234[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet v += 6.543[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$put =printf('%g', v)[?25l[1;24r[24;1H
[1;25r[24;1H7.777[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hlet v = 1.234[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet v += 5[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$put =printf('%g', v)[?25l[1;24r[24;1H
[1;25r[24;1H6.234[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hlet a = 5[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet a += 3.333[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$put =string(a)[?25l[1;24r[24;1H
[1;25r[24;1H8.333[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put ='=='[?25l[1;24r[24;1H
[1;25r[24;1H==[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hlet v = 1.234[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$put =v == 1.234[?25l[1;24r[24;1H
[1;25r[24;1H1[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =v == 1.2341[?25l[1;24r[24;1H
[1;25r[24;1H0[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put ='add-subtract'[?25l[1;24r[24;1H
[1;25r[24;1Hadd-subtract[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =printf('%g', 4 + 1.234)[?25l[1;24r[24;1H
[1;25r[24;1H5.234[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =printf('%g', 1.234 - 8)[?25l[1;24r[24;1H
[1;25r[24;1H-6.766[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put ='mult-div'[?25l[1;24r[24;1H
[1;25r[24;1Hmult-div[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =printf('%g', 4 * 1.234)[?25l[1;24r[24;1H
[1;25r[24;1H4.936[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =printf('%g', 4.0 / 1234)[?25l[1;24r[24;1H
[1;25r[24;1H0.003241[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put ='dict'[?25l[1;24r[24;1H
[1;25r[24;1Hdict[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =string({'x': 1.234, 'y': -2.0e20})[?25l[1;24r[24;1H
[1;25r[24;1H{'x': 1.234, 'y': -2.0e20}[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put ='list'[?25l[1;24r[24;1H
[1;25r[24;1Hlist[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =string([-123.4, 2.0e-20])[?25l[1;24r[24;1H
[1;25r[24;1H[-123.4, 2.0e-20][25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put ='abs'[?25l[1;24r[24;1H
[1;25r[24;1Habs[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =printf('%d', abs(1456))[?25l[1;24r[24;1H
[1;25r[24;1H1456[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =printf('%d', abs(-4))[?25l[1;24r[24;1H
[1;25r[24;1H4[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =printf('%d', abs([1, 2, 3]))[?25l[1m[37m[41mE745: Using a List as a Number[m[25;32H[K[1;24r[24;1H
[1;25r[24;1H-1[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =printf('%g', abs(14.56))[?25l[1;24r[24;1H
[1;25r[24;1H14.56[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =printf('%g', abs(-54.32))[?25l[1;24r[24;1H
[1;25r[24;1H54.32[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put ='ceil'[?25l[1;24r[24;1H
[1;25r[24;1Hceil[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =printf('%g', ceil(1.456))[?25l[1;24r[24;1H
[1;25r[24;1H2.0[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =printf('%g', ceil(-5.456))[?25l[1;24r[24;1H
[1;25r[24;1H-5.0[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =printf('%g', ceil(-4.000))[?25l[1;24r[24;1H
[1;25r[24;1H-4.0[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put ='floor'[?25l[1;24r[24;1H
[1;25r[24;1Hfloor[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =printf('%g', floor(1.856))[?25l[1;24r[24;1H
[1;25r[24;1H1.0[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =printf('%g', floor(-5.456))[?25l[1;24r[24;1H
[1;25r[24;1H-6.0[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =printf('%g', floor(4.0))[?25l[1;24r[24;1H
[1;25r[24;1H4.0[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put ='log10'[?25l[1;24r[24;1H
[1;25r[24;1Hlog10[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =printf('%g', log10(1000))[?25l[1;24r[24;1H
[1;25r[24;1H3.0[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =printf('%g', log10(0.01000))[?25l[1;24r[24;1H
[1;25r[24;1H-2.0[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put ='pow'[?25l[1;24r[24;1H
[1;25r[24;1Hpow[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =printf('%g', pow(3, 3.0))[?25l[1;24r[24;1H
[1;25r[24;1H27.0[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =printf('%g', pow(2, 16))[?25l[1;24r[24;1H
[1;25r[24;1H65536.0[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put ='round'[?25l[1;24r[24;1H
[1;25r[24;1Hround[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =printf('%g', round(0.456))[?25l[1;24r[24;1H
[1;25r[24;1H0.0[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =printf('%g', round(4.5))[?25l[1;24r[24;1H
[1;25r[24;1H5.0[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =printf('%g', round(-4.50))[?25l[1;24r[24;1H
[1;25r[24;1H-5.0[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put ='sqrt'[?25l[1;24r[24;1H
[1;25r[24;1Hsqrt[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =printf('%g', sqrt(100))[?25l[1;24r[24;1H
[1;25r[24;1H10.0[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hecho sqrt(-4.01)[?25l-nan[25;5H[K[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$put ='str2float'[?25l[1;24r[24;1H
[1;25r[24;1Hstr2float[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =printf('%g', str2float('1e40'))[?25l[1;24r[24;1H
[1;25r[24;1H1.0e40[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put ='trunc'[?25l[1;24r[24;1H
[1;25r[24;1Htrunc[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =printf('%g', trunc(1.456))[?25l[1;24r[24;1H
[1;25r[24;1H1.0[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =printf('%g', trunc(-5.456))[?25l[1;24r[24;1H
[1;25r[24;1H-5.0[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =printf('%g', trunc(4.000))[?25l[1;24r[24;1H
[1;25r[24;1H4.0[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put ='float2nr'[?25l[1;24r[24;1H
[1;25r[24;1Hfloat2nr[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =float2nr(123.456)[?25l[1;24r[24;1H
[1;25r[24;1H123[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h$put =float2nr(-123.456)[?25l[1;24r[24;1H
[1;25r[24;1H-123[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h/^Results/,$wq! test.out[?25l[31msearch hit BOTTOM, continuing at TOP[m"test.out" [25;12H[K[25;12H[New File] 56 lines, 363 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test66.failed test.ok test.out X* viminfo
cp test66.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test66.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test66.in" 25 lines, 400 characters[2;1HTest for visual block shift and tab characters.

STARTTEST
:so small.vim
/^abcdefgh
[34m^V[m4jI    [34m^[[mj<<11|D
7|a[13C[34m^[[m
7|a[16C[34m^[[m
7|a[13C[34m^[[m4k13|[34m^V[m4j<
:$-4,$w! test.out
:$-4,$s/\s\+//g
[34m^V[m4kI    [34m^[[mj<<
7|a[13C[34m^[[m
7|a[37C[34m^[[m
7|a[21C[34m^[[m4k13|[34m^V[m4j3<
:$-4,$w >> test.out
:qa!
ENDTEST

abcdefghijklmnopqrstuvwxyz
abcdefghijklmnopqrstuvwxyz
abcdefghijklmnopqrstuvwxyz
abcdefghijklmnopqrstuvwxyz[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[4;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 14 lines, 196 characters written[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[5;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[19;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[20;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^abcdefgh[?25l[21;1H[?12l[?25h[?25l[?12l[?25h[?25l[1;24r[24;1H
[1;25r[20;1H[7ma
a
a
a[m
abcdefghijklmnopqrstuvwxyz[25;1H[K[24;1H[?12l[?25h[?25l[20;1Ha
a
a
a[20;1H    abcdefghijklmnopqrstuvwxyz
    abcdefghijklmnopqrstuvwxyz
    abcdefghijklmnopqrstuvwxyz
    abcdefghijklmnopqrstuvwxyz
    abcdefghijklmnopqrstuvwxyz[20;1H[?12l[?25h
[?25labcdefghijklmnopqrstuvwxyz[21;27H[K[21;1H[?12l[?25h[10C[?25l[21;11H[K[21;10H[?12l[?25h[22;10H[?25lc         defghijklmnopqrstuvwxyz[22;16H[?12l[?25h[23;16H[23;7H[?25lc            defghijklmnopqrstuvwxyz[23;19H[?12l[?25h[24;19H[24;7H[?25lc         defghijklmnopqrstuvwxyz[24;16H[?12l[?25h[20;16H[?25l[?12l[?25h[?25l[7mi[22;13H [23;13H [24;13H[?12l[?25h[?25l[m
5 lines <ed 1 time[20;13Hi[22;13Hdefghijklmnopqrstuvwxyz[22;36H[K[23;13Hdefghijklmnopqrstuvwxyz[23;36H[K[24;13Hdefghijklmnopqrstuvwxyz[24;36H[K[20;13H[?12l[?25h[21;10H[?25l[25;1H[K[25;1H:[?12l[?25h$-4,$w! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 5 lines, 150 characters written[21;10H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h$-4,$s/\s\+//g[?25l7 substitutions on 4 lines[20;1Habcdefghijklmnopqrstuvwxyz[20;27H[K[22;1Habcdefghijklmnopqrstuvwxyz[22;27H[K[23;1Habcdefghijklmnopqrstuvwxyz[23;27H[K[24;1Habcdefghijklmnopqrstuvwxyz[24;27H[K[24;1H[?12l[?25h[?25l[?12l[?25h[?25l[21;1H[7ma
a
a
a[20;1H[?12l[?25h[?25l[m
a
a
a
a[20;1H    abcdefghijklmnopqrstuvwxyz
    abcdefghij
    abcdefghijklmnopqrstuvwxyz
    abcdefghijklmnopqrstuvwxyz
    abcdefghijklmnopqrstuvwxyz[20;1H[?12l[?25h
[?25labcdefghij[21;11H[K[21;1H[?12l[?25h
    ab[?25lc         defghijklmnopqrstuvwxyz[22;16H[?12l[?25h[23;16H[23;7H[?25lc                       [10Cdefghijklmnopqrstuvwxyz[23;40H[?12l[?25h[24;30H[24;7H[?25lc                 defghijklmnopqrstuvwxyz[24;24H[?12l[?25h[20;24H[20;13H[?25l[?12l[?25h[?25l[7mi[22;13H [23;13H [24;13H[?12l[?25h[?25l[m
5 lines <ed 3 times[25;20H[K[20;13Hi[22;13Hdefghijklmnopqrstuvwxyz[22;36H[K[23;13H    defghijklmnopqrstuvwxyz[23;41H[K[24;13Hdefghijklmnopqrstuvwxyz[24;36H[K[20;13H[?12l[?25h[21;10H[?25l[25;1H[K[25;1H:[?12l[?25h$-4,$w >> test.out[?25l"test.out"[25;12H[K[25;12H5 lines, 147 characters appended[21;10H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test67.failed test.ok test.out X* viminfo
cp test67.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test67.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test67.in" 33 lines, 1109 characters[1;1HTest that groups and patterns are tested correctly when calling exists() for
autocommands.

STARTTEST
:so small.vim
:let results=[]
:augroup auexists
:augroup END
:call add(results, "##BufEnter: " . exists("##BufEnter"))
:call add(results, "#BufEnter: " . exists("#BufEnter"))
:au BufEnter * let g:entered=1
:call add(results, "#BufEnter: " . exists("#BufEnter"))
:call add(results, "#auexists#BufEnter: " . exists("#auexists#BufEnter"))
:augroup auexists
:au BufEnter * let g:entered=1
:augroup END
:call add(results, "#auexists#BufEnter: " . exists("#auexists#BufEnter"))
:call add(results, "#BufEnter#*.test: " . exists("#BufEnter#*.test"))
:au BufEnter *.test let g:entered=1
:call add(results, "#BufEnter#*.test: " . exists("#BufEnter#*.test"))
:edit testfile.test
:call add(results, "#BufEnter#<buffer>: " . exists("#BufEnter#<buffer>"))
:au BufEnter <buffer> let g:entered=1
:call add(results, "#BufEnter#<buffer>: " . exists("#BufEnter#<buffer>"))[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest that groups and patterns are tested correctly when calling exists() for[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[4;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 27 lines, 998 characters written[5;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[5;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[8M[1;25r[17;1H:edit testfile2.test
:call add(results, "#BufEnter#<buffer>: " . exists("#BufEnter#<buffer>"))
:e test.out
:call append(0, results)
:$d
:w
:qa!
ENDTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet results=[][?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25haugroup auexists[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25haugroup END[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(results, "##BufEnter: " . exists("##BufEnter"))[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(results, "#BufEnter: " . exists("#BufEnter"))[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau BufEnter * let g:entered=1[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(results, "#BufEnter: " . exists("#BufEnter"))[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(results, "#auexists#BufEnter: " . exists("#auexists#BufEnter"))[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25haugroup auexists[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau BufEnter * let g:entered=1[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25haugroup END[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(results, "#auexists#BufEnter: " . exists("#auexists#BufEnter"))[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(results, "#BufEnter#*.test: " . exists("#BufEnter#*.test"))[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau BufEnter *.test let g:entered=1[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(results, "#BufEnter#*.test: " . exists("#BufEnter#*.test"))[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hedit testfile.test[?25l"testfile.test" [New File][1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hcall add(results, "#BufEnter#<buffer>: " . exists("#BufEnter#<buffer>"))[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hau BufEnter <buffer> let g:entered=1[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(results, "#BufEnter#<buffer>: " . exists("#BufEnter#<buffer>"))[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hedit testfile2.test[?25l"testfile2.test" [New File][1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall add(results, "#BufEnter#<buffer>: " . exists("#BufEnter#<buffer>"))[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he test.out[?25l"test.out" [New File][1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall append(0, results)[?25l[1;24r[1;1H[10L[1;25r[1;1H##BufEnter: 1
#BufEnter: 0
#BufEnter: 1
#auexists#BufEnter: 0
#auexists#BufEnter: 1
#BufEnter#*.test: 0
#BufEnter#*.test: 1
#BufEnter#<buffer>: 0
#BufEnter#<buffer>: 1
#BufEnter#<buffer>: 0[25;1H[K[11;1H[?12l[?25h[?25l[25;1H:[?12l[?25h$d[?25l[11;1H[1m[34m~                                                                               [10;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hw[?25l"test.out" [New File] 10 lines, 190 characters written[10;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test68.failed test.ok test.out X* viminfo
cp test68.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test68.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test68.in" 56 lines, 428 characters[1;1HTest for text formatting.

Results of test68:

STARTTEST
:so small.vim
/^{/+1
:set noai tw=2 fo=t
gRa b[34m^[[m
ENDTEST

{


}

STARTTEST
/^{/+1
:set ai tw=2 fo=tw
gqgqjjllab[34m^[[m
ENDTEST

{
a  b[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for text formatting.[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[5;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[6;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 4 lines, 48 characters written[6;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[6;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[10;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[11;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[11;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^{/+1[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset noai tw=2 fo=t[?25l[13;1H[?12l[?25h[?25la
b[?12l[?25h
[?25l[25;1H[K[25;1H/^STARTTEST[17;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[18;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3 lines, 38 characters written[18;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[18;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[21;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[22;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^{/+1[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset ai tw=2 fo=tw[?25l[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[23;4H[K[24;1Hb[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1Ha[?12l[?25ha [?25l[1;24r[24;1H
[1;25r[24;1Hb[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H}[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H/^{/+1[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H4 lines, 34 characters written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[4M[1;25r[21;1H:set tw=3 fo=t
gqgqo
a [34m^V^A^[[m
ENDTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^{/+1[?25l[1;24r[1;1H[2M[1;25r[23;1H{
a [34m^A[m[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hset tw=3 fo=t[?25l[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[23;3H[K[24;1H[34m^A[m[25;1H[K[24;1H[?12l[?25h[2C[?25l[1;24r[1;1H[3M[1;25r[23;1Ha
[34m^A[?12l[?25h[?25l[1;24r[m[24;1H
[1;25r[24;1H}[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H/^{/+1[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H5 lines, 58 characters written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[5M[1;25r[20;1H:set tw=2 fo=tcq1 comments=:#
gqgqjgqgqo
a b
#a b[34m^[[m
ENDTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^{/+1[?25l[1;24r[1;1H[2M[1;25r[23;1H{
a b[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hset tw=2 fo=tcq1 comments=:#[?25l[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H#a b[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[1;1H[3M[1;25r[23;1Ha b
#a b[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H}[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H:g/^STARTTEST/.,/^ENDTEST/d[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2 lines, 56 characters written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST[25;10H[K[25;1H[24;19H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H:1;/^Results/,$wq! test.out[25;1H[K[24;19H[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hg/^STARTTEST/.,/^ENDTEST/d[?25l28 fewer lines[25;15H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h1;/^Results/,$wq! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 35 lines, 91 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test69.failed test.ok test.out X* viminfo
cp test69.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test69.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test69.in" 139 lines, 1154 characters[1;1HTest for multi-byte text formatting.

STARTTEST
:so mbyte.vim
:set encoding=utf-8
ENDTEST

Results of test69:

STARTTEST
/^{/+1
:set tw=2 fo=t
gqgqjgqgqo
ＸＹＺ
abc ＸＹＺ[34m^[[m
ENDTEST

{
ＸＹＺ
abc ＸＹＺ
}

STARTTEST
/^{/+1[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for multi-byte text formatting.[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 2 lines, 34 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[6;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[7;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso mbyte.vim[?25l[7;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset encoding=utf-8[?25l[27m[m[H[2J[1;1HTest for multi-byte text formatting.

STARTTEST
:so mbyte.vim
:set encoding=utf-8
ENDTEST

Results of test69:

STARTTEST
/^{/+1
:set tw=2 fo=t
gqgqjgqgqo
ＸＹＺ
abc ＸＹＺ[34m^[[m
ENDTEST

{
ＸＹＺ
abc ＸＹＺ
}

STARTTEST
/^{/+1[7;1H[?12l[?25h[?25l[25;1H/^STARTTEST[10;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[11;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H5 lines, 58 characters written[11;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[11;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[16;1H[?12l[?25h
[?25l[25;1H[K[25;1H:so! Xdotest[17;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^{/+1[?25l[19;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset tw=2 fo=t[?25l[19;1H[?12l[?25h
[?25l[21;24r[21;1H[L[1;25r[20;5H[K[21;1HＸＹＺ[25;1H[K[21;1H[?12l[?25h[?25l[22;1H[K[24;1H}[24;2H[K[23;1H[?12l[?25h[?25lＸ[?12l[?25h[?25lＹ[?12l[?25h[?25lＺ
abc [?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HＸ[?12l[?25h[?25lＹ[?12l[?25h[?25lＺ[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H}[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H/^{/+1[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H8 lines, 80 characters written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[8M[1;25r[17;1H:set tw=1 fo=tm
gqgqjgqgqjgqgqjgqgqjgqgqo
Ｘ
Ｘa
Ｘ a
ＸＹ
Ｘ Ｙ[34m^[[m
ENDTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^{/+1[?25l[1;24r[1;1H[2M[1;25r[23;1H{
Ｘ[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hset tw=1 fo=tm[?25l[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HＸa[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[23;3H[K[24;1Ha[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HＸ a[?12l[?25h[?25l[1;24r[24;1H
[1;25r[23;4H[K[24;1Ha[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HＸＹ[?12l[?25h[?25l[1;24r[24;1H
[1;25r[23;3H[K[24;1HＹ[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HＸ Ｙ[?12l[?25h[?25l[1;24r[24;1H
[1;25r[23;4H[K[24;1HＹ[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[23;1HＸ
[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[22;1HＸ
a
[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[22;1HＸ
a
[?12l[?25h[?25lＸ[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[23;1HＹ
[?12l[?25h[?25lＸ [?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HＹ[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H}[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H/^{/+1[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H13 lines, 140 characters written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;1Hgqgqjgqgqjgqgqjgqgqjgqgqjgqgqjgqgqjgqgqjgqgqjgqgqo
Ｘ
Ｘa
Ｘ a
ＸＹ
Ｘ Ｙ
aＸ
abＸ
abcＸ
abＸ c
abＸＹ[34m^[[m
ENDTEST

{
Ｘ
Ｘa
Ｘ a
ＸＹ
Ｘ Ｙ
aＸ
abＸ
abcＸ
abＸ c
abＸＹ[12;1H[?12l[?25h
[?25l[25;1H:so! Xdotest[13;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^{/+1[?25l[15;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset tw=2 fo=tm[?25l[15;1H[?12l[?25h
[?25l[17;24r[17;1H[L[1;25r[16;3H[K[17;1Ha[25;1H[K[17;1H[?12l[?25h
[?25l[19;24r[19;1H[L[1;25r[18;4H[K[19;1Ha[?12l[?25h
[?25l[21;24r[21;1H[L[1;25r[20;3H[K[21;1HＹ[?12l[?25h
[?25l[22;4H[K[23;1HＹ 
aＸ [23;1H[?12l[?25h
[?25l[1;24r[24;1H
[1;25r[23;2H[K[24;1HＸ[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HabＸ[?12l[?25h[?25l[1;24r[24;1H
[1;25r[23;3H[K[24;1HＸ[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HabcＸ[?12l[?25h[?25l[1;24r[24;1H
[1;25r[23;4H[K[24;1HＸ[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HabＸ c[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[22;3H[K[23;1HＸ
c[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HabＸＹ[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[22;3H[K[23;1HＸ
Ｙ[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[23;1HＸ
[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[22;1HＸ
a
[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[22;1HＸ
a
[?12l[?25h[?25lＸ[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[23;1HＹ
[?12l[?25h[?25lＸ [?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[23;1HＹ
a[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[23;1HＸ
ab[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[23;1HＸ
abc[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[23;1HＸ
ab[?12l[?25h[?25l[1;24r[1;1H[3M[1;25r[22;1HＸ
c
ab[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HＸ[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HＹ[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H}[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H/^{/+1[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H5 lines, 47 characters written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[5M[1;25r[20;1H:set ai tw=2 fo=tm
gqgqjgqgqo
Ｘ
Ｘa[34m^[[m
ENDTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^{/+1[?25l[1;24r[1;1H[2M[1;25r[23;1H{
  Ｘ[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hset ai tw=2 fo=tm[?25l[24;1H[?12l[?25h  [?25l[1;24r[24;1H
[1;25r[24;2H Ｘa[25;1H[K[24;3H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[23;5H[K[24;2H a[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[24;3H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[23;2H Ｘ
  [?12l[?25h[?25l[1;24r[24;1H
[1;25r[23;2H Ｘ
  a[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H}[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H/^{/+1[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H5 lines, 53 characters written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[5M[1;25r[20;1H:set noai tw=2 fo=tm
gqgqjgqgqo
  Ｘ
  Ｘa[34m^[[m
ENDTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^{/+1[?25l[1;24r[1;1H[2M[1;25r[23;1H{
  Ｘ[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hset noai tw=2 fo=tm[?25l[24;1H[?12l[?25h  [?25l[1;24r[24;1H
[1;25r[24;2H Ｘa[25;1H[K[24;3H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[23;5H[K[24;1Ha[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[24;3H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[23;2H Ｘ
  [?12l[?25h[?25l[1;24r[24;1H
[1;25r[23;2H Ｘ
a[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H}[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H/^{/+1[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H13 lines, 169 characters written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;1Hgqgqjgqgqjgqgqjgqgqjgqgqjgqgqjgqgqjgqgqjgqgqjgqgqo
Ｘ
Ｘa
ＸaＹ
ＸＹ
ＸＹＺ
Ｘ Ｙ
Ｘ ＹＺ
ＸＸ
ＸＸa
ＸＸＹ[34m^[[m
ENDTEST

{
Ｘ
Ｘa
ＸaＹ
ＸＹ
ＸＹＺ
Ｘ Ｙ
Ｘ ＹＺ
ＸＸ
ＸＸa
ＸＸＹ[12;1H[?12l[?25h
[?25l[25;1H:so! Xdotest[13;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^{/+1[?25l[15;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset tw=2 fo=cqm comments=n:Ｘ[?25l[15;1H[?12l[?25h

[?25l[18;24r[18;1H[L[1;25r[17;4H[K[18;1HＸＹ[25;1H[K[18;1H[?12l[?25h

[?25l[21;24r[21;1H[L[1;25r[20;5H[K[21;1HＸＺ[?12l[?25h

[?25l[23;6H[K[24;3H Ｚ[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HＸＸ[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HＸＸa[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1HＸＸＹ[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[23;1HＸ
[?12l[?25h[?25l[1;24r[24;1H
[1;25r[23;1HＸa
[?12l[?25h[?25lＸa[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[23;1HＸＹ
[?12l[?25h[?25lＸ[?12l[?25h[?25l[1;24r[24;1H
[1;25r[23;3HＹ
[?12l[?25h[?25lＸ[?12l[?25h[?25lＹ[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[23;1HＸＺ
[?12l[?25h[?25lＸ [?12l[?25h[?25l[1;24r[24;1H
[1;25r[23;3H Ｙ
[?12l[?25h[?25lＸ [?12l[?25h[?25l Ｙ[?12l[?25h[?25l[1;24r[1;1H[2M[1;25r[23;1HＸ Ｚ
[?12l[?25h[?25lＸ[?12l[?25h[?25l[1;24r[24;1H
[1;25r[23;3HＸ
[?12l[?25h[?25lＸ[?12l[?25h[?25l[1;24r[24;1H
[1;25r[23;3HＸa
[?12l[?25h[?25lＸ[?12l[?25h[?25lＸ[?12l[?25h[?25lＹ[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H}[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H/^{/+1[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3 lines, 30 characters written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[3M[1;25r[22;1H:set tw=2 fo=tm
RＸa[34m^[[m
ENDTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25h^{/+1[?25l[1;24r[1;1H[2M[1;25r[23;1H{[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hset tw=2 fo=tm[?25l[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[23;1HＸ
a[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H}[?12l[?25h[?25l
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H:g/^STARTTEST/.,/^ENDTEST/d[?12l[?25h[?25l
:set ff=unix cpo-=A[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2 lines, 56 characters written[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?12l[?25h[?25l
/ENDTEST[25;10H[K[25;1H[24;19H[?12l[?25h[?25l[1;24r[24;1H
[1;25r[24;1H:1;/^Results/,$wq! test.out[25;1H[K[24;19H[?12l[?25h[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hg/^STARTTEST/.,/^ENDTEST/d[?25l74 fewer lines[25;15H[K[1;3HＸa[2;3HＸＹ[3;1H[K[4;4H[K[5;3Ha[5;4H[K[6;3Ha [7;3HＹ[7;5H[K[8;3HＹ[8;5H[K[9;1HＸＹ
ＸＺ
Ｘ Ｙ[11;6H[K[12;1HＸ Ｙ[12;6H[K[13;1HＸ Ｚ[13;6H[K[14;1HＸＸ[14;5H[K[15;1HＸＸa[15;6H[K[16;1HＸＸＹ
}[18;1H[K[19;1H[K[20;1H{
Ｘ
a[22;2H[K[23;1H}[23;2H[K[24;1H[K[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h1;/^Results/,$wq! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 142 lines, 574 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test70.failed test.ok test.out X* viminfo
cp test70.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test70.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test70.in" 53 lines, 1249 characters[1;1HSmoke test for MzScheme interface and mzeval() function

STARTTEST
:so mzscheme.vim
:set nocompatible viminfo+=nviminfo
:function! MzRequire()
:redir => l:mzversion
:mz (version)
:redir END
:if strpart(l:mzversion, 1, 1) < "4"
:" MzScheme versions < 4.x:
:mz (require (prefix vim- vimext))
:else
:" newer versions:
:mz (require (prefix-in vim- 'vimext))
:mz (require r5rs)
:endif
:endfunction
:silent call MzRequire()
:mz (define l '("item0" "dictionary with list OK" "item2"))
:mz (define h (make-hash))
:mz (hash-set! h "list" l)
/^1
:" change buffer contents[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HSmoke test for MzScheme interface and mzeval() function[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 45 lines, 1146 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;1H:let scalar_res = "OK"
:else
:let scalar_res = "FAILED"
:endif
:call append(search("^1"), "scalar test " . scalar_res)
:" dictionary containing a list
:let tmp = mzeval("h")["list"][1]
:/^2/put =tmp
:" circular list (at the same time test lists containing lists)
:mz (set-car! (cddr l) l)
:let l2 = mzeval("h")["list"]
:if l2[2] == l2
:let res = "OK"
:else
:let res = "FAILED"
:endif
:call setline(search("^3"), "circular test " . res)
:?^1?,$w! test.out
:qa!
ENDTEST

1 line 1
2 line 2
3 line 3[20;1H[?12l[?25h
[?25l[25;1H:so! Xdotest[21;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso mzscheme.vim[?25l"test.ok" [25;11H[K[25;11H5 lines, 82 characters
"test.out" [New File] 5 lines, 82 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test71.failed test.ok test.out X* viminfo
cp test71.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test71.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test71.in" 75 lines, 1397 characters[1;1HTest for encryption.

STARTTEST
:so small.vim
:/^start of text/+1
:let text_lines = getline('.', line('.') + 2)
:/^start of cm=zip bytes/+1
:let cm0_bytes = getline('.', '.')
:/^start of cm=blowfish bytes/+1
:let cm1_bytes = getline('.', '.')
:bwipe
:call append(0, text_lines)
:$d
:X
foobar
foobar
:w! Xtestfile
:bwipe!
:e Xtestfile
foobar
:let cm0_read_back = getline('.', '$')
:set key=
:set cryptmethod=blowfish
:" If the blowfish test fails 'cryptmethod' will be 'zip' now.[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for encryption.[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 57 lines, 1043 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;1H:w! Xtestfile
:bwipe!
:set nobin
:e Xtestfile
barbar
:call append(0, cm0_read_bin)
:call append(0, cm1_read_back)
:call append(0, cm0_read_back)
:set key= fenc=latin1
:w! test.out
:qa!
ENDTEST

start of text
01234567890123456789012345678901234567
line 2  foo bar blah
line 3 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
end of text

start of cm=zip bytes
VimCrypt~01![34m^F^\[mlV'}Mg[34m| [mV[34m^G[mE#3[34m~N[m2U[34m~W[m
end of cm=zip bytes

start of cm=blowfish bytes[12;1H[?12l[?25h
[?25l[25;1H:so! Xdotest[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[13;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^start of text/+1[?25l[15;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet text_lines = getline('.', line('.') + 2)[?25l[15;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^start of cm=zip bytes/+1[?25l[21;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet cm0_bytes = getline('.', '.')[?25l[21;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h/^start of cm=blowfish bytes/+1[?25l[1;24r[24;1H
[1;25r[24;1HVimCrypt~02!k)[34m^W~W[m#[34m^V[mS[34m~\[m=#M[34m~F[mJAͥM[34m~F[m![34m~@^U~[[m[34m^O[m[34m^Y~B^V~X[m[34m^M[m[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25hlet cm1_bytes = getline('.', '.')[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe[?25l[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hcall append(0, text_lines)[?25l[1;24r[1;1H[3L[1;25r[1;1H01234567890123456789012345678901234567
line 2  foo bar blah
line 3 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[25;1H[K[4;1H[?12l[?25h[?25l[25;1H:[?12l[?25h$d[?25l[4;1H[1m[34m~                                                                               [3;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hX[?25l[25;1H[K[25;1HEnter encryption key: [?12l[?25h******
[?25lEnter same key again: [?12l[?25h******
[1;1H[2L[?25l[1;1H01234567890123456789012345678901234567
line 2  foo bar blah[25;1H[K[3;1H[?12l[?25h[?25l[25;1H:[?12l[?25hw! Xtestfile[?25l"Xtestfile" [25;13H[K[25;13H[New File][crypted] 3 lines, 98 characters written[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe![?25l[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25he Xtestfile[?25l"Xtestfile" Need encryption key for "Xtestfile"
Enter encryption key: [?12l[?25h******
[?25l"Xtestfile" [crypted] 3 lines, 98 characters[1;1H[2L[1;1H01234567890123456789012345678901234567
line 2  foo bar blah
line 3 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[3;38H[K[25;1H[K[25;1H"Xtestfile" [crypted] 3 lines, 98 characters[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet cm0_read_back = getline('.', '$')[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset key=[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cryptmethod=blowfish[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" If the blowfish test fails 'cryptmethod' will be 'zip' now.[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h%s/^/\=&cryptmethod == 'blowfish' ? "OK " : "blowfish test failed "/[?25l3 substitutions on 3 lines[25;27H[K[1;1HOK 01234567890123456789012345678901234567
OK line 2  foo bar blah
OK line 3 [27Cxxx[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hX[?25l[25;1H[K[25;1HEnter encryption key: [?12l[?25h******
[?25lEnter same key again: [?12l[?25h******
[1;1H[2L[?25l[1;1HOK 01234567890123456789012345678901234567
OK line 2  foo bar blah[25;1H[K[3;1H[?12l[?25h[?25l[25;1H:[?12l[?25hw! Xtestfile[?25l"Xtestfile" [25;13H[K[25;13H[crypted] 3 lines, 107 characters written[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe![?25l[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25he Xtestfile[?25l"Xtestfile" Need encryption key for "Xtestfile"
Enter encryption key: [?12l[?25h******
[?25l"Xtestfile" [crypted] 3 lines, 107 characters[1;1H[2L[1;1HOK 01234567890123456789012345678901234567
OK line 2  foo bar blah
OK line 3 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[3;41H[K[25;1H[K[25;1H"Xtestfile" [crypted] 3 lines, 107 characters[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet cm1_read_back = getline('.', '$')[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe![?25l[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hset bin noeol key=[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall append(0, cm0_bytes)[?25l[1;24r[1;1H[L[1;25r[1;1HVimCrypt~01![34m^F^\[mlV'}Mg[34m| [mV[34m^G[mE#3[34m~N[m2U[34m~W[m[25;1H[K[2;1H[?12l[?25h[?25l[25;1H:[?12l[?25h$d[?25l[2;1H[1m[34m~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hset fenc=latin1[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw! Xtestfile[?25l"Xtestfile" [25;13H[K[25;13H[Incomplete last line] 1 line, 36 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe![?25l[1;1H[K[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset nobin[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he Xtestfile[?25l"Xtestfile" Need encryption key for "Xtestfile"
Enter encryption key: [?12l[?25h******
[?25l"Xtestfile" [crypted] 2 lines, 24 characters[1;1H[2L[1;1H1234567890
abbccddeff[25;1H[K[25;1H"Xtestfile" [crypted] 2 lines, 24 characters[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet cm0_read_bin = getline('.', '$')[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe![?25l[1;1H[K[2;1H[1m[34m~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hset bin noeol key=[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall append(0, cm1_bytes)[?25l[1;24r[1;1H[L[1;25r[1;1HVimCrypt~02!k)[34m^W~W[m#[34m^V[mS[34m~\[m=#M[34m~F[mJAͥM[34m~F[m![34m~@^U~[[m[34m^O[m[34m^Y~B^V~X[m[34m^M[m[25;1H[K[2;1H[?12l[?25h[?25l[25;1H:[?12l[?25h$d[?25l[2;1H[1m[34m~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hset fenc=latin1[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw! Xtestfile[?25l"Xtestfile" [25;13H[K[25;13H[Incomplete last line] 1 line, 55 characters written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe![?25l[1;1H[K[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset nobin[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he Xtestfile[?25l"Xtestfile" Need encryption key for "Xtestfile"
Enter encryption key: [?12l[?25h******
[?25l"Xtestfile" [crypted] 2 lines, 27 characters[1;1H[2L[1;1Hasdfasdfasdf
0001112223333[25;1H[K[25;1H"Xtestfile" [crypted] 2 lines, 27 characters[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall append(0, cm0_read_bin)[?25l[1;24r[1;1H[2L[1;25r[1;1H1234567890
abbccddeff[25;1H[K[3;1H[?12l[?25h[?25l[25;1H:[?12l[?25hcall append(0, cm1_read_back)[?25l[1;24r[1;1H[3L[1;25r[1;1HOK 01234567890123456789012345678901234567
OK line 2  foo bar blah
OK line 3 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[25;1H[K[6;1H[?12l[?25h[?25l[25;1H:[?12l[?25hcall append(0, cm0_read_back)[?25l[1;24r[1;1H[3L[1;25r[1;1H01234567890123456789012345678901234567
line 2  foo bar blah
line 3 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[25;1H[K[9;1H[?12l[?25h[?25l[25;1H:[?12l[?25hset key= fenc=latin1[?25l[9;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw! test.out[?25l"test.out" [25;12H[K[25;12H[New File] 10 lines, 256 characters written[9;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test72.failed test.ok test.out X* viminfo
cp test72.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test72.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test72.in" 109 lines, 1564 characters[1;1HTests for undo file.
Since this script is sourced we need to explicitly break changes up in
undo-able pieces.  Do that by setting 'undolevels'.

STARTTEST
:so small.vim
:"
:" Test 'undofile': first a simple one-line change.
:set nocompatible viminfo+=nviminfo visualbell
:set ul=100 undofile nomore
:e! Xtestfile
ggdGithis is one line[34m^[[m:set ul=100
:s/one/ONE/
:set ul=100
:w
:bwipe!
:e Xtestfile
u:.w! test.out
:"
:" Test 'undofile', change in original file fails check
:set noundofile
:e! Xtestfile
:s/line/Line/
:w[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for undo file.[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[5;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[6;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 98 lines, 1367 characters written[6;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[6;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;1Hibar [34m^[[m:set ul=100
:X
foobar
foobar
:w!
:bwipe!
:e Xtestfile
foobar
:set key=
/bar
:.w >>test.out
u:.w >>test.out
u:.w >>test.out
u:.w >>test.out
:"
:" Rename the undo file so that it gets cleaned up.
:call rename(".Xtestfile.un~", "Xtestundo")
:qa!
ENDTEST

1111 -----
2222 -----

123456789[19;1H[?12l[?25h
[?25l[25;1H:so! Xdotest[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Test 'undofile': first a simple one-line change.[?25l[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset nocompatible viminfo+=nviminfo visualbell[?25l[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset ul=100 undofile nomore[?25l[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! Xtestfile[?25l"Xtestfile" [New File][1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[1m-- INSERT --[m[25;13H[K[25;1H[K[1;1Hthis is one line[?12l[?25h[?25l[25;1H:[?12l[?25hset ul=100[?25l[1;16H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hs/one/ONE/[?25l[1;9HONE[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset ul=100[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw[?25l"Xtestfile" [New] 1L, 17C written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe![?25l"test72.in" 109L, 1564C[1;1Hibar [34m^[[m:set ul=100
:X[2;3H[K[3;1Hfoobar[3;7H[K[4;1Hfoobar[4;7H[K[5;1H:w![5;4H[K[6;1H:bwipe![6;8H[K[7;1H:e Xtestfile[7;13H[K[8;1Hfoobar[8;7H[K[9;1H:set key=[9;10H[K[10;1H/bar[10;5H[K[11;1H:.w >>test.out[11;15H[K[12;1Hu:.w >>test.out[12;16H[K[13;1Hu:.w >>test.out[13;16H[K[14;1Hu:.w >>test.out[14;16H[K[15;1H:"[15;3H[K[16;1H:" Rename the undo file so that it gets cleaned up.[16;52H[K[17;1H:call rename(".Xtestfile.un~", "Xtestundo")[17;44H[K[18;1H:qa![18;5H[K[19;1HENDTEST[19;8H[K[20;1H[K[21;1H1111 -----[21;11H[K[22;1H2222 -----[22;11H[K[23;1H[K[24;1H123456789[24;10H[K[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he Xtestfile[?25l"Xtestfile" 1L, 17C[1;1Hthis is ONE line[1;17H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H1 change; before #2  0 seconds ago[1;9Hone[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w! test.out[?25l"test.out" [25;12H[K[25;12H[New] 1L, 17C written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Test 'undofile', change in original file fails check[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset noundofile[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! Xtestfile[?25l"Xtestfile" [25;13H[K[25;13H1L, 17C[1;9HONE[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hs/line/Line/[?25l[1;13HL[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw[?25l"Xtestfile" 1L, 17C written[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset undofile[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe![?25l"test72.in" 109L, 1564C[1;1Hibar [34m^[[m:set ul=100
:X[2;3H[K[3;1Hfoobar[3;7H[K[4;1Hfoobar[4;7H[K[5;1H:w![5;4H[K[6;1H:bwipe![6;8H[K[7;1H:e Xtestfile[7;13H[K[8;1Hfoobar[8;7H[K[9;1H:set key=[9;10H[K[10;1H/bar[10;5H[K[11;1H:.w >>test.out[11;15H[K[12;1Hu:.w >>test.out[12;16H[K[13;1Hu:.w >>test.out[13;16H[K[14;1Hu:.w >>test.out[14;16H[K[15;1H:"[15;3H[K[16;1H:" Rename the undo file so that it gets cleaned up.[16;52H[K[17;1H:call rename(".Xtestfile.un~", "Xtestundo")[17;44H[K[18;1H:qa![18;5H[K[19;1HENDTEST[19;8H[K[20;1H[K[21;1H1111 -----[21;11H[K[22;1H2222 -----[22;11H[K[23;1H[K[24;1H123456789[24;10H[K[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he Xtestfile[?25l"Xtestfile" 1L, 17C[1;1Hthis is ONE Line[1;17H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h" TODO: this beeps[?25l[1;1H[?12l[?25h[?5h[?5l[?25l[25;1HAlready at oldest change[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1L, 17C appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Test 'undofile', add 10 lines, delete 6 lines, undo 3[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset undofile[?25l[1;1H[?12l[?25h[?25l[1;1H[K[25;1H--No lines in buffer--[1;1H[?12l[?25h[?25l[25;1H[1m-- INSERT --[m[25;13H[K[25;1H[K[1;1Hone
two[2;4H[K[3;1Hthree[3;6H[K[4;1Hfour[4;5H[K[5;1Hfive[5;5H[K[6;1Hsix[6;4H[K[7;1Hseven[7;6H[K[8;1Height[8;6H[K[9;1Hnine[9;5H[K[10;1Hten[10;4H[K[10;3H[?12l[?25h[?25l[25;1H:[?12l[?25hset ul=100[?25l[10;3H[?12l[?25h[3;1H[?25l[3;24r[24;1H
[1;25r[24;1H[1m[34m~                                                                               [m[25;1H[K[3;1H[?12l[?25h[?25l[25;1H:[?12l[?25hset ul=100[?25l[3;1H[?12l[?25h[?25l[3;24r[24;1H
[1;25r[24;1H[1m[34m~                                                                               [m[25;1H[K[3;1H[?12l[?25h[?25l[25;1H:[?12l[?25hset ul=100[?25l[3;1H[?12l[?25h[?25l[3;24r[24;1H
[1;25r[24;1H[1m[34m~                                                                               [m[25;1H[K[3;1H[?12l[?25h[?25l[25;1H:[?12l[?25hset ul=100[?25l[3;1H[?12l[?25h[?25l[3;24r[24;1H
[1;25r[24;1H[1m[34m~                                                                               [m[25;1H[K[3;1H[?12l[?25h[?25l[25;1H:[?12l[?25hset ul=100[?25l[3;1H[?12l[?25h[?25l[3;24r[24;1H
[1;25r[24;1H[1m[34m~                                                                               [m[25;1H[K[3;1H[?12l[?25h[?25l[25;1H:[?12l[?25hset ul=100[?25l[3;1H[?12l[?25h[?25l[3;24r[24;1H
[1;25r[24;1H[1m[34m~                                                                               [m[25;1H[K[3;1H[?12l[?25h[?25l[25;1H:[?12l[?25hset ul=100[?25l[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hw[?25l"Xtestfile" 4L, 17C written[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe![?25l"test72.in" 109L, 1564C[1;1Hibar [34m^[[m:set ul=100
:X[2;3H[K[3;1Hfoobar
foobar
:w![5;4H[K[6;1H:bwipe![6;8H[K[7;1H:e Xtestfile[7;13H[K[8;1Hfoobar[8;7H[K[9;1H:set key=[9;10H[K[10;1H/bar[10;5H[K[11;1H:.w >>test.out[11;15H[K[12;1Hu:.w >>test.out[12;16H[K[13;1Hu:.w >>test.out[13;16H[K[14;1Hu:.w >>test.out[14;16H[K[15;1H:"[15;3H[K[16;1H:" Rename the undo file so that it gets cleaned up.[16;52H[K[17;1H:call rename(".Xtestfile.un~", "Xtestundo")[17;44H[K[18;1H:qa![18;5H[K[19;1HENDTEST[19;8H[K[20;1H[K[21;1H1111 -----[21;11H[K[22;1H2222 -----[22;11H[K[23;1H[K[24;1H123456789[24;10H[K[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he Xtestfile[?25l"Xtestfile" 4L, 17C[1;1Hone[1;4H[K[2;1Htwo
nine[3;5H[K[4;1Hten[4;4H[K[5;1H[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?12l[?25h[?25l[m[25;1H1 more line; before #7  0 seconds ago[3;24r[3;1H[L[1;25r[3;1Height[25;1H[K[3;1H[?12l[?25h[?25l[25;1H1 more line; before #6  0 seconds ago[3;24r[3;1H[L[1;25r[3;1Hseven[25;1H[K[3;1H[?12l[?25h[?25l[25;1H1 more line; before #5  0 seconds ago[3;24r[3;1H[L[1;25r[3;1Hsix[25;1H[K[3;1H[?12l[?25h[?25l[25;1H:[?12l[?25hw >>test.out[?25l"test.out" [25;12H[K[25;12H7L, 33C appended[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" And now with encryption, cryptmethod=zip[?25l[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! Xtestfile[?25l"Xtestfile" [25;13H[K[25;13H4L, 17C[3;1Hnine
ten[4;4H[K[5;1H[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [3;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hset undofile cm=zip[?25l[3;1H[?12l[?25h[1;1H[?25l[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [m[25;1H--No lines in buffer--[1;1H[?12l[?25h[?25l[25;1H[1m-- INSERT --[m[25;13H[K[25;1H[K[1;1Hmonday
tuesday[2;8H[K[3;1Hwednesday[3;10H[K[4;1Hthursday[4;9H[K[5;1Hfriday[5;7H[K[5;6H[?12l[?25h[?25l[25;1H:[?12l[?25hset ul=100[?25l[5;6H[?12l[?25h[4;6H[3;6H[2;6H[?25l[2;24r[24;1H
[1;25r[24;1H[1m[34m~                                                                               [m[25;1H[K[2;1H[?12l[?25h[?25l[25;1H:[?12l[?25hset ul=100[?25l[2;1H[?12l[?25h[?25l[2;24r[24;1H
[1;25r[24;1H[1m[34m~                                                                               [m[25;1H[K[2;1H[?12l[?25h[?25l[25;1H:[?12l[?25hset ul=100[?25l[2;1H[?12l[?25h[?25l[2;24r[24;1H
[1;25r[24;1H[1m[34m~                                                                               [m[25;1H[K[2;1H[?12l[?25h[?25l[25;1H:[?12l[?25hset ul=100[?25l[2;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hX[?25l[25;1H[K[25;1HEnter encryption key: [?12l[?25h******
[?25lEnter same key again: [?12l[?25h******
[1;1H[2L[?25l[1;1Hmonday
friday[25;1H[K[2;1H[?12l[?25h[?25l[25;1H:[?12l[?25hw![?25l"Xtestfile" [crypted] 2L, 14C written[2;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe![?25l"test72.in" 109L, 1564C[1;1Hibar [34m^[[m:set ul=100
:X[2;3H[K[3;1Hfoobar[3;7H[K[4;1Hfoobar[4;7H[K[5;1H:w![5;4H[K[6;1H:bwipe![6;8H[K[7;1H:e Xtestfile[7;13H[K[8;1Hfoobar[8;7H[K[9;1H:set key=[9;10H[K[10;1H/bar[10;5H[K[11;1H:.w >>test.out[11;15H[K[12;1Hu:.w >>test.out[12;16H[K[13;1Hu:.w >>test.out[13;16H[K[14;1Hu:.w >>test.out[14;16H[K[15;1H:"[15;3H[K[16;1H:" Rename the undo file so that it gets cleaned up.[16;52H[K[17;1H:call rename(".Xtestfile.un~", "Xtestundo")[17;44H[K[18;1H:qa![18;5H[K[19;1HENDTEST[19;8H[K[20;1H[K[21;1H1111 -----[21;11H[K[22;1H2222 -----[22;11H[K[23;1H[K[24;1H123456789[24;10H[K[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he Xtestfile[?25l"Xtestfile" Need encryption key for "Xtestfile"
Enter encryption key: [?12l[?25h******
[?25l"Xtestfile" [crypted] 2L, 14C[1;1H[2L[1;1Hmonday
friday
[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [m[25;1H[K[25;1H"Xtestfile" [crypted] 2L, 14C[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset key=[?25l[1;1H[?12l[?25h[?25l[25;1H1 more line; before #11  0 seconds ago[2;24r[2;1H[L[1;25r[2;1Hthursday[25;1H[K[2;1H[?12l[?25h[?25l[25;1H1 more line; before #10  0 seconds ago[2;24r[2;1H[L[1;25r[2;1Hwednesday[25;1H[K[2;1H[?12l[?25h[?25l[25;1H:[?12l[?25hw >>test.out[?25l"test.out" [25;12H[K[25;12H4L, 33C appended[2;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[2;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[2;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" With encryption, cryptmethod=blowfish[?25l[2;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he! Xtestfile[?25l"Xtestfile" [25;13H[K[25;1HNeed encryption key for "Xtestfile"
Enter encryption key: [?12l[?25h*************************
[?25l"Xtestfile" [noeol][crypted] 1L, 14C[1;1H[2L[1;1H;[34m~H[m6[34m^][mQ[34m^C[m4[34m~][m[34m~E[m
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [m[25;1H[K[25;1H"Xtestfile" [noeol][crypted] 1L, 14C[1;1H[?12l[?25h[?25l[1;1H[K[25;1H--No lines in buffer--[25;23H[K[1;1H[?12l[?25h[?25l[25;1H[1m-- INSERT --[m[25;13H[K[25;1H[K[1;1Hjan
feb[2;4H[K[3;1Hmar[3;4H[K[4;1Hapr[4;4H[K[5;1Hjun[5;4H[K[5;3H[?12l[?25h[?25l[25;1H:[?12l[?25hset ul=100[?25l[5;3H[?12l[?25h[4;3H[3;3H[?25l[25;1H[1m-- INSERT --[m[25;1H[K[3;1Hfoo mar[?12l[?25h[?25l[25;1H:[?12l[?25hset ul=100[?25l[3;4H[?12l[?25h[?25l[3;24r[24;1H
[1;25r[24;1H[1m[34m~                                                                               [m[25;1H[K[3;1H[?12l[?25h[?25l[25;1H:[?12l[?25hset ul=100[?25l[3;1H[?12l[?25h[?25l[25;1H[1m-- INSERT --[m[25;1H[K[3;1Hbar apr[?12l[?25h[?25l[25;1H:[?12l[?25hset ul=100[?25l[3;4H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hX[?25l[25;1H[K[25;1HEnter encryption key: [?12l[?25h******
[?25lEnter same key again: [?12l[?25h******
[1;1H[2L[?25l[1;1Hjan
feb[25;1H[K[3;4H[?12l[?25h[?25l[25;1H:[?12l[?25hw![?25l"Xtestfile" [crypted] 4L, 20C written[3;4H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hbwipe![?25l"test72.in" 109L, 1564C[1;1Hibar [34m^[[m:set ul=100
:X[2;3H[K[3;1Hfoobar[3;7H[K[4;1Hfoobar
:w![5;4H[K[6;1H:bwipe![6;8H[K[7;1H:e Xtestfile[7;13H[K[8;1Hfoobar[8;7H[K[9;1H:set key=[9;10H[K[10;1H/bar[10;5H[K[11;1H:.w >>test.out[11;15H[K[12;1Hu:.w >>test.out[12;16H[K[13;1Hu:.w >>test.out[13;16H[K[14;1Hu:.w >>test.out[14;16H[K[15;1H:"[15;3H[K[16;1H:" Rename the undo file so that it gets cleaned up.[16;52H[K[17;1H:call rename(".Xtestfile.un~", "Xtestundo")[17;44H[K[18;1H:qa![18;5H[K[19;1HENDTEST[19;8H[K[20;1H[K[21;1H1111 -----[21;11H[K[22;1H2222 -----[22;11H[K[23;1H[K[24;1H123456789[24;10H[K[20;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he Xtestfile[?25l"Xtestfile" Need encryption key for "Xtestfile"
Enter encryption key: [?12l[?25h******
[?25l"Xtestfile" [crypted] 4L, 20C[1;1H[2L[1;1Hjan
feb
bar apr
jun[4;4H[K[5;1H[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [m[25;1H[K[25;1H"Xtestfile" [crypted] 4L, 20C[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset key=[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H/[?12l[?25hbar[?25l[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1L, 8C appended[3;1H[?12l[?25h[?25l[25;1H1 change; before #15  0 seconds ago[3;1Hap[3;5H[K[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1L, 4C appended[3;1H[?12l[?25h[?25l[25;1H1 more line; before #14  0 seconds ago[3;24r[3;1H[L[1;25r[3;1Hfoo mar[25;1H[K[3;1H[?12l[?25h[?25l[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1L, 8C appended[3;1H[?12l[?25h[?25l[25;1H1 change; before #13  0 seconds ago[3;1Hmar[3;5H[K[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h.w >>test.out[?25l"test.out" [25;12H[K[25;12H1L, 4C appended[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Rename the undo file so that it gets cleaned up.[?25l[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall rename(".Xtestfile.un~", "Xtestundo")[?25l[3;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test73.failed test.ok test.out X* viminfo
cp test73.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test73.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;25r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[25;1H"test73.in" 166 lines, 3622 characters[1;1HTests for find completion.

STARTTEST
:so small.vim
:" Do all test in a separate window to avoid E211 when we recursively
:" delete the Xfind directory during cleanup
:"
:" This will cause a few errors, do it silently.
:set visualbell
:set nocp viminfo+=nviminfo
:"
:function! DeleteDirectory(dir)
: if has("win16") || has("win32") || has("win64") || has("dos16") || has("dos32""[14;1H)
:  exec "silent !rmdir /Q /S " . a:dir
: else
:  exec "silent !rm -rf " . a:dir
: endif
:endfun
:" On windows a stale "Xfind" directory may exist, remove it so that
:" we start from a clean state.
:call DeleteDirectory("Xfind")
:new
:let cwd=getcwd()[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[24;80Hf[25;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for find completion.[25;1H[K[1;1H[?12l[?25h[?25l[25;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 161 lines, 3575 characters written[4;1H[?12l[?25h[?25l[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[25;1H/ENDTEST[25;10H[K[25;1H[27m[m[H[2J[1;1H:cd x
:cd bar
:find voyager
:exec "w >> " . test_out
:find voyager
:exec "w >> " . test_out
:" Check for correct handling of shorten_fname()'s behavior on windows
:exec "cd " . cwd . "/Xfind/in"
:find file
:exec "w >>" . test_out
:" Test for relative to current buffer 'path' item
:exec "cd " . cwd . "/Xfind/"
:set path=./path
:" Open the file where Jimmy Hoffa is found
:e in/file.txt
:" Find the file containing 'E.T.' in the Xfind/in/path directory
:find file
:exec "w >>" . test_out
:q
:exec "cd " . cwd
:call DeleteDirectory("Xfind")
:qa!
ENDTEST[?12l[?25h
[?25l
:so! Xdotest[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hso small.vim[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Do all test in a separate window to avoid E211 when we recursively[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" delete the Xfind directory during cleanup[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" This will cause a few errors, do it silently.[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset visualbell[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset nocp viminfo+=nviminfo[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfunction! DeleteDirectory(dir)[?25l
:  [?12l[?25h: if has("win16") || has("win32") || has("win64") || has("dos16") || has("do
[24;80Hs[25;1H32")
[?25l:    [?12l[?25h:  exec "silent !rmdir /Q /S " . a:dir
[?25l:    [?12l[?25h: else
[?25l:    [?12l[?25h:  exec "silent !rm -rf " . a:dir
[?25l:    [?12l[?25h: endif
[?25l:  [?12l[?25h:endfun[1;1H[7L[?25l[1;1H:cd x
:cd bar
:find voyager
:exec "w >> " . test_out
:find voyager
:exec "w >> " . test_out
:" Check for correct handling of shorten_fname()'s behavior on windows[25;1H[K[24;1H[?12l[?25h[?25l
:[?12l[?25h" On windows a stale "Xfind" directory may exist, remove it so that[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" we start from a clean state.[?25l[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall DeleteDirectory("Xfind")[?25l[?1l>[?12l[?25h[?1049l[?1049h[?1h=[24;1H[?25l[25;1H[K[25;1H:[?12l[?25hnew[?25l[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [m[12;1H[1m[7m[No Name]                                                                       [m[13;2H" Open the file where Jimmy Hoffa is found
:e in/file.txt[14;15H[K[15;2H" Find the file containing 'E.T.' in the Xfind/in/path directory
:find file      [16;18H[K[17;2Hexec "w >>" . test_out
:q[18;3H[K[19;2Hexec "cd " . cwd
:call DeleteDirectory("Xfind")
:qa![21;5H[K[22;1HENDTEST[23;1H[K[24;1H[7mtest73.in                                                                       [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hlet cwd=getcwd()[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hlet test_out = cwd . '/test.out'[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall mkdir('Xfind')[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcd Xfind[?25l/sources/vim73/src/testdir/Xfind[24;1H[7m/sources/vim73/src/testdir/test73.in[1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hset path=[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfind ...[?25l[25;7H[K[25;7H[?5h[?5l[?12l[?25h[?25l[1m[37m[41mE345: Can't find file "" in path[1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hexec "w! " . test_out[?25l"/sources/vim73/src/testdir/test.out" [New] 0L, 0C written[12;1H[1m[7m/sources/vim73/src/testdir/test.out[1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hclose[?25l[1;1H:cd x
:cd bar[2;8H[K[3;1H:find voyager   [3;17H[K[4;1H:exec "w >> " . test_out[4;25H[K[5;1H:find voyager           [5;25H[K[6;1H:exec "w >> " . test_out[6;25H[K[7;1H:" Check for correct handling of shorten_fname()'s behavior on windows[7;71H[K[8;1H:exec "cd " . cwd . "/Xfind/in"[8;32H[K[9;1H:find file      [9;17H[K[10;1H:exec "w >>" . test_out[10;24H[K[11;1H:" Test for relative to current buffer 'path' item[11;51H[K[12;1H:exec "cd " . cwd . "/Xfind/"[12;30H[K[13;2Hset path=./path[13;18H[K[14;2H" Open the file where Jimmy Hoffa is found
:e in/file.txt[15;15H[K[16;2H" Find the file containing 'E.T.' in the Xfind/in/path directory
:find file      [17;17H[K[18;2Hexec "w >>" . test_out
:q[19;3H[K[20;2Hexec "cd " . cwd[20;18H[K[21;2Hcall DeleteDirectory("Xfind")
:qa![22;5H[K[23;1HENDTEST[24;1H[K[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hnew[?25l[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [m[12;1H[1m[7m[No Name]                                                                       [m[13;2H" Open the file where Jimmy Hoffa is found
:e in/file.txt[14;15H[K[15;2H" Find the file containing 'E.T.' in the Xfind/in/path directory
:find file      [16;18H[K[17;2Hexec "w >>" . test_out
:q[18;3H[K[19;2Hexec "cd " . cwd
:call DeleteDirectory("Xfind")
:qa![21;5H[K[22;1HENDTEST[23;1H[K[24;1H[7m/sources/vim73/src/testdir/test73.in                                            [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hset path=.[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfind ...[?25l[25;7H[K[25;7H[?5h[?5l[?12l[?25h[?25l[1m[37m[41mE32: No file name[1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hexec "w >>" . test_out[?25l"/sources/vim73/src/testdir/test.out" 0L, 0C appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hclose[?25l[1;1H:cd x
:cd bar[2;8H[K[3;1H:find voyager   [3;17H[K[4;1H:exec "w >> " . test_out[4;25H[K[5;1H:find voyager           [5;25H[K[6;1H:exec "w >> " . test_out[6;25H[K[7;1H:" Check for correct handling of shorten_fname()'s behavior on windows[7;71H[K[8;1H:exec "cd " . cwd . "/Xfind/in"[8;32H[K[9;1H:find file      [9;17H[K[10;1H:exec "w >>" . test_out[10;24H[K[11;1H:" Test for relative to current buffer 'path' item[11;51H[K[12;1H:exec "cd " . cwd . "/Xfind/"[12;30H[K[13;2Hset path=./path[13;18H[K[14;2H" Open the file where Jimmy Hoffa is found
:e in/file.txt[15;15H[K[16;2H" Find the file containing 'E.T.' in the Xfind/in/path directory
:find file      [17;17H[K[18;2Hexec "w >>" . test_out
:q[19;3H[K[20;2Hexec "cd " . cwd[20;18H[K[21;2Hcall DeleteDirectory("Xfind")
:qa![22;5H[K[23;1HENDTEST[24;1H[K[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hnew[?25l[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [m[12;1H[1m[7m[No Name]                                                                       [m[13;2H" Open the file where Jimmy Hoffa is found
:e in/file.txt[14;15H[K[15;2H" Find the file containing 'E.T.' in the Xfind/in/path directory
:find file      [16;18H[K[17;2Hexec "w >>" . test_out
:q[18;3H[K[19;2Hexec "cd " . cwd
:call DeleteDirectory("Xfind")
:qa![21;5H[K[22;1HENDTEST[23;1H[K[24;1H[7m/sources/vim73/src/testdir/test73.in                                            [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hset path=.,,[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfind ...[?25l[25;7H[K[25;7H[?5h[?5l[?12l[?25h[?25l[1m[37m[41mE32: No file name[1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hexec "w >>" . test_out[?25l"/sources/vim73/src/testdir/test.out" 0L, 0C appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hclose[?25l[1;1H:cd x
:cd bar[2;8H[K[3;1H:find voyager   [3;17H[K[4;1H:exec "w >> " . test_out[4;25H[K[5;1H:find voyager           [5;25H[K[6;1H:exec "w >> " . test_out[6;25H[K[7;1H:" Check for correct handling of shorten_fname()'s behavior on windows[7;71H[K[8;1H:exec "cd " . cwd . "/Xfind/in"[8;32H[K[9;1H:find file      [9;17H[K[10;1H:exec "w >>" . test_out[10;24H[K[11;1H:" Test for relative to current buffer 'path' item[11;51H[K[12;1H:exec "cd " . cwd . "/Xfind/"[12;30H[K[13;2Hset path=./path[13;18H[K[14;2H" Open the file where Jimmy Hoffa is found
:e in/file.txt[15;15H[K[16;2H" Find the file containing 'E.T.' in the Xfind/in/path directory
:find file      [17;17H[K[18;2Hexec "w >>" . test_out
:q[19;3H[K[20;2Hexec "cd " . cwd[20;18H[K[21;2Hcall DeleteDirectory("Xfind")
:qa![22;5H[K[23;1HENDTEST[24;1H[K[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hnew[?25l[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [m[12;1H[1m[7m[No Name]                                                                       [m[13;2H" Open the file where Jimmy Hoffa is found
:e in/file.txt[14;15H[K[15;2H" Find the file containing 'E.T.' in the Xfind/in/path directory
:find file      [16;18H[K[17;2Hexec "w >>" . test_out
:q[18;3H[K[19;2Hexec "cd " . cwd
:call DeleteDirectory("Xfind")
:qa![21;5H[K[22;1HENDTEST[23;1H[K[24;1H[7m/sources/vim73/src/testdir/test73.in                                            [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hset path=./**[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfind ...[?25l[25;7H[K[25;7H[?5h[?5l[?12l[?25h[?25l[1m[37m[41mE32: No file name[1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hexec "w >>" . test_out[?25l"/sources/vim73/src/testdir/test.out" 0L, 0C appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hclose[?25l[1;1H:cd x
:cd bar[2;8H[K[3;1H:find voyager   [3;17H[K[4;1H:exec "w >> " . test_out[4;25H[K[5;1H:find voyager           [5;25H[K[6;1H:exec "w >> " . test_out[6;25H[K[7;1H:" Check for correct handling of shorten_fname()'s behavior on windows[7;71H[K[8;1H:exec "cd " . cwd . "/Xfind/in"[8;32H[K[9;1H:find file      [9;17H[K[10;1H:exec "w >>" . test_out[10;24H[K[11;1H:" Test for relative to current buffer 'path' item[11;51H[K[12;1H:exec "cd " . cwd . "/Xfind/"[12;30H[K[13;2Hset path=./path[13;18H[K[14;2H" Open the file where Jimmy Hoffa is found
:e in/file.txt[15;15H[K[16;2H" Find the file containing 'E.T.' in the Xfind/in/path directory
:find file      [17;17H[K[18;2Hexec "w >>" . test_out
:q[19;3H[K[20;2Hexec "cd " . cwd[20;18H[K[21;2Hcall DeleteDirectory("Xfind")
:qa![22;5H[K[23;1HENDTEST[24;1H[K[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hnew[?25l[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [m[12;1H[1m[7m[No Name]                                                                       [m[13;2H" Open the file where Jimmy Hoffa is found
:e in/file.txt[14;15H[K[15;2H" Find the file containing 'E.T.' in the Xfind/in/path directory
:find file      [16;18H[K[17;2Hexec "w >>" . test_out
:q[18;3H[K[19;2Hexec "cd " . cwd
:call DeleteDirectory("Xfind")
:qa![21;5H[K[22;1HENDTEST[23;1H[K[24;1H[7m/sources/vim73/src/testdir/test73.in                                            [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h" We shouldn't find any file at this point, test.out must be empty.[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall mkdir('in')[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcd in[?25l/sources/vim73/src/testdir/Xfind/in[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall mkdir('path')[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hexec "cd " . cwd[?25l/sources/vim73/src/testdir[24;1H[7mtest73.in                           [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25he Xfind/file.txt[?25l"Xfind/file.txt" [New File][12;1H[1m[7mXfind/file.txt[1;1H[?12l[?25h[?25l[m[25;1H[1m-- INSERT --[m[25;13H[K[25;1H[K[1;1HHoly Grail[12;16H[1m[7m[+][1;10H[?12l[?25h[?25l[25;1H[m:[?12l[?25hw[?25l"Xfind/file.txt" [New] 1L, 11C written[12;16H[1m[7m    [1;10H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25he Xfind/in/file.txt[?25l"Xfind/in/file.txt" [New File][1;1H[K[12;7H[1m[7min/file.txt[1;1H[?12l[?25h[?25l[m[25;1H[1m-- INSERT --[m[25;13H[K[25;1H[K[1;1HJimmy Hoffa[12;19H[1m[7m[+][1;11H[?12l[?25h[?25l[25;1H[m:[?12l[?25hw[?25l"Xfind/in/file.txt" [New] 1L, 12C written[12;19H[1m[7m    [1;11H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25he Xfind/in/stuff.txt[?25l"Xfind/in/stuff.txt" [New File][1;1H[K[12;10H[1m[7mstuff.txt[1;1H[?12l[?25h[?25l[m[25;1H[1m-- INSERT --[m[25;13H[K[25;1H[K[1;1HAnother Holy Grail[12;20H[1m[7m[+][1;18H[?12l[?25h[?25l[25;1H[m:[?12l[?25hw[?25l"Xfind/in/stuff.txt" [New] 1L, 19C written[12;20H[1m[7m    [1;18H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25he Xfind/in/path/file.txt[?25l"Xfind/in/path/file.txt" [New File][1;1H[K[12;10H[1m[7mpath/file.txt[1;1H[?12l[?25h[?25l[m[25;1H[1m-- INSERT --[m[25;13H[K[25;1H[K[1;1HE.T.[12;24H[1m[7m[+][1;4H[?12l[?25h[?25l[25;1H[m:[?12l[?25hw[?25l"Xfind/in/path/file.txt" [New] 1L, 5C written[12;24H[1m[7m    [1;4H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hset path=Xfind/**[?25l[1;4H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfind file...[?25l[25;7H./Xfind/file.txt[?5h[?5l[?12l[?25h[?25l"Xfind/file.txt" [25;18H[K[25;18H1L, 11C[1;1HHoly Grail[12;7H[1m[7mfile.txtf         [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hexec "w >>" . test_out[?25l"/sources/vim73/src/testdir/test.out" 1L, 11C appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfind file...[?25l[25;7H./Xfind/file.txt[?5h[?5l[?12l[?25h...[?25l[25;7Hin/file.txt[25;18H[K[25;18H[?12l[?25h[?25l"Xfind/in/file.txt" 1L, 12C[1;1HJimmy Hoffa[12;7H[1m[7min/file.txt[1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hexec "w >>" . test_out[?25l"/sources/vim73/src/testdir/test.out" 1L, 12C appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfind file...[?25l[25;7H./Xfind/file.txt[?5h[?5l[?12l[?25h...[?25l[25;7Hin/file.txt[25;18H[K[25;18H[?12l[?25h...[?25l[25;7Hpath/file.txt[25;20H[K[25;20H[?12l[?25h[?25l"Xfind/in/path/file.txt" 1L, 5C[1;1HE.T.[1;5H[K[12;10H[1m[7mpath/file.txt[1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hexec "w >>" . test_out[?25l"/sources/vim73/src/testdir/test.out" 1L, 5C appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Rerun the previous three find completions, using fullpath in 'path'[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hexec "set path=" . cwd . "/Xfind/**"[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfind file...[?25l[25;7H./Xfind/file.txt[?5h[?5l[?12l[?25h[?25l"Xfind/file.txt" [25;18H[K[25;18H1L, 11C[1;1HHoly Grail[12;7H[1m[7mfile.txtf         [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hexec "w >>" .  test_out[?25l"/sources/vim73/src/testdir/test.out" 1L, 11C appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfind file...[?25l[25;7H./Xfind/file.txt[?5h[?5l[?12l[?25h...[?25l[25;7Hin/file.txt[25;18H[K[25;18H[?12l[?25h[?25l"Xfind/in/file.txt" 1L, 12C[1;1HJimmy Hoffa[12;7H[1m[7min/file.txt[1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hexec "w >>" . test_out[?25l"/sources/vim73/src/testdir/test.out" 1L, 12C appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfind file...[?25l[25;7H./Xfind/file.txt[?5h[?5l[?12l[?25h...[?25l[25;7Hin/file.txt[25;18H[K[25;18H[?12l[?25h...[?25l[25;7Hpath/file.txt[25;20H[K[25;20H[?12l[?25h[?25l"Xfind/in/path/file.txt" 1L, 5C[1;1HE.T.[1;5H[K[12;10H[1m[7mpath/file.txt[1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hexec "w >>" . test_out[?25l"/sources/vim73/src/testdir/test.out" 1L, 5C appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Same steps again, using relative and fullpath items that point to the same[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" recursive location.[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" This is to test that there are no duplicates in the completion list.[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hexec "set path+=Xfind/**"[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfind file...[?25l[25;7H./Xfind/file.txt[?5h[?5l[?12l[?25h[?25l"Xfind/file.txt" [25;18H[K[25;18H1L, 11C[1;1HHoly Grail[12;7H[1m[7mfile.txtf         [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hexec "w >>" .  test_out[?25l"/sources/vim73/src/testdir/test.out" 1L, 11C appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfind file...[?25l[25;7H./Xfind/file.txt[?5h[?5l[?12l[?25h...[?25l[25;7Hin/file.txt[25;18H[K[25;18H[?12l[?25h[?25l"Xfind/in/file.txt" 1L, 12C[1;1HJimmy Hoffa[12;7H[1m[7min/file.txt[1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hexec "w >>" . test_out[?25l"/sources/vim73/src/testdir/test.out" 1L, 12C appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfind file...[?25l[25;7H./Xfind/file.txt[?5h[?5l[?12l[?25h...[?25l[25;7Hin/file.txt[25;18H[K[25;18H[?12l[?25h...[?25l[25;7Hpath/file.txt[25;20H[K[25;20H[?12l[?25h[?25l"Xfind/in/path/file.txt" 1L, 5C[1;1HE.T.[1;5H[K[12;10H[1m[7mpath/file.txt[1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hexec "w >>" . test_out[?25l"/sources/vim73/src/testdir/test.out" 1L, 5C appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfind file...[?25l[25;7H./Xfind/file.txt[?5h[?5l[?12l[?25h...[?25l[25;7Hin/file.txt[25;18H[K[25;18H[?12l[?25h[?25l"Xfind/in/file.txt" 1L, 12C[1;1HJimmy Hoffa[12;10H[1m[7mfile.txte      [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h" Test find completion for directory of current buffer, which at this point[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" is Xfind/in/file.txt.[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hset path=.[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfind st...[?25luff.txt[?12l[?25h[?25l"Xfind/in/stuff.txt" 1L, 19C[1;1HAnother Holy Grail[12;10H[1m[7mstuff.txt[1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hexec "w >>" .  test_out[?25l"/sources/vim73/src/testdir/test.out" 1L, 19C appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Test find completion for empty path item ",," which is the current directory[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcd Xfind[?25l/sources/vim73/src/testdir/Xfind[12;1H[1m[7min/stuff.txtf       [m[24;1H[7m/sources/vim73/src/testdir/test73.in[1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hset path=,,[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfind f...[?25lile.txt[?12l[?25h...[?25l[25;15H[K[25;15H[?12l[?25h[?25l"file.txt" [25;12H[K[25;12H1L, 11C[1;1HHoly Grail[1;11H[K[12;1H[1m[7mfile.txt.     [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hexec "w >>" . test_out[?25l"/sources/vim73/src/testdir/test.out" 1L, 11C appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Test shortening of[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"    foo/x/bar/voyager.txt[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"    foo/y/bar/voyager.txt[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" When current directory is above foo/ they should be shortened to (in order[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" of appearance):[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"    x/bar/voyager.txt[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"    y/bar/voyager.txt[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall mkdir('foo')[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcd foo[?25l/sources/vim73/src/testdir/Xfind/foo[12;1H[1m[7m/sources/vim73/src/testdir/Xfind/file.txt[1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hcall mkdir('x')[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall mkdir('y')[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcd x[?25l/sources/vim73/src/testdir/Xfind/foo/x[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall mkdir('bar')[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcd ..[?25l/sources/vim73/src/testdir/Xfind/foo[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcd y[?25l/sources/vim73/src/testdir/Xfind/foo/y[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall mkdir('bar')[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcd ..[?25l/sources/vim73/src/testdir/Xfind/foo[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcd ..[?25l/sources/vim73/src/testdir/Xfind[12;1H[1m[7mfile.txt/                                  [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25h" We should now be in the Xfind directory[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he foo/x/bar/voyager.txt[?25l"foo/x/bar/voyager.txt" [New File][1;1H[K[12;2H[1m[7moo/x/bar/voyager.txt[1;1H[?12l[?25h[?25l[m[25;1H[1m-- INSERT --[m[25;13H[K[25;1H[K[1;1HVoyager 1[12;23H[1m[7m[+][1;9H[?12l[?25h[?25l[25;1H[m:[?12l[?25hw[?25l"foo/x/bar/voyager.txt" [New] 1L, 10C written[12;23H[1m[7m    [1;9H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25he foo/y/bar/voyager.txt[?25l"foo/y/bar/voyager.txt" [New File][1;1H[K[12;5H[1m[7my/[1;1H[?12l[?25h[?25l[m[25;1H[1m-- INSERT --[m[25;13H[K[25;1H[K[1;1HVoyager 2[12;23H[1m[7m[+][1;9H[?12l[?25h[?25l[25;1H[m:[?12l[?25hw[?25l"foo/y/bar/voyager.txt" [New] 1L, 10C written[12;23H[1m[7m    [1;9H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hexec "set path=" . cwd . "/Xfind/**"[?25l[1;9H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfind voyager...[?25l[25;7Hx/bar/voyager.txt[?5h[?5l[?12l[?25h[?25l"foo/x/bar/voyager.txt" 1L, 10C[1;9H1[12;5H[1m[7mx/[1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hexec "w >>" . test_out[?25l"/sources/vim73/src/testdir/test.out" 1L, 10C appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfind voyager...[?25l[25;7Hx/bar/voyager.txt[?5h[?5l[?12l[?25h...[?25l[25;7Hy[25;24H[K[25;24H[?12l[?25h[?25l"foo/y/bar/voyager.txt" 1L, 10C[1;9H2[12;5H[1m[7my/[1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hexec "w >>" . test_out[?25l"/sources/vim73/src/testdir/test.out" 1L, 10C appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" When current directory is .../foo/y/bar they should be shortened to (in[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" order of appearance):[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"    ./voyager.txt[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h"    x/bar/voyager.txt[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcd foo[?25l/sources/vim73/src/testdir/Xfind/foo[12;1H[1m[7my/bar/voyager.txt.     [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hcd y[?25l/sources/vim73/src/testdir/Xfind/foo/y[12;1H[1m[7mbar/voyager.txt   [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hcd bar[?25l/sources/vim73/src/testdir/Xfind/foo/y/bar[12;1H[1m[7mvoyager.txt.     [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hfind voyager...[?25l[25;7H./voyager.txt[?5h[?5l[?12l[?25h[?25l"voyager.txt" [25;15H[K[25;15H1L, 10C[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hexec "w >> " . test_out[?25l"/sources/vim73/src/testdir/test.out" 1L, 10C appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfind voyager...[?25l[25;7H./voyager.txt[?5h[?5l[?12l[?25h...[?25l[25;7Hx/bar/voyager.txt[?12l[?25h[?25l"/sources/vim73/src/testdir/Xfind/foo/x/bar/voyager.txt" 1L, 10C[1;9H1[12;1H[1m[7m/sources/vim73/src/testdir/Xfind/foo/x/bar/voyager.txt[1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hexec "w >> " . test_out[?25l"/sources/vim73/src/testdir/test.out" 1L, 10C appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Check the opposite too:[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcd ..[?25l/sources/vim73/src/testdir/Xfind/foo/y[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcd ..[?25l/sources/vim73/src/testdir/Xfind/foo[12;1H[1m[7mx/bar/voyager.txtc                                      [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hcd x[?25l/sources/vim73/src/testdir/Xfind/foo/x[12;1H[1m[7mbar/voyager.txt   [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hcd bar[?25l/sources/vim73/src/testdir/Xfind/foo/x/bar[12;1H[1m[7mvoyager.txt.     [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hfind voyager...[?25l[25;7H./voyager.txt[?5h[?5l[?12l[?25h[?25l"voyager.txt" [25;15H[K[25;15H1L, 10C[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hexec "w >> " . test_out[?25l"/sources/vim73/src/testdir/test.out" 1L, 10C appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfind voyager...[?25l[25;7H./voyager.txt[?5h[?5l[?12l[?25h...[?25l[25;7Hy/bar/voyager.txt[?12l[?25h[?25l"/sources/vim73/src/testdir/Xfind/foo/y/bar/voyager.txt" 1L, 10C[1;9H2[12;1H[1m[7m/sources/vim73/src/testdir/Xfind/foo/y/bar/voyager.txt[1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hexec "w >> " . test_out[?25l"/sources/vim73/src/testdir/test.out" 1L, 10C appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Check for correct handling of shorten_fname()'s behavior on windows[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hexec "cd " . cwd . "/Xfind/in"[?25l/sources/vim73/src/testdir/Xfind/in[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfind file...[?25l[25;7H./file.txt[?5h[?5l[?12l[?25h[?25l"file.txt" [25;12H[K[25;12H1L, 12C[1;1HJimmy Hoffa[12;1H[1m[7mfile.txt/                                               [1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hexec "w >>" . test_out[?25l"/sources/vim73/src/testdir/test.out" 1L, 12C appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Test for relative to current buffer 'path' item[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hexec "cd " . cwd . "/Xfind/"[?25l/sources/vim73/src/testdir/Xfind[12;1H[1m[7min/file.txt[1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hset path=./path[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Open the file where Jimmy Hoffa is found[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25he in/file.txt[?25l"in/file.txt" 1L, 12C[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25h" Find the file containing 'E.T.' in the Xfind/in/path directory[?25l[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hfind file...[?25ltxt[?12l[?25h[?25l"in/path/file.txt" 1L, 5C[1;1HE.T.[1;5H[K[12;4H[1m[7mpath/file.txt[1;1H[?12l[?25h[?25l[m[25;1H[K[25;1H:[?12l[?25hexec "w >>" . test_out[?25l"/sources/vim73/src/testdir/test.out" 1L, 5C appended[1;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hq[?25l[1;1H:cd x
:cd bar[2;8H[K[3;1H:find voyager   [3;17H[K[4;1H:exec "w >> " . test_out[4;25H[K[5;1H:find voyager           [5;25H[K[6;1H:exec "w >> " . test_out[6;25H[K[7;1H:" Check for correct handling of shorten_fname()'s behavior on windows[7;71H[K[8;1H:exec "cd " . cwd . "/Xfind/in"[8;32H[K[9;1H:find file      [9;17H[K[10;1H:exec "w >>" . test_out[10;24H[K[11;1H:" Test for relative to current buffer 'path' item[11;51H[K[12;1H:exec "cd " . cwd . "/Xfind/"[12;30H[K[13;2Hset path=./path[13;18H[K[14;2H" Open the file where Jimmy Hoffa is found
:e in/file.txt[15;15H[K[16;2H" Find the file containing 'E.T.' in the Xfind/in/path directory
:find file      [17;17H[K[18;2Hexec "w >>" . test_out
:q[19;3H[K[20;2Hexec "cd " . cwd[20;18H[K[21;2Hcall DeleteDirectory("Xfind")
:qa![22;5H[K[23;1HENDTEST[24;1H[K[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hexec "cd " . cwd[?25l/sources/vim73/src/testdir[24;1H[?12l[?25h[?25l[25;1H[K[25;1H:[?12l[?25hcall DeleteDirectory("Xfind")[?25l[?1l>[?12l[?25h[?1049l[?1049h[?1h=[24;1H[?25l[25;1H[K[25;1H:[?12l[?25hqa![?25l[25;1H[K[25;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo

Test results:
ALL DONE
make[3]: Leaving directory `/sources/vim73/src/testdir'
make[2]: Leaving directory `/sources/vim73/src'
make[1]: Leaving directory `/sources/vim73'
