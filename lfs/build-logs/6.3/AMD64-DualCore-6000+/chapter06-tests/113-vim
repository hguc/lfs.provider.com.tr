Wed Aug 29 21:40:46 GMT 2007
make[1]: Entering directory `/sources/vim71'
Starting make in the src directory.
If there are problems, cd to the src directory and run make there
cd src && make test
make[2]: Entering directory `/sources/vim71/src'
make -f Makefile vim
make[3]: Entering directory `/sources/vim71/src'
make[3]: `vim' is up to date.
make[3]: Leaving directory `/sources/vim71/src'
if test -n "yes" -a -f po/Makefile; then \
		cd po; make -f Makefile check VIM=../vim; \
	fi
make[3]: Entering directory `/sources/vim71/src/po'
../vim -u NONE -e -S check.vim -c "if error == 0 | q | endif" -c cq af.po
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[?25l[22;1H"af.po" "af.po" 5409 lines, 133799 characters
search hit BOTTOM, continuing at TOPOK[22;3H[K[22;1H
[?1l>[?12l[?25h[?1049ltouch af.ck
../vim -u NONE -e -S check.vim -c "if error == 0 | q | endif" -c cq ca.po
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[?25l[22;1H"ca.po" "ca.po" 4947 lines, 129501 characters
search hit BOTTOM, continuing at TOPOK[22;3H[K[22;1H
[?1l>[?12l[?25h[?1049ltouch ca.ck
../vim -u NONE -e -S check.vim -c "if error == 0 | q | endif" -c cq cs.po
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[?25l[22;1H"cs.po" "cs.po" 4664 lines, 111009 characters
search hit BOTTOM, continuing at TOPOK[22;3H[K[22;1H
[?1l>[?12l[?25h[?1049ltouch cs.ck
../vim -u NONE -e -S check.vim -c "if error == 0 | q | endif" -c cq de.po
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[?25l[22;1H"de.po" "de.po" 6135 lines, 157126 characters
search hit BOTTOM, continuing at TOPOK[22;3H[K[22;1H
[?1l>[?12l[?25h[?1049ltouch de.ck
../vim -u NONE -e -S check.vim -c "if error == 0 | q | endif" -c cq en_GB.po
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[?25l[22;1H"en_GB.po" "en_GB.po" 292 lines, 8821 characters
search hit BOTTOM, continuing at TOPOK[22;3H[K[22;1H
[?1l>[?12l[?25h[?1049ltouch en_GB.ck
../vim -u NONE -e -S check.vim -c "if error == 0 | q | endif" -c cq es.po
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[?25l[22;1H"es.po" "es.po" 5453 lines, 139991 characters
search hit BOTTOM, continuing at TOPOK[22;3H[K[22;1H
[?1l>[?12l[?25h[?1049ltouch es.ck
../vim -u NONE -e -S check.vim -c "if error == 0 | q | endif" -c cq fr.po
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[?25l[22;1H"fr.po" "fr.po" 6543 lines, 176361 characters
search hit BOTTOM, continuing at TOPOK[22;3H[K[22;1H
[?1l>[?12l[?25h[?1049ltouch fr.ck
../vim -u NONE -e -S check.vim -c "if error == 0 | q | endif" -c cq ga.po
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[?25l[22;1H"ga.po" "ga.po" 5626 lines, 140933 characters
search hit BOTTOM, continuing at TOPOK[22;3H[K[22;1H
[?1l>[?12l[?25h[?1049ltouch ga.ck
../vim -u NONE -e -S check.vim -c "if error == 0 | q | endif" -c cq it.po
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[?25l[22;1H"it.po" "it.po" 6167 lines, 155031 characters
search hit BOTTOM, continuing at TOPOK[22;3H[K[22;1H
[?1l>[?12l[?25h[?1049ltouch it.ck
../vim -u NONE -e -S check.vim -c "if error == 0 | q | endif" -c cq ja.po
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[?25l[22;1H"ja.po" "ja.po" 6097 lines, 151279 characters
search hit BOTTOM, continuing at TOPOK[22;3H[K[22;1H
[?1l>[?12l[?25h[?1049ltouch ja.ck
../vim -u NONE -e -S check.vim -c "if error == 0 | q | endif" -c cq ko.po
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[?25l[22;1H"ko.po" "ko.po" 5154 lines, 122328 characters
search hit BOTTOM, continuing at TOPOK[22;3H[K[22;1H
[?1l>[?12l[?25h[?1049ltouch ko.ck
../vim -u NONE -e -S check.vim -c "if error == 0 | q | endif" -c cq no.po
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[?25l[22;1H"no.po" "no.po" 6184 lines, 150977 characters
search hit BOTTOM, continuing at TOPOK[22;3H[K[22;1H
[?1l>[?12l[?25h[?1049ltouch no.ck
../vim -u NONE -e -S check.vim -c "if error == 0 | q | endif" -c cq pl.po
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[?25l[22;1H"pl.po" "pl.po" 6148 lines, 152937 characters
search hit BOTTOM, continuing at TOPOK[22;3H[K[22;1H
[?1l>[?12l[?25h[?1049ltouch pl.ck
../vim -u NONE -e -S check.vim -c "if error == 0 | q | endif" -c cq ru.po
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[?25l[22;1H"ru.po" "ru.po" 5237 lines, 166173 characters
search hit BOTTOM, continuing at TOPOK[22;3H[K[22;1H
[?1l>[?12l[?25h[?1049ltouch ru.ck
../vim -u NONE -e -S check.vim -c "if error == 0 | q | endif" -c cq sk.po
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[?25l[22;1H"sk.po" "sk.po" 5837 lines, 147784 characters
search hit BOTTOM, continuing at TOPOK[22;3H[K[22;1H
[?1l>[?12l[?25h[?1049ltouch sk.ck
../vim -u NONE -e -S check.vim -c "if error == 0 | q | endif" -c cq sv.po
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[?25l[22;1H"sv.po" "sv.po" 6166 lines, 149571 characters
Mismatching % in line 14
msgid: 
msgstr: %
search hit BOTTOM, continuing at TOP[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lmake[3]: *** [sv.ck] Error 1
../vim -u NONE -e -S check.vim -c "if error == 0 | q | endif" -c cq uk.po
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[?25l[22;1H"uk.po" "uk.po" 4926 lines, 116555 characters
search hit BOTTOM, continuing at TOPOK[22;3H[K[22;1H
[?1l>[?12l[?25h[?1049ltouch uk.ck
../vim -u NONE -e -S check.vim -c "if error == 0 | q | endif" -c cq vi.po
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[?25l[22;1H"vi.po" "vi.po" 5214 lines, 144437 characters
search hit BOTTOM, continuing at TOPOK[22;3H[K[22;1H
[?1l>[?12l[?25h[?1049ltouch vi.ck
../vim -u NONE -e -S check.vim -c "if error == 0 | q | endif" -c cq zh_CN.UTF-8.po
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[?25l[22;1H"zh_CN.UTF-8.po" "zh_CN.UTF-8.po" 6158 lines, 147881 characters
search hit BOTTOM, continuing at TOPOK[22;3H[K[22;1H
[?1l>[?12l[?25h[?1049ltouch zh_CN.UTF-8.ck
../vim -u NONE -e -S check.vim -c "if error == 0 | q | endif" -c cq zh_CN.po
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[?25l[22;1H"zh_CN.po" "zh_CN.po" 6158 lines, 136858 characters
search hit BOTTOM, continuing at TOPOK[22;3H[K[22;1H
[?1l>[?12l[?25h[?1049ltouch zh_CN.ck
../vim -u NONE -e -S check.vim -c "if error == 0 | q | endif" -c cq zh_TW.UTF-8.po
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[?25l[22;1H"zh_TW.UTF-8.po" "zh_TW.UTF-8.po" 5300 lines, 127697 characters
search hit BOTTOM, continuing at TOPOK[22;3H[K[22;1H
[?1l>[?12l[?25h[?1049ltouch zh_TW.UTF-8.ck
../vim -u NONE -e -S check.vim -c "if error == 0 | q | endif" -c cq zh_TW.po
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[?25l[22;1H"zh_TW.po" "zh_TW.po" 5293 lines, 117728 characters
search hit BOTTOM, continuing at TOPOK[22;3H[K[22;1H
[?1l>[?12l[?25h[?1049ltouch zh_TW.ck
../vim -u NONE -e -S check.vim -c "if error == 0 | q | endif" -c cq cs.cp1250.po
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[?25l[22;1H"cs.cp1250.po" "cs.cp1250.po" 4664 lines, 111017 characters
search hit BOTTOM, continuing at TOPOK[22;3H[K[22;1H
[?1l>[?12l[?25h[?1049ltouch cs.cp1250.ck
../vim -u NONE -e -S check.vim -c "if error == 0 | q | endif" -c cq ja.sjis.po
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[?25l[22;1H"ja.sjis.po" "ja.sjis.po" 6097 lines, 151373 characters
search hit BOTTOM, continuing at TOPOK[22;3H[K[22;1H
[?1l>[?12l[?25h[?1049ltouch ja.sjis.ck
../vim -u NONE -e -S check.vim -c "if error == 0 | q | endif" -c cq pl.cp1250.po
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[?25l[22;1H"pl.cp1250.po" "pl.cp1250.po" 6148 lines, 152933 characters
search hit BOTTOM, continuing at TOPOK[22;3H[K[22;1H
[?1l>[?12l[?25h[?1049ltouch pl.cp1250.ck
../vim -u NONE -e -S check.vim -c "if error == 0 | q | endif" -c cq pl.UTF-8.po
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[?25l[22;1H"pl.UTF-8.po" "pl.UTF-8.po" 6148 lines, 155258 characters
search hit BOTTOM, continuing at TOPOK[22;3H[K[22;1H
[?1l>[?12l[?25h[?1049ltouch pl.UTF-8.ck
../vim -u NONE -e -S check.vim -c "if error == 0 | q | endif" -c cq ru.cp1251.po
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[?25l[22;1H"ru.cp1251.po" "ru.cp1251.po" 5237 lines, 131462 characters
search hit BOTTOM, continuing at TOPOK[22;3H[K[22;1H
[?1l>[?12l[?25h[?1049ltouch ru.cp1251.ck
../vim -u NONE -e -S check.vim -c "if error == 0 | q | endif" -c cq sk.cp1250.po
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[?25l[22;1H"sk.cp1250.po" "sk.cp1250.po" 5837 lines, 147780 characters
search hit BOTTOM, continuing at TOPOK[22;3H[K[22;1H
[?1l>[?12l[?25h[?1049ltouch sk.cp1250.ck
../vim -u NONE -e -S check.vim -c "if error == 0 | q | endif" -c cq uk.cp1251.po
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[?25l[22;1H"uk.cp1251.po" "uk.cp1251.po" 4926 lines, 116555 characters
search hit BOTTOM, continuing at TOPOK[22;3H[K[22;1H
[?1l>[?12l[?25h[?1049ltouch uk.cp1251.ck
../vim -u NONE -e -S check.vim -c "if error == 0 | q | endif" -c cq zh_CN.cp936.po
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[?25l[22;1H"zh_CN.cp936.po" "zh_CN.cp936.po" 6158 lines, 136870 characters
search hit BOTTOM, continuing at TOPOK[22;3H[K[22;1H
[?1l>[?12l[?25h[?1049ltouch zh_CN.cp936.ck
make[3]: Target `check' not remade because of errors.
make[3]: Leaving directory `/sources/vim71/src/po'
make[2]: [test] Error 2 (ignored)
if test vim != vim -a ! -e vim; then \
		ln -s vim vim; \
	fi
cd testdir; make -f Makefile  VIMPROG=../vim 
make[3]: Entering directory `/sources/vim71/src/testdir'
echo Test results: >test.log
rm -f test1.failed tiny.vim small.vim mbyte.vim test.ok X* viminfo
../vim -u unix.vim -U NONE --noplugin -s dotest.in test1.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test1.in" 40 lines, 1465 characters[2;1HFirst a simple test to check if the test script works.

If Vim was not compiled with the +eval feature, the small.vim script will be
set to copy the test.ok file to test.out, so that it looks like the test
succeeded.  Otherwise an empty small.vim is written.  small.vim is sourced by
tests that require the +eval feature or other features that are missing in the
small version.

If Vim was not compiled with the +windows feature, the tiny.vim script will be
set like small.vim above.  tiny.vim is sourced by tests that require the
+windows feature or other features that are missing in the tiny version.

If Vim was not compiled with the +multi_byte feature, the mbyte.vim script will  [15;1Hbe set like small.vim above.  mbyte.vim is sourced by tests that require the
+multi_byte feature.

STARTTEST
:" Write a single line to test.out to check if testing works at all.
:%d
athis is a test[34m^[[m:w! test.out[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[18;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[19;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 21 lines, 661 characters written[19;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[19;1H[?12l[?25h[?25l


/ENDTEST[22;10H[K[22;1H[27m[m[H[2J[27m[m[H[2J[1;1H:%d
athis is a test[34m^[[m:w! test.out
:" Create small.vim and tiny.vim empty, create mbyte.vim to skip the test.
0D:w! small.vim
:w! tiny.vim
ae! test.ok
w! test.out
qa!
[34m^[[m:w! mbyte.vim
:" If +multi_byte feature supported, make mbyte.vim empty.
:if has("multi_byte") | sp another | w! mbyte.vim | q | endif
:" If +eval feature supported quit here, leaving tiny.vim and small.vim empty.
:" Otherwise write small.vim to skip the test.
:if 1 | q! | endif
:w! small.vim
:" If +windows feature not supported :sp will fail and tiny.vim will be
:" written to skip the test.
:sp another
:wq! tiny.vim
:qa!
ENDTEST[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" Write a single line to test.out to check if testing works at all.[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h%d[?25l[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [m[22;1H--No lines in buffer--[1;1H[?12l[?25h[?25lthis is a test[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw! test.out[?25l"test.out" [22;12H[K[22;12H[New File] 1 line, 15 characters written[1;14H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" Create small.vim and tiny.vim empty, create mbyte.vim to skip the test.[?25l[1;14H[?12l[?25h[?25l[1;1H[K[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw! small.vim[?25l"small.vim" [22;13H[K[22;13H[New File] 1 line, 1 character written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw! tiny.vim[?25l"tiny.vim" [22;12H[K[22;12H[New File] 1 line, 1 character written[1;1H[?12l[?25h[?25le! test.ok
w! test.out[2;12H[K[3;1Hqa![3;4H[K[4;1H[K[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw! mbyte.vim[?25l"mbyte.vim" [22;13H[K[22;13H[New File] 4 lines, 28 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" If +multi_byte feature supported, make mbyte.vim empty.[?25l[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hif has("multi_byte") | sp another | w! mbyte.vim | q | endif[?25l"another" [New File][22;21H[K[22;1H
"mbyte.vim" 0 lines, 0 characters written[1;1H[L[1;1He! test.ok[22;1H[K[4;1H[?12l[?25h[?25l[22;1H:[?12l[?25h" If +eval feature supported quit here, leaving tiny.vim and small.vim empty.[?25l[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" Otherwise write small.vim to skip the test.[?25l[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hif 1 | q! | endif[?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* viminfo
rm -rf test2.failed test.ok test.out X* viminfo
cp test2.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test2.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test2.in" 29 lines, 717 characters[2;1HThis is a test if a URL is recognized by "gf", with the cursor before and
after the "://".  Also test ":\\".

STARTTEST
:so small.vim
/^first
/tmp
:call append(0, expand("<cfile>"))
/^second
/URL
:call append(1, expand("<cfile>"))
:if has("ebcdic")
: set isf=@,240-249,/,.,-,_,+,,,$,:,~,\
:else
: set isf=@,48-57,/,.,-,_,+,,,$,:,~,\
:endif
/^third
/name
:call append(2, expand("<cfile>"))
/^fourth[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[5;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[6;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 19 lines, 336 characters written[6;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[6;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[1;21r[1;1H[4M[1;22r[18;1H/URL
:call append(3, expand("<cfile>"))
5GdG:wq! test.out
ENDTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hfirst test for URL://machine.name/tmp/vimtest2a and other text[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h^first[?25l[31msearch hit BOTTOM, continuing at TOP[21;1H[?12l[?25h[?25l[m[22;1H[K[22;1H/[?12l[?25htmp[?25l[21;35H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hcall append(0, expand("<cfile>"))[?25l[21;35H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h^second[?25l[1;21r[21;1H
[1;22r[21;1Hsecond test for URL://machine.name/tmp/vimtest2b. And other text[22;1H[K[21;1H[?12l[?25h[?25l
/[?12l[?25hURL[?25l[21;17H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hcall append(1, expand("<cfile>"))[?25l[21;17H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hif has("ebcdic")[?25l
:  [?12l[?25h: set isf=@,240-249,/,.,-,_,+,,,$,:,~,\
[?25l:  [?12l[?25h:else
[?25l:  [?12l[?25h: set isf=@,48-57,/,.,-,_,+,,,$,:,~,\
[?25l:  [?12l[?25h:endif[1;1H[4L[?25l[1;1H/^first
/tmp
:call append(0, expand("<cfile>"))
/^second[22;1H[K[21;17H[?12l[?25h[?25l
/[?12l[?25h^third[?25l[1;21r[21;1H
[1;22r[21;1Hthird test for URL:\\machine.name\vimtest2c and other text[22;1H[K[21;1H[?12l[?25h[?25l
/[?12l[?25hname[?25l[21;30H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hcall append(2, expand("<cfile>"))[?25l[21;30H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h^fourth[?25l[1;21r[21;1H
[1;22r[21;1Hfourth test for URL:\\machine.name\tmp\vimtest2d, and other text[22;1H[K[21;1H[?12l[?25h[?25l
/[?12l[?25hURL[?25l[21;17H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hcall append(3, expand("<cfile>"))[?25l[21;17H[?12l[?25h[?25l[1;21r[1;1H[8L[1;22r[2;1HThis is a test if a URL is recognized by "gf", with the cursor before and
after the "://".  Also test ":\\".

STARTTEST
:so small.vim
/^first
/tmp[22;1H[K[1;1H[?12l[?25h[?25l[22;1H29 fewer lines[27m[m[H[2J[1;1HURL:\\machine.name\tmp\vimtest2d
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [m[22;1H29 fewer lines[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hwq! test.out[?25l"test.out" [22;12H[K[22;12H[New File] 4 lines, 128 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test3.failed test.ok test.out X* viminfo
cp test3.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test3.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test3.in" 1320 lines, 13734 characters[1;1H/* vim: set cin ts=4 sw=4 : */

Test for 'cindent'

STARTTEST
:so small.vim
:set nocompatible viminfo+=nviminfo
:edit[16C" read modeline
/start of AUTO
=/end of AUTO
ENDTEST

/* start of AUTO matically checked vim: set ts=4 : */
{[15;9Hif (test)[16;17Hcmd1;[17;9Hcmd2;
}

{[21;9Hif (test)[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1H/* vim: set cin ts=4 sw=4 : */[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[5;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[6;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 5 lines, 116 characters written[6;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[6;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[11;1H[?12l[?25h
[?25l[22;1H[K[22;1H:so! Xdotest[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset nocompatible viminfo+=nviminfo[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hedit                " read modeline[?25l"test3.in"[22;22H[K[22;12H1320L, 13734C[1;1H[K[2;1HTest for 'cindent'[3;1H[K[4;1HSTARTTEST
:so small.vim
:set nocompatible viminfo+=nviminfo
:edit                " read modeline
/start of AUTO[8;22H[K[9;1H=/end of AUTO[9;14H[K[10;1HENDTEST[10;8H[K[11;1H[K[12;1H/* start of AUTO matically checked vim: set ts=4 : */
{[13;2H[K[14;1H [7Cif (test)[15;9H        cmd1;[16;9Hcmd2;[16;17H[K[17;1H}[17;9H[K[18;1H[K[19;1H{
 [7Cif (test)[21;9H        cmd1;[11;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25hstart of AUTO[?25l[12;4H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25hend of AUTO[?25l789 lines to indent...750065055045035025015050 lines to indent... 790 lines indented [22;20H[K[12;1H[?12l[?25h[?25l[22;1H[K[22;1H/^STARTTEST[27m[m[H[2J[2;1Hmain()
{[4;9Hchar    foo[] = "/*";[5;9H/* as[6;12Hdf */[7;9Hhello
}
/* end of AUTO */

STARTTEST
:set tw=0 wm=60 columns=80 noai fo=croq
/serious/e
a about life, the universe, and the rest[34m^[[m
ENDTEST

{

/* this is
 * a real serious important big
 * comment[11;1H[?12l[?25h
[?25l[22;1H:set ff=unix cpo-=A[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H3L, 93C written[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[12;1H[?12l[?25h[?25l[22;1H/ENDTEST/+-1[22;13H[K[22;1H[14;1H[?12l[?25h
[?25l[22;1H[K[22;1H:so! Xdotest[15;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset tw=0 wm=60 columns=80 noai fo=croq[?25l[27m[m[H[2J[2;1Hmain()
{[4;9Hchar    foo[] = "/*";[5;9H/* as[6;12Hdf */[7;9Hhello
}
/* end of AUTO */

STARTTEST
:set tw=0 wm=60 columns=80 noai fo=croq
/serious/e
a about life, the universe, and the rest[34m^[[m
ENDTEST

{

/* this is
 * a real serious important big
 * comment[15;1H[?12l[?25h[?25l[22;1H/[?12l[?25hserious/e[?25l[20;17H[?12l[?25h[?25l

[1m-- INSERT --[m[22;1H[K[1;21r[1;1H[2M[1;22r[18;19H[K[19;4Habout life, the
 * universe, and the
 * rest important big[21;7H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;2H* comment[?12l[?25h[?25l
/^STARTTEST[1;21r[1;1H[5M[1;22r[17;2H*/[18;9H/* insert " about life, the universe, and the rest" after "serious" */
}

STARTTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H:set nocin[?12l[?25h[?25l
:set ff=unix cpo-=A[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H6L, 78C written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[21;1H[?12l[?25h[?25l
/ENDTEST/+-1[22;13H[K[22;1H[1;21r[1;1H[5M[1;22r[17;1H/comments
joabout life[34m^[[m/happens
jothere[34m^[[m/below
oline[34m^[[m/this
Ohello[34m^[[m[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset nocin[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25hcomments[?25l[1;21r[1;1H[4M[1;22r[19;1H{[20;9H/*[21;10H* Testing for comments, without 'cin' set[22;1H[K[21;24H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;10H*/[?12l[?25h[?25l
[1m-- INSERT --[m[22;1H[K[1;21r[21;1H
[1;22r[21;1Habout life[?12l[?25h[?25l
/[?12l[?25hhappens[?25l[1;21r[1;1H[3M[1;22r[20;1H/*
* what happens here?[22;1H[K[21;8H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H*/[?12l[?25h[?25l
[1m-- INSERT --[m[22;1H[K[1;21r[21;1H
[1;22r[21;1Hthere[?12l[?25h[?25l
/[?12l[?25hbelow[?25l[1;21r[1;1H[3M[1;22r[20;9H/*[21;12Hthe end of the comment, try inserting a line below */[22;1H[K[21;57H[?12l[?25h[?25l
[1m-- INSERT --[m[22;1H[K[1;21r[21;1H
[1;22r[21;1Hline[?12l[?25h[?25l
/[?12l[?25hthis[?25l[1;21r[1;1H[3M[1;22r[20;17H/* how about[21;33Hthis one */[22;1H[K[21;33H[?12l[?25h[?25l
[1m-- INSERT --[m[22;1H[K[21;1Hhello[21;33H[K[21;5H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;33Hthis one */[21;8H[?12l[?25h[?25l
/^STARTTEST[1;21r[1;1H[3M[1;22r[19;1H}

STARTTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H:set cin[?12l[?25h[?25l
:set ff=unix cpo-=A[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H3L, 18C written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[21;1H[?12l[?25h[?25l
/ENDTEST/+-1[22;13H[K[22;1H[1;21r[1;1H[2M[1;22r[20;1H/vec2
==[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cin[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25hvec2[?25l[1;21r[1;1H[5M[1;22r[18;1H{
    var = this + that + vec[0] * vec[0][20;39H+ vec[1] * vec[1][21;43H+ vec2[2] * vec[2];[22;1H[K[21;45H[?12l[?25h[?25l+ vec2[2] * vec[2];[21;58H[K[21;39H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H}[?12l[?25h[?25l
/^STARTTEST[1;21r[1;1H[2M[1;22r[21;1HSTARTTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H:set cin[?12l[?25h[?25l
:set ff=unix cpo-=A[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H5L, 51C written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[21;1H[?12l[?25h[?25l
/ENDTEST/+-1[22;13H[K[22;1H[1;21r[1;1H[4M[1;22r[18;1H:set cino=}4
/testing1
k2==/testing2
k2==[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cin[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cino=}4[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25htesting1[?25l[1;21r[1;1H[8M[1;22r[15;1H{[16;17Hasdf asdflkajds f;[17;9Hif (tes & ting) {[18;17Hasdf asdf asdf ;[19;17Hasdfa sdf asdf;[20;17H}[21;9Htesting1;[22;1H[K[21;9H[?12l[?25h[20;16H[?25l}[20;17H[K[20;13H[?12l[?25h[?25l

/[?12l[?25htesting2[?25l[1;21r[1;1H[6M[1;22r[16;9Hif (tes & ting)[17;9H{[18;17Hasdf asdf asdf ;[19;17Hasdfa sdf asdf;[20;17H}[21;9Htesting2;[22;1H[K[21;9H[?12l[?25h[20;16H[?25l}[20;17H[K[20;13H[?12l[?25h[21;13H[?25l
/^STARTTEST[1;21r[1;1H[3M[1;22r[19;1H}

STARTTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H:set cin[?12l[?25h[?25l
:set ff=unix cpo-=A[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H4L, 36C written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[21;1H[?12l[?25h[?25l
/ENDTEST/+-1[22;13H[K[22;1H[1;21r[1;1H[3M[1;22r[19;1H:set cino=(0,)20
/main
=][[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cin[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cino=(0,)20[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25hmain[?25l[1;21r[1;1H[2M[1;22r[21;1Hmain ( int first_par, /*[22;1H[K[21;1H[?12l[?25h[?25l
19 lines to indent...20[7Cindented [22;19H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;24H* Comment for[22;1H[K[21;8H[?12l[?25h[?25l
/^STARTTEST[27m[m[H[2J[1;27H* first par[2;27H*/[3;15Hsecond_par /*[4;27H* Comment for[5;27H* second par[6;27H*/[7;13H);

}

STARTTEST
:set cin
:set cino=
]]=][
ENDTEST

{[18;9Hdo[19;9H{[20;17Hif ()[21;17H{[11;1H[?12l[?25h
[?25l[22;1H:set ff=unix cpo-=A[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H3L, 26C written[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[12;1H[?12l[?25h[?25l[22;1H/ENDTEST/+-1[22;13H[K[22;1H[14;1H[?12l[?25h
[?25l[22;1H[K[22;1H:so! Xdotest[15;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cin[?25l[15;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cino=[?25l[15;1H[?12l[?25h

[?25l[22;1H11 lines to indent...12[7Cindented [22;19H[K[17;1H[?12l[?25h[18;8H[?25l[22;1H[K[22;1H/^STARTTEST[1;21r[1;1H[10M[1;22r[12;25Hif ()[13;33Hasdf;[14;25Helse[15;33Hasdf;[16;17H}[17;9H} while ();[18;9Hcmd;[12C/* this should go under the } */
}

STARTTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H]]=][[?12l[?25h[?25l
:set ff=unix cpo-=A[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H1L, 6C written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[21;1H[?12l[?25h[?25l
/ENDTEST/+-1[22;13H[K[22;1H[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1HENDTEST[22;1H[K[21;1H[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[1;21r[1;1H[3M[1;22r[20;1Hvoid f()
{[22;1H[K[21;1H[?12l[?25h[?25l
8 lines to indent...9[7Cindented [22;18H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;9Hif ( k() ) {[22;1H[K[21;8H[?12l[?25h[?25l
/^STARTTEST[1;21r[1;1H[10M[1;22r[12;17Hl();[14;9H} else { /* Start (two words) end */[15;17Hm();[16;9H}[18;9Hn();
}

STARTTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H:set cino={s,e-s[?12l[?25h[?25l
:set ff=unix cpo-=A[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H2L, 23C written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[21;1H[?12l[?25h[?25l
/ENDTEST/+-1[22;13H[K[22;1H[1;21r[21;1H
[1;22r[21;1H]]=][[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cino={s,e-s[?25l[21;1H[?12l[?25h[?25l[1;21r[1;1H[3M[1;22r[20;1Hvoid f()
{[22;1H[K[21;1H[?12l[?25h[?25l
7 lines to indent...8[7Cindented [22;18H[K[21;1H [7C{[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;9Hif ( k() )[22;1H[K[21;9H[?12l[?25h[?25l
/^STARTTEST[1;21r[1;1H[9M[1;22r[13;17H{[14;17Hl();[15;17H} else { /* Start (two words) end */[16;17Hm();[17;17H}[18;9Hn();    /* should be under the if () */
}

STARTTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H:set cino={s,fs[?12l[?25h[?25l
:set ff=unix cpo-=A[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H2L, 25C written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[21;1H[?12l[?25h[?25l
/ENDTEST/+-1[22;13H[K[22;1H[1;21r[21;1H
[1;22r[21;1H]]=/ foo[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cino={s,fs[?25l[21;1H[?12l[?25h[?25l[1;21r[1;1H[3M[1;22r[20;1Hvoid bar(void)
{[22;1H[K[21;1H[?12l[?25h[?25l
/[?12l[?25h foo[?25l30 lines to indent...31[7Cindented [22;19H[K[21;1H [7C{[?12l[?25h[?25l[22;1H[K[22;1H/^STARTTEST[27m[m[H[2J[1;9H{[2;9Ha = 1;[3;17H{[4;17Hb = 2;[5;17H}[6;9Hc = 3;[7;9Hd = 4;[8;9H}
/* foo */

STARTTEST
:set cino=
/while
ohere[34m^[[m
ENDTEST

a()
{
  do {
    a = a +[21;7Ha;[11;1H[?12l[?25h
[?25l[22;1H:set ff=unix cpo-=A[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H3L, 25C written[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[12;1H[?12l[?25h[?25l[22;1H/ENDTEST/+-1[22;13H[K[22;1H[14;1H[?12l[?25h
[?25l[22;1H[K[22;1H:so! Xdotest[15;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cino=[?25l[15;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25hwhile[?25l[1;21r[21;1H
[1;22r[21;3H} while ( a );[16C/* add text under this line */[22;1H[K[21;5H[?12l[?25h[?25l
[1m-- INSERT --[m[22;1H[K[1;21r[21;1H
[1;22r[21;3Hhere[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;5Hif ( a )    i[?12l[?25h[?25l
/^STARTTEST[1;21r[1;1H[4M[1;22r[18;7Ha;
}

STARTTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H:set cino= com=[?12l[?25h[?25l
:set ff=unix cpo-=A[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H3L, 109C written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[21;1H[?12l[?25h[?25l
/ENDTEST/+-1[22;13H[K[22;1H[1;21r[1;1H[3M[1;22r[19;1H/comment
olabel2: b();[34m^M[mlabel3 /* post */:[34m^M[m/* pre */ label4:[34m^M[mf(/*com*/);[34m^M[mif (/*com*/)[34m^^[21;1HM[mcmd();[34m^[[m[22;1H[K[20;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cino= com=[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25hcomment[?25l[1;21r[1;1H[6M[1;22r[17;1Ha()
{
label1:[20;13H/* hmm */[21;13H// comment[22;1H[K[21;16H[?12l[?25h[?25l
[1m-- INSERT --[m[22;1H[K[1;21r[1;1H[6M[1;22r[16;1Hlabel2: b();
label3 /* post */:
/* pre */ label4:[19;9Hf(/*com*/);[20;9Hif (/*com*/)[21;17Hcmd();[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H}[?12l[?25h[?25l
/^STARTTEST[1;21r[1;1H[2M[1;22r[21;1HSTARTTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H:set comments& comments^=s:/*,m:**,ex:*/[?12l[?25h[?25l
:set ff=unix cpo-=A[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H3L, 53C written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[21;1H[?12l[?25h[?25l
/ENDTEST/+-1[22;13H[K[22;1H[1;21r[1;1H[2M[1;22r[20;1H/simple
=5j[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[1;1H[2M[1;22r[20;1HENDTEST[?12l[?25h[?25l

:so! Xdotest[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset comments& comments^=s:/*,m:**,ex:*/[?25l[20;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25hsimple[?25l[1;21r[1;1H[2M[1;22r[20;1H/*
  * A simple comment[22;1H[K[21;7H[?12l[?25h[?25l
5 lines to indent...6[7Cindented [22;18H[K[21;2H* A simple comment[21;20H[K[21;2H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;2H*/[22;1H[K[21;2H[?12l[?25h[?25l
/^STARTTEST[1;21r[1;1H[6M[1;22r[17;1H/*
** A different comment
*/

STARTTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H:set cino=c0[?12l[?25h[?25l
:set ff=unix cpo-=A[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H3L, 70C written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[21;1H[?12l[?25h[?25l
/ENDTEST/+-1[22;13H[K[22;1H[1;21r[1;1H[2M[1;22r[20;1H:set comments& comments-=s1:/* comments^=s0:/*
2kdd]]=][[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cino=c0[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset comments& comments-=s1:/* comments^=s0:/*[?25l[21;1H[?12l[?25h[19;1H[?25l2kdd]]=][[19;10H[K[20;1HENDTEST[20;8H[K[21;1H[K[19;1H[?12l[?25h[?25l[1;21r[1;1H[2M[1;22r[20;1Hvoid f()
{[22;1H[K[21;1H[?12l[?25h[?25l
4 lines to indent...5[7Cindented [22;18H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[22;1H[K[21;1H[?12l[?25h[?25l
/^STARTTEST[1;21r[1;1H[6M[1;22r[16;9H/*********[17;11HA comment.[18;9H*********/
}

STARTTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H:set cino=c0,C1[?12l[?25h[?25l
:set ff=unix cpo-=A[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H3L, 73C written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[21;1H[?12l[?25h[?25l
/ENDTEST/+-1[22;13H[K[22;1H[1;21r[1;1H[2M[1;22r[20;1H:set comments& comments-=s1:/* comments^=s0:/*
2kdd]]=][[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cino=c0,C1[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset comments& comments-=s1:/* comments^=s0:/*[?25l[21;1H[?12l[?25h[19;1H[?25l2kdd]]=][[19;10H[K[20;1HENDTEST[20;8H[K[21;1H[K[19;1H[?12l[?25h[?25l[1;21r[1;1H[2M[1;22r[20;1Hvoid f()
{[22;1H[K[21;1H[?12l[?25h[?25l
4 lines to indent...5[7Cindented [22;18H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[22;1H[K[21;1H[?12l[?25h[?25l
/^STARTTEST[1;21r[1;1H[6M[1;22r[16;9H/*********[17;9HA comment.[18;9H*********/
}

STARTTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H:set cino=[?12l[?25h[?25l
:set ff=unix cpo-=A[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H2L, 17C written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[21;1H[?12l[?25h[?25l
/ENDTEST/+-1[22;13H[K[22;1H[1;21r[21;1H
[1;22r[21;1H]]=][[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cino=[?25l[21;1H[?12l[?25h[?25l[1;21r[1;1H[3M[1;22r[20;1Hvoid f()
{[22;1H[K[21;1H[?12l[?25h[?25l
5 lines to indent...6[7Cindented [22;18H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;9Hc = c1 &&[22;1H[K[21;8H[?12l[?25h[?25l
/^STARTTEST[1;21r[1;1H[7M[1;22r[15;17H([16;18Hc2 ||[17;18Hc3[18;17H) && c4;
}

STARTTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H:set cino=(s[?12l[?25h[?25l
:set ff=unix cpo-=A[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H2L, 23C written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[21;1H[?12l[?25h[?25l
/ENDTEST/+-1[22;13H[K[22;1H[1;21r[21;1H
[1;22r[21;1H2kdd]]=][[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cino=(s[?25l[21;1H[?12l[?25h[19;1H[?25l2kdd]]=][[19;10H[K[20;1HENDTEST[20;8H[K[21;1H[K[19;1H[?12l[?25h[?25l[1;21r[1;1H[2M[1;22r[20;1Hvoid f()
{[22;1H[K[21;1H[?12l[?25h[?25l
5 lines to indent...6[7Cindented [22;18H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;9Hc = c1 &&[22;1H[K[21;8H[?12l[?25h[?25l
/^STARTTEST[1;21r[1;1H[7M[1;22r[15;17H([16;18Hc2 ||[17;18Hc3[18;17H) && c4;
}

STARTTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H:set cino=(s,U1[?12l[?25h[?25l
:set ff=unix cpo-=A[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H2L, 28C written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[21;1H[?12l[?25h[?25l
/ENDTEST/+-1[22;13H[K[22;1H[1;21r[21;1H
[1;22r[21;1H2kdd]]=][[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cino=(s,U1  [?25l[21;1H[?12l[?25h[19;1H[?25l2kdd]]=][[19;10H[K[20;1HENDTEST[20;8H[K[21;1H[K[19;1H[?12l[?25h[?25l[1;21r[1;1H[2M[1;22r[20;1Hvoid f()
{[22;1H[K[21;1H[?12l[?25h[?25l
5 lines to indent...6[7Cindented [22;18H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;9Hc = c1 &&[22;1H[K[21;8H[?12l[?25h[?25l
/^STARTTEST[1;21r[1;1H[7M[1;22r[15;17H([16;25Hc2 ||[17;25Hc3[18;17H) && c4;
}

STARTTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H:set cino=(0[?12l[?25h[?25l
:set ff=unix cpo-=A[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H2L, 23C written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[21;1H[?12l[?25h[?25l
/ENDTEST/+-1[22;13H[K[22;1H[1;21r[21;1H
[1;22r[21;1H2kdd]]=][[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cino=(0[?25l[21;1H[?12l[?25h[19;1H[?25l2kdd]]=][[19;10H[K[20;1HENDTEST[20;8H[K[21;1H[K[19;1H[?12l[?25h[?25l[1;21r[1;1H[2M[1;22r[20;1Hvoid f()
{[22;1H[K[21;1H[?12l[?25h[?25l
4 lines to indent...5[7Cindented [22;18H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;9Hif (   c1[22;1H[K[21;8H[?12l[?25h[?25l
/^STARTTEST[1;21r[1;1H[6M[1;22r[16;16H&& (   c2[17;23H|| c3))[18;17Hfoo;
}

STARTTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H:set cino=(0,w1[?12l[?25h[?25l
:set ff=unix cpo-=A[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H2L, 28C written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[21;1H[?12l[?25h[?25l
/ENDTEST/+-1[22;13H[K[22;1H[1;21r[21;1H
[1;22r[21;1H2kdd]]=][[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cino=(0,w1  [?25l[21;1H[?12l[?25h[19;1H[?25l2kdd]]=][[19;10H[K[20;1HENDTEST[20;8H[K[21;1H[K[19;1H[?12l[?25h[?25l[1;21r[1;1H[2M[1;22r[20;1Hvoid f()
{[22;1H[K[21;1H[?12l[?25h[?25l
4 lines to indent...5[7Cindented [22;18H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;9Hif (   c1[22;1H[K[21;8H[?12l[?25h[?25l
/^STARTTEST[1;21r[1;1H[6M[1;22r[16;13H&& (   c2[17;17H|| c3))[18;17Hfoo;
}

STARTTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H:set cino=(s[?12l[?25h[?25l
:set ff=unix cpo-=A[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H2L, 23C written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[21;1H[?12l[?25h[?25l
/ENDTEST/+-1[22;13H[K[22;1H[1;21r[21;1H
[1;22r[21;1H2kdd]]=][[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cino=(s[?25l[21;1H[?12l[?25h[19;1H[?25l2kdd]]=][[19;10H[K[20;1HENDTEST[20;8H[K[21;1H[K[19;1H[?12l[?25h[?25l[1;21r[1;1H[2M[1;22r[20;1Hvoid f()
{[22;1H[K[21;1H[?12l[?25h[?25l
8 lines to indent...9[7Cindented [22;18H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;9Hc = c1 && ([22;1H[K[21;8H[?12l[?25h[?25l
/^STARTTEST[1;21r[1;1H[10M[1;22r[12;17Hc2 ||[13;17Hc3[14;17H) && c4;[15;9Hif ([16;17Hc1 && c2[17;12H)[18;17Hfoo;
}

STARTTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H:set cino=(s,m1[?12l[?25h[?25l
:set ff=unix cpo-=A[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H2L, 28C written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[21;1H[?12l[?25h[?25l
/ENDTEST/+-1[22;13H[K[22;1H[1;21r[21;1H
[1;22r[21;1H2kdd]]=][[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cino=(s,m1  [?25l[21;1H[?12l[?25h[19;1H[?25l2kdd]]=][[19;10H[K[20;1HENDTEST[20;8H[K[21;1H[K[19;1H[?12l[?25h[?25l[1;21r[1;1H[2M[1;22r[20;1Hvoid f()
{[22;1H[K[21;1H[?12l[?25h[?25l
8 lines to indent...9[7Cindented [22;18H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;9Hc = c1 && ([22;1H[K[21;8H[?12l[?25h[?25l
/^STARTTEST[1;21r[1;1H[10M[1;22r[12;17Hc2 ||[13;17Hc3[14;9H) && c4;[15;9Hif ([16;17Hc1 && c2[17;9H)[18;17Hfoo;
}

STARTTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H:set cino=b1[?12l[?25h[?25l
:set ff=unix cpo-=A[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H2L, 23C written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[21;1H[?12l[?25h[?25l
/ENDTEST/+-1[22;13H[K[22;1H[1;21r[21;1H
[1;22r[21;1H2kdd]]=][[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cino=b1[?25l[21;1H[?12l[?25h[19;1H[?25l2kdd]]=][[19;10H[K[20;1HENDTEST[20;8H[K[21;1H[K[19;1H[?12l[?25h[?25l[1;21r[1;1H[2M[1;22r[20;1Hvoid f()
{[22;1H[K[21;1H[?12l[?25h[?25l
9 lines to indent...10 lines indented [22;19H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;9Hswitch (x)[22;1H[K[21;8H[?12l[?25h[?25l
/^STARTTEST[1;21r[1;1H[11M[1;22r[11;9H{[12;17Hcase 1:[13;25Ha = b;[14;17Hbreak;[15;17Hdefault:[16;25Ha = 0;[17;17Hbreak;[18;9H}
}

STARTTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H:set cino=(0,W5[?12l[?25h[?25l
:set ff=unix cpo-=A[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H2L, 26C written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[21;1H[?12l[?25h[?25l
/ENDTEST/+-1[22;13H[K[22;1H[1;21r[21;1H
[1;22r[21;1H2kdd]]=][[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cino=(0,W5[?25l[21;1H[?12l[?25h[19;1H[?25l2kdd]]=][[19;10H[K[20;1HENDTEST[20;8H[K[21;1H[K[19;1H[?12l[?25h[?25l[1;21r[1;1H[2M[1;22r[20;1Hvoid f()
{[22;1H[K[21;1H[?12l[?25h[?25l
10 lines to indent...11[7Cindented [22;19H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;9Hinvokeme([22;1H[K[21;8H[?12l[?25h[?25l
/^STARTTEST[27m[m[H[2J[1;14Hment);[2;9Hinvokeme([3;14Hargu,[4;14Hment[5;14H);[6;9Hinvokeme(argu,[7;18Hment[8;17H);
}

STARTTEST
:set cino=/6
2kdd]]=][
ENDTEST

void f()
{[18;9Hstatement;[19;17H// comment 1[20;9H// comment 2
}[11;1H[?12l[?25h
[?25l[22;1H:set ff=unix cpo-=A[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H2L, 23C written[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[12;1H[?12l[?25h[?25l[22;1H/ENDTEST/+-1[22;13H[K[22;1H[13;1H[?12l[?25h
[?25l[22;1H[K[22;1H:so! Xdotest[14;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cino=/6[?25l[14;1H[?12l[?25h[12;1H[?25l[12;21r[21;1H
[1;22r[22;1H[K[12;1H[?12l[?25h[16;1H[?25l[22;1H3 lines to indent...4[7Cindented [22;18H[K[18;15H// comment 1[18;28H[K[19;9H      // comment 2[16;1H[?12l[?25h[17;8H[?25l[22;1H[K[22;1H/^STARTTEST[1;21r[21;1H
[1;22r[21;1HSTARTTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H:set cino=[?12l[?25h[?25l
:set ff=unix cpo-=A[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H3L, 34C written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[21;1H[?12l[?25h[?25l
/ENDTEST/+-1[22;13H[K[22;1H[1;21r[1;1H[2M[1;22r[20;1H2kdd]]/comment 1/+1
==[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cino=[?25l[21;1H[?12l[?25h[19;1H[?25l==[19;3H[K[20;1HENDTEST[21;1H[K[19;1H[?12l[?25h[?25l[1;21r[1;1H[2M[1;22r[20;1Hvoid f()
{[22;1H[K[21;1H[?12l[?25h[?25l
/[?12l[?25hcomment 1/+1[?25l[1;21r[1;1H[3M[1;22r[19;9Hstatement;[20;12H// comment 1[21;9H// comment 2[22;1H[K[21;8H[?12l[?25h[?25l    // comment 2[21;12H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H}[?12l[?25h[?25l
/^STARTTEST[1;21r[1;1H[2M[1;22r[21;1HSTARTTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H:set cino=g0[?12l[?25h[?25l
:set ff=unix cpo-=A[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H2L, 23C written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[21;1H[?12l[?25h[?25l
/ENDTEST/+-1[22;13H[K[22;1H[1;21r[21;1H
[1;22r[21;1H2kdd]]=][[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cino=g0[?25l[21;1H[?12l[?25h[19;1H[?25l2kdd]]=][[19;10H[K[20;1HENDTEST[20;8H[K[21;1H[K[19;1H[?12l[?25h[?25l[1;21r[1;1H[2M[1;22r[20;1Hclass CAbc
{[22;1H[K[21;1H[?12l[?25h[?25l
6 lines to indent...7[7Cindented [22;18H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;9Hint Test() { return FALSE; }[22;1H[K[21;8H[?12l[?25h[?25l
/^STARTTEST[1;21r[1;1H[8M[1;22r[15;1Hpublic: // comment[16;9Hvoid testfall();
protected:[18;9Hvoid testfall();
};

STARTTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H:set cino=+20[?12l[?25h[?25l
:set ff=unix cpo-=A[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H2L, 24C written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[21;1H[?12l[?25h[?25l
/ENDTEST/+-1[22;13H[K[22;1H[1;21r[21;1H
[1;22r[21;1H2kdd]]=][[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cino=+20[?25l[21;1H[?12l[?25h[19;1H[?25l2kdd]]=][[19;10H[K[20;1HENDTEST[20;8H[K[21;1H[K[19;1H[?12l[?25h[?25l[1;21r[1;1H[3M[1;22r[19;9Hvoid
foo()
{[22;1H[K[21;1H[?12l[?25h[?25l
4 lines to indent...5[7Cindented [22;18H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;9Hif (a)[22;1H[K[21;8H[?12l[?25h[?25l
/^STARTTEST[1;21r[1;1H[6M[1;22r[16;9H{[17;9H} else[18;17Hasdf;
}

STARTTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H:set cino=(0,W2s[?12l[?25h[?25l
:set ff=unix cpo-=A[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H2L, 27C written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[21;1H[?12l[?25h[?25l
/ENDTEST/+-1[22;13H[K[22;1H[1;21r[21;1H
[1;22r[21;1H2kdd]]=][[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1HENDTEST[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cino=(0,W2s[?25l[21;1H[?12l[?25h[19;1H[?25l2kdd]]=][[19;10H[K[20;1HENDTEST[20;8H[K[21;1H[K[19;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H{[22;1H[K[21;1H[?12l[?25h[?25l
34 lines to indent...35[7Cindented [22;19H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;9Haverylongfunctionnamelongfunctionnameaverylongfunctionname()->asd([22;1H[K[21;8H[?12l[?25h[?25l
/^STARTTEST[27m[m[H[2J[1;57Hasdfadsf,[2;57Hasdfasdf,[3;57Hasdfasdf,[4;57H),[5;25Hfunc(asdfadf,[6;30Hasdfasdf),[7;25Hasdasdf[8;25H);
}

STARTTEST
:set cino=M1
2kdd]]=][
ENDTEST

int main ()
{[18;9Hif (cond1 &&[19;25Hcond2[20;25H)[21;17Hfoo;[11;1H[?12l[?25h
[?25l[22;1H:set ff=unix cpo-=A[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H2L, 23C written[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[12;1H[?12l[?25h[?25l[22;1H/ENDTEST/+-1[22;13H[K[22;1H[13;1H[?12l[?25h
[?25l[22;1H[K[22;1H:so! Xdotest[14;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cino=M1[?25l[14;1H[?12l[?25h[12;1H[?25l[12;21r[21;1H
[1;22r[21;1H}[22;1H[K[12;1H[?12l[?25h[16;1H[?25l[22;1H4 lines to indent...5[7Cindented [22;18H[K[16;1H[?12l[?25h[17;8H[?25l[22;1H[K[22;1H/^STARTTEST[1;21r[1;1H[2M[1;22r[21;1HSTARTTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H:g/^STARTTEST/.,/^ENDTEST/d[?12l[?25h[?25l
:set ff=unix cpo-=A[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H2L, 61C written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[21;1H[?12l[?25h[?25l
/ENDTEST/+-1[22;13H[K[22;1H[20;1H[?12l[?25h
[?25l[22;1H[K[22;1H:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hg/^STARTTEST/.,/^ENDTEST/d[?25l128 fewer lines[22;16H[K[1;41Habc,[1;57H[K[2;25H                dec)->asdfasdfasdf([3;30H          [17Casdfadsf,[4;25H       [25Casdfasdf,[5;25H  [30Casdfasdf,
 [55C),[7;25Hfunc(asdfadf,
         [20Casdfasdf),
         [15Casdasdf
       [17C);
}[12;1H[K[13;1H[K[14;1Hint main ()[14;12H[K[15;1H{[15;25H[K[16;9Hif (cond1 &&[16;25H[K[17;17H        cond2
 [23C)[19;17Hfoo;
}[20;2H[K[21;1H[K[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h1;/start of AUTO/,$wq! test.out[?25l"test.out" [22;12H[K[22;12H[New] 1185L, 11386C written
[?1l>[?12l[?25h[?1049l254,256c254,256
< 				int i;
< 				cmd;
< 			}
---
> 					int i;
> 					cmd;
> 				}
258,262c258,262
< 					test) {		/* this line doesn't work right */
< 				int i;
< 				cmd;
< 			}
< 			break;
---
> 						test) {		/* this line doesn't work right */
> 					int i;
> 					cmd;
> 				}
> 				break;
304c304
< 	    b;
---
> 		b;
382,384c382,384
< 				asdfasdf)
< 			aasdf;
< 		a = 9;
---
> 					asdfasdf)
> 				aasdf;
> 			a = 9;
386,387c386,387
< 			aasdf;
< 		a = 9;
---
> 				aasdf;
> 			a = 9;
389c389
< 		   y = 2;
---
> 			   y = 2;
392c392
< 		here;
---
> 			here;
395,397c395,397
< 			asdfasdf)
< 	{
< 	}
---
> 				asdfasdf)
> 		{
> 		}
400,402c400,402
< 			asdfasdf) {
< 		there;
< 	}
---
> 				asdfasdf) {
> 			there;
> 		}
405,406c405,406
< 			asdfasdf)
< 		there;
---
> 				asdfasdf)
> 			there;
527c527
< 					bar;
---
> 						bar;
540,541c540,541
< 	     foo\
< 	     bor";
---
> 			 foo\
> 			 bor";
545,547c545,547
< 		asdf\
< 		asdf",
< 	*bar;
---
> 				asdf\
> 				asdf",
> 		*bar;
554,556c554,556
< 			asdf\
< 			asdf",
< 		*bar;
---
> 					asdf\
> 					asdf",
> 			*bar;
560,562c560,562
< 				asdf\
< 				asdf",
< 			*bar;
---
> 						asdf\
> 						asdf",
> 				*bar;
583c583
< 	     two;
---
> 		 two;
585c585
< 		   jan;
---
> 			   jan;
587c587
< 		 jannie;
---
> 			 jannie;
589c589
< 			krap;
---
> 					krap;
591c591
< 		     jan;
---
> 				 jan;
772,773c772,773
< 			  {
< 			  }
---
> 				  {
> 				  }
830c830
< 				      + vec2[2] * vec[2];
---
> 					  + vec2[2] * vec[2];
839c839
< 	    }
---
> 		}
845c845
< 	    }
---
> 		}
851,858c851,858
< 		       * Comment for
< 		       * first par
< 		       */
<        int second_par /*
< 		       * Comment for
< 		       * second par
< 		       */
<      )
---
> 					   * Comment for
> 					   * first par
> 					   */
> 	   int second_par /*
> 					   * Comment for
> 					   * second par
> 					   */
> 	 )
861,868c861,868
< 			  * Comment for
< 			  * first par
< 			  */
< 	      second_par /*
< 			  * Comment for
< 			  * second par
< 			  */
< 	    );
---
> 					  * Comment for
> 					  * first par
> 					  */
> 		  second_par /*
> 					  * Comment for
> 					  * second par
> 					  */
> 		);
967,969c967,969
< 	f(/*com*/);
< 	if (/*com*/)
< 		cmd();
---
> 		f(/*com*/);
> 		if (/*com*/)
> 			cmd();
1033,1034c1033,1034
< 	       && (   c2
< 		      || c3))
---
> 		   && (   c2
> 				  || c3))
1042,1043c1042,1043
< 	    && (   c2
< 		|| c3))
---
> 		&& (   c2
> 			|| c3))
1091,1092c1091,1092
< 	     argu,
< 	     ment);
---
> 		 argu,
> 		 ment);
1094,1097c1094
< 	     argu,
< 	     ment
< 	     );
< 	invokeme(argu,
---
> 		 argu,
1099c1096,1099
< 		);
---
> 		 );
> 	invokeme(argu,
> 			 ment
> 			);
1106,1107c1106,1107
< 	      // comment 1
< 	      // comment 2
---
> 		  // comment 1
> 		  // comment 2
1144c1144
< 			     asdfadsf),
---
> 				 asdfadsf),
1151,1162c1151,1162
< 		    averylongfunctionname(
< 				    abc,
< 				    dec)->averylongfunctionname(
< 						    asdfadsf,
< 						    asdfasdf,
< 						    asdfasdf,
< 						    ),
< 		    func(asdfadf,
< 			 asdfasdf
< 			),
< 		    asdasdf
< 		   );
---
> 				averylongfunctionname(
> 						abc,
> 						dec)->averylongfunctionname(
> 								asdfadsf,
> 								asdfasdf,
> 								asdfasdf,
> 								),
> 				func(asdfadf,
> 					 asdfasdf
> 					),
> 				asdasdf
> 			   );
1172c1172
< 			     asdfasdf),
---
> 				 asdfasdf),
rm -rf X* test.ok viminfo
rm -rf test4.failed test.ok test.out X* viminfo
cp test4.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test4.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test4.in" 31 lines, 839 characters[1;1HTest for autocommand that changes current buffer on BufEnter event.
Check if modelines are interpreted for the correct buffer.

STARTTEST
:so small.vim
:set nocompatible viminfo+=nviminfo
:au BufEnter Xxx brew
/start of
:.,/end of/w! Xxx   " write test file Xxx
:set ai modeline modelines=3
:sp Xxx[13C" split to Xxx, autocmd will do :brew
G?this is a
othis should be auto-indented[34m^[[m
:[19C" Append text with autoindent to this file
:au! BufEnter Xxx
:buf Xxx[12C" go to Xxx, no autocmd anymore
G?this is a
othis should be in column 1[34m^[[m:wq " append text without autoindent to Xxx
G:r Xxx[13C" include Xxx in the current file
:?startstart?,$w! test.out
:qa![1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for autocommand that changes current buffer on BufEnter event.[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[4;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 17 lines, 557 characters written[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[5;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[1;21r[21;1H
[1;22r[21;1HENDTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset nocompatible viminfo+=nviminfo[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hau BufEnter Xxx brew[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25hstart of[?25l[1;21r[1;1H[2M[1;22r[20;1Hstartstart
start of test file Xxx[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h.,/end of/w! Xxx   " write test file Xxx[?25l"Xxx" [22;7H[K[22;7H[New] 7L, 124C written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset ai modeline modelines=3[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hsp Xxx             " split to Xxx, autocmd will do :brew[?25l"Xxx" [22;7H[K[22;7H7L, 124C[1;2Hqa![1;5H[K[2;1HENDTEST[2;8H[K[3;1H[K[4;1Hstartstart
start of test file Xxx[5;23H[K[6;1Hvim: set noai :[6;16H[K[7;1H        this is a test[7;23H[K[8;1H        this is a test
        this is a test[9;23H[K[10;1H [7Cthis is a test[10;23H[K[11;1H[1m[7mtest4.in                                                                        [m[12;1HG?this is a[12;21H[K[13;1Hothis should be in column 1[34m^[[m:wq " append text without autoindent to Xxx
G:r Xxx             " include Xxx in the current file[14;54H[K[15;1H:?startstart?,$w! test.out[15;27H[K[16;2Hqa![16;5H[K[17;1HENDTEST[18;1H[K[19;1Hstartstart[20;6H of test file Xxx
[7mtest4.in                                                                        [m[22;2Htest4.in" line 25 of 31 --80%-- col 1[5;1H[?12l[?25h[?25l[1;10r[10;1H
[1;22r[10;1Hend of test file Xxx[22;1H[K[10;1H[?12l[?25h[?25l[22;1H?[?12l[?25hthis is a[?25l[9;9H[?12l[?25h[?25l[22;1H[1m-- INSERT --[m[22;1H[K[10;1H        this should be auto-indented[11;10H[1m[7m[+][m[21;10H[7m[+][10;36H[?12l[?25h[?25l[1;10r[m[10;1H
[1;22r[10;1Hend of test file Xxx[?12l[?25h[?25l[22;1H:[?12l[?25h                   " Append text with autoindent to this file[?25l[10;20H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hau! BufEnter Xxx[?25l[10;20H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hbuf Xxx            " go to Xxx, no autocmd anymore[?25l"Xxx" [22;7H[K[22;7H7L, 124C[1;1Hstart of test file Xxx
vim: set noai :
        this is a test
        this is a test


end of test file Xxx[7;21H[K[8;1H[1m[34m~                                                                               [9;1H~                                                                               [10;1H~                                                                               [m[11;1H[1m[7mXxx          [1;1H[?12l[?25h[7;1H[?25l[m[22;1H[K[22;1H?[?12l[?25hthis is a[?25l[6;9H[?12l[?25h[?25l[22;1H[1m-- INSERT --[m[22;1H[K[7;10r[7;1H[L[1;22r[7;1Hthis should be in column 1[11;5H[1m[7m[+][7;26H[?12l[?25h[?25l[22;1H[m:[?12l[?25hwq " append text without autoindent to Xxx[?25l"Xxx[22;7H[K[22;7H8L, 151C written[1;1H:so small.vim[1;15H[K[2;1H:set nocompatible viminfo+=nviminfo
:au BufEnter Xxx brew[3;22H[K[4;1H/start of[4;10H[K[5;1H:.,/end of/w! Xxx   " write test file Xxx
:set ai modeline modelines=3
:sp Xxx             " split to Xxx, autocmd will do :brew
G?this is a[8;13H[K[9;1Hothis should be auto-indented[34m^[[m[9;32H[K[10;1H:                   " Append text with autoindent to this file[10;63H[K[11;1H:au! BufEnter Xxx[11;18H[K[12;1H:buf Xxx   [9C" go to Xxx, no autocmd anymore
G?this is a[13;12H[K[14;1Hothis should be in column 1[34m^[[m:wq " append text without autoindent to Xxx
G:r Xxx             " include Xxx in the current file
:?startstart?,$w! test.out
:qa![17;5H[K[18;1HENDTEST[19;1H[K[20;6Hstar[20;11H[K[21;1Hstart of test file Xxx[21;23H[K[21;1H[?12l[?25h[?25l[1;21r[1;1H[7M[1;22r[15;1Hvim: set noai :[16;9Hthis is a test[17;9Hthis is a test[18;9Hthis is a test[19;9Hthis is a test[20;9Hthis should be auto-indented
end of test file Xxx[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25hr Xxx             " include Xxx in the current file[?25l"Xxx" [22;20H[K[22;7H8L, 151C[1;21r[21;1H
[1;22r[21;1Hstart of test file Xxx[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h?startstart?,$w! test.out[?25l"test.out" [22;12H[K[22;12H[New] 17L, 316C written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test5.failed test.ok test.out X* viminfo
cp test5.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test5.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test5.in" 29 lines, 949 characters[1;1HTest for autocommand that deletes the current buffer on BufLeave event.
Also test deleting the last buffer, should give a new, empty buffer.

STARTTEST
:so small.vim
:au BufLeave Xxx bwipe
/start of
:.,/end of/w! Xxx[15C" write test file Xxx
:sp Xxx[25C" split to Xxx
:bwipe[26C" delete buffer Xxx, now we're back here
G?this is a
othis is some more text[34m^[[m
:[31C" Append some text to this file
:?start?,$w! test.out[11C" Write current file contents
:bwipe test.out[17C" delete alternate buffer
:au bufleave test5.in bwipe
:bwipe![25C" delete current buffer, get an empty one
ithis is another test line[34m^[[m:w >>test.out
:[31C" append an extra line to the output file
:qa!
ENDTEST[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for autocommand that deletes the current buffer on BufLeave event.[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[4;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 16 lines, 664 characters written[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[5;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[22;1H[K[21;1H[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hau BufLeave Xxx bwipe[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25hstart of[?25l[1;21r[21;1H
[1;22r[21;1Hstart of test file Xxx[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h.,/end of/w! Xxx               " write test file Xxx[?25l"Xxx" [22;7H[K[22;7H[New File] 7 lines, 124 characters written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hsp Xxx                         " split to Xxx[?25l"Xxx" [22;7H[K[22;7H7 lines, 124 characters[1;1Hstart of test file Xxx
vim: set noai :
        this is a test
        this is a test
        this is a test
        this is a test[6;33H[K[7;1Hend of test file Xxx[7;33H[K[8;1H[1m[34m~                                                                               [9;1H~                                                                               [10;1H~                                                                               [m[11;1H[1m[7mXxx                                                                             [m[12;2Hbwipe test.out      [13Cdelete alternate buffer[12;58H[K[13;2Hau bufleave test5.in bwipe[13;33H[K[14;2Hbwipe!                         " delete current buffer, get an empty one
ithis is another test line[34m^[[m:w >>test.out[15;42H[K[16;1H:                               " append an extra line to the output file
:qa![17;33H[K[18;1HENDTEST[19;1H[K[20;1Hstart of test file Xxx
[7mtest5.in                                                                        [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hbwipe                          " delete buffer Xxx, now we're back here[?25l[1;1H[K[2;1HSTARTTEST[2;10H[K[3;1H:so small.vim[3;14H[K[4;1H:au BufLeave Xxx bwipe
/start of[5;10H[K[6;1H:.,/end of/w! Xxx     [10C" write test file Xxx
:sp Xxx             [12C" split to Xxx
:bwipe                          " delete buffer Xxx, now we're back here[8;73H[K[9;1HG?this is a[9;12H[K[10;1Hothis is some more text[34m^[[m[10;26H[K[11;1H:                               " Append some text to this file[11;64H[K[12;2H?start?,$w! test.out[13CWrite current file contents
:bwipe test.out                 " delete alternate buffer
:au bufleave test5.in bwipe[14;33H[K[15;1H:bwipe!                         " delete current buffer, get an empty one
ithis is another test line[34m^[[m:w >>test.out[16;42H[K[17;2H   [28C" append an extra line to the output file
:qa![18;5H[K[19;1HENDTEST[20;1H[K[21;1Hstart of test file Xxx[21;23H[K[21;1H[?12l[?25h[?25l[1;21r[1;1H[6M[1;22r[16;1Hvim: set noai :[17;9Hthis is a test[18;9Hthis is a test[19;9Hthis is a test[20;9Hthis is a test
end of test file Xxx[22;1H[K[21;1H[?12l[?25h[?25l
?[?12l[?25hthis is a[?25l[20;9H[?12l[?25h[?25l
this is some more text[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hend of test file Xxx[22;1H[K[21;20H[?12l[?25h[?25l
:[?12l[?25h                               " Append some text to this file[?25l[21;20H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h?start?,$w! test.out           " Write current file contents[?25l"test.out" [22;12H[K[22;12H[New File] 8 lines, 147 characters written[21;20H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hbwipe test.out                 " delete alternate buffer[?25l[21;20H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hau bufleave test5.in bwipe[?25l[21;20H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hbwipe!                         " delete current buffer, get an empty one[?25l[1m[37m[41mError detected while processing BufLeave Auto commands for "test5.in":[m[22;71H[K[22;1H
[1m[37m[41mE89: No write since last change for buffer 1 (add ! to override)[m
[32mPress ENTER or type command to continue[?12l[?25h[m[1;1H[2L[?25l[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [m[22;1H[K[1;1H[?12l[?25h[?25lthis is another test line[?12l[?25h[?25l[22;1H:[?12l[?25hw >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 26 characters appended[1;25H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h                               " append an extra line to the output file[?25l[1;25H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test6.failed test.ok test.out X* viminfo
cp test6.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test6.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test6.in" 24 lines, 739 characters[1;1HTest for autocommand that redefines the argument list, when doing ":all".

STARTTEST
:so small.vim
:au BufReadPost Xxx2 next Xxx2 Xxx1
/^start of
A1[34m^[[m:.,/end of/w! Xxx1    " write test file Xxx1
$r2:.,/end of/w! Xxx2     " write test file Xxx2
$r3:.,/end of/w! Xxx3     " write test file Xxx3
:next! Xxx1 Xxx2 Xxx3     " redefine arglist; go to Xxx1
:all[22C" open window for all args
:w! test.out[14C" Write contents of Xxx1
[34m^W^W^W^W[m:w >>test.out     " Append contents of last window (Xxx1)
:rew[22C" should now be in Xxx2
:w >>test.out[13C" Append contents of Xxx2
:qa!
ENDTEST

start of test file Xxx[20;9Hthis is a test[21;9Hthis is a test[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for autocommand that redefines the argument list, when doing ":all".[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 13 lines, 537 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[17;1H[?12l[?25h
[?25l[22;1H[K[22;1H:so! Xdotest[18;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[18;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hau BufReadPost Xxx2 next Xxx2 Xxx1[?25l[18;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h^start of[?25l[19;1H[?12l[?25h[?25l[22C1[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.,/end of/w! Xxx1    " write test file Xxx1[?25l"Xxx1" [22;9H[K[22;8H[New File] 6 lines, 109 characters written[19;23H[?12l[?25h[?25l2[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.,/end of/w! Xxx2     " write test file Xxx2[?25l"Xxx2" [22;9H[K[22;8H[New File] 6 lines, 109 characters written[19;23H[?12l[?25h[?25l3[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.,/end of/w! Xxx3     " write test file Xxx3[?25l"Xxx3" [22;9H[K[22;8H[New File] 6 lines, 109 characters written[19;23H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hnext! Xxx1 Xxx2 Xxx3     " redefine arglist; go to Xxx1[?25l"Xxx1"[22;8H[K[22;8H6 lines, 109 characters[1;1Hstart of test file Xxx1[1;24H[K[2;9Hthis is a test
        this is a test
        this is a test
        this is a test[5;23H[K[6;1Hend of test file Xxx
[1m[34m~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hall                      " open window for all args[?25l"Xxx2"[22;27H[K[22;8H6 lines, 109 characters
"Xxx2" 6 lines, 109 characters
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw! test.out              " Write contents of Xxx1[?25l"test.out" [22;12H[K[22;12H[New File] 6 lines, 109 characters written
[32mPress ENTER or type command to continue[?12l[?25h[m[1;1H[3L[?25l[1;1Hstart of test file Xxx1[2;9Hthis is a test[3;9Hthis is a test[10;1H[1m[7mXxx1                                                                            [m[11;1Hstart of test file Xxx2[11;24H[K[12;1H        this is a test[12;23H[K[13;1H        this is a test[13;23H[K[14;1H        this is a test[14;23H[K[15;1H        this is a test[15;23H[K[16;1Hend of test file Xxx[16;21H[K[21;1H[7mXxx2                                                                            [m[22;1H[K[1;1H[?12l[?25h[10;1H[7mXxx1                                                                            [m[21;1H[1m[7mXxx2                                                                            [11;1H[10;1HXxx1                                                                            [m[21;1H[7mXxx2                                                                            [1;1H[?25l[22;1H[m:[?12l[?25hw >>test.out     " Append contents of last window (Xxx1)[?25l"test.out" [22;12H[K[22;12H6 lines, 109 characters appended[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hrew                      " should now be in Xxx2[?25l"Xxx2" line 1 of 6 --16%-- col 1 (file 1 of 2)[22;47H[K[1;23H2[10;4H[1m[7m2[1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw >>test.out             " Append contents of Xxx2[?25l"test.out" [22;12H[K[22;12H6 lines, 109 characters appended[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test7.failed test.ok test.out X* viminfo
cp test7.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test7.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test7.in" 26 lines, 675 characters[1;1HTest for autocommand that changes the buffer list, when doing ":ball".

STARTTEST
:so small.vim
/^start of
A1[34m^[[m:.,/end of/w! Xxx1   " write test file Xxx1
:sp Xxx1
:close
$r2:.,/end of/w! Xxx2    " write test file Xxx2
:sp Xxx2
:close
$r3:.,/end of/w! Xxx3    " write test file Xxx3
:sp Xxx3
:close
:au BufReadPost Xxx2 bwipe
$r4:ball[17C" open window for all args, close Xxx2
:.,$w! test.out[10C" Write contents of this file
[34m^W^W[m:w >>test.out[8C" Append contents of second window (Xxx1)
[34m^W^W[m:/^start of/,$w >>test.out   " Append contents of last window (this file)
:qa!
ENDTEST[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for autocommand that changes the buffer list, when doing ":ball".[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 17 lines, 508 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[22;1H[K[21;1H[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h^start of[?25l[1;21r[21;1H
[1;22r[21;1Hstart of test file Xxx[22;1H[K[21;1H[?12l[?25h[?25l[22C1[?12l[?25h[?25l
:[?12l[?25h.,/end of/w! Xxx1   " write test file Xxx1[?25l"Xxx1" [22;9H[K[22;8H[New File] 4 lines, 77 characters written[21;23H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hsp Xxx1[?25l"Xxx1" [22;8H[K[22;8H4 lines, 77 characters[1;1Hstart of test file Xxx1
        this is a test
        this is a test
end of test file Xx[4;21H[K[5;1H[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [m[11;1H[1m[7mXxx1                                                                            [m[12;2Hau BufReadPost Xxx2 bwipe
$r4:ball                 " open window for all args, close Xxx2
:.,$w! test.out[12CWrite contents of this file[14;55H[K[15;1H[34m^W^W[m:w >>test.out[10CAppend contents of second window (Xxx1)[16;6H/^start of/,$w >>test.out   " Append contents of last window (this file)
:qa![17;5H[K[18;1HENDTEST[19;1H[K[20;1Hstart of test file Xxx1
[7mtest7.in [+]                                                                    [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hclose[?25l[1;1HSTARTTEST[1;10H[K[2;1H:so small.vim[2;14H[K[3;1H/^start of[3;11H[K[4;1HA1[34m^[[m:.,/end of/w! Xxx1   " write test file Xxx1
:sp Xxx1[5;9H[K[6;1H:close[6;7H[K[7;1H$r2:.,/end of/w! Xxx2    " write test file Xxx2[7;48H[K[8;1H:sp Xxx2[8;9H[K[9;1H:close[9;7H[K[10;1H$r3:.,/end of/w! Xxx3    " write test file Xxx3[10;48H[K[11;1H:sp Xxx3[11;9H[K[12;2Hclose[12;7H[K[13;1H:au BufReadPost Xxx2 bwipe[13;28H[K[14;1H$r4:ball       [12Copen window for all args, close Xxx2
:.,$w! test.out  [10CWrite contents of this file[15;55H[K[16;6Hw >>test.out        " Append contents of second window (Xxx1)[16;67H[K[17;1H[34m^W^W[m:/^start of/,$w >>test.out   " Append contents of last window (this file)
:qa![18;5H[K[19;1HENDTEST[20;1H[K[21;1Hstart of test file Xxx1[21;24H[K[21;23H[?12l[?25h[?25l2[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.,/end of/w! Xxx2    " write test file Xxx2[?25l"Xxx2" [22;9H[K[22;8H[New File] 4 lines, 77 characters written[21;23H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hsp Xxx2[?25l"Xxx2" [22;8H[K[22;8H4 lines, 77 characters[1;1Hstart of test file Xxx2
        this is a test
        this is a test
end of test file Xx[4;21H[K[5;1H[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [m[11;1H[1m[7mXxx2                                                                            [m[12;2Hau BufReadPost Xxx2 bwipe
$r4:ball                 " open window for all args, close Xxx2
:.,$w! test.out[12CWrite contents of this file[14;55H[K[15;1H[34m^W^W[m:w >>test.out[10CAppend contents of second window (Xxx1)[16;6H/^start of/,$w >>test.out   " Append contents of last window (this file)
:qa![17;5H[K[18;1HENDTEST[19;1H[K[20;1Hstart of test file Xxx2
[7mtest7.in [+]                                                                    [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hclose[?25l[1;1HSTARTTEST[1;10H[K[2;1H:so small.vim[2;14H[K[3;1H/^start of[3;11H[K[4;1HA1[34m^[[m:.,/end of/w! Xxx1   " write test file Xxx1
:sp Xxx1[5;9H[K[6;1H:close[6;7H[K[7;1H$r2:.,/end of/w! Xxx2    " write test file Xxx2[7;48H[K[8;1H:sp Xxx2[8;9H[K[9;1H:close[9;7H[K[10;1H$r3:.,/end of/w! Xxx3    " write test file Xxx3[10;48H[K[11;1H:sp Xxx3[11;9H[K[12;2Hclose[12;7H[K[13;1H:au BufReadPost Xxx2 bwipe[13;28H[K[14;1H$r4:ball       [12Copen window for all args, close Xxx2
:.,$w! test.out  [10CWrite contents of this file[15;55H[K[16;6Hw >>test.out        " Append contents of second window (Xxx1)[16;67H[K[17;1H[34m^W^W[m:/^start of/,$w >>test.out   " Append contents of last window (this file)
:qa![18;5H[K[19;1HENDTEST[20;1H[K[21;1Hstart of test file Xxx2[21;24H[K[21;23H[?12l[?25h[?25l3[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.,/end of/w! Xxx3    " write test file Xxx3[?25l"Xxx3" [22;9H[K[22;8H[New File] 4 lines, 77 characters written[21;23H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hsp Xxx3[?25l"Xxx3" [22;8H[K[22;8H4 lines, 77 characters[1;1Hstart of test file Xxx3
        this is a test
        this is a test
end of test file Xx[4;21H[K[5;1H[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [m[11;1H[1m[7mXxx3                                                                            [m[12;2Hau BufReadPost Xxx2 bwipe
$r4:ball                 " open window for all args, close Xxx2
:.,$w! test.out[12CWrite contents of this file[14;55H[K[15;1H[34m^W^W[m:w >>test.out[10CAppend contents of second window (Xxx1)[16;6H/^start of/,$w >>test.out   " Append contents of last window (this file)
:qa![17;5H[K[18;1HENDTEST[19;1H[K[20;1Hstart of test file Xxx3
[7mtest7.in [+]                                                                    [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hclose[?25l[1;1HSTARTTEST[1;10H[K[2;1H:so small.vim[2;14H[K[3;1H/^start of[3;11H[K[4;1HA1[34m^[[m:.,/end of/w! Xxx1   " write test file Xxx1
:sp Xxx1[5;9H[K[6;1H:close[6;7H[K[7;1H$r2:.,/end of/w! Xxx2    " write test file Xxx2[7;48H[K[8;1H:sp Xxx2[8;9H[K[9;1H:close[9;7H[K[10;1H$r3:.,/end of/w! Xxx3    " write test file Xxx3[10;48H[K[11;1H:sp Xxx3[11;9H[K[12;2Hclose[12;7H[K[13;1H:au BufReadPost Xxx2 bwipe[13;28H[K[14;1H$r4:ball       [12Copen window for all args, close Xxx2
:.,$w! test.out  [10CWrite contents of this file[15;55H[K[16;6Hw >>test.out        " Append contents of second window (Xxx1)[16;67H[K[17;1H[34m^W^W[m:/^start of/,$w >>test.out   " Append contents of last window (this file)
:qa![18;5H[K[19;1HENDTEST[20;1H[K[21;1Hstart of test file Xxx3[21;24H[K[21;23H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hau BufReadPost Xxx2 bwipe[?25l[21;23H[?12l[?25h[?25l4[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hball                 " open window for all args, close Xxx2[?25l"Xxx1"[22;23H[K[22;8H4 lines, 77 characters
"Xxx2" 4 lines, 77 characters
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25h.,$w! test.out          " Write contents of this file[?25l"test.out" [22;12H[K[22;12H[New File] 4 lines, 77 characters written
[32mPress ENTER or type command to continue[?12l[?25h[27m[m[H[2J[?25l[1;1H:au BufReadPost Xxx2 bwipe
$r4:ball[17C" open window for all args, close Xxx2
:.,$w! test.out[10C" Write contents of this file
[34m^W^W[m:w >>test.out[8C" Append contents of second window (Xxx1)
[34m^W^W[m:/^start of/,$w >>test.out   " Append contents of last window (this file)
:qa!
ENDTEST

start of test file Xxx4
[1m[7mtest7.in [+]                                                                    [m[11;1Hstart of test file Xxx1[12;9Hthis is a test[13;9Hthis is a test
end of test file Xxx
[1m[34m~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [m[21;1H[7mXxx1                                                                            [9;23H[?12l[?25h
test7.in [+]                                                                    [m[21;1H[1m[7mXxx1                                                                            [11;1H[?25l[22;1H[m:[?12l[?25hw >>test.out        " Append contents of second window (Xxx1)[?25l"test.out" [22;12H[K[22;12H4 lines, 77 characters appended[11;1H[?12l[?25h[10;1H[1m[7mtest7.in [+]                                                                    [m[21;1H[7mXxx1                                                                            [9;23H[?25l[m[22;1H[K[22;1H:[?12l[?25h/^start of/,$w >>test.out   " Append contents of last window (this file)[?25l[31msearch hit BOTTOM, continuing at TOP[m[22;37H[K[22;1H"test.out" [22;12H[K[22;12H4 lines, 77 characters appended[9;23H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test8.failed test.ok test.out X* viminfo
cp test8.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test8.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test8.in" 24 lines, 797 characters[1;1HTest for BufWritePre autocommand that deletes or unloads the buffer.

STARTTEST
:so small.vim
:au BufWritePre Xxx1 bunload
:au BufWritePre Xxx2 bwipe
/^start of
A1[34m^[[m:.,/end of/w! Xxx1  " write test file Xxx1
$r2:.,/end of/w! Xxx2   " write test file Xxx2
:e! Xxx2[16C" edit Xxx2
:bdel test8.in[10C" delete this file from the buffer list
:e Xxx1[17C" edit Xxx1
:w[22C" write it, will unload it and give an error msg
:w! test.out[12C" Write contents of this file
:e! Xxx2[16C" start editing Xxx2
:bwipe test.out[9C" remove test.out from the buffer list
:w[22C" write it, will delete the buffer and give an error msg[18;1H:w >>test.out[11C" Append contents of this file
:qa!
ENDTEST[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for BufWritePre autocommand that deletes or unloads the buffer.[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 16 lines, 678 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[20;1H[?12l[?25h
[?25l[22;1H[K[22;1H:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hau BufWritePre Xxx1 bunload[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hau BufWritePre Xxx2 bwipe[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h^start of[?25l[1;21r[21;1H
[1;22r[21;1Hstart of Xxx[22;1H[K[21;1H[?12l[?25h[?25l[12C1[?12l[?25h[?25l
:[?12l[?25h.,/end of/w! Xxx1  " write test file Xxx1[?25l"Xxx1" [22;9H[K[22;8H[New File] 3 lines, 31 characters written[21;13H[?12l[?25h[?25l2[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.,/end of/w! Xxx2   " write test file Xxx2[?25l"Xxx2" [22;9H[K[22;8H[New File] 3 lines, 31 characters written[21;13H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! Xxx2                " edit Xxx2[?25l"Xxx2" [22;8H[K[22;8H3 lines, 31 characters[1;1Hstart of Xxx2
        test
end of Xxx[3;11H[K[4;1H[1m[34m~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hbdel test8.in[34m^I^I[m" delete this file from the buffer list[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he Xxx1                 " edit Xxx1[?25l"Xxx1" [22;25H[K[22;8H3 lines, 31 characters[1;13H1[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw                      " write it, will unload it and give an error msg[?25l"Xxx2"[22;25H[K[22;8H3 lines, 31 characters
[1m[37m[41mE203: Autocommands deleted or unloaded buffer to be written[m
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw! test.out            " Write contents of this file[?25l"test.out" [22;12H[K[22;12H[New File] 3 lines, 31 characters written
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25he! Xxx2                " start editing Xxx2[?25l"Xxx2" [22;8H[K[22;8H3 lines, 31 characters[1;1H[3L[1;1Hstart of Xxx2[2;9Htest
end of Xxx[22;1H[K[22;1H"Xxx2" 3 lines, 31 characters[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hbwipe test.out         " remove test.out from the buffer list[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw                      " write it, will delete the buffer and give an error ms
[21;80Hg[22;1H[?25l[21;1H"Xxx1"[21;25H[K[21;8H3 lines, 31 characters
[1m[37m[41mE203: Autocommands deleted or unloaded buffer to be written[m
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw >>test.out           " Append contents of this file[?25l"test.out" [22;12H[K[22;12H3 lines, 31 characters appended
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test9.failed test.ok test.out X* viminfo
cp test9.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test9.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test9.in" 12 lines, 255 characters[1;1HTest for Bufleave autocommand that deletes the buffer we are about to edit.

STARTTEST
:so small.vim
:au BufLeave test9.in bwipe yy
:e yy
:/^start of/,$w! test.out      " Write contents of this file
:qa!
ENDTEST

start of test file xx
end of test file xx
[1m[34m~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for Bufleave autocommand that deletes the buffer we are about to edit.[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 5 lines, 117 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[9;1H[?12l[?25h
[?25l[22;1H[K[22;1H:so! Xdotest[10;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[10;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hau BufLeave test9.in bwipe yy[?25l[10;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he yy[?25l[1m[37m[41mE143: Autocommands unexpectedly deleted new buffer yy[10;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25h/^start of/,$w! test.out      " Write contents of this file[?25l"test.out" [22;12H[K[22;12H[New File] 2 lines, 42 characters written[10;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test10.failed test.ok test.out X* viminfo
cp test10.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test10.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test10.in" 57 lines, 1624 characters[1;1HTest for 'errorformat'.  This will fail if the quickfix feature was disabled.

STARTTEST
:so small.vim
:/start of errorfile/,/end of errorfile/w! Xerrorfile
:/start of testfile/,/end of testfile/w! Xtestfile
:cf Xerrorfile
rA
:cn
rB
:cn
rC
:cn
rD
:cn
rE
:w! test.out[13C" Write contents of this file
:qa!
ENDTEST

start of errorfile[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for 'errorformat'.  This will fail if the quickfix feature was disabled.[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 15 lines, 225 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[19;1H[?12l[?25h
[?25l[22;1H[K[22;1H:so! Xdotest[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/start of errorfile/,/end of errorfile/w! Xerrorfile[?25l"Xerrorfile" [22;14H[K[22;14H[New File] 13 lines, 447 characters written[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/start of testfile/,/end of testfile/w! Xtestfile[?25l"Xtestfile" [22;13H[K[22;13H[New File] 23 lines, 853 characters written[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hcf Xerrorfile[?25l"Xtestfile" [22;13H[K[22;13H23 lines, 853 characters
(2 of 13): 1506-045 (S) Undeclared identifier fd_set.
[32mPress ENTER or type command to continue[?12l[?25h[m[1;1H[2L[?25l[1;1Hstart of testfile
line 2  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 4  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[5;39H[K[6;1Hline 6  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[6;39H[K[7;1Hline 7  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 8  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 9  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 10 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 11 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 12 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 13 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 14 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 15 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 16 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 17 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[17;39H[K[18;1Hline 18 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 19 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 20 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 21 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[22;1H[K[4;12H[?12l[?25h[?25lA[?12l[?25h[5;12H[?25l[22;1H:[?12l[?25hcn[?25l(3 of 13): this is an error[7;19H[?12l[?25h[?25lB[?12l[?25h[8;19H[?25l[22;1H[K[22;1H:[?12l[?25hcn[?25l(5 of 13): parse error before `asd'[13;1H[?12l[?25h[?25lC[?12l[?25h
[?25l[22;1H[K[22;1H:[?12l[?25hcn[?25l(7 of 13): there is an error[16;1H[?12l[?25h[?25lD[?12l[?25h
[?25l[22;1H[K[22;1H:[?12l[?25hcn[?25l(10 of 13): yet another problem[19;1H[?12l[?25h[?25lE[?12l[?25h
[?25l[22;1H[K[22;1H:[?12l[?25hw! test.out             " Write contents of this file[?25l"test.out" [22;12H[K[22;12H[New File] 23 lines, 853 characters written[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test11.failed test.ok test.out X* viminfo
cp test11.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test11.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test11.in" 78 lines, 3040 characters[1;1HTests for autocommands:
- FileWritePre[10Cwriting a compressed file
- FileReadPost[10Creading a compressed file
- BufNewFile[12Creading a file template
- BufReadPre[12Cdecompressing the file to be read
- FilterReadPre[9Csubstituting characters in the temp file
- FilterReadPost[8Csubstituting characters after filtering
- FileReadPre[11Cset options for decompression
- FileReadPost[10Cdecompress the file

Note: This test will fail if "gzip" is not available.
$GZIP is made empty, "-v" would cause trouble.
Use a FileChangedShell autocommand to avoid a prompt for "Xtestfile.gz" being
modified outside of Vim (noticed on Solaris).

STARTTEST
:so small.vim
:let $GZIP = ""
:au FileChangedShell * echo "caught FileChangedShell"
:set bin
:au FileWritePre    *.gz   '[,']!gzip[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for autocommands:[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[16;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[17;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 42 lines, 1973 characters written[17;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[17;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[27m[m[H[2J[1;1H:au! FileReadPre    *.gz   !gzip -d <afile>
:au  FileReadPre    *.gz   call rename(expand("<afile>:r"), expand("<afile>"))
:au! FileReadPost   *.gz   '[,']s/l/L/
:$r Xtestfile.gz[13C" Read compressed file
:w[27C" write it, after filtering
:au![13C" remove all autocommands
:e[15C" Edit test.out again
:set nobin ff&   " use the default fileformat for writing
:w
:qa!
ENDTEST

startstart
start of testfile
line 2  Abcdefghijklmnopqrstuvwxyz
line 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 4  Abcdefghijklmnopqrstuvwxyz
line 5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 6  Abcdefghijklmnopqrstuvwxyz
line 7  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 8  Abcdefghijklmnopqrstuvwxyz[11;1H[?12l[?25h
[?25l[22;1H:so! Xdotest[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hlet $GZIP = ""[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hau FileChangedShell * echo "caught FileChangedShell"[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset bin[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hau FileWritePre    *.gz   '[,']!gzip[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hau FileWritePost   *.gz   undo[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^start of testfile/,/^end of testfile/w! Xtestfile.gz[?25l[?12l[?25h[?25l11 lines filtered[22;18H[K[22;1H
"Xtestfile.gz" [New File][Incomplete last line] 1 line, 111 characters written
10 more lines; before #1  0 seconds ago
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hau FileReadPost    *.gz   '[,']!gzip -d[?25l[1;1H[3L[1;1H:$r Xtestfile.gz[13C" Read compressed file
:w[27C" write it, after filtering
:au![13C" remove all autocommands
:e               " Edit test.out again[4;39H[K[5;2Hset nobin ff&   " use the default fileformat for writing
:w[6;3H[K[7;2Hqa![7;18H[K[8;1HENDTEST[8;8H[K[9;1H[K[10;1Hstartstart
start of testfile
line 2  Abcdefghijklmnopqrstuvwxyz
line 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 4  Abcdefghijklmnopqrstuvwxyz[15;6H5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[16;6H6  Abcdefghijklmnopqrstuvwxyz[16;35H[K[17;6H7  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[18;6H8  Abcdefghijklmnopqrstuvwxyz[18;35H[K[19;6H9  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[20;6H10 Abcdefghijklmnopqrstuvwxyz[20;35H[K[21;1Hend of testfile[21;16H[K[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h$r Xtestfile.gz                " Read and decompress the testfile[?25l"Xtestfile.gz" [22;16H[K[22;16H[Incomplete last line] 1 line, 111 characters[?12l[?25h[60C[?25l[1;21r[1;1H[7M[1;22r[16;1Hstart of test.c
/*
 * Here is a new .c file
 */
end of test.c
start of testfile[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h?startstart?,$w! test.out      " Write contents of this file[?25l"test.out" [22;12H[K[22;12H[New File] 29 lines, 788 characters written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hau BufNewFile      *.c    read Xtest.c[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^start of test.c/+1,/^end of test.c/-1w! Xtest.c[?25l[31msearch hit BOTTOM, continuing at TOP[m[22;37H[K[22;1H"Xtest.c" [22;11H[K[22;11H[New File] 3 lines, 32 characters written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! foo.c                       " Will load Xtest.c[?25l"foo.c" [New File][22;33H[K[22;1H
"Xtest.c" 3 lines, 32 characters
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hau FileAppendPre   *.out  '[,']s/new/NEW/[?25l[1;1H[2L[2;1H/*
 * Here is a new .c file
 */[4;4H[K[5;1H[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [m[22;1H[K[2;1H[?12l[?25h[?25l[22;1H:[?12l[?25hau FileAppendPost  *.out  !cat Xtest.c >>test.out[?25l[2;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw>>test.out                    " Append it to the output file[?25l"test.out" [22;12H[K[22;12H4 lines, 33 characters appended
:!cat Xtest.c >>test.out
[?12l[?25h[m
[32mPress ENTER or type command to continue[?25l[m[22;1H[K[22;1H:[?12l[?25hau! FileAppendPre[?25l[27m[m[H[2J[2;1H/*
 * Here is a NEW .c file
 */
[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [3;2H[?12l[?25h[?25l[22;1H[m:[?12l[?25h" setup autocommands to decompress before reading and re-compress afterwards[?25l[3;2H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hau BufReadPre      *.gz   !gzip -d <afile>[?25l[3;2H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hau BufReadPre      *.gz   call rename(expand("<afile>:r"), expand("<afile>"))[?25l[3;2H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hau BufReadPost     *.gz   call rename(expand("<afile>"), expand("<afile>:r"))[?25l[3;2H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hau BufReadPost     *.gz   !gzip <afile>:r[?25l[3;2H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! Xtestfile.gz                " Edit compressed file[?25l:!gzip -d Xtestfile.gz[22;33H[K[22;23H
[?12l[?25h[?25l[m"Xtestfile.gz"[21;1H"Xtestfile.gz" 11 lines, 357 characters[22;1H[K[22;1H:!gzip Xtestfile
[?12l[?25h[m
[32mPress ENTER or type command to continue[?25l[m[22;1H[K[22;1H:[?12l[?25hw>>test.out                    " Append it to the output file[?25l"test.out" [22;12H[K[22;12H11 lines, 357 characters appended
:!cat Xtest.c >>test.out
[?12l[?25h[m
[32mPress ENTER or type command to continue[?25l[m[22;1H[K[22;1H:[?12l[?25hset shelltemp                  " need temp files here[?25l[27m[m[H[2J[1;1Hstart of testfile
line 2  Abcdefghijklmnopqrstuvwxyz
line 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 4  Abcdefghijklmnopqrstuvwxyz
line 5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 6  Abcdefghijklmnopqrstuvwxyz
line 7  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 8  Abcdefghijklmnopqrstuvwxyz
line 9  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 10 Abcdefghijklmnopqrstuvwxyz
end of testfile
[1m[34m~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[22;1H[m:[?12l[?25hau FilterReadPre   *.out  call rename(expand("<afile>"), expand("<afile>").".t
[21;80H"[22;1H)[?25l[1;1H[L[1;1Hstart of testfile[22;1H[K[1;1H[?12l[?25h[?25l[22;1H:[?12l[?25hau FilterReadPre   *.out  !sed s/e/E/ <afile>.t ><afile>[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hau FilterReadPre   *.out  !rm <afile>.t[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hau FilterReadPost  *.out  '[,']s/x/X/g[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! test.out                    " Edit the output file[?25l"test.out" [22;12H[K[22;12H50 lines, 1242 characters[1;6Hstar[1;11H[K[2;1Hstart of testfile[2;18H[K[3;6H2  Abcdefghijklmnopqrstuvwxyz[3;35H[K[4;6H3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[5;6H4  Abcdefghijklmnopqrstuvwxyz[5;35H[K[6;6H5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[7;6H6  Abcdefghijklmnopqrstuvwxyz[7;35H[K[8;6H7  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[9;6H8  Abcdefghijklmnopqrstuvwxyz[9;35H[K[10;6H9  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 10 Abcdefghijklmnopqrstuvwxyz
end of testfile[12;16H[K[13;1H[K[14;1Hstart of test.c[14;16H[K[15;1H/*[15;3H[K[16;1H * Here is a new .c file[16;25H[K[17;1H */[17;4H[K[18;1Hend of test.c[18;14H[K[19;1Hstart of testfile[19;18H[K[20;1Hline 2  Abcdefghijklmnopqrstuvwxyz[20;35H[K[21;1Hline 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[21;39H[K[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h23,$!cat[?25l[?12l[?25h[?25l:!sed s/e/E/ /tmp/v449378/1.t >/tmp/v449378/1
[?12l[?25h[?25l[m:!rm /tmp/v449378/1.t
[?12l[?25h[?25l[m218 substitutions on 15 lines
28 lines filtered
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25h23,$s/\r$//                 " remove CR for when sed adds them[?25l[1m[37m[41mE486: Pattern not found: \r$[m[22;30H[K[22;1H
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hau! FileReadPre    *.gz   !gzip -d <afile>[?25l[27m[m[H[2J[1;1Hline 2  Abcdefghijklmnopqrstuvwxyz
line 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 4  Abcdefghijklmnopqrstuvwxyz
line 5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 6  Abcdefghijklmnopqrstuvwxyz
line 7  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 8  Abcdefghijklmnopqrstuvwxyz
line 9  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 10 Abcdefghijklmnopqrstuvwxyz
end of testfile

start of test.c
/*
 * Here is a new .c file
 */
end of test.c
start of testfile
line 2  Abcdefghijklmnopqrstuvwxyz
line 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 4  Abcdefghijklmnopqrstuvwxyz
linE 5  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX[?12l[?25h[?25l
:[?12l[?25hau  FileReadPre    *.gz   call rename(expand("<afile>:r"), expand("<afile>"))[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hau! FileReadPost   *.gz   '[,']s/l/L/[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$r Xtestfile.gz             " Read compressed file[?25l:!gzip -d Xtestfile.gz[22;30H[K[22;23H
[?12l[?25h[?25l[m"Xtestfile.gz"[21;1H"Xtestfile.gz" 11 lines, 357 characters[22;1H[K[22;1H11 substitutions on 11 lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw                           " write it, after filtering[?25l"test.out"[22;30H[K[22;12H61 lines, 1599 characters written
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hau!             " remove all autocommands[?25l[1m[37m[41mE216: No such group or event: " remove all autocommands[m
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25he               " Edit test.out again[?25l"test.out"[22;18H[K[22;12H61 lines, 1599 characters[27m[m[H[2J[1;1Hstartstart
start of testfile
line 2  Abcdefghijklmnopqrstuvwxyz
line 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 4  Abcdefghijklmnopqrstuvwxyz
line 5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 6  Abcdefghijklmnopqrstuvwxyz
line 7  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 8  Abcdefghijklmnopqrstuvwxyz
line 9  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 10 Abcdefghijklmnopqrstuvwxyz
end of testfile

start of test.c
/*
 * Here is a new .c file
 */
end of test.c
start of testfile
line 2  Abcdefghijklmnopqrstuvwxyz
line 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
"test.out" 61 lines, 1599 characters[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset nobin ff&   " use the default fileformat for writing[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw[?25l"test.out" 61 lines, 1599 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test12.failed test.ok test.out X* viminfo
cp test12.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test12.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test12.in" 52 lines, 1199 characters[1;1HTests for 'directory' option.
- ".", in same dir as file
- "./dir", in directory relative to file
- "dir", in directory relative to current dir

STARTTEST
:so small.vim
:set nocompatible viminfo+=nviminfo
:set dir=.,~
:/start of testfile/,/end of testfile/w! Xtest1
:" do an ls of the current dir to find the swap file (should not be there)
:if has("unix")
:  !ls .X*.swp >test.out
:else
:  r !ls X*.swp >test.out
:endif
:!echo first line >>test.out
:e Xtest1
:if has("unix")
:" Do an ls of the current dir to find the swap file, remove the leading dot
:" to make the result the same for all systems.[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for 'directory' option.[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[6;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[7;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 40 lines, 965 characters written[7;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[7;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[27m[m[H[2J[1;1H:e Xtest1
:!ls X*.swp >>test.out
:!echo under under >>test.out
:!ls Xtest2 >>test.out
:!echo under Xtest1.swp >>test.out
:!mkdir Xtest.je
:/start of testfile/,/end of testfile/w! Xtest2/Xtest3
:set dir=Xtest.je,~
:e Xtest2/Xtest3
:swap
:!ls Xtest2 >>test.out
:!echo under Xtest3 >>test.out
:!ls Xtest.je >>test.out
:!echo under Xtest3.swp >>test.out
:qa!
ENDTEST

start of testfile
line 2 Abcdefghij
line 3 Abcdefghij
end of testfile[16;1H[?12l[?25h
[?25l[22;1H:so! Xdotest[17;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[17;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset nocompatible viminfo+=nviminfo[?25l[17;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset dir=.,~[?25l[17;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/start of testfile/,/end of testfile/w! Xtest1[?25l"Xtest1" [22;10H[K[22;10H[New] 4L, 70C written[17;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" do an ls of the current dir to find the swap file (should not be there)[?25l[17;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hif has("unix")[?25l
:  [?12l[?25h:  !ls .X*.swp >test.out
[?25l:!ls .X*.swp >test.out[?1l>[?12l[?25h[?1049l
ls: cannot access .X*.swp: No such file or directory

shell returned 2

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:  :[?12l[?25helse
[?25l:  [?12l[?25h:  r !ls X*.swp >test.out
[?25l:  [?12l[?25h:endif[?25l[22;1H[K[22;1H:[?12l[?25h!echo first line >>test.out[?25l[28C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H:[?12l[?25he Xtest1[?25l"Xtest1" 4L, 70C[27m[m[H[2J[1;1Hstart of testfile
line 2 Abcdefghij
line 3 Abcdefghij
end of testfile
[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [m[22;1H"Xtest1" 4L, 70C[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hif has("unix")[?25l
:  [?12l[?25h:" Do an ls of the current dir to find the swap file, remove the leading dot
[?25l:  [?12l[?25h:" to make the result the same for all systems.
[?25l:  [?12l[?25h:  r!ls .X*.swp[m
[?25l:  [?12l[?25h:  s/\.*X/X/
[?25l:  [?12l[?25h:  .w >>test.out[?25l"test.out" [22;12H[K[22;12H1L, 11C appended
:  [?12l[?25h:  undo
[?25l1 line less; before #1  0 seconds ago
:  [?12l[?25h:else
[?25l:  [?12l[?25h:  !ls X*.swp >>test.out
[?25l:  [?12l[?25h:endif[27m[m[H[2J[?25l[1;1Hstart of testfile
line 2 Abcdefghij
line 3 Abcdefghij
end of testfile
[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[22;1H[m:[?12l[?25h!echo under Xtest1.swp >>test.out[?25l[34C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H:[?12l[?25h!mkdir Xtest2[?25l[14C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H:[?12l[?25hset dir=./Xtest2,.,~[?25l[27m[m[H[2J[1;1Hstart of testfile
line 2 Abcdefghij
line 3 Abcdefghij
end of testfile
[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[22;1H[m:[?12l[?25he Xtest1[?25l"Xtest1" 4L, 70C[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h!ls X*.swp >>test.out[?25l[22C[?1l>[?12l[?25h[?1049l
ls: cannot access X*.swp: No such file or directory

shell returned 2

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H:[?12l[?25h!echo under under >>test.out[?25l[29C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H:[?12l[?25h!ls Xtest2 >>test.out[?25l[22C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H:[?12l[?25h!echo under Xtest1.swp >>test.out[?25l[34C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H:[?12l[?25h!mkdir Xtest.je[?25l[16C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H:[?12l[?25h/start of testfile/,/end of testfile/w! Xtest2/Xtest3[?25l[31msearch hit BOTTOM, continuing at TOP[m[22;37H[K[22;1H"Xtest2/Xtest3" [22;17H[K[22;17H[New] 4L, 70C written[27m[m[H[2J[1;1Hstart of testfile
line 2 Abcdefghij
line 3 Abcdefghij
end of testfile
[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [m[22;1H"Xtest2/Xtest3" [New] 4L, 70C written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset dir=Xtest.je,~[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he Xtest2/Xtest3[?25l"Xtest2/Xtest3" 4L, 70C[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hswap[?25lXtest.je/Xtest3.swp[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h!ls Xtest2 >>test.out[?25l[22C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H:[?12l[?25h!echo under Xtest3 >>test.out[?25l[30C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H:[?12l[?25h!ls Xtest.je >>test.out[?25l[24C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H:[?12l[?25h!echo under Xtest3.swp >>test.out[?25l[34C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[?1l>[?12l[?25h[?1049l
rm -rf X* test.ok viminfo
rm -rf test13.failed test.ok test.out X* viminfo
cp test13.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test13.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test13.in" 58 lines, 1133 characters[1;1HTests for autocommands on :close command

Write three files and open them, each in a window.
Then go to next window, with autocommand that deletes the previous one.
Do this twice, writing the file.

Also test deleting the buffer on a Unload event.  If this goes wrong there
will be the ATTENTION prompt.

Also test changing buffers in a BufDel autocommand.  If this goes wrong there
are ml_line errors and/or a Crash.

STARTTEST
:so small.vim
:/^start of testfile/,/^end of testfile/w! Xtestje1
:/^start of testfile/,/^end of testfile/w! Xtestje2
:/^start of testfile/,/^end of testfile/w! Xtestje3
:e Xtestje1
otestje1[34m^[[m
:w
:sp Xtestje2[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for autocommands on :close command[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[13;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[14;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 38 lines, 631 characters written[14;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[14;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[27m[m[H[2J[1;1H:e Xtestje3
:w >>test.out
:e Xtestje2
:sp Xtestje1
:e
:w >>test.out
:au!
:only
:e Xtestje1
:bwipe Xtestje2 Xtestje3 test.out test13.in
:au BufWipeout Xtestje1 buf Xtestje1
:bwipe
:w >>test.out
:qa!
ENDTEST

start of testfile[18;9Hcontents[19;9Hcontents[20;9Hcontents
end of testfile[15;1H[?12l[?25h
[?25l[22;1H:so! Xdotest[16;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[16;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^start of testfile/,/^end of testfile/w! Xtestje1[?25l"Xtestje1" [22;13H[K[22;12H[New File] 5 lines, 64 characters written[16;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^start of testfile/,/^end of testfile/w! Xtestje2[?25l"Xtestje2" [22;13H[K[22;12H[New File] 5 lines, 64 characters written[16;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^start of testfile/,/^end of testfile/w! Xtestje3[?25l"Xtestje3" [22;13H[K[22;12H[New File] 5 lines, 64 characters written[16;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he Xtestje1[?25l"Xtestje1" 5 lines, 64 characters[1;1Hstart of testfile
        contents
        contents
        contents
end of testfile
[1m[34m~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[2;21r[m[2;1H[L[1;22r[2;1Htestje1[22;1H[K[2;7H[?12l[?25h[3;8H[?25l[22;1H:[?12l[?25hw[?25l"Xtestje1" 6 lines, 72 characters written[3;8H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hsp Xtestje2[?25l"Xtestje2" [22;12H[K[22;12H5 lines, 64 characters[2;1H        contents


end of testfile[5;16H[K[6;1H[1m[34m~                                                                               [m[11;1H[1m[7mXtestje2                                                                        [m[12;1Htestje1[12;8H[K[13;1H        contents[13;17H[K[14;1H        contents[14;17H[K[15;1H        contents[15;17H[K[16;1Hend of testfile[16;16H[K[21;1H[7mXtestje1                                                                        [1;1H[?12l[?25h[?25l[2;10r[m[2;1H[L[1;22r[2;1Htestje2[11;10H[1m[7m[+][m[22;1H[K[2;7H[?12l[?25h[3;8H[?25l[22;1H:[?12l[?25hw[?25l"Xtestje2" 6 lines, 72 characters written[11;10H[1m[7m    [3;8H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hsp Xtestje3[?25l"Xtestje3" [22;12H[K[22;12H5 lines, 64 characters[27m[m[H[2J[1;1Hstart of testfile[2;9Hcontents[3;9Hcontents[4;9Hcontents
end of testfile
[1m[34m~                                                                               [m[7;1H[1m[7mXtestje3                                                                        [m[8;1Htestje2[9;9Hcontents[10;9Hcontents[11;9Hcontents
end of testfile
[1m[34m~                                                                               [m[14;1H[7mXtestje2                                                                        [m[15;9Hcontents[16;9Hcontents[17;9Hcontents
end of testfile
[1m[34m~                                                                               [20;1H~                                                                               [m[21;1H[7mXtestje1                                                                        [1;1H[?12l[?25h[?25l[2;6r[m[2;1H[L[1;22r[2;1Htestje3[7;10H[1m[7m[+][2;7H[?12l[?25h[3;8H[?25l[22;1H[m:[?12l[?25hw[?25l"Xtestje3" 6 lines, 72 characters written[7;10H[1m[7m    [3;8H[?12l[?25h[m[7;1H[7mXtestje3                                                                        [m[14;1H[1m[7mXtestje2                                                                        [9;8H[10;8H[?25l[m[22;1H[K[22;1H:[?12l[?25hau WinLeave Xtestje2 bwipe[?25l[10;8H[?12l[?25h[27m[m[H[2J[?25l[1;1Hstart of testfile
testje3[3;9Hcontents[4;9Hcontents[5;9Hcontents
end of testfile
[1m[34m~                                                                               [8;1H~                                                                               [9;1H~                                                                               [m[10;1H[7mXtestje3                                                                        [m[11;1Htestje1[12;9Hcontents[13;9Hcontents[14;9Hcontents
end of testfile
[1m[34m~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [m[21;1H[1m[7mXtestje1                                                                        [12;8H[?12l[?25h[13;8H[?25l[22;1H[m:[?12l[?25hw! test.out[?25l"test.out" [22;12H[K[22;12H[New File] 6 lines, 72 characters written[13;8H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hau WinLeave Xtestje1 bwipe Xtestje3[?25l[13;8H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hclose[?25l[2;7H1[10;1H[1m[34m~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [21;1H~                                                                               [4;8H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw >>test.out[?25l"test.out" [22;12H[K[22;12H6 lines, 72 characters appended[4;8H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he Xtestje1[?25l"Xtestje1" 6 lines, 72 characters[4;9H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hbwipe Xtestje2 Xtestje3 test.out[?25l[1m[37m[41mE94: No matching buffer for Xtestje2 Xtestje3 test.out[4;9H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hau![?25l[4;9H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hau! BufUnload Xtestje1 bwipe[?25l[4;9H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he Xtestje3[?25l"Xtestje3" 6 lines, 72 characters[2;7H3[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>test.out[?25l"test.out" [22;12H[K[22;12H6 lines, 72 characters appended[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he Xtestje2[?25l"Xtestje2" 6 lines, 72 characters[2;7H2[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hsp Xtestje1[?25l"Xtestje1" [22;12H[K[22;12H6 lines, 72 characters[2;7H1[11;1H[1m[7mXtestje1                                                                        [m[12;1Hstart of testfile[12;18H[K[13;1Htestje2[13;8H[K[14;1H        contents[14;17H[K[15;1H        contents[15;17H[K[16;1H        contents[16;17H[K[17;1Hend of testfile[17;16H[K[21;1H[7mXtestje2                                                                        [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25he[?25l[1m[37m[41mE143: Autocommands unexpectedly deleted new buffer Xtestje1[m[2;7H2[11;1H[1m[34m~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw >>test.out[?25l"test.out" [22;12H[K[22;12H6 lines, 72 characters appended[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hau![?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25honly[?25lAlready only one window[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he Xtestje1[?25l"Xtestje1" 6 lines, 72 characters[2;7H1[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hbwipe Xtestje2 Xtestje3 test.out test13.in[?25l4 buffers wiped out[22;20H[K[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hau BufWipeout Xtestje1 buf Xtestje1[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hbwipe[?25l"Xtestje1" 6 lines, 72 characters[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>test.out[?25l"test.out" [22;12H[K[22;12H6 lines, 72 characters appended[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test14.failed test.ok test.out X* viminfo
cp test14.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test14.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test14.in" 65 lines, 1012 characters[1;1HTests for "vaBiB", end could be wrong.
Also test ":s/pat/sub/" with different ~s in sub.
Also test for ^Vxff and ^Vo123 in Insert mode.
Also test "[m", "]m", "[M" and "]M"

STARTTEST
:so small.vim
/Start cursor here
vaBiBD:?Bug?,/Piece/-2w! test.out
/^- Bug
:s/u/~u~/
:s/i/~u~/
:s/o/~~~/
:.w >>test.out
:if has("ebcdic")
: let tt = "o\<C-V>193\<C-V>xc2\<C-V>o303 \<C-V>90a\<C-V>xfg\<C-V>o578\<Esc>"
:else
: let tt = "o\<C-V>65\<C-V>x42\<C-V>o103 \<C-V>33a\<C-V>xfg\<C-V>o78\<Esc>"
:endif
:exe "normal " . tt
:.w >>test.out[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for "vaBiB", end could be wrong.[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[6;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[7;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 30 lines, 613 characters written[7;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[7;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[27m[m[H[2J[1;1H[maD[34m^[[m:.w >>test.out
k2[maE[34m^[[m:.w >>test.out
3[maF[34m^[[m:.w >>test.out
]MaG[34m^[[m:.w >>test.out
j2]MaH[34m^[[m:.w >>test.out
]M]MaI[34m^[[m:.w >>test.out
2[MaJ[34m^[[m:.w >>test.out
k[MaK[34m^[[m:.w >>test.out
3[MaL[34m^[[m:.w >>test.out
:qa!
ENDTEST

- Bug in "vPPPP" on this text (Webb):[14;9H{[15;17Hcmd;[16;17H{[17;25Hcmd;    /* <-- Start cursor here */[18;25H{[19;25H}[20;17H}[21;9H}[11;1H[?12l[?25h
[?25l[22;1H:so! Xdotest[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25hStart cursor here[?25l[17;40H[?12l[?25h[?25l[?12l[?25h[?25l[16;17H[7m{ 
                        cmd;    /* <-- Start cursor here */ 
                        { 
                        } 
                [?12l[?25h[?25l[15;1H                cmd; 
                [20;17H}[?12l[?25h[?25l[m

6 fewer lines[22;15H[K[15;1H        }[15;10H[K[16;1H[K[17;1HPiece of Java[17;14H[K[18;1H{[18;2H[K[19;1H        tt m1 {[19;16H[K[20;1H                t1;[21;11He1[15;9H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h?Bug?,/Piece/-2w! test.out[?25l"test.out" [22;12H[K[22;12H[New File] 3 lines, 44 characters written[15;9H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h^- Bug[?25l[31msearch hit BOTTOM, continuing at TOP[13;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hs/u/~u~/[?25l[13;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hs/i/~u~/[?25l[13;7Huuun "vPPPP" on this text (Webb):[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hs/o/~~~/[?25l[13;20Huuuuuuuuun this text (Webb):[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 48 characters appended[13;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hif has("ebcdic")[?25l
:  [?12l[?25h: let tt = "o\<C-V>193\<C-V>xc2\<C-V>o303 \<C-V>90a\<C-V>xfg\<C-V>o578\<Esc>
[21;80H"[22;1H
[?25l:  [?12l[?25h:else
[?25l:  [?12l[?25h: let tt = "o\<C-V>65\<C-V>x42\<C-V>o103 \<C-V>33a\<C-V>xfg\<C-V>o78\<Esc>"
[?25l:  [?12l[?25h:endif[1;1H[5L[?25l[1;1H[maD[34m^[[m:.w >>test.out
k2[maE[34m^[[m:.w >>test.out
3[maF[34m^[[m:.w >>test.out
]MaG[34m^[[m:.w >>test.out
j2]MaH[34m^[[m:.w >>test.out[22;1H[K[13;1H[?12l[?25h[?25l[22;1H:[?12l[?25hexe "normal " . tt[?25l[14;21r[14;1H[L[1;22r[14;1HABC !a[34m^O[mg[34m^G[m8[22;1H[K[14;12H[?12l[?25h[?25l[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 11 characters appended[14;12H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset vb[?25l[14;12H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h^Piece[?25l[18;1H[?12l[?25h[20;15H[?25l{A[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 10 characters appended[20;16H[?12l[?25h[21;16H[?25l[1;21r[1;1H[3M[1;22r[19;9H} e1[21;9Htt m2 {[22;1H[K[21;15H[?12l[?25h[?25l{B[?12l[?25h[?25l
:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 10 characters appended[21;16H[?12l[?25h[?25l[1;21r[1;1H[4M[1;22r[18;17Ht2;[19;9H} e2[21;9Htt m3 {[22;1H[K[21;15H[?12l[?25h[?25l{C[?12l[?25h[?25l
:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 10 characters appended[21;16H[?12l[?25h[?25l{DC[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 11 characters appended[21;16H[?12l[?25h[20;1H[13;15H[?25l{EA[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 11 characters appended[13;16H[?12l[?25h[12;1H[?25l{F[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 3 characters appended[12;2H[?12l[?25h[15;9H[?25l}G e1[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 7 characters appended[15;10H[?12l[?25h
[?25l[1;21r[1;1H[5M[1;22r[17;17Hif (x)[18;17H{[19;25Ht3;[20;17H}[21;9H} e3[22;1H[K[21;9H[?12l[?25h[?25l}H e3[?12l[?25h[?25l
:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 7 characters appended[21;10H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H}[22;1H[K[21;1H[?12l[?25h[?5h[?5l[?25l}I[?12l[?25h[?25l
:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 3 characters appended[21;2H[?12l[?25h[20;9H[?25l}JH e3[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 8 characters appended[20;10H[?12l[?25h[19;16H[13;9H[?25l}K e2[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 7 characters appended[13;10H[?12l[?25h[6;1H[?25l{LF[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 4 characters appended[6;2H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test15.failed test.ok test.out X* viminfo
cp test15.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test15.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test15.in" 136 lines, 2246 characters[1;1HTests for :right on text with embedded TAB.
Also test formatting a paragraph.
Also test undo after ":%s" and formatting.

STARTTEST
:so small.vim
:set tw=65

:/^\s*test for :left/,/^\s*test for :center/ left
:/^\s*test for :center/,/^\s*test for :right/ center
:/^\s*test for :right/,/^xxx/-1 right
:set fo+=tcroql tw=72
/xxxxxxxx$
0gq6kk
:set nocp viminfo+=nviminfo
:" undo/redo here to make the next undo only work on the following changes
u[34m^R[m
:map gg :.,.+2s/^/x/<CR>kk:set tw=3<CR>gqq
/^aa
ggu
:?test for :left?,$w! test.out[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for :right on text with embedded TAB.[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[5;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[6;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 17 lines, 401 characters written[6;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[6;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[1;21r[1;1H[2M[1;22r[20;1H:qa!
ENDTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset tw=65[?25l[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;9Htest for :left[22;1H[K[21;8H[?12l[?25h[?25l
:[?12l[?25h/^\s*test for :left/,/^\s*test for :center/ left[?25l[31msearch hit BOTTOM, continuing at TOP[m[22;37H[K[21;1Htest for :left[21;15H[K[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^\s*test for :center/,/^\s*test for :right/ center[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^\s*test for :right/,/^xxx/-1 right[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fo+=tcroql tw=72[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25hxxxxxxxx$[?25l[27m[m[H[2J[1;47Ha[9Caxxxoikey[2;46Hfa[9Caxxxoikey[3;45Hdfa[9Caxxxoikey[4;44Hsdfa[9Caxxxoikey[5;43Hasdfa[9Caxxxoikey[6;42Hxasdfa[9Caxxxoikey[7;41Hasxxdfa[9Caxxxoikey[8;40Hasxa;ofa[9Caxxxoikey[9;39Hasdfaqwer[9Caxxxoikey

xxxxx xx xxxxxx
xxxxxxx xxxxxxxxx xxx xxxx xxxxx xxxxx xxx xx
xxxxxxxxxxxxxxxxxx xxxxx xxxx, xxxx xxxx xxxx xxxx xxx xx xx
xx xxxxxxx. xxxx xxxx.

> xx xx, xxxx xxxx xxx xxxx xxx xxxxx xxx xxx xxxxxxx xxx xxxxx
> xxxxxx xxxxxxx: xxxx xxxxxxx, xx xxxxxx xxxx xxxxxxxxxx

aa aa aa aa
bb bb bb bb
cc cc cc cc[17;50H[?12l[?25h[?25l[11;21r[21;1H
[1;22r[11;6H xx xxxxxx xxxxxxx xxxxxxxxx xxx xxxx xxxxx xxxxx xxx xx[12;62Hxx xxxxxxx.
xxxx xxxx.[13;11H[K[15;65Hxxxxxx[16;9Hx: xxxx xxxxxxx, xx xxxx[7C xxxxxxx[16;51H[K[21;1H[1m[34m~                                                                               [16;1H[?12l[?25h[15;1H
[?25l[22;1H[m:[?12l[?25hset nocp viminfo+=nviminfo[?25l[16;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" undo/redo here to make the next undo only work on the following changes[?25l[16;1H[?12l[?25h[?25l[22;1H1 more line; before #1  0 seconds ago[22;38H[K[27m[m[H[2J[1;1H:set nocp viminfo+=nviminfo
:" undo/redo here to make the next undo only work on the following changes
u[34m^R[m
:map gg :.,.+2s/^/x/<CR>kk:set tw=3<CR>gqq
/^aa
ggu
:?test for :left?,$w! test.out
:qa!
ENDTEST[11;9Htest for :left[12;11Ha[13Ca[13;13Hfa[10Ca[14;11Hdfa[11Ca[15;17Hsdfa[12Ca[16;11Hasdfa[9Ca[17;17Hxasdfa[10Ca
asxxdfa[9Ca[20;9Htest for :center[21;11Ha[13Ca[11;8H[?12l[?25h[?25l[22;1H1 line less; after #1  0 seconds ago[11;1Htest for :left[11;15H[K[12;1Ha[9C      a[12;25H[K[13;1Hfa[10C    a[13;25H[K[14;1Hdfa[7C      a[14;25H[K[15;1Hsdfa[12Ca[15;18H[K[16;1Hasdfa           a[16;25H[K[17;1Hxasdfa[10Ca[17;18H[K[20;9H                test for :center[21;11H [13C a[14Ca[11;1H[?12l[?25h
[?25l[22;1H[K[22;1H:[?12l[?25hmap gg :.,.+2s/^/x/<CR>kk:set tw=3<CR>gqq[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h^aa[?25l[27m[m[H[2J[1;39Hasdfaqwer[9Caxxxoike[2;47Ha[9Caxxxoikey[3;46Hfa[9Caxxxoikey[4;45Hdfa[9Caxxxoikey[5;44Hsdfa[9Caxxxoikey[6;43Hasdfa[9Caxxxoikey[7;42Hxasdfa[9Caxxxoikey[8;41Hasxxdfa[9Caxxxoikey[9;40Hasxa;ofa[9Caxxxoikey[10;39Hasdfaqwer[9Caxxxoikey

xxxxx xx xxxxxx xxxxxxx xxxxxxxxx xxx xxxx xxxxx xxxxx xxx xx
xxxxxxxxxxxxxxxxxx xxxxx xxxx, xxxx xxxx xxxx xxxx xxx xx xx xx xxxxxxx.
xxxx xxxx.

> xx xx, xxxx xxxx xxx xxxx xxx xxxxx xxx xxx xxxxxxx xxx xxxxx xxxxxx
> xxxxxxx: xxxx xxxxxxx, xx xxxxxx xxxx xxxxxxxxxx

aa aa aa aa
bb bb bb bb
cc cc cc cc[19;1H[?12l[?25h[?25l


:.,.+2s/^/x/3 substitutions on 3 lines[19;1Hxaa aa aa aa
xbb bb bb bb
xcc cc cc cc[?12l[?25h[20;1H[19;1H[?25l[22;1H[K[22;1H:set tw=3[19;1H[?12l[?25h[?25l


3 more lines[1;21r[21;1H
[1;22r[18;5H[K[19;1Haa[19;3H[K[20;1Haa[20;3H[K[21;1Haa[22;1H[K[22;1H3 more lines[21;1H[?12l[?25h[?25l
3 fewer lines; before #2  0 seconds ago[18;1Haa aa aa aa
bb bb bb bb
cc cc cc cc
[1m[34m~                                                                               [18;1H[?12l[?25h
[?25l[m[22;1H[K[22;1H:[?12l[?25h?test for :left?,$w! test.out[?25l"test.out"[22;12H[K[22;12H[New] 111L, 2304C written[19;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test17.failed test.ok test.out X* viminfo
cp test17.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test17.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test17.in" 27 lines, 368 characters[1;1HTests for "gf" on ${VAR}

STARTTEST
:so small.vim
:if has("ebcdic")
: set isfname=@,240-249,/,.,-,_,+,,,$,:,~,{,}
:else
: set isfname=@,48-57,/,.,-,_,+,,,$,:,~,{,}
:endif
:if has("unix")
:let $CDIR = "."
/CDIR
:else
:if has("amiga")
:let $TDIR = "/testdir"
:else
:let $TDIR = "."
:endif
/TDIR
:endif
gf[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for "gf" on ${VAR}[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 20 lines, 285 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[1;21r[1;1H[3M[1;22r[19;1H:w! test.out
:qa!
ENDTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hif has("ebcdic")[?25l
:  [?12l[?25h: set isfname=@,240-249,/,.,-,_,+,,,$,:,~,{,}
[?25l:  [?12l[?25h:else
[?25l:  [?12l[?25h: set isfname=@,48-57,/,.,-,_,+,,,$,:,~,{,}
[?25l:  [?12l[?25h:endif[1;1H[4L[?25l[1;1H:if has("ebcdic")
: set isfname=@,240-249,/,.,-,_,+,,,$,:,~,{,}
:else
: set isfname=@,48-57,/,.,-,_,+,,,$,:,~,{,}[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25hif has("unix")[?25l
:  [?12l[?25h:let $CDIR = "."
[?25l:  [?12l[?25h/CDIR
[?25l:  [?12l[?25h:else
[?25l:  [?12l[?25h:if has("amiga")
[?25l:    [?12l[?25h:let $TDIR = "/testdir"
[?25l:    [?12l[?25h:else
[?25l:    [?12l[?25h:let $TDIR = "."
[?25l:    [?12l[?25h:endif
[?25l:  [?12l[?25h/TDIR
[?25l:  [?12l[?25h:endif[1;1H[10L[?25l[1;1H: set isfname=@,240-249,/,.,-,_,+,,,$,:,~,{,}
:else
: set isfname=@,48-57,/,.,-,_,+,,,$,:,~,{,}
:endif
:if has("unix")
:let $CDIR = "."
/CDIR
:else
:if has("amiga")
:let $TDIR = "/testdir"
:else[11;6H[K[12;2Hlet $TDIR = "."
:endif[13;7H[K[14;1H/TDIR[14;6H[K[15;1H:endif
gf[16;3H[K[17;1H:w! test.out
:qa![18;5H[K[19;1HENDTEST[20;1H[K[21;9H${CDIR}/test17a.in[22;1H[K[21;9H[?12l[?25h[?25l
"/sources/vim71/src/testdir/./test17a.in" 3 lines, 88 characters[1;1HThis file is just to test "gf" in test 17.[1;43H[K[2;1HThe contents is not importent.
Just testing![3;14H[K[4;1H[1m[34m~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h
[?25l[m[22;1H[K[22;1H:[?12l[?25hw! test.out[?25l"test.out" [22;12H[K[22;12H[New File] 3 lines, 88 characters written[2;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test18.failed test.ok test.out X* viminfo
cp test18.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test18.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test18.in" 16 lines, 213 characters[1;1HTests for not doing smart indenting when it isn't set.

STARTTEST
:so small.vim
:set nocin nosi ai
/some
2cc#test[34m^[[m
:?start?,$w! test.out
:qa!
ENDTEST

start text[13;17Hsome test text[14;17Htest text
test text[16;17Htest text
[1m[34m~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for not doing smart indenting when it isn't set.[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 6 lines, 76 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[10;1H[?12l[?25h
[?25l[22;1H[K[22;1H:so! Xdotest[11;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[11;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset nocin nosi ai[?25l[11;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25hsome[?25l[13;17H[?12l[?25h[?25l[13;21r[21;1H
[1;22r[13;17H#test[13;22H[K[21;1H[1m[34m~                                                                               [m[22;1H[K[13;21H[?12l[?25h[14;9H[?25l[22;1H:[?12l[?25h?start?,$w! test.out[?25l"test.out" [22;12H[K[22;12H[New File] 4 lines, 41 characters written[14;9H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test19.failed test.ok test.out X* viminfo
cp test19.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test19.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test19.in" 23 lines, 374 characters[1;1HTests for "r<Tab>" with 'smarttab' and 'expandtab' set/not set.

STARTTEST
:set smarttab expandtab ts=8 sw=4
/some
r[7C:set noexpandtab
/other
r
:" Test replacing with Tabs and then backspacing to undo it
0wR[21C[34m^H^H^H^[[m
:" Test replacing with Tabs
0wR[21C[34m^[[m
:?^start?,$w! test.out
:qa!
ENDTEST

start text[18;17Hsome test text
test text[20;17Hother test text
    a cde[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for "r<Tab>" with 'smarttab' and 'expandtab' set/not set.[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 11 lines, 204 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[15;1H[?12l[?25h
[?25l[22;1H[K[22;1H:so! Xdotest[16;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset smarttab expandtab ts=8 sw=4[?25l[16;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25hsome[?25l[18;17H[?12l[?25h[?25l    ome test text[18;20H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset noexpandtab[?25l[18;20H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25hother[?25l[20;17H[?12l[?25h[?25l    ther test text[20;20H[?12l[?25h[21;9H[?25l[22;1H[K[22;1H:[?12l[?25h" Test replacing with Tabs and then backspacing to undo it[?25l[21;9H[?12l[?25h    [?25l[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;5Hf ghi[22;1H[K[21;4H[?12l[?25h[?25l
:[?12l[?25h" Test replacing with Tabs[?25l[21;4H[?12l[?25h    [?25l     [7Chi[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Htest text[22;1H[K[21;9H[?12l[?25h[?25l
:[?12l[?25h?^start?,$w! test.out[?25l"test.out" [22;12H[K[22;12H[New File] 7 lines, 91 characters written[21;9H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test20.failed test.ok test.out X* viminfo
cp test20.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test20.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test20.in" 22 lines, 361 characters[1;1HTests Blockwise Visual when there are TABs before the text.
First test for undo working properly when executing commands from a register.
Also test this in an empty buffer.

STARTTEST
:so tiny.vim
G0"ay$k@au
:new
@auY:quit!
GP
/start here$
[34m^V[mjjlld
:/here$/,$-1w! test.out
:qa!
ENDTEST

test text test tex start here[18;17Hsome text[19;17Htest text
test text[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests Blockwise Visual when there are TABs before the text.[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[5;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[6;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 9 lines, 92 characters written[6;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[6;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[15;1H[?12l[?25h
[?25l[22;1H[K[22;1H:so! Xdotest[16;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso tiny.vim[?25l[16;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1HOx[34m^[[mjAy[34m^[[mkdd[22;1H[K[21;1H[?12l[?25h[20;1H[?25lx[21;1H[K[20;1H[?12l[?25h
[?25ly[?12l[?25h[20;1H[?25ly
Ox[34m^[[mjAy[34m^[[mkdd[20;1H[?12l[?25h[?25l

2 changes; before #1  0 seconds ago[20;1H[K[20;1H[?12l[?25h
[?25l[22;1H[K[22;1H:[?12l[?25hnew[?25l[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [m[11;1H[1m[7m[No Name]                                                                       [m[12;2Hqa![12;5H[K[13;1HENDTEST[14;1H[K[15;1Htest text test tex start here
                some text[16;26H[K[17;17Htest
test text[18;17H[K[19;1H[K[20;1HOx[34m^[[mjAy[34m^[[mkdd
[7mtest20.in                                                                       [1;1H[?12l[?25h[?25l[1;10r[m[1;1H[L[1;22r[1;1Hx[11;11H[1m[7m[+][m[22;1H[K[1;1H[?12l[?25h
[?25ly[?12l[?25h[1;1H[?25l[1;10r[10;1H
[1;22r[10;1H[1m[34m~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H1 line less; before #1  0 seconds ago[1;1H[K[11;11H[1m[7m    [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hquit![?25l[1;1HFirst test for undo working properly when executing commands from a register.
Also test this in an empty buffer.[2;35H[K[3;1H[K[4;1HSTARTTEST[4;10H[K[5;1H:so tiny.vim[5;13H[K[6;1HG0"ay$k@au[6;11H[K[7;1H:new[7;5H[K[8;1H@auY:quit![8;11H[K[9;1HGP[9;3H[K[10;1H/start here$[10;13H[K[11;1H[34m^V[mjjlld[11;8H[K[12;2H/here$/,$-1w! test.out
:qa![13;5H[K[14;1HENDTEST[15;1H[K[16;1Htest text test tex start here[17;17Hsome
         [7Ctest text
test text[20;1H[K[21;1HOx[34m^[[mjAy[34m^[[mkdd[21;13H[K[21;1H[?12l[?25h[?25l[21;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1HOx[34m^[[mjAy[34m^[[mkdd[22;1H[K[21;1H[?12l[?25h[?25l
/[?12l[?25hstart here$[?25l[31msearch hit BOTTOM, continuing at TOP[15;20H[?12l[?25h[?25l[?12l[?25h[?25l[m[7ms[16;20H[?12l[?25h[?25le[17;20H[?12l[?25h[?25l[15;21Ht[16;21H [17;20Ht[?12l[?25h[?25l[15;22Ha[16;22Ht[17;21H [?12l[?25h[?25l[m[15;20Hrt here[15;27H[K[16;20Hext[16;23H[K[17;20Hex[17;23H[K[15;20H[?12l[?25h[16;20H[?25l[22;1H[K[22;1H:[?12l[?25h/here$/,$-1w! test.out[?25l[31msearch hit BOTTOM, continuing at TOP[m"test.out" [22;12H[K[22;12H[New File] 6 lines, 57 characters written[16;20H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test21.failed test.ok test.out X* viminfo
cp test21.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test21.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test21.in" 19 lines, 297 characters[1;1HTests for [ CTRL-I with a count and CTRL-W CTRL-I with a count

STARTTEST
:so small.vim
/start
6[      :.w! test.out
?start here
6[34m^W[m     :.w >>test.out
:qa!
ENDTEST

#include test21.in

/* test text test tex start here[15;17Hsome text[16;17Htest text[17;17Hstart OK if found this line[18;9Hstart found wrong line
test text
[1m[34m~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for [ CTRL-I with a count and CTRL-W CTRL-I with a count[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 6 lines, 73 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[10;1H[?12l[?25h
[?25l[22;1H[K[22;1H:so! Xdotest[11;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[11;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25hstart[?25l[14;23H[?12l[?25h[17;17H[?25l[22;1H[K[22;1H:[?12l[?25h.w! test.out[?25l"test.out" [22;12H[K[22;12H[New File] 1 line, 30 characters written[17;17H[?12l[?25h[?25l[22;1H[K[22;1H?[?12l[?25hstart here[?25l[14;23H[?12l[?25h[?25l[1;1H/* test text test tex start here[1;33H[K[2;17Hsome text
         [7Ctest text
                start OK if found this line
        start found wrong line
test text[6;10H[K[7;1H[1m[34m~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [m[11;1H[1m[7mtest21.in                                                                       [m[12;1H:qa![12;5H[K[13;1HENDTEST[14;1H[K[15;1H#include test21.in[15;19H[K[16;17H[K[17;1H/* test text test tex start here[17;33H[K[18;9H        some text[18;27H[K[19;1H         [7Ctest text
                start OK if found this line[20;44H[K[21;1H[7mtest21.in                                                                       [4;17H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 30 characters appended[4;17H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test22.failed test.ok test.out X* viminfo
cp test22.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test22.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test22.in" 13 lines, 197 characters[1;1HTests for file with some lines ending in CTRL-M, some not[34m^M
^M[m
STARTTEST
:set ta tx
:e!
:$-3,$w! test.out
:qa!
ENDTEST

this lines ends in a[34m^M[m
this one doesn't
this one does[34m^M[m
and the last one doesn't
[1m[34m~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for file with some lines ending in CTRL-M, some not[34m^M[m[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 4 lines, 38 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[8;1H[?12l[?25h
[?25l[22;1H[K[22;1H:so! Xdotest[9;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset ta tx[?25l[9;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he![?25l"test22.in" 13 lines, 197 characters[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$-3,$w! test.out[?25l"test.out" [22;12H[K[22;12H[New File] 4 lines, 79 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test23.failed test.ok test.out X* viminfo
cp test23.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test23.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test23.in" 15 lines, 282 characters[1;1HTests for complicated + argument to :edit command

STARTTEST
:$-1w! Xfile1
:$w! Xfile2
:edit +1|s/|/PIPE/|w Xfile1| e Xfile2|1 | s/\//SLASH/|w
:w! test.out
:e Xfile1
:w >> test.out
:qa!
ENDTEST

The result should be in Xfile1: "fooPIPEbar", in Xfile2: "fooSLASHbar"
foo|bar
foo/bar
[1m[34m~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for complicated + argument to :edit command[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 7 lines, 125 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[11;1H[?12l[?25h
[?25l[22;1H[K[22;1H:so! Xdotest[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$-1w! Xfile1[?25l"Xfile1" [22;10H[K[22;10H[New File] 1 line, 8 characters written[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$w! Xfile2[?25l"Xfile2" [22;10H[K[22;10H[New File] 1 line, 8 characters written[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hedit +1|s/|/PIPE/|w Xfile1| e Xfile2|1 | s/\//SLASH/|w[?25l"Xfile1" [22;10H[K[22;10H1 line, 8 characters
foo|bar
"Xfile1" 1 line, 11 characters written
"Xfile2" 1 line, 8 characters
foo/bar
"Xfile2" 1 line, 12 characters written
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw! test.out[?25l"test.out" [22;12H[K[22;12H[New File] 1 line, 12 characters written
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25he Xfile1[?25l"Xfile1" 1 line, 11 characters[1;1H[7L[1;1HfooPIPEbar
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [m[22;1H[K[22;1H"Xfile1" 1 line, 11 characters[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >> test.out[?25l"test.out" [22;12H[K[22;12H1 line, 11 characters appended[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test24.failed test.ok test.out X* viminfo
cp test24.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test24.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test24.in" 79 lines, 1240 characters[1;1HTests for regexp with backslash and other special characters inside []
Also test backslash for hex/octal numbered character.

STARTTEST
:set nocompatible viminfo+=nviminfo
/[\x]
x/[\t\]]
x/[]y]
x/[\]]
x/[y^]
x/[$y]
x/[\x61]
x/[\x60-\x64]
xj0/[\x785]
x/[\o143]
x/[\o140-\o144]
x/[\o417]
x/\%x42
x/\%o103
x/[\x00]
x[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for regexp with backslash and other special characters inside [][22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[4;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 44 lines, 480 characters written[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[5;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[27m[m[H[2J[2;1H:s/\(foo\)\@<!bar/A/

:s/\(an\_s\+\)\@<=file/A/

:s/^\(\h\w*\%(->\|\.\)\=\)\+=/XX/

:s/^\(\h\w*\%(->\|\.\)\=\)\+=/YY/
:?start?,$w! test.out
:qa!
ENDTEST

start
test \text test text
test    text test text
test text ]test text
test ]text test text
test text te^st text
test te$xt test text
test taext test text  x61
test tbext test text  x60-x64[11;1H[?12l[?25h
[?25l[22;1H:so! Xdotest[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset nocompatible viminfo+=nviminfo[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h[\x][?25l[14;6H[?12l[?25h[?25ltext test text[14;20H[K[14;6H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h[\t\]][?25l[15;8H[?12l[?25h[?25ltext test tex[15;20H[K[15;6H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h[]y][?25l[16;11H[?12l[?25h[?25ltest text[16;20H[K[16;11H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h[\]][?25l[17;6H[?12l[?25h[?25ltext test text[17;20H[K[17;6H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h[y^][?25l[18;13H[?12l[?25h[?25lst text[18;20H[K[18;13H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h[$y][?25l[19;8H[?12l[?25h[?25lxt test text[19;20H[K[19;8H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h[\x61][?25l[20;7H[?12l[?25h[?25lext test text  x61[20;25H[K[20;7H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h[\x60-\x64][?25l[21;7H[?12l[?25h[?25lext test text  x60-x64[21;29H[K[21;7H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Htest 5text test text  x78 5[22;1H[K[21;7H[?12l[?25h[?25l
/[?12l[?25h[\x785][?25l[21;6H[?12l[?25h[?25ltext test text  x78 5[21;27H[K[21;6H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h[\o143][?25l[1;21r[21;1H
[1;22r[21;1Htestc text test text  o143[22;1H[K[21;5H[?12l[?25h[?25l text test text  o143[21;26H[K[21;5H[?12l[?25h[?25l
/[?12l[?25h[\o140-\o144][?25l[1;21r[21;1H
[1;22r[21;1Htesdt text test text  o140-o144[22;1H[K[21;4H[?12l[?25h[?25lt text test text  o140-o14[21;31H[K[21;4H[?12l[?25h[?25l
/[?12l[?25h[\o417][?25l[1;21r[21;1H
[1;22r[21;1Htest7 text test text  o41 7[22;1H[K[21;5H[?12l[?25h[?25l text test text  o41 7[21;27H[K[21;5H[?12l[?25h[?25l
/[?12l[?25h\%x42[?25l[1;21r[21;1H
[1;22r[21;1Htest text tBest text  \%x42[22;1H[K[21;12H[?12l[?25h[?25lest text  \%x42[21;27H[K[21;12H[?12l[?25h[?25l
/[?12l[?25h\%o103[?25l[1;21r[21;1H
[1;22r[21;1Htest text teCst text  \%o103[22;1H[K[21;13H[?12l[?25h[?25lst text  \%o103[21;28H[K[21;13H[?12l[?25h[?25l
/[?12l[?25h[\x00][?25l[1;21r[21;1H
[1;22r[21;1Htest text [34m^@[mtest text  [\x00][22;1H[K[21;11H[?12l[?25h[?25ltest text  [\x00][21;28H[K[21;11H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Htest te[34m^@[mxt t[34m^D[mest t[34m^P[mext  [\x00-\x10][21;11H[?12l[?25h[?25l
:[?12l[?25hs/[\x00-\x10]//g[?25l3 substitutions on 1 line[21;8Hxt test text  [\x00-\x10][21;33H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Htest \xyztext test text  [\x-z][22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25hs/[\x-z]\+//[?25l[21;6Htext test text  [\x-z][21;28H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Htest text tev\uyst text  [\u-z][22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25hs/[\u-z]\{2,}//[?25l[21;13Hst text  [\u-z][21;28H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hxx aaaaa xx a[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25hs/\(a\)\+//[?25l[21;4H xx [21;10H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hxx aaaaa xx a[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25hs/\(a*\)\+//[?25l[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hxx aaaaa xx a[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25hs/\(a*\)*//[?25l[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hxx aaaaa xx[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25hs/\(a\)\{2,3}/A/[?25l[21;4HAaa xx[21;10H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hxx aaaaa xx[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25hs/\(a\)\{-2,3}/A/[?25l[21;4HAaaa x[21;11H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hxx aaa12aa xx[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25hs/\(a\)*\(12\)\@>/A/[?25l[21;4HAaa xx[21;10H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hxx foobar xbar xx[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25hs/\(foo\)\@<!bar/A/[?25l[21;12HA xx[21;16H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hxx an file xx[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25hs/\(an\_s\+\)\@<=file/A/[?25l[21;7HA xx[21;12H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hx= 9;[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25hs/^\(\h\w*\%(->\|\.\)\=\)\+=/XX/[?25l[21;1HXX[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hhh= 77;[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25hs/^\(\h\w*\%(->\|\.\)\=\)\+=/YY/[?25l[21;1HYY 77;[21;7H[K[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h?start?,$w! test.out[?25l"test.out" [22;12H[K[22;12H[New] 29L, 571C written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test25.failed test.ok test.out X* viminfo
cp test25.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test25.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test25.in" 31 lines, 840 characters[1;1HTest for jumping to a tag with 'hidden' set, with symbolic link in path of tag.
This only works for Unix, because of the symbolic link.

STARTTEST
:so small.vim
:set hidden
:" Create a link from test25.dir to the current directory.
:!rm -f test25.dir
:!ln -s . test25.dir
:" Create tags.text, with the current directory name inserted.
/tags line
:r !pwd
d$/test
hP:.w! tags.test
:" Try jumping to a tag in the current file, but with a path that contains a
:" symbolic link.  When wrong, this will give the ATTENTION message.  The next
:" space will then be eaten by hit-return, instead of moving the cursor to 'd'.
:set tags=tags.test
G[34m^][m x:.w! test.out
:!rm -f test25.dir tags.test
:qa![1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for jumping to a tag with 'hidden' set, with symbolic link in path of tag.[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[4;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 17 lines, 540 characters written[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[5;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[1;21r[21;1H
[1;22r[21;1HENDTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset hidden[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" Create a link from test25.dir to the current directory.[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h!rm -f test25.dir[?25l[18C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H:[?12l[?25h!ln -s . test25.dir[?25l[20C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H:[?12l[?25h" Create tags.text, with the current directory name inserted.[?25l[27m[m[H[2J[2;1HSTARTTEST
:so small.vim
:set hidden
:" Create a link from test25.dir to the current directory.
:!rm -f test25.dir
:!ln -s . test25.dir
:" Create tags.text, with the current directory name inserted.
/tags line
:r !pwd
d$/test
hP:.w! tags.test
:" Try jumping to a tag in the current file, but with a path that contains a
:" symbolic link.  When wrong, this will give the ATTENTION message.  The next
:" space will then be eaten by hit-return, instead of moving the cursor to 'd'.
:set tags=tags.test
G[34m^][m x:.w! test.out
:!rm -f test25.dir tags.test
:qa!
ENDTEST
[?12l[?25h[?25l
/[?12l[?25htags line[?25l[1;1HSTARTTEST
:so small.vim
:set hidden[3;12H[K[4;2H" Create a link from test25.dir to the current directory.
:!rm -f test25.dir[5;19H[K[6;3Hln -s . test25.dir
:" Create tags.text, with the current directory name inserted.
/tags line[8;11H[K[9;1H:r !pwd[9;8H[K[10;1Hd$/test
hP:.w! tags.test
:" Try jumping to a tag in the current file, but with a path that contains a
:" symbolic link.  When wrong, this will give the ATTENTION message.  The next
:" space will then be eaten by hit-return, instead of moving the cursor to 'd'.
:set tags=tags.test[15;20H[K[16;1HG[34m^][m x:.w! test.out[16;19H[K[17;1H:!rm -f test25.dir tags.test
:qa![18;6H[K[19;1HENDTEST[20;1H[K[21;1Htags line:[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hr !pwd[?25l[?12l[?25h[27m[m[H[2J[?25l[1;1H:so small.vim
:set hidden
:" Create a link from test25.dir to the current directory.
:!rm -f test25.dir
:!ln -s . test25.dir
:" Create tags.text, with the current directory name inserted.
/tags line
:r !pwd
d$/test
hP:.w! tags.test
:" Try jumping to a tag in the current file, but with a path that contains a
:" symbolic link.  When wrong, this will give the ATTENTION message.  The next
:" space will then be eaten by hit-return, instead of moving the cursor to 'd'.
:set tags=tags.test
G[34m^][m x:.w! test.out
:!rm -f test25.dir tags.test
:qa!
ENDTEST

tags line:
/sources/vim71/src/testdir[?12l[?25h[?25l[21;1H[K[21;1H[?12l[?25h[?25l
/[?12l[?25htest[?25l[1;21r[21;1H
[1;22r[21;1HSECTION_OFF     /test25.dir/test25.in   /^#define  SECTION_OFF  3$/[22;1H[K[21;18H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[20;18Hsources/vim71/src/testdir/test25.dir/test25.in /^#define  SECTII[21;1HON_OFF  3$/[20;42H[?12l[?25h[?25l

:[?12l[?25h.w! tags.test[?25l"tags.test" [22;13H[K[22;13H[New File] 1 line, 88 characters written[20;42H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" Try jumping to a tag in the current file, but with a path that contains a[?25l[20;42H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" symbolic link.  When wrong, this will give the ATTENTION message.  The next[?25l[20;42H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" space will then be eaten by hit-return, instead of moving the cursor to 'd'.[?25l[20;42H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset tags=tags.test[?25l[20;42H[?12l[?25h[?25l[1;21r[1;1H[6M[1;22r[17;1H/*tx.c*/
#define  SECTION_OFF  3
#define  NUM_SECTIONS 3

SECTION_OFF[22;1H[K[21;1H[?12l[?25h[18;1H#[?25lefine  SECTION_OFF  3[18;23H[K[18;2H[?12l[?25h[?25l[22;1H:[?12l[?25h.w! test.out[?25l"test.out" [22;12H[K[22;12H[New File] 1 line, 23 characters written[18;2H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h!rm -f test25.dir tags.test[?25l[28C[?1l>[?12l[?25h[?1049l
[No write since last change]

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[?1l>[?12l[?25h[?1049l
rm -rf X* test.ok viminfo
rm -rf test26.failed test.ok test.out X* viminfo
cp test26.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test26.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test26.in" 43 lines, 739 characters[1;1HTest for :execute, :while and :if

STARTTEST
:so small.vim
mt:let i = 0
:while i < 12
:  let i = i + 1
:  if has("ebcdic")
:    execute "normal o" . i . "\047"
:  else
:    execute "normal o" . i . "\033"
:  endif
:  if i % 2
:    normal Ax[34m^V^[[m
:    if i == 9
:      break
:    endif
:    if i == 5
:      continue
:    else
:      let j = 9[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for :execute, :while and :if[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 38 lines, 685 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[27m[m[H[2J[1;1H:[8Cif has("ebcdic")
:[10Cexecute "normal" j . "a" . j . "\x27"
:[8Celse
:[10Cexecute "normal" j . "a" . j . "\x1b"
:[8Cendif
:[8Clet j = j - 1
:      endwhile
:    endif
:  endif
:  if i == 9
:    if has("ebcdic")
:      execute "normal Az\047"
:    else
:      execute "normal Az\033"
:    endif
:  endif
:endwhile
:'t,$w! test.out
:qa!
ENDTEST[?12l[?25h
[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hlet i = 0[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hwhile i < 12[?25l
:  [?12l[?25h:  let i = i + 1
[?25l:  [?12l[?25h:  if has("ebcdic")
[?25l:    [?12l[?25h:    execute "normal o" . i . "\047"
[?25l:    [?12l[?25h:  else
[?25l:    [?12l[?25h:    execute "normal o" . i . "\033"
[?25l:    [?12l[?25h:  endif
[?25l:  [?12l[?25h:  if i % 2
[?25l:    [?12l[?25h:    normal Ax^[34m^[[m
[?25l:    [?12l[?25h:    if i == 9
[?25l:      [?12l[?25h:      break
[?25l:      [?12l[?25h:    endif
[?25l:    [?12l[?25h:    if i == 5
[?25l:      [?12l[?25h:      continue
[?25l:      [?12l[?25h:    else
[?25l:      [?12l[?25h:      let j = 9
[?25l:      [?12l[?25h:      while j > 0
[?25l:[8C[?12l[?25h:        if has("ebcdic")
[?25l:[10C[?12l[?25h:          execute "normal" j . "a" . j . "\x27"
[?25l:[10C[?12l[?25h:        else
[?25l:[10C[?12l[?25h:          execute "normal" j . "a" . j . "\x1b"
[?25l:[10C[?12l[?25h:        endif
[?25l:[8C[?12l[?25h:        let j = j - 1
[?25l:[8C[?12l[?25h:      endwhile
[?25l:      [?12l[?25h:    endif
[?25l:    [?12l[?25h:  endif
[?25l:  [?12l[?25h:  if i == 9
[?25l:    [?12l[?25h:    if has("ebcdic")
[?25l:      [?12l[?25h:      execute "normal Az\047"
[?25l:      [?12l[?25h:    else
[?25l:      [?12l[?25h:      execute "normal Az\033"
[?25l:      [?12l[?25h:    endif
[?25l:    [?12l[?25h:  endif
[?25l:  [?12l[?25h:endwhile[27m[m[H[2J[?25l[1;1H:  if i == 9
:    if has("ebcdic")
:      execute "normal Az\047"
:    else
:      execute "normal Az\033"
:    endif
:  endif
:endwhile
:'t,$w! test.out
:qa!
ENDTEST

1x999999999888888887777777666666555554444333221
2
3x999999999888888887777777666666555554444333221
4
5x
6
7x999999999888888887777777666666555554444333221
8
9x[?12l[?25h[?25l
:[?12l[?25h't,$w! test.out[?25l"test.out" [22;12H[K[22;12H[New File] 10 lines, 159 characters written[21;2H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test27.failed test.ok test.out X* viminfo
cp test27.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test27.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test27.in" 20 lines, 270 characters[1;1HTest for expanding file names

STARTTEST
:!mkdir Xdir1
:!mkdir Xdir2
:!mkdir Xdir3
:cd Xdir3
:!mkdir Xdir4
:cd ..
:w Xdir1/file
:w Xdir3/Xdir4/file
:n Xdir?/*/file
Go[34m^R[m%[34m^[[m:.w! test.out
:n! Xdir?/*/nofile
Go[34m^R[m%[34m^[[m:.w >>test.out
:e! xx
:!rm -rf Xdir1 Xdir2 Xdir3
:qa!
ENDTEST

[1m[34m~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for expanding file names[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 15 lines, 220 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[19;1H[?12l[?25h
[?25l[22;1H[K[22;1H:so! Xdotest[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h!mkdir Xdir1[?25l[13C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H:[?12l[?25h!mkdir Xdir2[?25l[13C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H:[?12l[?25h!mkdir Xdir3[?25l[13C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H:[?12l[?25hcd Xdir3[?25l/sources/vim71/src/testdir/Xdir3[27m[m[H[2J[1;1HTest for expanding file names

STARTTEST
:!mkdir Xdir1
:!mkdir Xdir2
:!mkdir Xdir3
:cd Xdir3
:!mkdir Xdir4
:cd ..
:w Xdir1/file
:w Xdir3/Xdir4/file
:n Xdir?/*/file
Go[34m^R[m%[34m^[[m:.w! test.out
:n! Xdir?/*/nofile
Go[34m^R[m%[34m^[[m:.w >>test.out
:e! xx
:!rm -rf Xdir1 Xdir2 Xdir3
:qa!
ENDTEST

[1m[34m~                                                                               [20;1H[?12l[?25h[?25l

[m:[?12l[?25h!mkdir Xdir4[?25l[13C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H:[?12l[?25hcd ..[?25l/sources/vim71/src/testdir[27m[m[H[2J[1;1HTest for expanding file names

STARTTEST
:!mkdir Xdir1
:!mkdir Xdir2
:!mkdir Xdir3
:cd Xdir3
:!mkdir Xdir4
:cd ..
:w Xdir1/file
:w Xdir3/Xdir4/file
:n Xdir?/*/file
Go[34m^R[m%[34m^[[m:.w! test.out
:n! Xdir?/*/nofile
Go[34m^R[m%[34m^[[m:.w >>test.out
:e! xx
:!rm -rf Xdir1 Xdir2 Xdir3
:qa!
ENDTEST

[1m[34m~                                                                               [20;1H[?12l[?25h[?25l

[m:[?12l[?25hw Xdir1/file[?25l"Xdir1/file" [New File] 20 lines, 270 characters written[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw Xdir3/Xdir4/file[?25l"Xdir3/Xdir4/file" [New File] 20 lines, 270 characters written[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hn Xdir?/*/file[?25l"Xdir3/Xdir4/file" 20 lines, 270 characters[1;1H[?12l[?25h[20;1H[?25l
Xdir3/Xdir4/file[21;17H[K[21;16H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w! test.out[?25l"test.out" [22;12H[K[22;12H[New File] 1 line, 17 characters written[21;16H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hn! Xdir?/*/nofile[?25l"Xdir?/*/nofile" [New DIRECTORY][1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m
Xdir?/*/nofile[2;15H[K[2;14H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 15 characters appended[2;14H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! xx[?25l"xx" [New File][2;1H[1m[34m~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25h!rm -rf Xdir1 Xdir2 Xdir3[?25l[26C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[?1l>[?12l[?25h[?1049l
rm -rf X* test.ok viminfo
rm -rf test28.failed test.ok test.out X* viminfo
cp test28.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test28.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test28.in" 23 lines, 364 characters[1;1HTest for sourcing a file with CTRL-V's at the end of the line

STARTTEST
:/firstline/+1,/lastline/-1w! Xtestfile
:so Xtestfile
Gmm__1[34m^[^[[m__2[34m^[[m__3[34m^[^[[m__4[34m^[[m__5[34m^[[m:'m,$s/[34m^@[m/0/g
:'m,$w! test.out
:qa!
ENDTEST

firstline
map __1 afirst
map __2 asecond
map __3 athird
map __4 afourth
map __5 afifth
map __1 asd[34m^V[m
map __2 asd[34m^V^V[m
map __3 asd[34m^V^V[m
map __4 asd[34m^V^V^V[m
map __5 asd[34m^V^V^V[1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for sourcing a file with CTRL-V's at the end of the line[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 5 lines, 114 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[9;1H[?12l[?25h
[?25l[22;1H[K[22;1H:so! Xdotest[10;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/firstline/+1,/lastline/-1w! Xtestfile[?25l"Xtestfile" [22;13H[K[22;13H[New File] 10 lines, 148 characters written[10;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso Xtestfile[?25l[10;1H[?12l[?25h[?25l[1;21r[1;1H[2M[1;22r[20;1Hlastline[22;1H[K[21;1H[?12l[?25h[11C[?25l[1;21r[21;1H
[1;22r[20;1Hsd
map __2 asd[34m^[[?12l[?25h[?25l[m[2Csecond[?12l[?25hd  [?25lsd[34m^[[?12l[?25h^[[m  [13C[?25l[21;24Hsd[34m^@[mmap __5 asd[34m^@[?12l[?25h[?25l[m[2Cfifth[?12l[?25h[?25l
:[?12l[?25h'm,$s/[34m^@[m/0/g[?25l[21;26H0map __5 asd0fifth[21;44H[K[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h'm,$w! test.out[?25l"test.out" [22;12H[K[22;12H[New File] 2 lines, 45 characters written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test29.failed test.ok test.out X* viminfo
cp test29.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test29.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test29.in" 67 lines, 663 characters[1;1HTest for joining lines with 'joinspaces' set or not

STARTTEST
:set nojoinspaces
/firstline/
jJjJjJjJjJjJjJjJjJjJjJjJjJjJ:set joinspaces
jJjJjJjJjJjJjJjJjJjJjJjJjJjJ:?firstline?+1,$w! test.out
:qa!
ENDTEST

firstline
asdfasdf.
asdf
asdfasdf.
asdf
asdfasdf.
asdf
asdfasdf.
asdf
asdfasdf.
asdf[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for joining lines with 'joinspaces' set or not[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 5 lines, 135 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[9;1H[?12l[?25h
[?25l[22;1H[K[22;1H:so! Xdotest[10;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset nojoinspaces[?25l[10;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25hfirstline/[?25l[22;11H[K[22;1H[11;1H[?12l[?25h
[?25l[12;21r[21;1H
[1;22r[12;5Hasdf. asdf[21;1Hasdfasdf.[22;1H[K[12;10H[?12l[?25h[13;10H[?25l[13;21r[21;1H
[1;22r[13;5Hasdf. asdf[21;1Hasdf[13;11H[?12l[?25h[14;11H[?25l[14;21r[21;1H
[1;22r[14;5Hasdf.  asdf[21;1Hasdfasdf.[14;12H[?12l[?25h[15;16H[?25l[15;21r[21;1H
[1;22r[15;5Hasdf.[7Casdf[21;1Hasdf[15;17H[?12l[?25h[16;16H[?25l[16;21r[21;1H
[1;22r[16;5Hasdf.[7Casdf[21;1Hasdfasdf[16;17H[?12l[?25h[17;17H[?25l[17;21r[21;1H
[1;22r[17;5Hasdf.[8Casdf[21;1Hasdf[17;18H[?12l[?25h[18;24H[?25l[18;21r[21;1H
[1;22r[18;5Hasdf.[15Casdf


asdfasdf[18;25H[?12l[?25h[19;8H[?25lf asdf
asdfasdf[21;5H[K[19;9H[?12l[?25h[20;9H[?25l asdf
asdfasdf[20;10H[?12l[?25h[21;10H[?25l asdf[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hasdfasdf[7C[?12l[?25h[?25l asdf[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hasdfasdf[8C[?12l[?25h[?25l asdf[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hasdfasdf[7C[?12l[?25h[?25l asdf[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hasdfasdf[15C[?12l[?25h[?25l asdf[?12l[?25h[?25l
:[?12l[?25hset joinspaces[?25l[21;25H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hasdfasdf.[22;1H[K[21;9H[?12l[?25h[?25l.  asdf[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hasdfasdf.[?12l[?25h[?25l  asdf[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hasdfasdf. [?12l[?25h[?25l asdf[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hasdfasdf.      [?12l[?25h[?25l asdf[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hasdfasdf.      [?12l[?25h[?25l asdf[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hasdfasdf.[7C[?12l[?25h[?25l asdf[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hasdfasdf.[14C[?12l[?25h[?25l asdf[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hasdfasdf[?12l[?25h[?25lf asdf[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hasdfasdf[?12l[?25h[?25l asdf[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hasdfasdf [?12l[?25h[?25l asdf[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hasdfasdf[7C[?12l[?25h[?25l asdf[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hasdfasdf[8C[?12l[?25h[?25l asdf[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hasdfasdf[7C[?12l[?25h[?25l asdf[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hasdfasdf[15C[?12l[?25h[?25l asdf[?12l[?25h[?25l
:[?12l[?25h?firstline?+1,$w! test.out[?25l"test.out" [22;12H[K[22;12H[New File] 28 lines, 424 characters written[21;25H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test30.failed test.ok test.out X* viminfo
cp test30.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test30.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test30.in" 208 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option

STARTTEST
:so small.vim
:" first write three test files, one in each format
:set fileformat=unix
:set fileformats=
:/^1/w! XX1
:/^2/w! XX2
:/^3/w! XX3
:/^4/w! XX4
:/^5/w! XX5
:/^6/w! XX6
:/^7/w! XX7
:/^8/w! XX8
:/^9/w! XX9
:/^10/w! XX10
:/^unix/;/eof/-1w! XXUnix
:/^dos/;/eof/-1w! XXDos
:set bin noeol
:$w! XXMac[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for a lot of variations of the 'fileformats' option[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 183 lines, 2957 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[27m[m[H[2J[1;1H:$r XXtt63
Go7[34m^[[m:$r XXtt71
Go8[34m^[[m:$r XXtt81
Go9[34m^[[m:$r XXtt91
:$r XXtt92
:$r XXtt93
Go10[34m^[[m:$r XXUnix
:set nobinary ff&
:w
:qa!
ENDTEST

1
2
3
4
5
6
7
8
9[11;1H[?12l[?25h
[?25l[22;1H:so! Xdotest[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" first write three test files, one in each format[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fileformat=unix[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fileformats=[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^1/w! XX1[?25l"XX1" [22;7H[K[22;7H[New File] 1 line, 2 characters written[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^2/w! XX2[?25l"XX2" [22;7H[K[22;7H[New File] 1 line, 2 characters written[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^3/w! XX3[?25l"XX3" [22;7H[K[22;7H[New File] 1 line, 2 characters written[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^4/w! XX4[?25l"XX4" [22;7H[K[22;7H[New File] 1 line, 2 characters written[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^5/w! XX5[?25l"XX5" [22;7H[K[22;7H[New File] 1 line, 2 characters written[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^6/w! XX6[?25l"XX6" [22;7H[K[22;7H[New File] 1 line, 2 characters written[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^7/w! XX7[?25l"XX7" [22;7H[K[22;7H[New File] 1 line, 2 characters written[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^8/w! XX8[?25l"XX8" [22;7H[K[22;7H[New File] 1 line, 2 characters written[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^9/w! XX9[?25l"XX9" [22;7H[K[22;7H[New File] 1 line, 2 characters written[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^10/w! XX10[?25l"XX10" [22;8H[K[22;8H[New File] 1 line, 3 characters written[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^unix/;/eof/-1w! XXUnix[?25l"XXUnix" [22;10H[K[22;10H[New File] 2 lines, 10 characters written[1;21r[1;1H[3M[1;22r[19;1H10

unix[22;1H[K[22;1H"XXUnix" [New File] 2 lines, 10 characters written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^dos/;/eof/-1w! XXDos[?25l"XXDos" [22;9H[K[22;9H[New File] 2 lines, 10 characters written[1;21r[1;1H[4M[1;22r[18;1Hunix
eof

dos[34m^M[m[22;1H[K[22;1H"XXDos" [New File] 2 lines, 10 characters written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset bin noeol[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$w! XXMac[?25l"XXMac" [22;9H[K[22;9H[New File][Incomplete last line] 1 line, 8 characters written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset nobin eol[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hbwipe XXUnix XXDos XXMac[?25l3 buffers wiped out[22;21H[K[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" create mixed format files[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h!cat XXUnix XXDos >XXUxDs[?25l[26C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H:[?12l[?25h!cat XXUnix XXMac >XXUxMac[?25l[27C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H:[?12l[?25h!cat XXDos XXMac >XXDosMac[?25l[27C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H:[?12l[?25h!cat XXUnix XXDos XXMac >XXUxDsMc[?25l[34C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[27m[m[H[2J[1;1H:set nobinary ff&
:w
:qa!
ENDTEST

1
2
3
4
5
6
7
8
9
10

unix
unix
eof

dos[34m^M[?12l[?25h[?25l
[m:[?12l[?25h" try reading and writing with 'fileformats' empty[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fileformat=unix[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! XXUnix[?25l"XXUnix" [22;10H[K[22;10H2 lines, 10 characters[1;1Hunix[1;6H[K[2;1Hunix
[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw! test.out[?25l"test.out" [22;12H[K[22;12H[New File] 2 lines, 10 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! XXDos[?25l"XXDos" [22;9H[K[22;9H2 lines, 10 characters[1;1Hdos[34m^M[m
dos[34m^M[1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw! XXtt01[?25l"XXtt01" [22;10H[K[22;10H[New File] 2 lines, 10 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! XXMac[?25l"XXMac" [22;9H[K[22;9H[Incomplete last line] 1 line, 8 characters[1;1Hmac[2Cmac[34m^M[m
[1m[34m~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw! XXtt02[?25l"XXtt02" [22;10H[K[22;10H[New File] 1 line, 9 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hbwipe XXUnix XXDos XXMac[?25l"test30.in" [22;13H[K[22;13H208 lines, 3095 characters
3 buffers wiped out
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hset fileformat=dos[?25l[1;1H[2L[2;1H1
2[3;2H[K[4;1H3[4;2H[K[5;1H4[5;2H[K[6;1H5[6;2H[K[7;1H6[7;2H[K[8;1H7[8;2H[K[9;1H8[9;2H[K[10;1H9[10;2H[K[11;1H10[11;3H[K[12;1H[K[13;1Hunix[13;5H[K[14;1Hunix[14;5H[K[15;1Heof[15;4H[K[16;1H[K[17;1Hdos[34m^M[m[17;6H[K[18;1Hdos[34m^M[m[18;6H[K[19;1Heof[19;4H[K[20;1H[K[21;1Hmac[34m^M[mmac[34m^M[m[21;11H[K[22;1H[K[17;1H[?12l[?25h[?25l[22;1H:[?12l[?25he! XXUnix[?25l"XXUnix" [22;10H[K[22;10H[CR missing][dos format] 2 lines, 10 characters[1;1Hunix
unix
[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw! XXtt11[?25l"XXtt11" [22;10H[K[22;10H[New File][dos format] 2 lines, 12 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! XXDos[?25l"XXDos" [22;9H[K[22;9H[dos format] 2 lines, 10 characters[1;1Hdos[1;4H[K[2;1Hdos[2;4H[K[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw! XXtt12[?25l"XXtt12" [22;10H[K[22;10H[New File][dos format] 2 lines, 10 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! XXMac[?25l"XXMac" [22;9H[K[22;9H[Incomplete last line][dos format] 1 line, 8 characters[1;1Hmac[34m^M[mmac[34m^M[m
[1m[34m~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw! XXtt13[?25l"XXtt13" [22;10H[K[22;10H[New File][dos format] 1 line, 10 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hbwipe XXUnix XXDos XXMac[?25l"test30.in" [22;13H[K[22;13H[CR missing][dos format] 208 lines, 3095 characters
3 buffers wiped out
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hset fileformat=mac[?25l[1;1H[2L[2;1H1
2[3;2H[K[4;1H3[4;2H[K[5;1H4[5;2H[K[6;1H5[6;2H[K[7;1H6[7;2H[K[8;1H7[8;2H[K[9;1H8[9;2H[K[10;1H9[10;2H[K[11;1H10[11;3H[K[12;1H[K[13;1Hunix[13;5H[K[14;1Hunix[14;5H[K[15;1Heof[15;4H[K[16;1H[K[17;1Hdos[17;4H[K[18;1Hdos[18;4H[K[19;1Heof[19;4H[K[20;1H[K[21;1Hmac[34m^J[mmac[21;9H[K[22;1H[K[17;1H[?12l[?25h[?25l[22;1H:[?12l[?25he! XXUnix[?25l"XXUnix" [22;10H[K[22;10H[Incomplete last line][mac format] 1 line, 10 characters[1;1Hunix[34m^J[munix[34m^J[m
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw! XXtt21[?25l"XXtt21" [22;10H[K[22;10H[New File][mac format] 1 line, 11 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! XXDos[?25l"XXDos" [22;9H[K[22;9H[Incomplete last line][mac format] 3 lines, 10 characters[1;1Hdos[1;4H[K[2;1H[34m^J[mdos[2;6H[K[3;1H[34m^J[m[3;3H[K[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw! XXtt22[?25l"XXtt22" [22;10H[K[22;10H[New File][mac format] 3 lines, 11 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! XXMac[?25l"XXMac" [22;9H[K[22;9H[mac format] 2 lines, 8 characters[1;1Hmac
mac[2;4H[K[3;1H[1m[34m~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw! XXtt23[?25l"XXtt23" [22;10H[K[22;10H[New File][mac format] 2 lines, 8 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hbwipe XXUnix XXDos XXMac[?25l"test30.in" [22;13H[K[22;13H[Incomplete last line][mac format] 5 lines, 3095 characters
3 buffers wiped out
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25h"[?25l[1;1H[2L[1;1H[34m^J[mdos
[34m^J[meof[34m^J^J[mmac
mac[3;4H[K[4;1H[34m^J[m[4;3H[K[22;1H[K[4;1H[?12l[?25h[?25l[22;1H:[?12l[?25h" try reading and writing with 'fileformats' set to one format[?25l[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fileformats=unix[?25l[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! XXUxDsMc[?25l"XXUxDsMc" [22;12H[K[22;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;5H[K[2;1Hunix[2;5H[K[3;1Hdos[34m^M[m
dos[34m^M[m
mac[34m^M[mmac[34m^M[m[5;11H[K[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw! XXtt31[?25l"XXtt31" [22;10H[K[22;10H[New File] 5 lines, 29 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hbwipe XXUxDsMc[?25l"test30.in" [22;13H[K[22;13H208 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HSTARTTEST
:so small.vim
:" first write three test files, one in each format
:set fileformat=unix[6;21H[K[7;1H:set fileformats=[7;18H[K[8;1H:/^1/w! XX1[8;12H[K[9;1H:/^2/w! XX2[9;12H[K[10;1H:/^3/w! XX3[10;12H[K[11;1H:/^4/w! XX4[11;12H[K[12;1H:/^5/w! XX5[12;12H[K[13;1H:/^6/w! XX6[13;12H[K[14;1H:/^7/w! XX7[14;12H[K[15;1H:/^8/w! XX8[15;12H[K[16;1H:/^9/w! XX9[16;12H[K[17;1H:/^10/w! XX10[17;14H[K[18;1H:/^unix/;/eof/-1w! XXUnix[18;26H[K[19;1H:/^dos/;/eof/-1w! XXDos[19;24H[K[20;1H:set bin noeol[20;15H[K[21;1H:$w! XXMac[21;11H[K[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fileformats=dos[?25l[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! XXUxDsMc[?25l"XXUxDsMc" [22;12H[K[22;12H[Incomplete last line][CR missing][dos format] 5 lines, 28 character
[21;80Hs[22;1H
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw! XXtt32[?25l"XXtt32" [22;10H[K[22;10H[New File][dos format] 5 lines, 32 characters written
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hbwipe XXUxDsMc[?25l"test30.in" [22;13H[K[22;13H[CR missing][dos format] 208 lines, 3095 characters[1;1H[3L[1;1HTest for a lot of variations of the 'fileformats' option

STARTTEST[22;1H[K[22;1H"test30.in" [CR missing][dos format] 208 lines, 3095 characters[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fileformats=mac[?25l[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! XXUxDsMc[?25l"XXUxDsMc" [22;12H[K[22;12H[mac format] 4 lines, 28 characters[1;1Hunix[34m^J[munix[34m^J[mdos[1;16H[K[2;1H[34m^J[mdos
[34m^J[mmac[3;6H[K[4;1Hmac[4;5H[K[5;1H[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw! XXtt33[?25l"XXtt33" [22;10H[K[22;10H[New File][mac format] 4 lines, 28 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hbwipe XXUxDsMc[?25l"test30.in" [22;13H[K[22;13H[Incomplete last line][mac format] 5 lines, 3095 characters[1;1H[34m^J[mdos[1;6H[K[2;3Heof[34m^J^J[mmac
mac[3;4H[K[4;1H[34m^J[m[4;3H[K[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" try reading and writing with 'fileformats' set to two formats[?25l[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fileformats=unix,dos[?25l[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! XXUxDsMc[?25l"XXUxDsMc" [22;12H[K[22;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;5H[K[2;1Hunix[2;5H[K[3;1Hdos[34m^M[m
dos[34m^M[m
mac[34m^M[mmac[34m^M[m[5;11H[K[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw! XXtt41[?25l"XXtt41" [22;10H[K[22;10H[New File] 5 lines, 29 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hbwipe XXUxDsMc[?25l"test30.in" [22;13H[K[22;13H208 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HSTARTTEST
:so small.vim
:" first write three test files, one in each format
:set fileformat=unix[6;21H[K[7;1H:set fileformats=[7;18H[K[8;1H:/^1/w! XX1[8;12H[K[9;1H:/^2/w! XX2[9;12H[K[10;1H:/^3/w! XX3[10;12H[K[11;1H:/^4/w! XX4[11;12H[K[12;1H:/^5/w! XX5[12;12H[K[13;1H:/^6/w! XX6[13;12H[K[14;1H:/^7/w! XX7[14;12H[K[15;1H:/^8/w! XX8[15;12H[K[16;1H:/^9/w! XX9[16;12H[K[17;1H:/^10/w! XX10[17;14H[K[18;1H:/^unix/;/eof/-1w! XXUnix[18;26H[K[19;1H:/^dos/;/eof/-1w! XXDos[19;24H[K[20;1H:set bin noeol[20;15H[K[21;1H:$w! XXMac[21;11H[K[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! XXUxMac[?25l"XXUxMac" [22;11H[K[22;11H[Incomplete last line] 3 lines, 18 characters[1;1Hunix[1;6H[K[2;1Hunix
mac[34m^M[mmac[34m^M[m
[1m[34m~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw! XXtt42[?25l"XXtt42" [22;10H[K[22;10H[New File] 3 lines, 19 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hbwipe XXUxMac[?25l"test30.in" [22;13H[K[22;13H208 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HSTARTTEST[3;10H[K[4;1H:so small.vim[4;14H[K[5;1H:" first write three test files, one in each format[5;52H[K[6;1H:set fileformat=unix[6;21H[K[7;1H:set fileformats=[7;18H[K[8;1H:/^1/w! XX1[8;12H[K[9;1H:/^2/w! XX2[9;12H[K[10;1H:/^3/w! XX3[10;12H[K[11;1H:/^4/w! XX4[11;12H[K[12;1H:/^5/w! XX5[12;12H[K[13;1H:/^6/w! XX6[13;12H[K[14;1H:/^7/w! XX7[14;12H[K[15;1H:/^8/w! XX8[15;12H[K[16;1H:/^9/w! XX9[16;12H[K[17;1H:/^10/w! XX10[17;14H[K[18;1H:/^unix/;/eof/-1w! XXUnix[18;26H[K[19;1H:/^dos/;/eof/-1w! XXDos[19;24H[K[20;1H:set bin noeol[20;15H[K[21;1H:$w! XXMac[21;11H[K[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! XXDosMac[?25l"XXDosMac" [22;12H[K[22;12H[Incomplete last line][dos format] 3 lines, 18 characters[1;1Hdo[1;4H[K[2;1Hdos
mac[34m^M[mmac[34m^M[m
[1m[34m~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw! XXtt43[?25l"XXtt43" [22;10H[K[22;10H[New File][dos format] 3 lines, 20 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hbwipe XXDosMac[?25l"test30.in" [22;13H[K[22;13H208 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HSTARTTEST[3;10H[K[4;1H:so small.vim[4;14H[K[5;1H:" first write three test files, one in each format[5;52H[K[6;1H:set fileformat=unix[6;21H[K[7;1H:set fileformats=[7;18H[K[8;1H:/^1/w! XX1[8;12H[K[9;1H:/^2/w! XX2[9;12H[K[10;1H:/^3/w! XX3[10;12H[K[11;1H:/^4/w! XX4[11;12H[K[12;1H:/^5/w! XX5[12;12H[K[13;1H:/^6/w! XX6[13;12H[K[14;1H:/^7/w! XX7[14;12H[K[15;1H:/^8/w! XX8[15;12H[K[16;1H:/^9/w! XX9[16;12H[K[17;1H:/^10/w! XX10[17;14H[K[18;1H:/^unix/;/eof/-1w! XXUnix[18;26H[K[19;1H:/^dos/;/eof/-1w! XXDos[19;24H[K[20;1H:set bin noeol[20;15H[K[21;1H:$w! XXMac[21;11H[K[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fileformats=unix,mac[?25l[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! XXUxDs[?25l"XXUxDs" [22;10H[K[22;10H4 lines, 20 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[34m^M[m[3;6H[K[4;1Hdos[34m^M[m[4;6H[K[5;1H[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw! XXtt51[?25l"XXtt51" [22;10H[K[22;10H[New File] 4 lines, 20 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hbwipe XXUxDs[?25l"test30.in" [22;13H[K[22;13H208 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HSTARTTEST
:so small.vim
:" first write three test files, one in each format[5;52H[K[6;1H:set fileformat=unix[6;21H[K[7;1H:set fileformats=[7;18H[K[8;1H:/^1/w! XX1[8;12H[K[9;1H:/^2/w! XX2[9;12H[K[10;1H:/^3/w! XX3[10;12H[K[11;1H:/^4/w! XX4[11;12H[K[12;1H:/^5/w! XX5[12;12H[K[13;1H:/^6/w! XX6[13;12H[K[14;1H:/^7/w! XX7[14;12H[K[15;1H:/^8/w! XX8[15;12H[K[16;1H:/^9/w! XX9[16;12H[K[17;1H:/^10/w! XX10[17;14H[K[18;1H:/^unix/;/eof/-1w! XXUnix[18;26H[K[19;1H:/^dos/;/eof/-1w! XXDos[19;24H[K[20;1H:set bin noeol[20;15H[K[21;1H:$w! XXMac[21;11H[K[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! XXUxDsMc[?25l"XXUxDsMc" [22;12H[K[22;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[34m^M[m[3;6H[K[4;1Hdos[34m^M[m[4;6H[K[5;1Hmac[34m^M[mmac[34m^M[m[5;11H[K[6;1H[1m[34m~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw! XXtt52[?25l"XXtt52" [22;10H[K[22;10H[New File] 5 lines, 29 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hbwipe XXUxDsMc[?25l"test30.in" [22;13H[K[22;13H208 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HSTARTTEST
:so small.vim
:" first write three test files, one in each format
:set fileformat=unix[6;21H[K[7;1H:set fileformats=[7;18H[K[8;1H:/^1/w! XX1[8;12H[K[9;1H:/^2/w! XX2[9;12H[K[10;1H:/^3/w! XX3[10;12H[K[11;1H:/^4/w! XX4[11;12H[K[12;1H:/^5/w! XX5[12;12H[K[13;1H:/^6/w! XX6[13;12H[K[14;1H:/^7/w! XX7[14;12H[K[15;1H:/^8/w! XX8[15;12H[K[16;1H:/^9/w! XX9[16;12H[K[17;1H:/^10/w! XX10[17;14H[K[18;1H:/^unix/;/eof/-1w! XXUnix[18;26H[K[19;1H:/^dos/;/eof/-1w! XXDos[19;24H[K[20;1H:set bin noeol[20;15H[K[21;1H:$w! XXMac[21;11H[K[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! XXDosMac[?25l"XXDosMac" [22;12H[K[22;12H[mac format] 4 lines, 18 characters[1;1Hdo[1;4H[K[2;1H[34m^J[mdos
[34m^J[mmac[3;6H[K[4;1Hmac[4;5H[K[5;1H[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw! XXtt53[?25l"XXtt53" [22;10H[K[22;10H[New File][mac format] 4 lines, 18 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hbwipe XXDosMac[?25l"test30.in" [22;13H[K[22;13H208 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HSTARTTEST
:so small.vim
:" first write three test files, one in each format[5;52H[K[6;1H:set fileformat=unix[6;21H[K[7;1H:set fileformats=[7;18H[K[8;1H:/^1/w! XX1[8;12H[K[9;1H:/^2/w! XX2[9;12H[K[10;1H:/^3/w! XX3[10;12H[K[11;1H:/^4/w! XX4[11;12H[K[12;1H:/^5/w! XX5[12;12H[K[13;1H:/^6/w! XX6[13;12H[K[14;1H:/^7/w! XX7[14;12H[K[15;1H:/^8/w! XX8[15;12H[K[16;1H:/^9/w! XX9[16;12H[K[17;1H:/^10/w! XX10[17;14H[K[18;1H:/^unix/;/eof/-1w! XXUnix[18;26H[K[19;1H:/^dos/;/eof/-1w! XXDos[19;24H[K[20;1H:set bin noeol[20;15H[K[21;1H:$w! XXMac[21;11H[K[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fileformats=dos,mac[?25l[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! XXUxDs[?25l"XXUxDs" [22;10H[K[22;10H[CR missing][dos format] 4 lines, 20 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[3;4H[K[4;1Hdos[4;5H[K[5;1H[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw! XXtt61[?25l"XXtt61" [22;10H[K[22;10H[New File][dos format] 4 lines, 22 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hbwipe XXUxDs[?25l"test30.in" [22;13H[K[22;13H[CR missing][dos format] 208 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HSTARTTEST
:so small.vim
:" first write three test files, one in each format[5;52H[K[6;1H:set fileformat=unix[6;21H[K[7;1H:set fileformats=[7;18H[K[8;1H:/^1/w! XX1[8;12H[K[9;1H:/^2/w! XX2[9;12H[K[10;1H:/^3/w! XX3[10;12H[K[11;1H:/^4/w! XX4[11;12H[K[12;1H:/^5/w! XX5[12;12H[K[13;1H:/^6/w! XX6[13;12H[K[14;1H:/^7/w! XX7[14;12H[K[15;1H:/^8/w! XX8[15;12H[K[16;1H:/^9/w! XX9[16;12H[K[17;1H:/^10/w! XX10[17;14H[K[18;1H:/^unix/;/eof/-1w! XXUnix[18;26H[K[19;1H:/^dos/;/eof/-1w! XXDos[19;24H[K[20;1H:set bin noeol[20;15H[K[21;1H:$w! XXMac[21;11H[K[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! XXUxMac[?25l"XXUxMac" [22;11H[K[22;11H[Incomplete last line][CR missing][dos format] 3 lines, 18 characters[1;1Hunix[1;6H[K[2;1Hunix
mac[34m^M[mmac[34m^M[m
[1m[34m~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw! XXtt62[?25l"XXtt62" [22;10H[K[22;10H[New File][dos format] 3 lines, 22 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hbwipe XXUxMac[?25l"test30.in" [22;13H[K[22;13H[CR missing][dos format] 208 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HSTARTTEST[3;10H[K[4;1H:so small.vim[4;14H[K[5;1H:" first write three test files, one in each format[5;52H[K[6;1H:set fileformat=unix[6;21H[K[7;1H:set fileformats=[7;18H[K[8;1H:/^1/w! XX1[8;12H[K[9;1H:/^2/w! XX2[9;12H[K[10;1H:/^3/w! XX3[10;12H[K[11;1H:/^4/w! XX4[11;12H[K[12;1H:/^5/w! XX5[12;12H[K[13;1H:/^6/w! XX6[13;12H[K[14;1H:/^7/w! XX7[14;12H[K[15;1H:/^8/w! XX8[15;12H[K[16;1H:/^9/w! XX9[16;12H[K[17;1H:/^10/w! XX10[17;14H[K[18;1H:/^unix/;/eof/-1w! XXUnix[18;26H[K[19;1H:/^dos/;/eof/-1w! XXDos[19;24H[K[20;1H:set bin noeol[20;15H[K[21;1H:$w! XXMac[21;11H[K[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! XXUxDsMc[?25l"XXUxDsMc" [22;12H[K[22;12H[Incomplete last line][CR missing][dos format] 5 lines, 28 character
[21;80Hs[22;1H
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw! XXtt63[?25l"XXtt63" [22;10H[K[22;10H[New File][dos format] 5 lines, 32 characters written
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hbwipe XXUxDsMc[?25l"test30.in" [22;13H[K[22;13H[CR missing][dos format] 208 lines, 3095 characters[1;1H[3L[1;1HTest for a lot of variations of the 'fileformats' option

STARTTEST[22;1H[K[22;1H"test30.in" [CR missing][dos format] 208 lines, 3095 characters[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" try reading and writing with 'fileformats' set to three formats[?25l[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fileformats=unix,dos,mac[?25l[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! XXUxDsMc[?25l"XXUxDsMc" [22;12H[K[22;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[34m^M[m[3;6H[K[4;1Hdos[34m^M[m[4;6H[K[5;1Hmac[34m^M[mmac[34m^M[m[5;11H[K[6;1H[1m[34m~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw! XXtt71[?25l"XXtt71" [22;10H[K[22;10H[New File] 5 lines, 29 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hbwipe XXUxDsMc[?25l"test30.in" [22;13H[K[22;13H208 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HSTARTTEST
:so small.vim
:" first write three test files, one in each format
:set fileformat=unix[6;21H[K[7;1H:set fileformats=[7;18H[K[8;1H:/^1/w! XX1[8;12H[K[9;1H:/^2/w! XX2[9;12H[K[10;1H:/^3/w! XX3[10;12H[K[11;1H:/^4/w! XX4[11;12H[K[12;1H:/^5/w! XX5[12;12H[K[13;1H:/^6/w! XX6[13;12H[K[14;1H:/^7/w! XX7[14;12H[K[15;1H:/^8/w! XX8[15;12H[K[16;1H:/^9/w! XX9[16;12H[K[17;1H:/^10/w! XX10[17;14H[K[18;1H:/^unix/;/eof/-1w! XXUnix[18;26H[K[19;1H:/^dos/;/eof/-1w! XXDos[19;24H[K[20;1H:set bin noeol[20;15H[K[21;1H:$w! XXMac[21;11H[K[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fileformats=mac,dos,unix[?25l[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! XXUxDsMc[?25l"XXUxDsMc" [22;12H[K[22;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[34m^M[m[3;6H[K[4;1Hdos[34m^M[m[4;6H[K[5;1Hmac[34m^M[mmac[34m^M[m[5;11H[K[6;1H[1m[34m~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw! XXtt81[?25l"XXtt81" [22;10H[K[22;10H[New File] 5 lines, 29 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hbwipe XXUxDsMc[?25l"test30.in" [22;13H[K[22;13H208 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HSTARTTEST
:so small.vim
:" first write three test files, one in each format
:set fileformat=unix[6;21H[K[7;1H:set fileformats=[7;18H[K[8;1H:/^1/w! XX1[8;12H[K[9;1H:/^2/w! XX2[9;12H[K[10;1H:/^3/w! XX3[10;12H[K[11;1H:/^4/w! XX4[11;12H[K[12;1H:/^5/w! XX5[12;12H[K[13;1H:/^6/w! XX6[13;12H[K[14;1H:/^7/w! XX7[14;12H[K[15;1H:/^8/w! XX8[15;12H[K[16;1H:/^9/w! XX9[16;12H[K[17;1H:/^10/w! XX10[17;14H[K[18;1H:/^unix/;/eof/-1w! XXUnix[18;26H[K[19;1H:/^dos/;/eof/-1w! XXDos[19;24H[K[20;1H:set bin noeol[20;15H[K[21;1H:$w! XXMac[21;11H[K[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" try with 'binary' set[?25l[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fileformats=mac,unix,dos[?25l[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset binary[?25l[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! XXUxDsMc[?25l"XXUxDsMc" [22;12H[K[22;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[34m^M[m[3;6H[K[4;1Hdos[34m^M[m[4;6H[K[5;1Hmac[34m^M[mmac[34m^M[m[5;11H[K[6;1H[1m[34m~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw! XXtt91[?25l"XXtt91" [22;10H[K[22;10H[New File][Incomplete last line] 5 lines, 28 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hbwipe XXUxDsMc[?25l"test30.in" [22;13H[K[22;13H208 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HSTARTTEST
:so small.vim
:" first write three test files, one in each format
:set fileformat=unix[6;21H[K[7;1H:set fileformats=[7;18H[K[8;1H:/^1/w! XX1[8;12H[K[9;1H:/^2/w! XX2[9;12H[K[10;1H:/^3/w! XX3[10;12H[K[11;1H:/^4/w! XX4[11;12H[K[12;1H:/^5/w! XX5[12;12H[K[13;1H:/^6/w! XX6[13;12H[K[14;1H:/^7/w! XX7[14;12H[K[15;1H:/^8/w! XX8[15;12H[K[16;1H:/^9/w! XX9[16;12H[K[17;1H:/^10/w! XX10[17;14H[K[18;1H:/^unix/;/eof/-1w! XXUnix[18;26H[K[19;1H:/^dos/;/eof/-1w! XXDos[19;24H[K[20;1H:set bin noeol[20;15H[K[21;1H:$w! XXMac[21;11H[K[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fileformats=mac[?25l[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! XXUxDsMc[?25l"XXUxDsMc" [22;12H[K[22;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[34m^M[m[3;6H[K[4;1Hdos[34m^M[m[4;6H[K[5;1Hmac[34m^M[mmac[34m^M[m[5;11H[K[6;1H[1m[34m~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw! XXtt92[?25l"XXtt92" [22;10H[K[22;10H[New File][Incomplete last line] 5 lines, 28 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hbwipe XXUxDsMc[?25l"test30.in" [22;13H[K[22;13H208 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HSTARTTEST
:so small.vim
:" first write three test files, one in each format
:set fileformat=unix[6;21H[K[7;1H:set fileformats=[7;18H[K[8;1H:/^1/w! XX1[8;12H[K[9;1H:/^2/w! XX2[9;12H[K[10;1H:/^3/w! XX3[10;12H[K[11;1H:/^4/w! XX4[11;12H[K[12;1H:/^5/w! XX5[12;12H[K[13;1H:/^6/w! XX6[13;12H[K[14;1H:/^7/w! XX7[14;12H[K[15;1H:/^8/w! XX8[15;12H[K[16;1H:/^9/w! XX9[16;12H[K[17;1H:/^10/w! XX10[17;14H[K[18;1H:/^unix/;/eof/-1w! XXUnix[18;26H[K[19;1H:/^dos/;/eof/-1w! XXDos[19;24H[K[20;1H:set bin noeol[20;15H[K[21;1H:$w! XXMac[21;11H[K[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fileformats=dos[?25l[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! XXUxDsMc[?25l"XXUxDsMc" [22;12H[K[22;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[34m^M[m[3;6H[K[4;1Hdos[34m^M[m[4;6H[K[5;1Hmac[34m^M[mmac[34m^M[m[5;11H[K[6;1H[1m[34m~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw! XXtt93[?25l"XXtt93" [22;10H[K[22;10H[New File][Incomplete last line] 5 lines, 28 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" Append "END" to each file so that we can see what the last written char was.[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fileformat=unix nobin[?25l[1;1H[?12l[?25h[?25l[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [m[22;1H--No lines in buffer--[22;23H[K[1;1H[?12l[?25h[?25lEND[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>XXtt01[?25l"XXtt01" [22;10H[K[22;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>XXtt02[?25l"XXtt02" [22;10H[K[22;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>XXtt11[?25l"XXtt11" [22;10H[K[22;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>XXtt12[?25l"XXtt12" [22;10H[K[22;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>XXtt13[?25l"XXtt13" [22;10H[K[22;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>XXtt21[?25l"XXtt21" [22;10H[K[22;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>XXtt22[?25l"XXtt22" [22;10H[K[22;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>XXtt23[?25l"XXtt23" [22;10H[K[22;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>XXtt31[?25l"XXtt31" [22;10H[K[22;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>XXtt32[?25l"XXtt32" [22;10H[K[22;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>XXtt33[?25l"XXtt33" [22;10H[K[22;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>XXtt41[?25l"XXtt41" [22;10H[K[22;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>XXtt42[?25l"XXtt42" [22;10H[K[22;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>XXtt43[?25l"XXtt43" [22;10H[K[22;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>XXtt51[?25l"XXtt51" [22;10H[K[22;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>XXtt52[?25l"XXtt52" [22;10H[K[22;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>XXtt53[?25l"XXtt53" [22;10H[K[22;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>XXtt61[?25l"XXtt61" [22;10H[K[22;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>XXtt62[?25l"XXtt62" [22;10H[K[22;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>XXtt63[?25l"XXtt63" [22;10H[K[22;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>XXtt71[?25l"XXtt71" [22;10H[K[22;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>XXtt81[?25l"XXtt81" [22;10H[K[22;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>XXtt91[?25l"XXtt91" [22;10H[K[22;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>XXtt92[?25l"XXtt92" [22;10H[K[22;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>XXtt93[?25l"XXtt93" [22;10H[K[22;10H1 line, 4 characters appended[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" Concatenate the results.[?25l[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" Make fileformat of test.out the native fileformat.[?25l[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" Add a newline at the end.[?25l[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset binary[?25l[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! test.out[?25l"test.out" [22;12H[K[22;12H2 lines, 10 characters[1;1Hunix
unix[2;5H[K[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$r XXtt01[?25l"XXtt01" [22;10H[K[22;10H3 lines, 14 characters[3;1Hdos[34m^M[m[3;6H[K[4;1Hdos[34m^M[m[4;6H[K[5;1HEND[5;4H[K[3;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$r XXtt02[?25l"XXtt02" [22;10H[K[22;10H2 lines, 13 characters[6;1Hmac[34m^M[mmac[34m^M[m[6;11H[K[7;1HEND[7;4H[K[6;1H[?12l[?25h
[?25l
1[8;2H[K[8;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$r XXtt11[?25l"XXtt11" [22;10H[K[22;10H3 lines, 16 characters[9;1Hunix[34m^M[m[9;7H[K[10;1Hunix[34m^M[m[10;7H[K[11;1HEND[11;4H[K[9;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$r XXtt12[?25l"XXtt12" [22;10H[K[22;10H3 lines, 14 characters[12;1Hdos[34m^M[m[12;6H[K[13;1Hdos[34m^M[m[13;6H[K[14;1HEND[14;4H[K[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$r XXtt13[?25l"XXtt13" [22;10H[K[22;10H2 lines, 14 characters[15;1Hmac[34m^M[mmac[34m^M^M[m[15;13H[K[16;1HEND[16;4H[K[15;1H[?12l[?25h
[?25l
2[17;2H[K[17;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$r XXtt21[?25l"XXtt21" [22;10H[K[22;10H3 lines, 15 characters[18;1Hunix[18;5H[K[19;1Hunix[19;5H[K[20;1H[34m^M[mEND[20;6H[K[18;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$r XXtt22[?25l"XXtt22" [22;10H[K[22;10H3 lines, 15 characters[21;1Hdos[34m^M[m[21;6H[K[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$r XXtt23[?25l"XXtt23" [22;10H[K[22;10H1 line, 12 characters[1;21r[1;1H[3M[1;22r[19;1Hdos[34m^M
^M[mEND
mac[34m^M[mmac[34m^M[mEND[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H3[?12l[?25h[?25l
:[?12l[?25h$r XXtt31[?25l"XXtt31" [22;10H[K[22;10H6 lines, 33 characters[1;21r[21;1H
[1;22r[21;1Hunix[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h$r XXtt32[?25l"XXtt32" [22;10H[K[22;10H6 lines, 36 characters[1;21r[1;1H[6M[1;22r[16;1Hunix
dos[34m^M[m
dos[34m^M[m
mac[34m^M[mmac[34m^M[m
END
unix[34m^M[m[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h$r XXtt33[?25l"XXtt33" [22;10H[K[22;10H5 lines, 32 characters[1;21r[1;1H[6M[1;22r[16;1Hunix[34m^M[m
dos[34m^M[m
dos[34m^M[m
mac[34m^M[mmac[34m^M^M[m
END
unix[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[1;1H[4M[1;22r[18;1Hunix
dos[34m^M[m
dos[34m^M[m
mac[34m^M[mmac[34m^M[mEND[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H4[?12l[?25h[?25l
:[?12l[?25h$r XXtt41[?25l"XXtt41" [22;10H[K[22;10H6 lines, 33 characters[1;21r[21;1H
[1;22r[21;1Hunix[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h$r XXtt42[?25l"XXtt42" [22;10H[K[22;10H4 lines, 23 characters[1;21r[1;1H[6M[1;22r[16;1Hunix
dos[34m^M[m
dos[34m^M[m
mac[34m^M[mmac[34m^M[m
END
unix[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h$r XXtt43[?25l"XXtt43" [22;10H[K[22;10H4 lines, 24 characters[1;21r[1;1H[4M[1;22r[18;1Hunix
mac[34m^M[mmac[34m^M[m
END
dos[34m^M[m[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[1;1H[3M[1;22r[19;1Hdos[34m^M[m
mac[34m^M[mmac[34m^M^M[m
END[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H5[?12l[?25h[?25l
:[?12l[?25h$r XXtt51[?25l"XXtt51" [22;10H[K[22;10H5 lines, 24 characters[1;21r[21;1H
[1;22r[21;1Hunix[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h$r XXtt52[?25l"XXtt52" [22;10H[K[22;10H6 lines, 33 characters[1;21r[1;1H[5M[1;22r[17;1Hunix
dos[34m^M[m
dos[34m^M[m
END
unix[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h$r XXtt53[?25l"XXtt53" [22;10H[K[22;10H3 lines, 22 characters[1;21r[1;1H[6M[1;22r[16;1Hunix
dos[34m^M[m
dos[34m^M[m
mac[34m^M[mmac[34m^M[m
END
dos[34m^M[m[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[1;1H[2M[1;22r[20;1Hdos[34m^M[m
mac[34m^M[mmac[34m^M[mEND[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H6[?12l[?25h[?25l
:[?12l[?25h$r XXtt61[?25l"XXtt61" [22;10H[K[22;10H5 lines, 26 characters[1;21r[21;1H
[1;22r[21;1Hunix[34m^M[m[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h$r XXtt62[?25l"XXtt62" [22;10H[K[22;10H4 lines, 26 characters[1;21r[1;1H[5M[1;22r[17;1Hunix[34m^M[m
dos[34m^M[m
dos[34m^M[m
END
unix[34m^M[m[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h$r XXtt63[?25l"XXtt63" [22;10H[K[22;10H6 lines, 36 characters[1;21r[1;1H[4M[1;22r[18;1Hunix[34m^M[m
mac[34m^M[mmac[34m^M^M[m
END
unix[34m^M[m[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[1;1H[5M[1;22r[17;1Hunix[34m^M[m
dos[34m^M[m
dos[34m^M[m
mac[34m^M[mmac[34m^M^M[m
END[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H7[?12l[?25h[?25l
:[?12l[?25h$r XXtt71[?25l"XXtt71" [22;10H[K[22;10H6 lines, 33 characters[1;21r[21;1H
[1;22r[21;1Hunix[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[1;1H[5M[1;22r[17;1Hunix
dos[34m^M[m
dos[34m^M[m
mac[34m^M[mmac[34m^M[m
END[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H8[?12l[?25h[?25l
:[?12l[?25h$r XXtt81[?25l"XXtt81" [22;10H[K[22;10H6 lines, 33 characters[1;21r[21;1H
[1;22r[21;1Hunix[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[1;1H[5M[1;22r[17;1Hunix
dos[34m^M[m
dos[34m^M[m
mac[34m^M[mmac[34m^M[m
END[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H9[?12l[?25h[?25l
:[?12l[?25h$r XXtt91[?25l"XXtt91" [22;10H[K[22;10H5 lines, 32 characters[1;21r[21;1H
[1;22r[21;1Hunix[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h$r XXtt92[?25l"XXtt92" [22;10H[K[22;10H5 lines, 32 characters[1;21r[1;1H[5M[1;22r[17;1Hunix
dos[34m^M[m
dos[34m^M[m
mac[34m^M[mmac[34m^M[mEND
unix[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h$r XXtt93[?25l"XXtt93" [22;10H[K[22;10H5 lines, 32 characters[1;21r[1;1H[5M[1;22r[17;1Hunix
dos[34m^M[m
dos[34m^M[m
mac[34m^M[mmac[34m^M[mEND
unix[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[1;1H[4M[1;22r[18;1Hunix
dos[34m^M[m
dos[34m^M[m
mac[34m^M[mmac[34m^M[mEND[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H10[?12l[?25h[?25l
:[?12l[?25h$r XXUnix[?25l"XXUnix" [22;10H[K[22;10H2 lines, 10 characters[1;21r[21;1H
[1;22r[21;1Hunix[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25hset nobinary ff&[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw[?25l"test.out" 121 lines, 664 characters written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[?1l>[?12l[?25h[?1049l
rm -rf X* test.ok viminfo
rm -rf test31.failed test.ok test.out X* viminfo
cp test31.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test31.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test31.in" 69 lines, 1423 characters[1;1HTest for commands that close windows and/or buffers:
:quit
:close
:hide
:only
:sall
:all
:ball
:buf
:edit

STARTTEST
:so tiny.vim
GA 1[34m^[[m:$w! Xtest1
$r2:$w! Xtest2
$r3:$w! Xtest3
:n! Xtest1 Xtest2
A 1[34m^[[m:set hidden
:" test for working :n when hidden set; write "testtext 2"
:n
:w! test.out[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for commands that close windows and/or buffers:[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[12;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[13;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 54 lines, 1288 characters written[13;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[13;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[27m[m[H[2J[1;1H:" write "testtext 3 3"
A 3[34m^[[m:e Xtest1
:w >>test.out
:" test ":edit" working in modified buffer when 'hidden' set; write "testtext 1"[5;1H:set hidden
:e Xtest1
:w >>test.out
:" test ":close" not hiding when 'hidden' not set in modified buffer;
:" write "testtext 3 3 3"
:sp Xtest3
:set nohidden
A 3[34m^[[m:close
:w >>test.out
:" test ":close!" does hide when 'hidden' not set in modified buffer;
:" write "testtext 1"
A 3[34m^[[m:close!
:w >>test.out
:qa!
ENDTEST

testtext[19;1H[?12l[?25h
[?25l

:so! Xdotest[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso tiny.vim[?25l[20;1H[?12l[?25h
[?25l[9C1[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$w! Xtest1[?25l"Xtest1" [22;10H[K[22;10H[New File] 1 line, 11 characters written[21;10H[?12l[?25h[?25l2[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$w! Xtest2[?25l"Xtest2" [22;10H[K[22;10H[New File] 1 line, 11 characters written[21;10H[?12l[?25h[?25l3[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$w! Xtest3[?25l"Xtest3" [22;10H[K[22;10H[New File] 1 line, 11 characters written[21;10H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hn! Xtest1 Xtest2[?25l"Xtest1" [22;10H[K[22;10H1 line, 11 characters[1;1Htesttext 1[1;11H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m[11C1[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset hidden[?25l[1;12H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" test for working :n when hidden set; write "testtext 2"[?25l[1;12H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hn[?25l"Xtest2" 1 line, 11 characters[1;10H2[1;12H[K[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw! test.out[?25l"test.out" [22;12H[K[22;12H[New File] 1 line, 11 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" test for failing :rew when hidden not set; write "testtext 2 2"[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset nohidden[?25l[1;1H[?12l[?25h[?25l[11C2[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hrew[?25l[1m[37m[41mE37: No write since last change (add ! to override)[1;12H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 13 characters appended[1;12H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" test for working :rew when hidden set; write "testtext 1 1"[?25l[1;12H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset hidden[?25l[1;12H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hrew[?25l"Xtest1" [Modified] line 1 of 1 --100%-- col 1 (file 1 of 2)[1;10H1 1[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 13 characters appended[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" test for :all keeping a buffer when it's modified; write "testtext 1 1 1"[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset nohidden[?25l[1;1H[?12l[?25h[?25l[13C1[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hsp[?25l[11;1H[1m[7mXtest1 [+]                                                                      [m[12;1Htesttext 1 1 1[12;15H[K[21;1H[7mXtest1 [+]                                                                      [1;14H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hn Xtest2 Xtest3[?25l"Xtest2" [Modified] line 1 of 1 --100%-- col 1 (file 1 of 2)[1;10H2 2[1;14H[K[11;6H[1m[7m2 [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hall[?25l"Xtest3" 1 line, 11 characters[27m[m[H[2J[1;1Htesttext 1 1 1
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [m[7;1H[7mXtest1 [+]                                                                      [m[8;1Htesttext 2 2
[1m[34m~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [m[14;1H[1m[7mXtest2 [+]                                                                      [m[15;1Htesttext 3
[1m[34m~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [m[21;1H[7mXtest3                                                                          [8;1H[?12l[?25h[?25l[22;1H[m:[?12l[?25h1wincmd w[?25l[7;1H[1m[7mXtest1 [+]                                                                      [m[14;1H[7mXtest2 [+]                                                                      [1;14H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 15 characters appended[1;14H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" test abandoning changed buffer, should be unloaded even when 'hidden' set[?25l[1;14H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" write "testtext 2 2" twice[?25l[1;14H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset hidden[?25l[1;14H[?12l[?25h[?25l1 1[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hq![?25l[27m[m[H[2J[1;1Htesttext 2 2
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [m[11;1H[1m[7mXtest2 [+]                                                                      [m[12;1Htesttext 3
[1m[34m~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [m[21;1H[7mXtest3                                                                          [1;1H[?12l[?25h[?25l[22;1H[m:[?12l[?25hw >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 13 characters appended[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hunhide[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 13 characters appended[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" test ":hide" hides anyway when 'hidden' not set; write "testtext 3"[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset nohidden[?25l[1;1H[?12l[?25h[?25l[13C2[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hhide[?25l[1;10H3[1;12H[K[11;1H[1m[34m~                                                                               [12;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 11 characters appended[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" test ":edit" failing in modified buffer when 'hidden' not set[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" write "testtext 3 3"[?25l[1;1H[?12l[?25h[?25l[11C3[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he Xtest1[?25l[1m[37m[41mE37: No write since last change (add ! to override)[1;12H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 13 characters appended[1;12H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" test ":edit" working in modified buffer when 'hidden' set; write "testtext 1
[21;80H"[22;1H[?25l[1;1H[L[1;1Htesttext 3 3[22;1H[K[1;12H[?12l[?25h[?25l[22;1H:[?12l[?25hset hidden[?25l[1;12H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he Xtest1[?25l"Xtest1" 1 line, 11 characters[1;10H1[1;12H[K[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 11 characters appended[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" test ":close" not hiding when 'hidden' not set in modified buffer;[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" write "testtext 3 3 3"[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hsp Xtest3[?25l"Xtest3" [Modified] line 1 of 1 --100%-- col 1 (file 2 of 2)[1;10H3 3[11;1H[1m[7mXtest3 [+]                                                                      [m[12;1Htesttext 1[12;11H[K[21;1H[7mXtest1                                                                          [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hset nohidden[?25l[1;1H[?12l[?25h[?25l[13C3[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hclose[?25l[1m[37m[41mE37: No write since last change (add ! to override)[1;14H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 15 characters appended[1;14H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" test ":close!" does hide when 'hidden' not set in modified buffer;[?25l[1;14H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" write "testtext 1"[?25l[1;14H[?12l[?25h[?25l3 3[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hclose![?25l[1;10H1[1;12H[K[11;1H[1m[34m~                                                                               [12;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 11 characters appended[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test32.failed test.ok test.out X* viminfo
cp test32.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test32.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test32.in" 57 lines, 1242 characters[1;1HTest for insert expansion

:se cpt=.,w
* add-expands (word from next line) from other window
* add-expands (current buffer first)
* Local expansion, ends in an empty line (unless it becomes a global expansion)
* starts Local and switches to global add-expansion
:se cpt=.,w,i
* i-add-expands and switches to local
* add-expands lines (it would end in an empty line if it didn't ignored it self)[11;1H:se cpt=kXtestfile
* checks k-expansion, and file expansion (use Xtest11 instead of test11,
* because TEST11.OUT may match first on DOS)
:se cpt=w
* checks make_cyclic in other window
:se cpt=u nohid
* checks unloaded buffer expansion
* checks adding mode abortion
:se cpt=t,d
* tag expansion, define add-expansion interrupted
* t-expansion[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for insert expansion[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[1;21r[1;1H[2M[1;22r[21;1HSTARTTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H:so small.vim[?12l[?25h[?25l
:set ff=unix cpo-=A[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 24 lines, 384 characters written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[21;1H[?12l[?25h[?25l
/ENDTEST[22;10H[K[22;1H[27m[m[H[2J[1;1H:w Xtest11.two
O[34m^N^[[mIX[34m^[[mA[34m^X^F^N^[[m
:se cpt=w
OST[34m^N^P^P^P^P^[[m
:se cpt=u nohid
[34m^W[moOEN[34m^N[m
unl[34m^N^X^X^P^[[m
:se cpt=t,d def=^\\k* tags=Xtestfile notagbsearch
O[34m^X^]^X^D^X^D^X^X^D^X^D^X^D^X^D[m
a[34m^N^[[m
:wq! test.out
ENDTEST

start of testfile
run1
run2
end of testfile

test11  36Gepeto[8C/Tag/
asd     test11file      36G
Makefile[8Cto      run[12;1H[?12l[?25h
[?25l[22;1H:so! Xdotest[13;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[13;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hse nocp viminfo+=nviminfo cpt=.,w ff=unix | $-2,$w!Xtestfile | set ff&[?25l"Xtestfile" [22;13H[K[22;13H[New] 3L, 57C written[13;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hse cot=[?25l[13;1H[?12l[?25h[?25l[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [m[11;1H[1m[7m[No Name]                                                                       [m[12;1H:se cpt=t,d def=^\\k* tags=Xtestfile notagbsearch
O[34m^X^]^X^D^X^D^X^X^D^X^D^X^D^X^D[m
a[34m^N^[[m[14;7H[K[15;1H:wq! test.out
ENDTEST[17;1H[K[18;1Hstart of testfile
run1[19;5H[K[20;1Hrun2[20;9H[K[21;1H[7mtest32.in                                                                       [1;1H[?12l[?25h[?25l[m[22;1H[1m-- INSERT ---- Keyword completion (^N^P) -- Searching...[m[32mScanning: test32.in[m[22;20H[K[22;1Hmatch in file test32.in[1m-- Keyword completion (^N^P) [m[32mmatch 1 of 4[2;3H[m[22;29H[K[22;1Hmatch in file test32.in[22;24H[K[22;1H[1m-- Keyword completion (^N^P) [m[32mmatch 2 of 4[2;5H[m[22;29H[K[22;1H[K[22;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[m[22;13H[K[22;4H[1mAdding Keyword completion (^N^P) -- Searching...[m[32mScanning: test32.in[m[22;20H[K[22;1Hmatch in file test32.in[1m-- Adding Keyword completion (^N^P) Word from other line[2;10H[1;10r[m[1;1H[2L[1;22r[1;1H#include "Xtestfile"
run1 run2[11;11H[1m[7m[+][2;10H[?12l[?25h[m[22;1H[K[?25l[22;1H[1m-- Adding Keyword completion (^N^P) Word from other line[m[22;1H[K[22;1H[1m-- INSERT --[m[22;1H[K[2;9H[?12l[?25h[?25l3[?12l[?25h
[?25l[22;1H[1m-- INSERT ---- Keyword completion (^N^P) -- Searching...[m[32mScanning: test32.in[m[22;20H[K[22;1H[1m-- Keyword completion (^N^P) [m[32mmatch 1 of 103[3;5H[m[22;29H[K[22;1H[K[22;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[m[22;13H[K[22;4H[1mAdding Keyword completion (^N^P) -- Searching...[m[32mScanning: test32.in[m[22;20H[K[22;1H[1m-- Adding Keyword completion (^N^P) Word from other line[3;10H[m[22;1H[K[22;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[m[22;13H[K[22;4H[1mKeyword Local completion (^N^P) -- Searching...[m[22;36H[32mmatch 1 of 4[m[22;48H[K[4;5H[22;35H[K[22;35H[1m [m[32mmatch 2 of 4[4;5H[m[22;35H[K[22;35H[1m [m[32mmatch 3 of 4[4;10H[m[22;35H[K[22;35H[1m [m[32mmatch 4 of 4[4;8H[m[22;35H[K[22;35H[1m [m[31mBack at original[4;1H[m[22;1H[K[22;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[m[22;13H[K[22;4H[1mKeyword Local completion (^N^P) -- Searching...[m[22;36H[32mmatch 1 of 4[m[22;48H[K[5;5H[22;35H[K[22;35H[1m [m[32mmatch 2 of 4[5;5H[m[22;35H[K[22;1H[K[22;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[m[22;13H[K[22;4H[1m^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[m[22;13H[K[22;4H[1mKeyword completion (^N^P) -- Searching...[m[32mScanning: test32.in[m[22;20H[K[22;1H[1m-- Keyword completion (^N^P) The only match[5;5H[m[22;29H[K[22;1H[K[22;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[m[22;13H[K[22;4H[1mAdding Keyword completion (^N^P) -- Searching...[m[32mScanning: test32.in[m[22;20H[K[22;1H[1m-- Adding Keyword completion (^N^P) [m[32mmatch 1 of 2[5;10H[m[22;36H[K[22;1Hmatch in file test32.in[22;24H[K[22;1H[1m-- Adding Keyword completion (^N^P) Word from other line[5;10H[3;10r[m[3;1H[3L[1;22r[3;1Hrun3 run3

run1 run2[?12l[?25h[22;1H[K[?25l[22;1H[1m-- Adding Keyword completion (^N^P) Word from other line[m[22;1H[K[22;1H[1m-- INSERT --[m[22;1H[K[5;9H[?12l[?25h
[?25l[22;1H:[?12l[?25hse cpt=.,w,i[?25l[6;1H[?12l[?25h[5;1H[?25l[22;1H[1m-- INSERT --[m[22;13H[K[22;4H[1mKeyword completion (^N^P) -- Searching...[m[32mScanning: test32.in[m[22;20H[K[22;9H[32m included file: Xtestfile[mmatch in file test32.in[22;24H[K[22;1H[1m-- Keyword completion (^N^P) The only match[5;9H[m[22;29H[K[22;1H[K[22;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[m[22;13H[K[22;4H[1mAdding Keyword completion (^N^P) -- Searching...[m[32mScanning: test32.in[m[22;20H[K[22;9H[32m included file: Xtestfile[mmatch in file test32.in[22;24H[K[22;1H[1m-- Adding Keyword completion (^N^P) The only match[5;19H[m[22;36H[K[22;1H[K[22;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[m[22;13H[K[22;4H[1mAdding Keyword completion (^N^P) -- Searching...[m[32mScanning: test32.in[m[22;20H[K[22;9H[32m included file: Xtestfile[mmatch in file test32.in[22;24H[K[22;1H[1m-- Adding Keyword completion (^N^P) The only match[5;28H[m[22;36H[K[22;1H[K[22;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[m[22;13H[K[22;4H[1m^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[m[22;13H[K[22;4H[1m^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[m[22;13H[K[22;4H[1mKeyword Local completion (^N^P) -- Searching...[m[22;36H[32mmatch 1 of 3[m[22;48H[K[5;29H[22;1H[K[22;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- Whole line completion (^L^N^P) -- Searching...[m[32mScanning: test32.in[m[22;20H[K[22;1H[1m-- Whole line completion (^L^N^P) [m[32mmatch 1 of 54[6;29H[m[22;4H[1mINSERT --[m[22;13H[K[22;1H[K[22;1H[1m-- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y) [m[32mmatch 1 of 54[m[22;4H[1mAdding Whole line completion (^L^N^P) -- Searching...[m[32mScanning: test32.in[m[22;20H[K[22;1H[1m-- Adding Whole line completion (^L^N^P) The only match[7;29H[m[22;41H[K[22;41H[1m [m[31mBack at original[7;1H[m[22;41H[K[22;41H[1m The only match[7;29H[5;10r[m[5;1H[3L[1;22r[5;1HMakefile[8Cto      run3
Makefile[8Cto      run3
Makefile[8Cto      run3[?12l[?25h[22;1H[K[?25l[22;1H[1m-- INSERT --[m[22;1H[K[7;28H[?12l[?25h[8;9H[?25l[22;1H:[?12l[?25hse cpt=kXtestfile[?25l[8;9H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw Xtest11.one[?25l"Xtest11.one" [New] 9L, 104C written[11;1H[1m[7mXtest11.one   [8;9H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hw Xtest11.two[?25l"Xtest11.two" [New] 9L, 104C written[8;9H[?12l[?25h[?25l[22;1H[1m-- INSERT --[m[22;13H[K[22;4H[1mKeyword completion (^N^P) -- Searching...[m[32mScanning dictionary: Xtestfile[m[22;31H[K[22;1Hmatch in file Xtestfile[22;24H[K[22;1H[1m-- Keyword completion (^N^P) [m[32mmatch 1 of 9[8;7H[mtest11[8;7H[K[9;1Hrun1 run2[10;1H[K[11;13H[1m[7m[+][8;7H[mI[?12l[?25h [22;1H[K[?25l[22;1H[1m-- Keyword completion (^N^P) [m[32mmatch 1 of 9[m[22;1H[K[22;1H[1m-- INSERT --[m[22;1H[K[8;6H[?12l[?25h[?25l[22;1H[1m-- INSERT --[m[22;1H[K[8;1HXtest11[?12l[?25h[?25l[22;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- File name completion (^F^N^P) -- Searching...[m[22;34H[32mmatch 1 of 2[m[22;46H[K[8;12H[22;33H[K[22;33H[1m [m[32mmatch 2 of 2[8;12H[m.two[?12l[?25h[22;1H[K[?25l[22;1H[1m-- INSERT --[m[22;1H[K[8;11H[?12l[?25h[9;9H[?25l[22;1H:[?12l[?25hse cpt=w[?25l[9;9H[?12l[?25h[?25l[22;1H[1m-- INSERT ---- Keyword completion (^N^P) -- Searching...[m[32mScanning: test32.in[m[22;20H[K[22;1Hmatch in file test32.in[1m-- Keyword completion (^N^P) The only match[9;10H[m[22;29H[K[22;29H[1m [m[31mBack at original[9;3H[m[22;29H[K[22;1Hmatch in file test32.in[22;24H[K[22;1H[1m-- Keyword completion (^N^P) The only match[9;10H[m[22;29H[K[22;29H[1m [m[31mBack at original[9;3H[m[22;29H[K[22;1Hmatch in file test32.in[22;24H[K[22;1H[1m-- Keyword completion (^N^P) The only match[9;10H[mSTARTTEST
run1 run2[9;10H[?12l[?25h[22;1H[K[?25l[22;1H[1m-- Keyword completion (^N^P) The only match[m[22;1H[K[22;1H[1m-- INSERT --[m[22;1H[K[9;9H[?12l[?25h[10;9H[?25l[22;1H:[?12l[?25hse cpt=u nohid[?25l[10;9H[?12l[?25h[?25l[11;1H[K[12;1H[1m[34m~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [10;9H[?12l[?25h[?25l[m[22;1H[1m-- INSERT --[m[22;13H[K[22;4H[1mKeyword completion (^N^P) -- Searching...[m[32mScanning: test32.in[m[22;20H[K[22;1Hmatch in file test32.in[1m-- Keyword completion (^N^P) The only match[10;8H[m[22;1H[K[22;1H[1m-- INSERT ---- Keyword completion (^N^P) -- Searching...[m[32mScanning: test32.in[m[22;20H[K[22;1Hmatch in file test32.in[1m-- Keyword completion (^N^P) [m[32mmatch 1 of 3[11;7H[m[22;29H[K[22;1H[K[22;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[m[22;13H[K[22;4H[1m^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[m[22;13H[K[22;4H[1mKeyword completion (^N^P) -- Searching...[m[32mScanning: test32.in[m[22;20H[K[22;1Hmatch in file test32.in[1m-- Keyword completion (^N^P) The only match[11;7H[10;21r[m[10;1H[2L[1;22r[10;1HENDTEST
unless[?12l[?25h[22;1H[K[?25l[22;1H[1m-- Keyword completion (^N^P) The only match[m[22;1H[K[22;1H[1m-- INSERT --[m[22;1H[K[11;6H[?12l[?25h[12;6H[?25l[22;1H:[?12l[?25hse cpt=t,d def=^\\k* tags=Xtestfile notagbsearch[?25l[12;6H[?12l[?25h[?25l[22;1H[1m-- INSERT --[m[22;13H[K[22;4H[1m^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- Tag completion (^]^N^P) -- Searching...[m[22;28H[32mmatch 1 of 3[m[22;40H[K[12;7H[22;4H[1mINSERT --[m[22;13H[K[22;1H[K[22;1H[1m-- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y) [m[32mmatch 1 of 3[m[22;4H[1mDefinition completion (^D^N^P) -- Searching...[m[22;50H[K[22;1H[32mScanning included file: Xtestfile[m[22;34H[K[22;1Hmatch in file Xtestfile[22;24H[K[22;1H[1m-- Definition completion (^D^N^P) The only match[12;11H[22;4HINSERT --[m[22;13H[K[22;1H[K[22;1H[1m-- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y) The only match-- Adding Definition completion (^D^N^P) -- Searching...[m[32mScanning included file: Xtestfile[m[22;34H[K[22;1Hmatch in file Xtestfile[22;24H[K[22;1H[1m-- Adding Definition completion (^D^N^P) The only match[12;20H[22;4HINSERT --[m[22;13H[K[22;1H[K[22;1H[1m-- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y) The only match-- INSERT --[m[22;13H[K[22;4H[1m^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- Definition completion (^D^N^P) -- Searching...[m[32mScanning included file: Xtestfile[m[22;34H[K[22;1Hmatch in file Xtestfile[22;24H[K[22;1H[1m-- Definition completion (^D^N^P) The only match[12;25H[22;4HINSERT --[m[22;13H[K[22;1H[K[22;1H[1m-- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y) The only match-- Adding Definition completion (^D^N^P) -- Searching...[m[32mScanning included file: Xtestfile[m[22;34H[K[22;1Hmatch in file Xtestfile[22;24H[K[22;1H[1m-- Adding Definition completion (^D^N^P) The only match[12;37H[22;4HINSERT --[m[22;13H[K[22;1H[K[22;1H[1m-- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y) The only match-- Adding Definition completion (^D^N^P) -- Searching...[m[32mScanning included file: Xtestfile[m[22;34H[K[22;1Hmatch in file Xtestfile[22;24H[K[22;1H[1m-- Adding Definition completion (^D^N^P) The only match[12;38H[22;4HINSERT --[m[22;13H[K[22;1H[K[22;1H[1m-- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y) The only match-- Adding Definition completion (^D^N^P) -- Searching...[m[32mScanning included file: Xtestfile[m[22;34H[K[22;1Hmatch in file Xtestfile[22;24H[K[22;1H[1m-- Adding Definition completion (^D^N^P) Word from other line[12;42H[22;4HINSERT --[m[22;13H[K[22;1H[K[22;1H[1m-- Keyword completion (^N^P) -- Searching...[m[32mScanning tags.[m[22;15H[K[22;10H[32mincluded file: Xtestfile[m[1m-- Keyword completion (^N^P) The only match[13;4H[12;21r[m[12;1H[2L[1;22r[12;1Htest11file      36Gepeto[8C/Tag/ asd
asd[?12l[?25h[22;1H[K[?25l[22;1H[1m-- Keyword completion (^N^P) The only match[m[22;1H[K[22;1H[1m-- INSERT --[m[22;1H[K[13;3H[?12l[?25h
ru[?25l[22;1H:[?12l[?25hwq! test.out[?25l"test.out" [22;12H[K[22;12H[New] 15L, 175C written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test33.failed test.ok test.out X* viminfo
cp test33.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test33.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test33.in" 34 lines, 616 characters[1;1HTest for 'lisp'
If the lisp feature is not enabled, this will fail!

STARTTEST
:so small.vim
:set lisp
/^(defun
=G:/^(defun/,$w! test.out
:q!
ENDTEST

(defun html-file (base)
(format nil "~(~A~).html" base))

(defmacro page (name title &rest body)
(let ((ti (gensym)))
`(with-open-file (*standard-output*
(html-file ,name)
:direction :output
:if-exists :supersede)
(let ((,ti ,title))[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for 'lisp'[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[4;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 5 lines, 63 characters written[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[5;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[10;1H[?12l[?25h
[?25l[22;1H[K[22;1H:so! Xdotest[11;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[11;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset lisp[?25l[11;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h^(defun[?25l[12;1H[?12l[?25h[?25l[22;1H22 lines to indent...23[7Cindented [22;19H[K[13;1H  (format nil "~(~A~).html" base))


  (let ((ti (gensym)))
       `(with-open-file (*standard-output*
                 [8C(html-file ,name)
                  [7C:direction :output
                         :if-exists :supersede)
                        (let ((,ti ,title))[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^(defun/,$w! test.out[?25l[31msearch hit BOTTOM, continuing at TOP[m"test.out" [22;12H[K[22;12H[New File] 23 lines, 544 characters written[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hq![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test34.failed test.ok test.out X* viminfo
cp test34.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test34.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test34.in" 58 lines, 1014 characters[1;1HTest for user functions.
Also test an <expr> mapping calling a function.

STARTTEST
:so small.vim
:function Table(title, ...)
:  let ret = a:title
:  let idx = 1
:  while idx <= a:0
:    exe "let ret = ret . a:" . idx
:    let idx = idx + 1
:  endwhile
:  return ret
:endfunction
:function Compute(n1, n2, divname)
:  if a:n2 == 0
:    return "fail"
:  endif
:  exe "let g:" . a:divname . " = ". a:n1 / a:n2
:  return "ok"
:endfunction[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for user functions.[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[4;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 51 lines, 916 characters written[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[5;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[27m[m[H[2J[1;1H:let counter = 0
:inoremap <expr> ( ListItem()
:inoremap <expr> [ ListReset()
:imap <expr> + Expr1()
:imap <expr> * Expr2()
:let retval = "nop"
/^here
C[34m^R[m=Table("xxx", 4, "asdf")
 [34m^R[m=Compute(45, 0, "retval")
 [34m^R[m=retval
 [34m^R[m=Compute(45, 5, "retval")
 [34m^R[m=retval

XX+-XX
---*---
(one
(two
[(one again[34m^[[m:$-5,$wq! test.out
ENDTEST

here[19;1H[?12l[?25h
[?25l

:so! Xdotest[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hfunction Table(title, ...)[?25l
:  [?12l[?25h:  let ret = a:title
[?25l:  [?12l[?25h:  let idx = 1
[?25l:  [?12l[?25h:  while idx <= a:0
[?25l:    [?12l[?25h:    exe "let ret = ret . a:" . idx
[?25l:    [?12l[?25h:    let idx = idx + 1
[?25l:    [?12l[?25h:  endwhile
[?25l:  [?12l[?25h:  return ret
[?25l:  [?12l[?25h:endfunction[1;1H[8L[?25l[1;1H:let counter = 0
:inoremap <expr> ( ListItem()
:inoremap <expr> [ ListReset()
:imap <expr> + Expr1()
:imap <expr> * Expr2()
:let retval = "nop"
/^here
C[34m^R[m=Table("xxx", 4, "asdf")[22;1H[K[20;1H[?12l[?25h[?25l

:[?12l[?25hfunction Compute(n1, n2, divname)[?25l
:  [?12l[?25h:  if a:n2 == 0
[?25l:    [?12l[?25h:    return "fail"
[?25l:    [?12l[?25h:  endif
[?25l:  [?12l[?25h:  exe "let g:" . a:divname . " = ". a:n1 / a:n2
[?25l:  [?12l[?25h:  return "ok"
[?25l:  [?12l[?25h:endfunction[1;1H[6L[?25l[1;1H:let counter = 0
:inoremap <expr> ( ListItem()
:inoremap <expr> [ ListReset()
:imap <expr> + Expr1()
:imap <expr> * Expr2()
:let retval = "nop"[22;1H[K[20;1H[?12l[?25h[?25l

:[?12l[?25hfunc Expr1()[?25l
:  [?12l[?25h:  normal! v
[?25l:  [?12l[?25h:  return "111"
[?25l:  [?12l[?25h:endfunc[1;1H[3L[?25l[1;1H:let counter = 0
:inoremap <expr> ( ListItem()
:inoremap <expr> [ ListReset()[22;1H[K[20;1H[?12l[?25h[?25l

:[?12l[?25hfunc Expr2()[?25l
:  [?12l[?25h:  call search('XX', 'b')
[?25l:  [?12l[?25h:  return "222"
[?25l:  [?12l[?25h:endfunc[1;1H[3L[?25l[1;1H:let counter = 0
:inoremap <expr> ( ListItem()
:inoremap <expr> [ ListReset()[22;1H[K[20;1H[?12l[?25h[?25l

:[?12l[?25hfunc ListItem()[?25l
:  [?12l[?25h:  let g:counter += 1
[?25l:  [?12l[?25h:  return g:counter . '. '
[?25l:  [?12l[?25h:endfunc[1;1H[3L[?25l[1;1H:let counter = 0
:inoremap <expr> ( ListItem()
:inoremap <expr> [ ListReset()[22;1H[K[20;1H[?12l[?25h[?25l

:[?12l[?25hfunc ListReset()[?25l
:  [?12l[?25h:  let g:counter = 0
[?25l:  [?12l[?25h:  return ''
[?25l:  [?12l[?25h:endfunc[1;1H[3L[?25l[1;1H:let counter = 0
:inoremap <expr> ( ListItem()
:inoremap <expr> [ ListReset()[22;1H[K[20;1H[?12l[?25h[?25l

:[?12l[?25hlet counter = 0[?25l[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hinoremap <expr> ( ListItem()[?25l[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hinoremap <expr> [ ListReset()[?25l[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25himap <expr> + Expr1()[?25l[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25himap <expr> * Expr2()[?25l[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hlet retval = "nop"[?25l[20;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h^here[?25l[21;1H[?12l[?25h[?25lher$[22;1H[K[22;1H=[?12l[?25hTable("xxx", 4, "asdf")[?25l[22;1H[K[22;1H=[?12l[?25hCompute(45, 0, "retval")[?25l[22;1H[K[22;1H=[?12l[?25hretval[?25l[22;1H[K[22;1H=[?12l[?25hCompute(45, 5, "retval")[?25l[22;1H[K[22;1H=[?12l[?25hretval
[?25l[1m[37m[41mError detected while processing function Expr1:[m
[33mline    1:[m
[1m[37m[41mE523: Not allowed here[m
[32mPress ENTER or type command to continue[?12l[?25h[m[1;1H[4L[?25l[1;1H:let retval = "nop"
/^here
C[34m^R[m=Table("xxx", 4, "asdf")
 [34m^R[m=Compute(45, 0, "retval")
 [34m^R[m=retval[5;11H[K[6;1H [34m^R[m=Compute(45, 5, "retval")
 [34m^R[m=retval[8;1H[K[9;1HXX+-XX[9;7H[K[10;1H---*---[10;8H[K[11;1H(one[11;5H[K[12;1H(two[12;5H[K[13;1H[(one again[34m^[[m:$-5,$wq! test.out
ENDTEST[15;1H[K[16;1Hxxx4asdf fail nop ok 9
XX111XX
---222---[18;10H[K[19;1H1. one[19;7H[K[20;1H2. two[21;1H[K[22;1H[K[21;1H[?12l[?25h[?25l1. one again[?12l[?25h[?25l
:[?12l[?25h$-5,$wq! test.out[?25l"test.out" [22;12H[K[22;12H[New File] 6 lines, 68 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test35.failed test.ok test.out X* viminfo
cp test35.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test35.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test35.in" 21 lines, 448 characters[1;1HTest Ctrl-A and Ctrl-X, which increment and decrement decimal, hexadecimal,
and octal numbers.

STARTTEST
/^start-here
:set nrformats=octal,hex
j[34m^A[m102[34m^X^A[ml[34m^X[ml[34m^A[m64[34m^A[m128[34m^X[m$[34m^X[m
:set nrformats=octal
0[34m^A[m102[34m^X^A[ml[34m^X[m2[34m^A[mw65[34m^A[m129[34m^X[mblx6lD
:set nrformats=hex
0101[34m^X[ml257[34m^X^A[mTxldt [34m^A[m [34m^X[m [34m^X[m
:set nrformats=
0200[34m^X[ml100[34m^X[mw78[34m^X^A[mk
:$-3,$wq! test.out
ENDTEST

start-here
100     0x100     077     0
100     0x100     077
100     0x100     077     0xfF     0xFf
100     0x100     077[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest Ctrl-A and Ctrl-X, which increment and decrement decimal, hexadecimal,[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[4;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 10 lines, 200 characters written[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[5;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[15;1H[?12l[?25h
[?25l[22;1H[K[22;1H:so! Xdotest[16;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h^start-here[?25l[17;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset nrformats=octal,hex[?25l[17;1H[?12l[?25h
[?25l101[?12l[?25h[?25l-1     0x100     077     0[18;27H[K[18;2H[?12l[?25h[?25l0     0x100     077     0[18;26H[K[18;1H[?12l[?25h0[?25l[7C0ff[?12l[?25hf[?25l     0100     0[18;20H[?12l[?25h[?25l20[?12l[?25h[?25l00[?12l[?25h0     [?25l-1[?12l[?25h[19;26H[?25l[22;1H[K[22;1H:[?12l[?25hset nrformats=octal[?25l[19;26H[?12l[?25h[?25l101[?12l[?25h[?25l-1     0x100     077 -[?12l[?25h[?25l0     0x100     077 [?12l[?25h0[?25l     -1x100     077[19;8H[?12l[?25h[?25l1x100     077 [19;7H[?12l[?25h[10C[?25l0200[?12l[?25h[?25l37777777777[?12l[?25h[19;17H0[?25l7[9C [19;18H[?12l[?25h777777[?25l[19;24H[K[19;23H[?12l[?25h[20;23H[?25l[22;1H[K[22;1H:[?12l[?25hset nrformats=hex[?25l[20;23H[?12l[?25h[?25l-1     0x100     077     0xfF     0xFf[20;39H[K[20;2H[?12l[?25h1[?25l[7Cffffffff     077     0xfF     0xFf[20;17H[?12l[?25h[?25l[20;10H00000000[?12l[?25h[20;10H0[?25l     077     0xfF     0xFf[20;40H[K[20;11H[?12l[?25h[?25l[7C8[?12l[?25h8[?25l[7CFE[?12l[?25hE[?25l[7Cfe[?12l[?25h[21;26H[?25l[22;1H[K[22;1H:[?12l[?25hset nrformats=[?25l[21;26H[?12l[?25h[?25l-100     0x100     077-10[?12l[?25h0[?25l     -100x100     077[21;13H[?12l[?25h[10C[?25l-001[?12l[?25h[?25l000 [?12l[?25h[20;25H[21;25H[?25l[22;1H[K[22;1H:[?12l[?25h$-3,$wq! test.out[?25l"test.out" [22;12H[K[22;12H[New File] 4 lines, 120 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test36.failed test.ok test.out X* viminfo
cp test36.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test36.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test36.in" 40 lines, 1596 characters[1;1HTest character classes in regexp

STARTTEST
/^start-here
j:s/\d//g
j:s/\D//g
j:s/\o//g
j:s/\O//g
j:s/\x//g
j:s/\X//g
j:s/\w//g
j:s/\W//g
j:s/\h//g
j:s/\H//g
j:s/\a//g
j:s/\A//g
j:s/\l//g
j:s/\L//g
j:s/\u//g
j:s/\U//g
:/^start-here/+1,$wq! test.out[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest character classes in regexp[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 18 lines, 204 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[1;21r[21;1H
[1;22r[21;1HENDTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h^start-here[?25l[1;21r[21;1H
[1;22r[21;1Hstart-here[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[1;1H[2M[1;22r[20;9H[34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[21;1H[34m^?~@~B~P~[[m[20;8H[?12l[?25h[?25l

:[?12l[?25hs/\d//g[?25l10 substitutions on 1 line[20;29H:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[34m^?~@~B~P~[[[m[21;1H[21;7H[K[20;9H[?12l[?25h[?25l[1;21r[1;1H[2M[1;22r[20;9H[34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[21;1H[34m^?~@~B~P~[[m[22;1H[K[20;9H[?12l[?25h[?25l

:[?12l[?25hs/\D//g[?25l72 substitutions on 1 line[20;1H0123456789[20;11H[K[21;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[21;1H[1m[34m@                                                                               [20;1H[?12l[?25h[?25l[1;21r[m[21;1H
[1;22r[20;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[21;1H[34m^?~@~B~P~[[m[22;1H[K[20;8H[?12l[?25h[?25l

:[?12l[?25hs/\o//g[?25l8 substitutions on 1 line[20;29H89:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[34m^?~@~B~PP[21;1H~[[m[21;9H[K[20;9H[?12l[?25h[?25l[1;21r[1;1H[2M[1;22r[20;9H[34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[21;1H[34m^?~@~B~P~[[m[22;1H[K[20;9H[?12l[?25h[?25l

:[?12l[?25hs/\O//g[?25l74 substitutions on 1 line[20;1H01234567[20;9H[K[21;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[21;1H[1m[34m@                                                                               [20;1H[?12l[?25h[?25l[1;21r[m[21;1H
[1;22r[20;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[21;1H[34m^?~@~B~P~[[m[22;1H[K[20;8H[?12l[?25h[?25l

:[?12l[?25hs/\x//g[?25l22 substitutions on 1 line[20;29H:;<=>?@GHIXYZ[\]^_`ghiwxyz{|}~[34m^?~@~B~P~[[m[20;75H[K[21;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[21;1H[1m[34m@                                                                               [20;9H[?12l[?25h[?25l[1;21r[m[21;1H
[1;22r[20;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[21;1H[34m^?~@~B~P~[[m[22;1H[K[20;9H[?12l[?25h[?25l

:[?12l[?25hs/\X//g[?25l60 substitutions on 1 line[20;1H0123456789ABCDEFabcdef[20;23H[K[21;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[21;1H[1m[34m@                                                                               [20;1H[?12l[?25h[?25l[1;21r[m[21;1H
[1;22r[20;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[21;1H[34m^?~@~B~P~[[m[22;1H[K[20;8H[?12l[?25h[?25l

:[?12l[?25hs/\w//g[?25l36 substitutions on 1 line[20;29H:;<=>?@[\]^`{|}~[34m^?~@~B~P~[[m[20;61H[K[21;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[21;1H[1m[34m@                                                                               [20;9H[?12l[?25h[?25l[1;21r[m[21;1H
[1;22r[20;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[21;1H[34m^?~@~B~P~[[m[22;1H[K[20;9H[?12l[?25h[?25l

:[?12l[?25hs/\W//g[?25l46 substitutions on 1 line[20;1H0123456789ABCDEFGHIXYZ_abcdefghiwxyz[20;37H[K[21;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[21;1H[1m[34m@                                                                               [20;1H[?12l[?25h[?25l[1;21r[m[21;1H
[1;22r[20;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[21;1H[34m^?~@~B~P~[[m[22;1H[K[20;8H[?12l[?25h[?25l

:[?12l[?25hs/\h//g[?25l26 substitutions on 1 line[20;46H[\]^`{|}~[34m^?~@~B~P~[[m[20;71H[K[21;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[21;1H[1m[34m@                                                                               [20;9H[?12l[?25h[?25l[1;21r[m[21;1H
[1;22r[20;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[21;1H[34m^?~@~B~P~[[m[22;1H[K[20;9H[?12l[?25h[?25l

:[?12l[?25hs/\H//g[?25l56 substitutions on 1 line[20;1HABCDEFGHIXYZ_abcdefghiwxyz[20;27H[K[21;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[21;1H[1m[34m@                                                                               [20;1H[?12l[?25h[?25l[1;21r[m[21;1H
[1;22r[20;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[21;1H[34m^?~@~B~P~[[m[22;1H[K[20;8H[?12l[?25h[?25l

:[?12l[?25hs/\a//g[?25l25 substitutions on 1 line[20;46H[\]^_`{|}~[34m^?~@~B~P~[[m[20;72H[K[21;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[21;1H[1m[34m@                                                                               [20;9H[?12l[?25h[?25l[1;21r[m[21;1H
[1;22r[20;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[21;1H[34m^?~@~B~P~[[m[22;1H[K[20;9H[?12l[?25h[?25l

:[?12l[?25hs/\A//g[?25l57 substitutions on 1 line[20;1HABCDEFGHIXYZabcdefghiwxyz[20;26H[K[21;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[21;1H[1m[34m@                                                                               [20;1H[?12l[?25h[?25l[1;21r[m[21;1H
[1;22r[20;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[21;1H[34m^?~@~B~P~[[m[22;1H[K[20;8H[?12l[?25h[?25l

:[?12l[?25hs/\l//g[?25l13 substitutions on 1 line[20;64H{|}~[34m^?~@~B~P~[[m[21;1H[21;4H[K[20;9H[?12l[?25h[?25l[1;21r[1;1H[2M[1;22r[20;9H[34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[21;1H[34m^?~@~B~P~[[m[22;1H[K[20;9H[?12l[?25h[?25l

:[?12l[?25hs/\L//g[?25l69 substitutions on 1 line[20;1Habcdefghiwxyz[20;14H[K[21;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[21;1H[1m[34m@                                                                               [20;1H[?12l[?25h[?25l[1;21r[m[21;1H
[1;22r[20;1H        [34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[21;1H[34m^?~@~B~P~[[m[22;1H[K[20;8H[?12l[?25h[?25l

:[?12l[?25hs/\u//g[?25l12 substitutions on 1 line[20;46H[\]^_`abcdefghiwxyz{|}~[34m^?~@~B~P~[[m[21;1H[21;5H[K[20;9H[?12l[?25h[?25l[1;21r[1;1H[2M[1;22r[20;9H[34m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~~[21;1H[34m^?~@~B~P~[[m[22;1H[K[20;9H[?12l[?25h[?25l

:[?12l[?25hs/\U//g[?25l70 substitutions on 1 line[20;1HABCDEFGHIXYZ[20;14H[K[21;1H[1m[34m~                                                                               [20;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25h/^start-here/+1,$wq! test.out[?25l[31msearch hit BOTTOM, continuing at TOP[m"test.out" [22;12H[K[22;12H[New File] 16 lines, 672 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test37.failed test.ok test.out X* viminfo
cp test37.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test37.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test37.in" 116 lines, 3262 characters[1;1HTest for 'scrollbind'. <eralston@computer.org>   Do not add a line below!
STARTTEST
:so small.vim
:set noscrollbind
:set scrollopt=ver,jump
:set scrolloff=2
:set nowrap
:set noequalalways
:set splitbelow
:" TEST using two windows open to one buffer, one extra empty window
:split
:new
[34m^W[mt:
:resize 8
/^start of window 1$/
zt:
:set scrollbind
[34m^W[mj:
:resize 7
/^start of window 2$/
zt:[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for 'scrollbind'. <eralston@computer.org>   Do not add a line below![22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[2;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[3;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 72 lines, 1498 characters written[3;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[3;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[27m[m[H[2J[1;1H[34m^W[mt:set noscb
ggL[34m^W[mj:set noscb
ggL:set scb
[34m^W[mt:set scb
[34m^W[mtG[34m^W[mjG[34m^W[mt:syncbind
Hk[34m^W[mjH[34m^W[mtHyy[34m^W[mbp[34m^W[mt[34m^W[mjyy[34m^W[mbp:
[34m^W[mtH3k[34m^W[mjH[34m^W[mtHyy[34m^W[mbp[34m^W[mt[34m^W[mjyy[34m^W[mbp:
:" ***** done with tests *****
:w! test.out[13C" Write contents of this file
:qa!
ENDTEST


start of window 1
. line 01 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01
. line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02
. line 03 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 03
. line 04 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 04
. line 05 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05
. line 06 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06
. line 07 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 07[11;1H[?12l[?25h
[?25l[22;1H:so! Xdotest[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset noscrollbind[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset scrollopt=ver,jump[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset scrolloff=2[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset nowrap[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset noequalalways[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset splitbelow[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" TEST using two windows open to one buffer, one extra empty window[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hsplit[?25l[1;1H:" ***** done with tests *****
:w! test.out    [9C" Write contents of this file
:qa![3;5H[K[4;1HENDTEST[4;9H[K[5;1H[K[6;1H[K[7;1Hstart of window 1[7;18H[K[8;1H. line 01 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01
. line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[9;51H[K[10;1H[7mtest37.in                                                                       [m[11;1H:qa![11;5H[K[12;1HENDTEST[14;1H[K[15;1Hstart of window 1[15;18H[K[16;9H1[39C1[17;9H2[39C2[18;9H3[39C3[19;9H4[39C4[20;9H5[39C5
[1m[7mtest37.in                                                                       [13;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hnew[?25l[11;1HENDTEST[12;1H[K[14;1Hstart of window 1
[7mtest37.in                                                                       [m[16;1H[K[17;1H[1m[34m~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [m[21;1H[1m[7m[No Name][16;1H[?12l[?25h[10;1Htest37.in                                                                       [m[21;1H[7m[No Name]                                                                       [5;1H[?25l[m[22;1H[K[22;1H:[?12l[?25h[?25l[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hresize 8[?25l[9;1H[1m[7mtest37.in                                                                       [m[10;1HENDTEST[10;8H[K[11;1H[K[13;1Hstart of window 1
. line 01 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01[5;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h^start of window 1$/[?25l[22;21H[K[22;1H[1;8r[8;1H
[1;22r[8;1H. line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[22;1H[K[6;1H[?12l[?25h[?25l[1;8r[1;1H[3M[1;22r[6;1H. line 03 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 03
. line 04 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 04
. line 05 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05[3;1H[?12l[?25h[?25l[22;1H:[?12l[?25h[?25l[3;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset scrollbind[?25l[3;1H[?12l[?25h[?25l[9;1H[7mtest37.in                                                                       [10;14r[m[10;1H[L[1;22r[10;1H:qa![15;1H[1m[7mtest37.in                                                                       [m[22;1H[K[12;1H[?12l[?25h[?25l[22;1H:[?12l[?25h[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hresize 7[?25l[10;2Hw! test.out[13C" Write contents of this file
:qa![11;5H[K[12;1HENDTEST[14;1H[K[15;1Hstart of window 1[15;18H[K[16;1H. line 01 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01
[1m[7mtest37.in                                                                       [m[18;1H[K[13;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h^start of window 2$/[?25l[22;21H[K[22;1H[10;1Hend of window 1[10;26H[K[11;1H[K[12;1H[K[13;1Hstart of window 2
. line 01 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 01
. line 02 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 02[16;9H3 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 03[13;1H[?12l[?25h[?25l[10;16r[16;1H
[1;22r[16;1H. line 04 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 04[22;1H[K[12;1H[?12l[?25h[?25l[22;1H:[?12l[?25h[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset scrollbind[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" -- start of tests --[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" TEST scrolling down[?25l[12;1H[?12l[?25h

[?25l[1;8r[1;1H[5M[1;22r[4;1H. line 06 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06
. line 07 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 07
. line 08 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 08
. line 09 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 09
. line 10 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 10[10;16r[10;1H[5M[1;22r[12;1H. line 05 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 05
. line 06 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 06
. line 07 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 07
. line 08 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 08
. line 09 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 09[22;1H[K[14;1H[?12l[?25h[12;1H[17;1H[7mtest37.in                                                                       [m[21;1H[1m[7m[No Name]                                                                       [18;1H[?25l[m
. line 05 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 05[19;50H[K[21;11H[1m[7m[+][19;1H[?12l[?25h[?25l[m0[?12l[?25h[9;1H[1m[7mtest37.in                                                                       [m[21;1H[7m[No Name] [+]                                                                   [3;1H[9;1Htest37.in                                                                       [m[21;1H[1m[7m[No Name] [+]                                                                   [19;1H[?25l[m
. line 05 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05[20;50H[K[20;1H[?12l[?25h[?25l1[?12l[?25h[9;1H[1m[7mtest37.in                                                                       [m[21;1H[7m[No Name] [+]                                                                   [3;1H


[?25l[1;8r[m[1;1H[6M[1;22r[3;1H. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11
. line 12 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 12
. line 13 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 13
. line 14 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 14
. line 15 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 15
end of window 1[10;16r[10;1H[6M[1;22r[11;1H. line 10 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 10
. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11
. line 12 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 12
. line 13 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 13
. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14
. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15[6;1H[?12l[?25h[3;1H[9;1H[7mtest37.in                                                                       [m[21;1H[1m[7m[No Name] [+]                                                                   [20;1H[?25l[18;20r[m[20;1H
[1;22r[20;1H. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11[?12l[?25h[?25l2[?12l[?25h[17;1H[1m[7mtest37.in                                                                       [m[21;1H[7m[No Name] [+]                                                                   [12;1H[17;1Htest37.in                                                                       [m[21;1H[1m[7m[No Name] [+]                                                                   [20;1H[?25l[18;20r[m[20;1H
[1;22r[20;1H. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11[?12l[?25h[?25l3[?12l[?25h[?25l

:[?12l[?25h[?25l[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" TEST scrolling up[?25l[20;1H[?12l[?25h[9;1H[1m[7mtest37.in                                                                       [m[21;1H[7m[No Name] [+]                                                                   [3;1H[?25l[1;8r[m[1;1H[5L[1;22r[1;1H. line 04 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 04
. line 05 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05
. line 06 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06
. line 07 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 07
. line 08 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 08[10;9H4[39C4[11;8H05[38C05[12;8H06[38C06[13;8H07[38C07[14;8H08[38C08[15;8H09[38C09[16;9H0[39C0[22;1H[K[4;1H[?12l[?25h[9;1H[7mtest37.in                                                                       [m[17;1H[1m[7mtest37.in                                                                       [14;1H[12;1H[9;1Htest37.in                                                                       [m[17;1H[7mtest37.in                                                                       [4;1H[3;1H[9;1Htest37.in                                                                       [m[21;1H[1m[7m[No Name] [+]                                                                   [20;1H[?25l[18;20r[m[20;1H
[1;22r[20;1H. line 06 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06[?12l[?25h[?25l4[?12l[?25h[17;1H[1m[7mtest37.in                                                                       [m[21;1H[7m[No Name] [+]                                                                   [12;1H[17;1Htest37.in                                                                       [m[21;1H[1m[7m[No Name] [+]                                                                   [20;1H[?25l[18;20r[m[20;1H
[1;22r[20;1H. line 06 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 06[?12l[?25h[?25l5[?12l[?25h[17;1H[1m[7mtest37.in                                                                       [m[21;1H[7m[No Name] [+]                                                                   [12;1H[?25l[1;8r[m[1;1H[4L[1;22r[1;1Hstart of window 1
. line 01 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01
. line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02
. line 03 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 03[10;16r[10;1H[4L[1;22r[10;1Hstart of window 2
. line 01 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 01
. line 02 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 02
. line 03 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 03[?12l[?25h[9;1H[1m[7mtest37.in                                                                       [m[17;1H[7mtest37.in                                                                       [6;1H[3;1H[9;1Htest37.in                                                                       [m[17;1H[1m[7mtest37.in                                                                       [13;1H[12;1H[m[17;1H[7mtest37.in                                                                       [m[21;1H[1m[7m[No Name] [+]                                                                   [20;1H[?25l[18;20r[m[20;1H
[1;22r[20;1H. line 02 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 02[?12l[?25h[?25l6[?12l[?25h[9;1H[1m[7mtest37.in                                                                       [m[21;1H[7m[No Name] [+]                                                                   [3;1H[9;1Htest37.in                                                                       [m[21;1H[1m[7m[No Name] [+]                                                                   [20;1H[?25l[18;20r[m[20;1H
[1;22r[20;1H. line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[?12l[?25h[?25l7[?12l[?25h[?25l

:[?12l[?25h[?25l[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" TEST horizontal scrolling[?25l[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset scrollopt+=hor[?25l[20;1H[?12l[?25h[?25l[18;1H[K[19;1H0[7C5[39C5
1[7C5[39C5[18;1H[?12l[?25h[?25l5 line 06 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 06
6[7C2[39C2
7[7C2[39C2[?12l[?25h[?25l[18;20r[20;1H
[1;22r[22;1H[K[20;1H[?12l[?25h[9;1H[1m[7mtest37.in                                                                       [m[21;1H[7m[No Name] [+]                                                                   [3;1H[?25l[m[1;1H 1[1;3H[K[2;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01[2;35H[K[3;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[3;35H[K[4;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 03[4;35H[K[5;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 04[5;35H[K[6;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05[6;35H[K[7;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06[7;35H[K[8;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 07[8;35H[K[10;1H 2[10;3H[K[11;1HUTSRQPONMLKJIHGREDCBA9876543210 01[11;35H[K[12;1HUTSRQPONMLKJIHGREDCBA9876543210 02[12;35H[K[13;1HUTSRQPONMLKJIHGREDCBA9876543210 03[13;35H[K[14;1HUTSRQPONMLKJIHGREDCBA9876543210 04[14;35H[K[15;1HUTSRQPONMLKJIHGREDCBA9876543210 05[15;35H[K[16;1HUTSRQPONMLKJIHGREDCBA9876543210 06[16;35H[K[3;1H[?12l[?25h[9;1H[7mtest37.in                                                                       [m[21;1H[1m[7m[No Name] [+]                                                                   [20;1H[?25l[m56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[?12l[?25h[?25l[18;20r[20;1H
[1;22r[20;1H[?12l[?25h[17;1H[1m[7mtest37.in                                                                       [m[21;1H[7m[No Name] [+]                                                                   [12;1H[17;1Htest37.in                                                                       [m[21;1H[1m[7m[No Name] [+]                                                                   [20;1H[?25l[mUTSRQPONMLKJIHGREDCBA9876543210 02[?12l[?25h[?25l[18;20r[20;1H
[1;22r[20;1H[?12l[?25h[?25l

:[?12l[?25h[?25l[20;1H[?12l[?25h[17;1H[1m[7mtest37.in                                                                       [m[21;1H[7m[No Name] [+]                                                                   [12;1H[?25l[m[1;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 09[2;33H10[3;33H11[4;33H12[5;33H13[6;33H14[7;33H15[8;1H[K[10;1HUTSRQPONMLKJIHGREDCBA9876543210 09[11;33H10[12;33H11[13;33H12[14;33H13[15;33H14[16;33H15[13;1H[?12l[?25h[?25l[1;1H. line 09 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 09
. line 10 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 10
. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11
. line 12 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 12
. line 13 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 13
. line 14 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 14
. line 15 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 15
end of window 1

. line 09 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 09
. line 10 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 10
. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11
. line 12 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 12
. line 13 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 13
. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14
. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15[12;1H[?12l[?25h[?25l[?12l[?25h[17;1H[7mtest37.in                                                                       [m[21;1H[1m[7m[No Name] [+]                                                                   [20;1H[?25l[m. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11[?12l[?25h[?25l[18;20r[20;1H
[1;22r[22;1H[K[20;1H[?12l[?25h[9;1H[1m[7mtest37.in                                                                       [m[21;1H[7m[No Name] [+]                                                                   [3;16H[9;1Htest37.in                                                                       [m[21;1H[1m[7m[No Name] [+]                                                                   [20;1H[?25l[m. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11[?12l[?25h[?25l[18;20r[20;1H
[1;22r[20;1H[?12l[?25h[?25l

:[?12l[?25h[?25l[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset scrollopt-=hor[?25l[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" ****** tests using two different buffers *****[?25l[20;1H[?12l[?25h[9;1H[1m[7mtest37.in                                                                       [m[21;1H[7m[No Name] [+]                                                                   [3;1H[9;1Htest37.in                                                                       [m[17;1H[1m[7mtest37.in                                                                       [12;1H[?25l[m[22;1H[K[22;1H:[?12l[?25h[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hclose[?25l[9;1H[K[10;1H[K[11;1Hstart of window 2[11;18H[K[12;8H0[39C0[13;8H0[39C0[14;8H0[39C0[15;8H0[39C0[16;8H0[39C0[3;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[?25l[3;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset noscrollbind[?25l[3;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^start of window 2$/,/^end of window 2$/y[?25l18 lines yanked[22;16H[K[3;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hnew[?25l[8;1H[7mtest37.in                                                                       [m[10;1H[1m[34m~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [m[17;1H[1m[7m[No Name][9;1H[?12l[?25h[8;1Htest37.in                                                                       [m[17;1H[7m[No Name]                                                                       [3;1H[8;1Htest37.in                                                                       [m[17;1H[1m[7m[No Name]                                                                       [9;1H[?25l[m[22;1H4 more lines[10;1H[K[11;1H[K[12;1H[K[13;1H[K[17;11H[1m[7m[+][10;1H[?12l[?25h


[?25l[m[22;1H18 more lines[14;1Hstart of window 2[14;18H[K[15;1H. line 01 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 01[15;50H[K[16;1H. line 02 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 02[16;50H[K[14;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[?25l[14;1H[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[17;1H[7m[No Name] [+]                                                                   [3;1H[?25l[m[22;1H[K[22;1H/[?12l[?25h^start of window 1$/[?25l[22;21H[K[22;1H[31msearch hit BOTTOM, continuing at TOP[m[1;1HENDTEST[1;8H[K[2;1H[K[3;1H[K[4;1Hstart of window 1[4;18H[K[5;8H01[38C01[6;8H02[38C02[7;8H03[38C03[4;1H[?12l[?25h[?25l[1;7r[7;1H
[1;22r[7;1H. line 04 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 04[22;1H[K[3;1H[?12l[?25h[?25l[22;1H:[?12l[?25h[?25l[3;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset scrollbind[?25l[3;1H[?12l[?25h[8;1H[7mtest37.in                                                                       [m[17;1H[1m[7m[No Name] [+]                                                                   [14;1H[?25l[m[22;1H[K[22;1H:[?12l[?25h[?25l[14;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h^start of window 2$/[?25l[22;21H[K[22;1H[31msearch hit BOTTOM, continuing at TOP[14;1H[?12l[?25h[?25l[9;16r[m[9;1H[3M[1;22r[14;1H. line 03 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 03
. line 04 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 04
. line 05 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 05[22;1H[K[11;1H[?12l[?25h[?25l[22;1H:[?12l[?25h[?25l[11;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset scrollbind[?25l[11;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" -- start of tests --[?25l[11;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" TEST scrolling down[?25l[11;1H[?12l[?25h


[?25l[1;7r[1;1H[5M[1;22r[3;1H. line 05 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05
. line 06 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06
. line 07 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 07
. line 08 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 08
. line 09 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 09[9;16r[9;1H[5M[1;22r[12;1H. line 06 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 06
. line 07 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 07
. line 08 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 08
. line 09 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 09
. line 10 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 10[22;1H[K[14;1H[?12l[?25h[11;1H[17;1H[7m[No Name] [+]                                                                   [m[21;1H[1m[7m[No Name] [+]                                                                   [20;1H[?25l[18;20r[m[20;1H
[1;22r[20;1H. line 05 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 05[?12l[?25h[?25l0[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[21;1H[7m[No Name] [+]                                                                   [3;1H[8;1Htest37.in                                                                       [m[21;1H[1m[7m[No Name] [+]                                                                   [20;1H[?25l[18;20r[m[20;1H
[1;22r[20;1H. line 05 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05[?12l[?25h[?25l1[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[21;1H[7m[No Name] [+]                                                                   [3;1H

[?25l[1;7r[m[1;1H[6M[1;22r[2;1H. line 10 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 10
. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11
. line 12 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 12
. line 13 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 13
. line 14 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 14
. line 15 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 15[9;16r[9;1H[6M[1;22r[11;1H. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11
. line 12 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 12
. line 13 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 13
. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14
. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15
. line 16 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 16[5;1H[?12l[?25h[3;1H[8;1H[7mtest37.in                                                                       [m[21;1H[1m[7m[No Name] [+]                                                                   [20;1H[?25l[18;20r[m[20;1H
[1;22r[20;1H. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11[?12l[?25h[?25l2[?12l[?25h[17;1H[1m[7m[No Name] [+]                                                                   [m[21;1H[7m[No Name] [+]                                                                   [11;1H[17;1H[No Name] [+]                                                                   [m[21;1H[1m[7m[No Name] [+]                                                                   [20;1H[?25l[18;20r[m[20;1H
[1;22r[20;1H. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11[?12l[?25h[?25l3[?12l[?25h[?25l

:[?12l[?25h[?25l[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" TEST scrolling up[?25l[20;1H[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[21;1H[7m[No Name] [+]                                                                   [3;1H[?25l[m[1;9H4[39C4[2;8H05[38C05[3;8H06[38C06[4;8H07[38C07[5;8H08[38C08[6;8H09[38C09[7;9H0[39C0[9;16r[9;1H[5L[1;22r[9;1H. line 04 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 04
. line 05 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 05
. line 06 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 06
. line 07 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 07
. line 08 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 08[22;1H[K[4;1H[?12l[?25h[8;1H[7mtest37.in                                                                       [m[17;1H[1m[7m[No Name] [+]                                                                   [14;1H[11;1H[8;1Htest37.in                                                                       [m[17;1H[7m[No Name] [+]                                                                   [4;1H[3;1H[8;1Htest37.in                                                                       [m[21;1H[1m[7m[No Name] [+]                                                                   [20;1H[?25l[18;20r[m[20;1H
[1;22r[20;1H. line 06 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06[?12l[?25h[?25l4[?12l[?25h[17;1H[1m[7m[No Name] [+]                                                                   [m[21;1H[7m[No Name] [+]                                                                   [11;1H[17;1H[No Name] [+]                                                                   [m[21;1H[1m[7m[No Name] [+]                                                                   [20;1H[?25l[18;20r[m[20;1H
[1;22r[20;1H. line 06 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 06[?12l[?25h[?25l5[?12l[?25h[17;1H[1m[7m[No Name] [+]                                                                   [m[21;1H[7m[No Name] [+]                                                                   [11;1H[?25l[1;7r[m[1;1H[4L[1;22r[1;1Hstart of window 1
. line 01 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01
. line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02
. line 03 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 03[9;16r[9;1H[4L[1;22r[9;1Hstart of window 2
. line 01 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 01
. line 02 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 02
. line 03 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 03[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[17;1H[7m[No Name] [+]                                                                   [5;1H[3;1H[8;1Htest37.in                                                                       [m[17;1H[1m[7m[No Name] [+]                                                                   [12;1H[11;1H[m[17;1H[7m[No Name] [+]                                                                   [m[21;1H[1m[7m[No Name] [+]                                                                   [20;1H[?25l[18;20r[m[20;1H
[1;22r[20;1H. line 02 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 02[?12l[?25h[?25l6[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[21;1H[7m[No Name] [+]                                                                   [3;1H[8;1Htest37.in                                                                       [m[21;1H[1m[7m[No Name] [+]                                                                   [20;1H[?25l[18;20r[m[20;1H
[1;22r[20;1H. line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[?12l[?25h[?25l7[?12l[?25h[?25l

:[?12l[?25h[?25l[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" TEST horizontal scrolling[?25l[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset scrollopt+=hor[?25l[20;1H[?12l[?25h[?25l[18;1H[K[19;1H0[7C5[39C5
1[7C5[39C5[18;1H[?12l[?25h[?25l5 line 06 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 06
6[7C2[39C2
7[7C2[39C2[?12l[?25h[?25l[18;20r[20;1H
[1;22r[22;1H[K[20;1H[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[21;1H[7m[No Name] [+]                                                                   [3;1H[?25l[m[1;1H 1[1;3H[K[2;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01[2;35H[K[3;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[3;35H[K[4;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 03[4;35H[K[5;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 04[5;35H[K[6;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05[6;35H[K[7;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06[7;35H[K[9;1H 2[9;3H[K[10;1HUTSRQPONMLKJIHGREDCBA9876543210 01[10;35H[K[11;1HUTSRQPONMLKJIHGREDCBA9876543210 02[11;35H[K[12;1HUTSRQPONMLKJIHGREDCBA9876543210 03[12;35H[K[13;1HUTSRQPONMLKJIHGREDCBA9876543210 04[13;35H[K[14;1HUTSRQPONMLKJIHGREDCBA9876543210 05[14;35H[K[15;1HUTSRQPONMLKJIHGREDCBA9876543210 06[15;35H[K[16;1HUTSRQPONMLKJIHGREDCBA9876543210 07[16;35H[K[3;1H[?12l[?25h[8;1H[7mtest37.in                                                                       [m[21;1H[1m[7m[No Name] [+]                                                                   [20;1H[?25l[m56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[?12l[?25h[?25l[18;20r[20;1H
[1;22r[20;1H[?12l[?25h[17;1H[1m[7m[No Name] [+]                                                                   [m[21;1H[7m[No Name] [+]                                                                   [11;1H[17;1H[No Name] [+]                                                                   [m[21;1H[1m[7m[No Name] [+]                                                                   [20;1H[?25l[mUTSRQPONMLKJIHGREDCBA9876543210 02[?12l[?25h[?25l[18;20r[20;1H
[1;22r[20;1H[?12l[?25h[?25l

:[?12l[?25h[?25l[20;1H[?12l[?25h[17;1H[1m[7m[No Name] [+]                                                                   [m[21;1H[7m[No Name] [+]                                                                   [11;1H[?25l[m[1;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 09[2;33H10[3;33H11[4;33H12[5;33H13[6;33H14[7;33H15

UTSRQPONMLKJIHGREDCBA9876543210 09[10;33H10[11;33H11[12;33H12[13;33H13[14;33H14[15;33H15[16;33H16[12;1H[?12l[?25h[?25l[1;1H. line 09 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 09
. line 10 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 10
. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11
. line 12 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 12
. line 13 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 13
. line 14 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 14
. line 15 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 15

. line 09 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 09
. line 10 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 10
. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11
. line 12 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 12
. line 13 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 13
. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14
. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15
. line 16 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 16[11;1H[?12l[?25h[?25l[?12l[?25h[17;1H[7m[No Name] [+]                                                                   [m[21;1H[1m[7m[No Name] [+]                                                                   [20;1H[?25l[m. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11[?12l[?25h[?25l[18;20r[20;1H
[1;22r[22;1H[K[20;1H[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[21;1H[7m[No Name] [+]                                                                   [3;16H[8;1Htest37.in                                                                       [m[21;1H[1m[7m[No Name] [+]                                                                   [20;1H[?25l[m. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11[?12l[?25h[?25l[18;20r[20;1H
[1;22r[20;1H[?12l[?25h[?25l

:[?12l[?25h[?25l[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset scrollopt-=hor[?25l[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" TEST syncbind[?25l[20;1H[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[21;1H[7m[No Name] [+]                                                                   [3;1H[?25l[m[22;1H[K[22;1H:[?12l[?25hset noscb[?25l[3;1H[?12l[?25h[?25l[1;1HTest for 'scrollbind'. <eralston@computer.org>   Do not add a line below!
STARTTEST[2;11H[K[3;1H:so small.vim[3;14H[K[4;1H:set noscrollbind[4;18H[K[5;1H:set scrollopt=ver,jump[5;24H[K[6;1H:set scrolloff=2[6;17H[K[7;1H:set nowrap[7;12H[K[1;1H[?12l[?25h[5;1H


[7mtest37.in                                                                       [m[17;1H[1m[7m[No Name] [+]                                                                   [11;1H[?25l[m[22;1H[K[22;1H:[?12l[?25hset noscb[?25l[11;1H[?12l[?25h[?25l[9;1H[K[10;1H[K[11;1H[K[12;1H[K[13;1H[K[14;1Hstart of window 2[14;18H[K[15;8H01[38C01[16;8H02[38C02[9;1H[?12l[?25h[14;1H[?25l[22;1H[K[22;1H:[?12l[?25hset scb[?25l[14;1H[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[17;1H[7m[No Name] [+]                                                                   [5;1H[?25l[m[22;1H[K[22;1H:[?12l[?25hset scb[?25l[5;1H[?12l[?25h[?25l[1;1H. line 13 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 13[1;50H[K[2;1H. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14
. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15
. line 16 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 16
end of window 2[5;16H[K[6;1H[K[7;1Hend of test37.in (please don't delete this line)

end of window 2
[1m[34m~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [7;1H[?12l[?25h[?25l[m[1;1Hzt:[1;4H[K[2;1H:set scrollbind[2;16H[K[3;1H:" -- start of tests --[3;24H[K[4;1H:" TEST scrolling down[4;23H[K[5;1HL5jHyy[34m^W[mbpr0[34m^W[mtHyy[34m^W[mbpr1[34m^W[mtL6jHyy[34m^W[mbpr2[34m^W[mkHyy[34m^W[mbpr3:
:" TEST scrolling up
[34m^W[mtH4k[34m^W[mjH[34m^W[mtHyy[34m^W[mbpr4[34m^W[mkHyy[34m^W[mbpr5[34m^W[mk3k[34m^W[mtH[34m^W[mjHyy[34m^W[mbpr6[34m^W[mtHyy[34m^W[mbpr7:
[7mtest37.in                                                                       [9;16r[m[9;1H[2L[1;22r[9;1H. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15
. line 16 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 16[17;1H[1m[7m[No Name] [+]                                                                   [m[22;1H[K[11;1H[?12l[?25h[?25l[22;1H:[?12l[?25hsyncbind[?25l[11;1H[?12l[?25h[?25l[1;7r[1;1H[L[1;22r[1;1H/^start of window 2$/[9;16r[9;1H[L[1;22r[9;1H. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14[22;1H[K[11;1H[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[17;1H[7m[No Name] [+]                                                                   [5;1H[3;1H[8;1Htest37.in                                                                       [m[17;1H[1m[7m[No Name] [+]                                                                   [11;1H[m[17;1H[7m[No Name] [+]                                                                   [m[21;1H[1m[7m[No Name] [+]                                                                   [20;1H[?25l[18;20r[m[20;1H
[1;22r[20;1H. line 16 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 16[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[21;1H[7m[No Name] [+]                                                                   [3;1H[8;1Htest37.in                                                                       [m[21;1H[1m[7m[No Name] [+]                                                                   [20;1H[?25l[18;20r[m[20;1H
[1;22r[20;1H:set scrollbind[?12l[?25h[?25l

:[?12l[?25h[?25l[20;1H[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[21;1H[7m[No Name] [+]                                                                   [3;1H[?25l[m[22;1H[K[22;1H:[?12l[?25hset noscb[?25l[3;1H[?12l[?25h[?25l[1;1HTest for 'scrollbind'. <eralston@computer.org>   Do not add a line below!
STARTTEST
:so small.vim[3;14H[K[4;2Hset noscrollbind[4;18H[K[5;2Hset scrollopt=ver,jump
:set scrolloff=2[6;17H[K[7;2Hset nowrap[7;12H[K[1;1H[?12l[?25h[5;1H


[7mtest37.in                                                                       [m[17;1H[1m[7m[No Name] [+]                                                                   [11;1H[?25l[m[22;1H[K[22;1H:[?12l[?25hset noscb[?25l[11;1H[?12l[?25h[?25l[9;1H[K[10;1H[K[11;1H[K[12;1H[K[13;1H[K[14;1Hstart of window 2[14;18H[K[15;1H. line 01 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 01[15;50H[K[16;1H. line 02 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 02[16;50H[K[9;1H[?12l[?25h[14;1H[?25l[22;1H[K[22;1H:[?12l[?25hset scb[?25l[14;1H[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[17;1H[7m[No Name] [+]                                                                   [5;1H[?25l[m[22;1H[K[22;1H:[?12l[?25hset scb[?25l[5;1H[?12l[?25h[?25l[1;1H. line 13 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 13[1;50H[K[2;1H. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14
. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15
. line 16 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 16
end of window 2[5;16H[K[6;1H[K[7;1Hend of test37.in (please don't delete this line)

end of window 2
[1m[34m~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [7;1H[?12l[?25h[?25l[m[1;1Hzt:[1;4H[K[2;1H:set scrollbind[2;16H[K[3;1H:" -- start of tests --[3;24H[K[4;1H:" TEST scrolling down[4;23H[K[5;1HL5jHyy[34m^W[mbpr0[34m^W[mtHyy[34m^W[mbpr1[34m^W[mtL6jHyy[34m^W[mbpr2[34m^W[mkHyy[34m^W[mbpr3:
:" TEST scrolling up
[34m^W[mtH4k[34m^W[mjH[34m^W[mtHyy[34m^W[mbpr4[34m^W[mkHyy[34m^W[mbpr5[34m^W[mk3k[34m^W[mtH[34m^W[mjHyy[34m^W[mbpr6[34m^W[mtHyy[34m^W[mbpr7:
[7mtest37.in                                                                       [9;16r[m[9;1H[2L[1;22r[9;1H. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15
. line 16 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 16[17;1H[1m[7m[No Name] [+]                                                                   [m[22;1H[K[11;1H[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[17;1H[7m[No Name] [+]                                                                   [5;1H[?25l[22;1H[m:[?12l[?25hsyncbind[?25l[5;1H[?12l[?25h[3;1H[?25l[1;7r[1;1H[L[1;22r[1;1H/^start of window 2$/[9;16r[9;1H[2L[1;22r[9;1H. line 13 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 13
. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14[22;1H[K[3;1H[?12l[?25h[?25l[1;7r[1;1H[L[1;22r[1;1H:resize 7[8;1H[7mtest37.in                                                                       [m[17;1H[1m[7m[No Name] [+]                                                                   [12;1H[?12l[?25h[11;1H[8;1Htest37.in                                                                       [m[17;1H[7m[No Name] [+]                                                                   [4;1H[3;1H[8;1Htest37.in                                                                       [m[21;1H[1m[7m[No Name] [+]                                                                   [20;1H[?25l[18;20r[m[20;1H
[1;22r[20;1Hzt:[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[21;1H[7m[No Name] [+]                                                                   [3;1H[8;1Htest37.in                                                                       [m[17;1H[1m[7m[No Name] [+]                                                                   [11;1H[m[17;1H[7m[No Name] [+]                                                                   [m[21;1H[1m[7m[No Name] [+]                                                                   [20;1H[?25l[18;20r[m[20;1H
[1;22r[20;1H. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15[?12l[?25h[?25l

:[?12l[?25h[?25l[20;1H[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[21;1H[7m[No Name] [+]                                                                   [3;1H[?25l[1;7r[m[1;1H[4L[1;22r[1;1H/^start of window 1$/
zt:
:set scrollbind
[34m^W[mj:[9;16r[9;1H[4L[1;22r[9;1H. line 09 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 09
. line 10 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 10
. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11
. line 12 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 12[22;1H[K[4;1H[?12l[?25h[8;1H[7mtest37.in                                                                       [m[17;1H[1m[7m[No Name] [+]                                                                   [14;1H[11;1H[8;1Htest37.in                                                                       [m[17;1H[7m[No Name] [+]                                                                   [4;1H[3;1H[8;1Htest37.in                                                                       [m[21;1H[1m[7m[No Name] [+]                                                                   [20;1H[?25l[18;20r[m[20;1H
[1;22r[20;1H:set scrollbind[?12l[?25h[8;1H[1m[7mtest37.in                                                                       [m[21;1H[7m[No Name] [+]                                                                   [3;1H[8;1Htest37.in                                                                       [m[17;1H[1m[7m[No Name] [+]                                                                   [11;1H[m[17;1H[7m[No Name] [+]                                                                   [m[21;1H[1m[7m[No Name] [+]                                                                   [20;1H[?25l[18;20r[m[20;1H
[1;22r[20;1H. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11[?12l[?25h[?25l

:[?12l[?25h[?25l[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" ***** done with tests *****[?25l[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw! test.out             " Write contents of this file[?25l"test.out" [22;12H[K[22;12H[New File] 33 lines, 1329 characters written[21;1H[1m[7mtest.out      [20;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test38.failed test.ok test.out X* viminfo
cp test38.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test38.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test38.in" 33 lines, 364 characters[2;1HTest Virtual replace mode.

STARTTEST
:so small.vim
ggdGa
abcdefghi
jk      lmn
    opq rst
[34m^D[muvwxyz
[34m^[[mgg:set ai
:set bs=2
gR0[34m^D[m 1
A
BCDEFGHIJ[16;9HKL
MNO
PQR[34m^[[mG:ka
o0[34m^D[m
abcdefghi
jk      lmn[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[4;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 27 lines, 316 characters written[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[5;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[1;21r[1;1H[11M[1;22r[11;5Hopq rst
[34m^D[muvwxyz
[34m^[[m'ajgR0[34m^D[m 1
A
BCDEFGHIJ[16;9HKL
MNO
PQR[34m^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^[[m:$
iab     cdefghi jkl[34m^[[m0gRAB......CDEFGHI.J[34m^[[mo[34m^[[m:
iabcdefghijklmnopqrst[34m^[[m0gRAB    IJKLMNO QR[34m^[[m:wq! test.out
ENDTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[21;1H[?12l[?25h[?25l[1;21r[1;1H[12L[1;22r[2;1HTest Virtual replace mode.

STARTTEST
:so small.vim
ggdGa
abcdefghi
jk      lmn
    opq rst
[34m^D[muvwxyz
[34m^[[mgg:set ai
:set bs=2[22;1H[K[1;1H[?12l[?25h[?25l
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [m[22;1H--No lines in buffer--[1;1H[?12l[?25h[?25l
abcdefghi[2;10H[K[3;1Hjk      lmn[3;12H[K[4;1H    opq rst[4;12H[K[5;1Huvwxyz[5;7H[K[6;1H[K[6;1H[?12l[?25h[1;1H[?25l[22;1H[K[22;1H:[?12l[?25hset ai[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset bs=2[?25l[1;1H[?12l[?25h[?25l 1
 A[2;3H[K[3;1H BCDEFGHIJ[3;11H[K[4;5H    KL[4;11H[K[5;1H        MNO[6;9HPQR[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hka[?25l[6;9H[?12l[?25h[?25l[7;1H[K[8;1Habcdefghi[8;10H[K[9;1Hjk      lmn[9;12H[K[10;1H    opq rst[10;12H[K[11;1Huvwxyz[11;7H[K[12;1H[K[12;1H[?12l[?25h[6;9H
[?25l 1[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$[?25l[12;1H[?12l[?25h[?25lab      cdefghi jkl[?12l[?25h[?25lAB......CDEFGHI.J[?12l[?25h[?25l[13;1H[K[13;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[?25l[13;1H[?12l[?25h[?25labcdefghijklmnopqrst[?12l[?25h[?25lAB      IJKLMNO QR[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hwq! test.out[?25l"test.out" [22;12H[K[22;12H[New File] 13 lines, 107 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test39.failed test.ok test.out X* viminfo
cp test39.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test39.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test39.in" 24 lines, 364 characters[2;1HTest Visual block mode commands

STARTTEST
:so small.vim
/^abcde
:" Test shift-right of a block
jllll[34m^V[mjj>wll[34m^V[mjlll>
:" Test shift-left of a block
G$hhhh[34m^V[mkk<
:" Test block-insert
Gkl[34m^V[mkkkIxyz[34m^[[m
:" Test block-replace
Gllll[34m^V[mkkklllrq
:" Test block-change
G$khhh[34m^V[mhhkkcmno[34m^[[m
:$-4,$wq! test.out
ENDTEST

abcdefghijklm
abcdefghijklm[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[4;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 13 lines, 241 characters written[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[5;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[18;1H[?12l[?25h
[?25l[22;1H[K[22;1H:so! Xdotest[19;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[19;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h^abcde[?25l[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" Test shift-right of a block[?25l[20;1H[?12l[?25h
abcd[?25l[?12l[?25h[?25l[1;21r[21;1H
[1;22r[20;5H[7me[m
abcdefghijklm[22;1H[K[21;5H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[20;5H[7me[m
abcdefghijklmabcd[?12l[?25h[?25l
3 lines >ed 1 time[19;5H        efghijklm
abcd        efghijklm
abcd        efghijklm[19;8H[?12l[?25h     ef[?25l[?12l[?25h[?25l[7mg[20;15H[?12l[?25h[?25l[19;16Hh[20;15Hg[?12l[?25h[?25l[19;17Hi[20;16Hh[?12l[?25h[?25l[19;18Hj[20;17Hi[?12l[?25h[?25l[m[19;15H        ghijklm[20;15H        ghijklm[19;16H[?12l[?25h[20;16H[?25l[22;1H[K[22;1H:[?12l[?25h" Test shift-left of a block[?25l[20;16H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Habcdefghijklm[22;1H[K[21;1H[?12l[?25h[12C[?25l[?12l[?25h[?25l[7mi[20;9H[?12l[?25h[?25l [19;9H[?12l[?25h[?25l[m


3 lines <ed 1 time[19;9Hef    [20;9Hefghijklm[20;18H[K[21;9Hi[19;9H[?12l[?25h[20;9H[?25l[22;1H[K[22;1H:[?12l[?25h" Test block-insert[?25l[20;9H[?12l[?25h
[20;1Ha[?25l[?12l[?25h[?25l[7mb[19;2H[?12l[?25h[?25lb[18;2H[?12l[?25h[?25lb[17;2H[?12l[?25h[?25l[m
ab
ab
ab[17;2Hxyzbcdefghijklm
axyzbcd
axyzbcd
axyzbcd[17;2H[?12l[?25h
a[?25l[22;1H[K[22;1H:[?12l[?25h" Test block-replace[?25l[18;2H[?12l[?25h


abcd[?25l[?12l[?25h[?25l[7me[20;5H[?12l[?25h[?25lb[19;5H[?12l[?25h[?25lb[18;5H[?12l[?25h[?25lb[19;6Hc[20;6Hc[21;6Hf[18;6H[?12l[?25h[?25lc[19;7Hd[20;7Hd[21;7Hg[18;7H[?12l[?25h[?25ld[19;8H [20;8H [21;8Hh[18;8H[?12l[?25h[?25l[mqqqq
axyzqqqq
axyzqqqq
abcdqqqq[18;5H[?12l[?25h
axyz[?25l[22;1H[K[22;1H:[?12l[?25h" Test block-change[?25l[19;5H[?12l[?25h

[12C[20;17H[?25l[?12l[?25h[?25l[7mj[?12l[?25h[?25li[?12l[?25h[?25l[19;12H     [20;11Hghijkl[19;11H[?12l[?25h[?25l[18;13Hef[m[19;15H  [20;11Hg[3Ckl[18;12H[?12l[?25h[?25lmno[19;12Hmno[20;12Hmno[18;14H[?12l[?25h[19;14H[?25l[22;1H[K[22;1H:[?12l[?25h$-4,$wq! test.out[?25l"test.out" [22;12H[K[22;12H[New File] 5 lines, 108 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test40.failed test.ok test.out X* viminfo
cp test40.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test40.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test40.in" 63 lines, 1521 characters[1;1HTest for "*Cmd" autocommands

STARTTEST
:so small.vim
:/^start/,$w! Xxx[15C" write lines below to Xxx
:au BufReadCmd testA 0r Xxx|$del
:e testA[24C" will read text of Xxd instead
:au BufWriteCmd testA call append(line("$"), "write")
:w[30C" will append a line to the file
:r testA[24C" should not read anything
:[31C" now we have:
:[31C" 1     start of Xxx
:[31C" 2[13Ctest40
:[31C" 3     end of Xxx
:[31C" 4     write
:au FileReadCmd testB '[r Xxx
:2r testB[23C" will read Xxx below line 2 instead
:[31C" 1     start of Xxx
:[31C" 2[13Ctest40
:[31C" 3     start of Xxx
:[31C" 4[13Ctest40[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for "*Cmd" autocommands[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 55 lines, 1440 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[27m[m[H[2J[1;1H:sp testE[23C" split window with test.out
5Goasdf[34m^[^W^W[m:"
:au BufWriteCmd testE w! test.out
:wall[27C" will write other window to test.out
:[31C" 1     start of Xxx
:[31C" 2[13Ctest40
:[31C" 3     start of Xxx
:[31C" 4[13Ctest401
:[31C" 5     end of Xxx
:[31C" 6     asdf
:[31C" 7     end of Xxx
:[31C" 8     write
:[31C" 9[13Ctest401
:[31C" 10    end of Xxx
:[31C" 11    end of Xxx
:qa!
ENDTEST

start of Xxx[20;9Htest40
end of Xxx[17;1H[?12l[?25h
[?25l[22;1H:so! Xdotest[18;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[18;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^start/,$w! Xxx[34m^I^I[m" write lines below to Xxx[?25l"Xxx" [22;7H[K[22;7H[New File] 3 lines, 32 characters written[18;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hau BufReadCmd testA 0r Xxx|$del[?25l[18;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he testA[34m^I^I^I[m" will read text of Xxd instead[?25l"Xxx" [22;7H[K[22;7H3 lines, 32 characters[1;1Hstart of Xxx[1;33H[K[2;1H        test40[2;15H[K[3;1Hend of Xxx[3;11H[K[4;1H[1m[34m~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [3;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hau BufWriteCmd testA call append(line("$"), "write")[?25l[3;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw[34m^I^I^I^I[m" will append a line to the file[?25l[4;1Hwrite[4;6H[K[3;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hr testA[34m^I^I^I[m" should not read anything[?25l[1m[37m[41mE484: Can't open file testA[m[22;28H[K[3;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" now we have:[?25l[3;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" 1[34m^I[mstart of Xxx[?25l[3;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" 2[34m^I^I[mtest40[?25l[3;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" 3[34m^I[mend of Xxx[?25l[3;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" 4[34m^I[mwrite[?25l[3;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hau FileReadCmd testB '[r Xxx[?25l[3;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h2r testB[34m^I^I^I[m" will read Xxx below line 2 instead[?25l"Xxx" [22;7H[K[22;7H3 lines, 32 characters[3;21r[3;1H[3L[1;22r[3;1Hstart of Xxx[4;9Htest40
end of Xxx[22;1H[K[3;1H[?12l[?25h[?25l[22;1H:[?12l[?25h[34m^I^I^I^I[m" 1[34m^I[mstart of Xxx[?25l[3;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" 2[34m^I^I[mtest40[?25l[3;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" 3[34m^I[mstart of Xxx[?25l[3;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" 4[34m^I^I[mtest40[?25l[3;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" 5[34m^I[mend of Xxx[?25l[3;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" 6[34m^I[mend of Xxx[?25l[3;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" 7[34m^I[mwrite[?25l[3;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hau FileWriteCmd testC '[,']copy $[?25l[3;1H[?12l[?25h[4;9H[?25ltest401[?12l[?25h[5;10H[?25l[22;1H[K[22;1H:[?12l[?25h4,5w testC[34m^I^I^I[m" will copy lines 4 and 5 to the end[?25l[8;1H        test401[8;16H[K[9;1Hend of Xxx[9;11H[K[9;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hr testC[34m^I^I^I[m" should not read anything[?25l[1m[37m[41mE484: Can't open file testC[m[22;28H[K[9;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" 1[34m^I[mstart of Xxx[?25l[9;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" 2[34m^I^I[mtest40[?25l[9;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" 3[34m^I[mstart of Xxx[?25l[9;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" 4[34m^I^I[mtest401[?25l[9;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" 5[34m^I[mend of Xxx[?25l[9;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" 6[34m^I[mend of Xxx[?25l[9;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" 7[34m^I[mwrite[?25l[9;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" 8[34m^I^I[mtest401[?25l[9;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" 9[34m^I[mend of Xxx[?25l[9;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hau FILEAppendCmd testD '[,']w! test.out[?25l[9;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>testD[34m^I^I^I[m" will write all lines to test.out[?25l"test.out" [22;12H[K[22;12H[New File] 9 lines, 91 characters written[9;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$r testD[34m^I^I^I[m" should not read anything[?25l[1m[37m[41mE484: Can't open file testD[m[22;29H[K[9;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$w >>test.out[34m^I^I^I[m" append "end of Xxx" to test.out[?25l"test.out" [22;12H[K[22;12H1 line, 11 characters appended[9;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hau BufReadCmd testE 0r test.out|$del[?25l[9;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hsp testE[34m^I^I^I[m" split window with test.out[?25l"test.out" [22;12H[K[22;12H10 lines, 102 characters[10;1Hend of Xxx[10;11H[K[11;1H[1m[7mtestE                                                                           [m[12;1Hend of Xxx[12;11H[K[13;1Hwrite[13;6H[K[14;1H        test401[14;16H[K[15;1Hend of Xxx[15;11H[K[21;1H[7mtestA                                                                           [10;1H[?12l[?25h[5;1H[?25l[6;10r[m[6;1H[L[1;22r[6;1Hasdf[11;7H[1m[7m[+][m[22;1H[K[6;4H[?12l[?25h[11;1H[7mtestE [+]                                                                       [m[21;1H[1m[7mtestA                                                                           [15;1H[?25l[22;1H[m:[?12l[?25h"[?25l[15;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hau BufWriteCmd testE w! test.out[?25l[15;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hwall[34m^I^I^I^I[m" will write other window to test.out[?25l"test.out" [22;12H[K[22;12H11 lines, 107 characters written[11;7H[7m   [15;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" 1[34m^I[mstart of Xxx[?25l[15;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" 2[34m^I^I[mtest40[?25l[15;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" 3[34m^I[mstart of Xxx[?25l[15;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" 4[34m^I^I[mtest401[?25l[15;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" 5[34m^I[mend of Xxx[?25l[15;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" 6[34m^I[masdf[?25l[15;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" 7[34m^I[mend of Xxx[?25l[15;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" 8[34m^I[mwrite[?25l[15;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" 9[34m^I^I[mtest401[?25l[15;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" 10[34m^I[mend of Xxx[?25l[15;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h[34m^I^I^I^I[m" 11[34m^I[mend of Xxx[?25l[15;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test41.failed test.ok test.out X* viminfo
cp test41.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test41.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test41.in" 24 lines, 421 characters[1;1HTest for writing and reading a file of over 100 Kbyte

1 line: "This is the start"
3001 lines: "This is the leader"
1 line: "This is the middle"
3001 lines: "This is the trailer"
1 line: "This is the end"

STARTTEST
:%d
aThis is the start
This is the leader
This is the middle
This is the trailer
This is the end[34m^[[mkY3000p2GY3000p
:w! Xtest
:%d
:e! Xtest
:.w! test.out
3003G:.w >>test.out
6005G:.w >>test.out[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for writing and reading a file of over 100 Kbyte[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[9;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[10;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 13 lines, 196 characters written[10;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[10;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[1;21r[1;1H[2M[1;22r[20;1H:qa!
ENDTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h%d[?25l[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [m[22;1H--No lines in buffer--[1;1H[?12l[?25h[?25lThis is the start
This is the leader[2;19H[K[3;1HThis is the middle[3;19H[K[4;1HThis is the trailer[4;20H[K[5;1HThis is the end[5;16H[K[5;15H[?12l[?25h[4;15H[?25l[22;1H3000 more lines[22;16H[K[5;13Htrailer
This is the trailer[6;20H[K[7;1HThis is the trailer[7;20H[K[8;1HThis is the trailer[8;20H[K[9;1HThis is the trailer[9;20H[K[10;1HThis is the trailer[10;20H[K[11;1HThis is the trailer[11;20H[K[12;1HThis is the trailer[12;20H[K[13;1HThis is the trailer[13;20H[K[14;1HThis is the trailer[14;20H[K[15;1HThis is the trailer[15;20H[K[16;1HThis is the trailer[16;20H[K[17;1HThis is the trailer[17;20H[K[18;1HThis is the trailer[18;20H[K[19;1HThis is the trailer[19;20H[K[20;1HThis is the trailer[20;20H[K[21;1HThis is the trailer[21;20H[K[5;1H[?12l[?25h[2;1H[?25l[3;13Hleader[4;13Hleader[4;19H[K[5;13Hleader[5;19H[K[6;13Hleader[6;19H[K[7;13Hleader[7;19H[K[8;13Hleader[8;19H[K[9;13Hleader[9;19H[K[10;13Hleader[10;19H[K[11;13Hleader[11;19H[K[12;13Hleader[12;19H[K[13;13Hleader[13;19H[K[14;13Hleader[14;19H[K[15;13Hleader[15;19H[K[16;13Hleader[16;19H[K[17;13Hleader[17;19H[K[18;13Hleader[18;19H[K[19;13Hleader[19;19H[K[20;13Hleader[20;19H[K[21;13Hleader[21;19H[K[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:[?12l[?25hw! Xtest[?25l"Xtest" [22;9H[K[22;9H[New File] 6005 lines, 117092 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h%d[?25l[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [m[22;1H--No lines in buffer--[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! Xtest[?25l"Xtest" [22;9H[K[22;9H6005 lines, 117092 characters[1;1HThis is the start
This is the leader[2;19H[K[3;1HThis is the leader[3;19H[K[4;1HThis is the leader[4;19H[K[5;1HThis is the leader[5;19H[K[6;1HThis is the leader[6;19H[K[7;1HThis is the leader[7;19H[K[8;1HThis is the leader[8;19H[K[9;1HThis is the leader[9;19H[K[10;1HThis is the leader[10;19H[K[11;1HThis is the leader[11;19H[K[12;1HThis is the leader[12;19H[K[13;1HThis is the leader[13;19H[K[14;1HThis is the leader[14;19H[K[15;1HThis is the leader[15;19H[K[16;1HThis is the leader[16;19H[K[17;1HThis is the leader[17;19H[K[18;1HThis is the leader[18;19H[K[19;1HThis is the leader[19;19H[K[20;1HThis is the leader[20;19H[K[21;1HThis is the leader[21;19H[K[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w! test.out[?25l"test.out" [22;12H[K[22;12H[New File] 1 line, 18 characters written[1;1H[?12l[?25h[?25l[27m[m[H[2J[1;1HThis is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the middle
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer[11;1H[?12l[?25h[?25l[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 19 characters appended[11;1H[?12l[?25h[?25l[27m[m[H[2J[1;1HThis is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the end[?12l[?25h[?25l
:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 16 characters appended[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test42.failed test.ok test.out X* viminfo
cp test42.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test42.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test42.in" 130 lines, 2368 characters[1;1HTest for writing and reading a file starting with a BOM

STARTTEST
:so mbyte.vim
:set encoding=utf-8
:set fileencodings=ucs-bom,latin-1
:set ff=unix ffs=unix[11C" This changes the file for DOS and MAC
:" --- Write the test files
:/^latin-1$/+1w! Xtest0
:/^utf-8$/+1w! Xtest1
:/^utf-8-err$/+1w! Xtest2
:/^ucs-2$/+1w! Xtest3
:/^ucs-2le$/+1w! Xtest4
:" Need to add a NUL byte after the NL byte
:set bin
:e! Xtest4[22C" Ignore change from setting 'ff'
o[34m^V^@^[[m:set noeol
:w
:set ffs& nobinary[14C" Allow default test42.in format
:e #
:set ff=unix[20C" Format for files to write[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for writing and reading a file starting with a BOM[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 111 lines, 2116 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[27m[m[H[2J[1;1H:$r Xtest0x
:$r Xtest1x
:$r Xtest2x
:$r Xtest3x
:$r Xtest4x
:$r Xtest5x
:$r Xtest6x
:set nobin ff&[15C" Write the file in default format
:w! test.out
:qa!
ENDTEST

latin-1
latin-1
utf-8
﻿utf-8
utf-8-err
﻿utf-8[34m~@[merr
ucs-2
[34m^@[mu[34m^@[mc[34m^@[ms[34m^@[m-[34m^@[m2[34m^@[m
ucs-2le[11;1H[?12l[?25h
[?25l[22;1H:so! Xdotest[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso mbyte.vim[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset encoding=utf-8[?25l[27m[m[H[2J[1;1H:$r Xtest0x
:$r Xtest1x
:$r Xtest2x
:$r Xtest3x
:$r Xtest4x
:$r Xtest5x
:$r Xtest6x
:set nobin ff&[15C" Write the file in default format
:w! test.out
:qa!
ENDTEST

latin-1
[34m<fe><fe>[mlatin-1
utf-8
[34m<feff>[mutf-8
utf-8-err
[34m<feff>[mutf-8[34m<80>[merr
ucs-2
[34m<fe><ff>^@[mu[34m^@[mc[34m^@[ms[34m^@[m-[34m^@[m2[34m^@[m
ucs-2le[12;1H[?12l[?25h[?25l[22;1H:[?12l[?25hset fileencodings=ucs-bom,latin-1[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset ff=unix ffs=unix           " This changes the file for DOS and MAC[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" --- Write the test files[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^latin-1$/+1w! Xtest0[?25l"Xtest0" [22;10H[K[22;1H"Xtest0" [New File] 1 line, 10 characters written"Xtest0" [New File] 1 line, 10 characters written[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^utf-8$/+1w! Xtest1[?25l"Xtest1" [22;10H[K[22;1H"Xtest1" [New File] 1 line, 9 characters written"Xtest1" [New File] 1 line, 9 characters written[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^utf-8-err$/+1w! Xtest2[?25l"Xtest2" [22;10H[K[22;1H"Xtest2" [New File] 1 line, 13 characters written"Xtest2" [New File] 1 line, 13 characters written[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^ucs-2$/+1w! Xtest3[?25l"Xtest3" [22;10H[K[22;1H"Xtest3" [New File] 1 line, 14 characters written"Xtest3" [New File] 1 line, 14 characters written[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^ucs-2le$/+1w! Xtest4[?25l"Xtest4" [22;10H[K[22;1H"Xtest4" [New File] 1 line, 17 characters written"Xtest4" [New File] 1 line, 17 characters written[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" Need to add a NUL byte after the NL byte[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset bin[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! Xtest4                      " Ignore change from setting 'ff'[?25l"Xtest4" [22;10H[K[22;1H"Xtest4" 1 line, 17 characters[1;1H[34m<ff><fe>[mu[34m^@[mc[34m^@[ms[34m^@[m-[34m^@[m2[34m^@[ml[34m^@[me[34m^@[m
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h
[?25l[m[34m^@[m[2;3H[K[2;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset noeol[?25l[2;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw[?25l"Xtest4" "Xtest4" [Incomplete last line] 2 lines, 18 characters written"Xtest4" [Incomplete last line] 2 lines, 18 characters written[2;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset ffs& nobinary              " Allow default test42.in format[?25l[2;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he #[?25l"test42.in" "test42.in" [converted] 130 lines, 2385 characters[1;1H:$r Xtest1x[1;12H[K[2;1H:$r Xtest2x
:$r Xtest3x[3;12H[K[4;1H:$r Xtest4x[4;12H[K[5;1H:$r Xtest5x[5;12H[K[6;1H:$r Xtest6x[6;12H[K[7;1H:set nobin ff&               " Write the file in default format[7;64H[K[8;1H:w! test.out[8;13H[K[9;1H:qa![9;5H[K[10;1HENDTEST[10;8H[K[11;1H[K[12;1Hlatin-1[12;8H[K[13;1Hþþlatin-1[13;10H[K[14;1Hutf-8[14;6H[K[15;1Hï»¿utf-8[15;9H[K[16;1Hutf-8-err[16;10H[K[17;1Hï»¿utf-8[34m<80>[merr[17;16H[K[18;1Hucs-2[18;6H[K[19;1Hþÿ[34m^@[mu[34m^@[mc[34m^@[ms[34m^@[m-[34m^@[m2[34m^@[m[19;20H[K[20;1Hucs-2le[20;8H[K[21;1Hÿþu[34m^@[mc[34m^@[ms[34m^@[m-[34m^@[m2[34m^@[ml[34m^@[me[34m^@[m[21;24H[K[11;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset ff=unix                    " Format for files to write[?25l[11;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^ucs-4$/+1w! Xtest5[?25l"Xtest5" [22;10H[K[22;1H"Xtest5" [converted][New File] 1 line, 30 characters written"Xtest5" [converted][New File] 1 line, 30 characters written[11;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^ucs-4le$/+1w! Xtest6[?25l"Xtest6" [22;10H[K[22;1H"Xtest6" [converted][New File] 1 line, 35 characters written"Xtest6" [converted][New File] 1 line, 35 characters written[11;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" Need to add three NUL bytes after the NL byte[?25l[11;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset bin[?25l[11;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! Xtest6                      " ! for when setting 'ff' is a change[?25l"Xtest6" [22;10H[K[22;1H"Xtest6" 1 line, 33 characters[1;1H[34m<ff><fe>^@^@[mu[34m^@^@^@[mc[34m^@^@^@[ms[34m^@^@^@[m-[34m^@^@^@[m4[34m^@^@^@[ml[34m^@^@^@[me[34m^@^@^@[m
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h
~   [?25l[m[34m^@^@^@[m[2;7H[K[2;5H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset noeol[?25l[2;5H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw[?25l"Xtest6" "Xtest6" [Incomplete last line] 2 lines, 36 characters written"Xtest6" [Incomplete last line] 2 lines, 36 characters written[2;5H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset nobin[?25l[2;5H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he #[?25l"test42.in" "test42.in" [converted] 130 lines, 2385 characters[1;1H:$r Xtest1x[1;12H[K[2;1H:$r Xtest2x
:$r Xtest3x[3;12H[K[4;1H:$r Xtest4x[4;12H[K[5;1H:$r Xtest5x[5;12H[K[6;1H:$r Xtest6x[6;12H[K[7;1H:set nobin ff&               " Write the file in default format[7;64H[K[8;1H:w! test.out[8;13H[K[9;1H:qa![9;5H[K[10;1HENDTEST[10;8H[K[11;1H[K[12;1Hlatin-1[12;8H[K[13;1Hþþlatin-1[13;10H[K[14;1Hutf-8[14;6H[K[15;1Hï»¿utf-8[15;9H[K[16;1Hutf-8-err[16;10H[K[17;1Hï»¿utf-8[34m<80>[merr[17;16H[K[18;1Hucs-2[18;6H[K[19;1Hþÿ[34m^@[mu[34m^@[mc[34m^@[ms[34m^@[m-[34m^@[m2[34m^@[m[19;20H[K[20;1Hucs-2le[20;8H[K[21;1Hÿþu[34m^@[mc[34m^@[ms[34m^@[m-[34m^@[m2[34m^@[ml[34m^@[me[34m^@[m[21;24H[K[11;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[11;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" --- Check that editing a latin-1 file doesn't see a BOM[?25l[11;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! Xtest0[?25l"Xtest0" [22;10H[K[22;1H"Xtest0" [converted] 1 line, 12 characters[1;1Hþþlatin-1[1;10H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hredir! >test.out[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fileencoding bomb?[?25l[22;1H[K[22;1H  fileencoding=latin1
nobomb
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hredir END[?25l[1;1H[2L[1;1Hþþlatin-1
[1m[34m~                                                                               [m[22;3H[K[1;1H[?12l[?25h[?25l[22;1H:[?12l[?25hset fenc=latin-1[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>test.out[?25l"test.out" [22;12H[K[22;1H"test.out" [converted] 1 line, 12 characters appended"test.out" [converted] 1 line, 12 characters appended[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset bomb fenc=latin-1[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw! Xtest0x[?25l"Xtest0x" [22;11H[K[22;1H"Xtest0x" [converted][New File] 1 line, 12 characters written"Xtest0x" [converted][New File] 1 line, 12 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" --- Check utf-8[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! Xtest1[?25l"Xtest1" [22;10H[K[22;1H"Xtest1" 1 line, 9 characters[1;1Hutf-8[1;6H[K[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hredir >>test.out[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fileencoding bomb?[?25l[22;1H[K[22;1H  fileencoding=utf-8
  bomb
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hredir END[?25l[1;1H[2L[1;1Hutf-8
[1m[34m~                                                                               [m[22;3H[K[1;1H[?12l[?25h[?25l[22;1H:[?12l[?25hset fenc=latin-1[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>test.out[?25l"test.out" [22;12H[K[22;1H"test.out" [converted] 1 line, 6 characters appended"test.out" [converted] 1 line, 6 characters appended[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fenc=utf-8[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw! Xtest1x[?25l"Xtest1x" [22;11H[K[22;1H"Xtest1x" [New File] 1 line, 9 characters written"Xtest1x" [New File] 1 line, 9 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" --- Check utf-8 with an error (will fall back to latin-1)[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! Xtest2[?25l"Xtest2" [22;10H[K[22;1H"Xtest2" [converted] 1 line, 17 characters[1;1Hï»¿utf-8[34m<80>[merr[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hredir >>test.out[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fileencoding bomb?[?25l[22;1H[K[22;1H  fileencoding=latin1
nobomb
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hredir END[?25l[1;1H[2L[1;1Hï»¿utf-8[34m<80>[merr
[1m[34m~                                                                               [m[22;3H[K[1;1H[?12l[?25h[?25l[22;1H:[?12l[?25hset fenc=latin-1[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>test.out[?25l"test.out" [22;12H[K[22;1H"test.out" [converted] 1 line, 17 characters appended"test.out" [converted] 1 line, 17 characters appended[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fenc=utf-8[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw! Xtest2x[?25l"Xtest2x" [22;11H[K[22;1H"Xtest2x" [New File] 1 line, 17 characters written"Xtest2x" [New File] 1 line, 17 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" --- Check ucs-2[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! Xtest3[?25l"Xtest3" [22;10H[K[22;1H"Xtest3" [converted] 1 line, 8 characters[1;1Hucs-2[1;6H[K[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hredir >>test.out[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fileencoding bomb?[?25l[22;1H[K[22;1H  fileencoding=ucs-2
  bomb
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hredir END[?25l[1;1H[2L[1;1Hucs-2
[1m[34m~                                                                               [m[22;3H[K[1;1H[?12l[?25h[?25l[22;1H:[?12l[?25hset fenc=latin-1[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>test.out[?25l"test.out" [22;12H[K[22;1H"test.out" [converted] 1 line, 6 characters appended"test.out" [converted] 1 line, 6 characters appended[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fenc=ucs-2[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw! Xtest3x[?25l"Xtest3x" [22;11H[K[22;1H"Xtest3x" [converted][New File] 1 line, 8 characters written"Xtest3x" [converted][New File] 1 line, 8 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" --- Check ucs-2le[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! Xtest4[?25l"Xtest4" [22;10H[K[22;1H"Xtest4" [converted] 1 line, 10 characters[1;6Hle[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hredir >>test.out[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fileencoding bomb?[?25l[22;1H[K[22;1H  fileencoding=ucs-2le
  bomb
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hredir END[?25l[1;1H[2L[1;1Hucs-2le
[1m[34m~                                                                               [m[22;3H[K[1;1H[?12l[?25h[?25l[22;1H:[?12l[?25hset fenc=latin-1[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>test.out[?25l"test.out" [22;12H[K[22;1H"test.out" [converted] 1 line, 8 characters appended"test.out" [converted] 1 line, 8 characters appended[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fenc=ucs-2le[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw! Xtest4x[?25l"Xtest4x" [22;11H[K[22;1H"Xtest4x" [converted][New File] 1 line, 10 characters written"Xtest4x" [converted][New File] 1 line, 10 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" --- Check ucs-4[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! Xtest5[?25l"Xtest5" [22;10H[K[22;1H"Xtest5" [converted] 1 line, 10 characters[1;5H4[1;6H[K[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hredir >>test.out[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fileencoding bomb?[?25l[22;1H[K[22;1H  fileencoding=ucs-4
  bomb
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hredir END[?25l[1;1H[2L[1;1Hucs-4
[1m[34m~                                                                               [m[22;3H[K[1;1H[?12l[?25h[?25l[22;1H:[?12l[?25hset fenc=latin-1[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>test.out[?25l"test.out" [22;12H[K[22;1H"test.out" [converted] 1 line, 6 characters appended"test.out" [converted] 1 line, 6 characters appended[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fenc=ucs-4[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw! Xtest5x[?25l"Xtest5x" [22;11H[K[22;1H"Xtest5x" [converted][New File] 1 line, 10 characters written"Xtest5x" [converted][New File] 1 line, 10 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" --- Check ucs-4le[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! Xtest6[?25l"Xtest6" [22;10H[K[22;1H"Xtest6" [converted] 1 line, 12 characters[1;6Hle[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hredir >>test.out[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fileencoding bomb?[?25l[22;1H[K[22;1H  fileencoding=ucs-4le
  bomb
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hredir END[?25l[1;1H[2L[1;1Hucs-4le
[1m[34m~                                                                               [m[22;3H[K[1;1H[?12l[?25h[?25l[22;1H:[?12l[?25hset fenc=latin-1[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw >>test.out[?25l"test.out" [22;12H[K[22;1H"test.out" [converted] 1 line, 8 characters appended"test.out" [converted] 1 line, 8 characters appended[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fenc=ucs-4le[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw! Xtest6x[?25l"Xtest6x" [22;11H[K[22;1H"Xtest6x" [converted][New File] 1 line, 12 characters written"Xtest6x" [converted][New File] 1 line, 12 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" --- Check the files written with BOM[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset bin[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! test.out[?25l"test.out" [22;12H[K[22;1H"test.out" 35 lines, 273 characters[1;1H[K[2;1H[K[3;1H  fileencoding=latin1[3;22H[K[4;1Hnobomb[4;7H[K[5;1H[34m<fe><fe>[mlatin-1[5;16H[K[6;1H[K[7;1H[K[8;1H  fileencoding=utf-8[8;21H[K[9;1H  bomb[9;7H[K[10;1Hutf-8[10;6H[K[11;1H[K[12;1H[K[13;1H  fileencoding=latin1[13;22H[K[14;1Hnobomb[14;7H[K[15;1H[34m<feff>[mutf-8[34m<80>[merr[15;19H[K[16;1H[K[17;1H[K[18;1H  fileencoding=ucs-2[18;21H[K[19;1H  bomb[19;7H[K[20;1Hucs-2[20;6H[K[21;1H[K[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$r Xtest0x[?25l"Xtest0x" [22;11H[K[22;1H"Xtest0x" 1 line, 10 characters[1;21r[1;1H[15M[1;22r[8;3Hfileencoding=ucs-2le
  bomb
ucs-2le[13;3Hfileencoding=ucs-4
  bomb
ucs-4[18;3Hfileencoding=ucs-4le
  bomb
ucs-4le
[34m<fe><fe>[mlatin-1[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h$r Xtest1x[?25l"Xtest1x" [22;11H[K[22;1H"Xtest1x" 1 line, 9 characters[1;21r[21;1H
[1;22r[21;1H[34m<feff>[mutf-8[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h$r Xtest2x[?25l"Xtest2x" [22;11H[K[22;1H"Xtest2x" 1 line, 17 characters[1;21r[21;1H
[1;22r[21;1Hï»¿utf-8[34m<80>[merr[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h$r Xtest3x[?25l"Xtest3x" [22;11H[K[22;1H"Xtest3x" 1 line, 14 characters[1;21r[21;1H
[1;22r[21;1H[34m<fe><ff>^@[mu[34m^@[mc[34m^@[ms[34m^@[m-[34m^@[m2[34m^@[m[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h$r Xtest4x[?25l"Xtest4x" [22;11H[K[22;1H"Xtest4x" [Incomplete last line] 2 lines, 18 characters[1;21r[21;1H
[1;22r[21;1H[34m<ff><fe>[mu[34m^@[mc[34m^@[ms[34m^@[m-[34m^@[m2[34m^@[ml[34m^@[me[34m^@[m[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h$r Xtest5x[?25l"Xtest5x" [22;11H[K[22;1H"Xtest5x" 1 line, 28 characters[1;21r[1;1H[2M[1;22r[20;1H[34m^@
^@^@<fe><ff>^@^@^@[mu[34m^@^@^@[mc[34m^@^@^@[ms[34m^@^@^@[m-[34m^@^@^@[m4[34m^@^@^@[m[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h$r Xtest6x[?25l"Xtest6x" [22;11H[K[22;1H"Xtest6x" [Incomplete last line] 2 lines, 36 characters[1;21r[21;1H
[1;22r[21;1H[34m<ff><fe>^@^@[mu[34m^@^@^@[mc[34m^@^@^@[ms[34m^@^@^@[m-[34m^@^@^@[m4[34m^@^@^@[ml[34m^@^@^@[me[34m^@^@^@[m[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25hset nobin ff&               " Write the file in default format[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw! test.out[?25l"test.out" [22;12H[K[22;1H"test.out" 44 lines, 407 characters written"test.out" 44 lines, 407 characters written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test43.failed test.ok test.out X* viminfo
cp test43.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test43.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test43.in" 27 lines, 412 characters[1;1HTests for regexp with various magic settings.

STARTTEST
:set nocompatible viminfo+=nviminfo
/^1
/a*b\{2}c\+/e
x/\Md\*e\{2}f\+/e
x:set nomagic
/g\*h\{2}i\+/e
x/\mj*k\{2}l\+/e
x/\vm*n{2}o+/e
x/\V^aa$
x:set magic
/\v(a)(b)\2\1\1/e
x/\V[ab]\(\[xy]\)\1
x:?^1?,$w! test.out
:qa!
ENDTEST

1 a aa abb abbccc
2 d dd dee deefff[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for regexp with various magic settings.[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 14 lines, 217 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[18;1H[?12l[?25h
[?25l[22;1H[K[22;1H:so! Xdotest[19;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset nocompatible viminfo+=nviminfo[?25l[19;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h^1[?25l[20;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25ha*b\{2}c\+/e[?25l[20;17H[?12l[?25h[?25l[20;17H[K[20;16H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h\Md\*e\{2}f\+/e[?25l[21;17H[?12l[?25h[?25l[21;17H[K[21;16H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset nomagic[?25l[21;16H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25hg\*h\{2}i\+/e[?25l[1;21r[21;1H
[1;22r[21;1H3 g gg ghh ghhiii[22;1H[K[21;17H[?12l[?25h[?25l[21;17H[K[21;16H[?12l[?25h[?25l
/[?12l[?25h\mj*k\{2}l\+/e[?25l[1;21r[21;1H
[1;22r[21;1H4 j jj jkk jkklll[22;1H[K[21;17H[?12l[?25h[?25l[21;17H[K[21;16H[?12l[?25h[?25l
/[?12l[?25h\vm*n{2}o+/e[?25l[1;21r[21;1H
[1;22r[21;1H5 m mm mnn mnnooo[22;1H[K[21;17H[?12l[?25h[?25l[21;17H[K[21;16H[?12l[?25h[?25l
/[?12l[?25h\V^aa$[?25l[1;21r[21;1H
[1;22r[21;1H6 x ^aa$ x[22;1H[K[21;5H[?12l[?25h[?25laa$ x[21;10H[K[21;5H[?12l[?25h[?25l
:[?12l[?25hset magic[?25l[21;5H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h\v(a)(b)\2\1\1/e[?25l[1;21r[21;1H
[1;22r[21;1H7 (a)(b) abbaa[22;1H[K[21;14H[?12l[?25h[?25l[21;14H[K[21;13H[?12l[?25h[?25l
/[?12l[?25h\V[ab]\(\[xy]\)\1[?25l[1;21r[21;1H
[1;22r[21;1H8 axx [ab]xx[22;1H[K[21;7H[?12l[?25h[?25lab]x[21;12H[K[21;7H[?12l[?25h[?25l
:[?12l[?25h?^1?,$w! test.out[?25l"test.out" [22;12H[K[22;12H[New] 8L, 121C written[21;7H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test44.failed test.ok test.out X* viminfo
cp test44.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test44.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test44.in" 55 lines, 1137 characters[1;1HTests for regexp with multi-byte encoding and various magic settings.
Test matchstr() with a count and multi-byte chars.

STARTTEST
:so mbyte.vim
:set nocompatible encoding=utf-8 termencoding=latin1 viminfo+=nviminfo
/^1
/a*b\{2}c\+/e
x/\Md\*e\{2}f\+/e
x:set nomagic
/g\*h\{2}i\+/e
x/\mj*k\{2}l\+/e
x/\vm*n{2}o+/e
x/\V^aa$
x:set magic
/\v(a)(b)\2\1\1/e
x/\V[ab]\(\[xy]\)\1
x:" Now search for multi-byte without composing char
/ม
x:" Now search for multi-byte with composing char
/ม[34m~H[1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for regexp with multi-byte encoding and various magic settings.[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[4;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 33 lines, 760 characters written[5;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[5;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[27m[m[H[2J[1;1Hx/[\U1234abcd\u1234\uabcd]
x/\%d21879b
x:?^1?,$w! test.out
:e! test.out
G:put =matchstr(\"[34m~P[m[34m~Q[m[34m~R[m[34m~S[m\", \".\", 0, 2) " [34m~Q[m
:put =matchstr(\"[34m~P[m[34m~Q[m[34m~R[m[34m~S[m\", \"..\", 0, 2) " [34m~Q[m[34m~R[m
:put =matchstr(\"[34m~P[m[34m~Q[m[34m~R[m[34m~S[m\", \".\", 0, 0) " [34m~P[m
:put =matchstr(\"[34m~P[m[34m~Q[m[34m~R[m[34m~S[m\", \".\", 4, -1) " [34m~R[m
:w!
:qa!
ENDTEST

1 a aa abb abbccc
2 d dd dee deefff
3 g gg ghh ghhiii
4 j jj jkk jkklll
5 m mm mnn mnnooo
6 x ^aa$ x
7 (a)(b) abbaa
8 axx [ab]xx
9 หม[34m~H[mx อมx[11;1H[?12l[?25h
[?25l[22;1H:so! Xdotest[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso mbyte.vim[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset nocompatible encoding=utf-8 termencoding=latin1 viminfo+=nviminfo[?25l[27m[m[H[2J[1;1Hx/[\U1234abcd\u1234\uabcd]
x/\%d21879b
x:?^1?,$w! test.out
:e! test.out
G:put =matchstr(\"\", \".\", 0, 2) " 
:put =matchstr(\"\", \"..\", 0, 2) " 
:put =matchstr(\"\", \".\", 0, 0) " 
:put =matchstr(\"\", \".\", 4, -1) " 
:w!
:qa!
ENDTEST

1 a aa abb abbccc
2 d dd dee deefff
3 g gg ghh ghhiii
4 j jj jkk jkklll
5 m mm mnn mnnooo
6 x ^aa$ x
7 (a)(b) abbaa
8 axx [ab]xx
9 x x[12;1H[?12l[?25h[?25l[22;1H/[?12l[?25h^1[?25l/^1[13;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25ha*b\{2}c\+/e[?25l/a*b\{2}c\+/e[13;17H[?12l[?25h[?25l[13;17H[K[13;16H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h\Md\*e\{2}f\+/e[?25l/\Md\*e\{2}f\+/e[14;17H[?12l[?25h[?25l[14;17H[K[14;16H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset nomagic[?25l[14;16H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25hg\*h\{2}i\+/e[?25l/g\*h\{2}i\+/e[15;17H[?12l[?25h[?25l[15;17H[K[15;16H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h\mj*k\{2}l\+/e[?25l/\mj*k\{2}l\+/e[16;17H[?12l[?25h[?25l[16;17H[K[16;16H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h\vm*n{2}o+/e[?25l/\vm*n{2}o+/e[17;17H[?12l[?25h[?25l[17;17H[K[17;16H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h\V^aa$[?25l/\V^aa$[18;5H[?12l[?25h[?25laa$ x[18;10H[K[18;5H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset magic[?25l[18;5H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h\v(a)(b)\2\1\1/e[?25l/\v(a)(b)\2\1\1/e[19;14H[?12l[?25h[?25l[19;14H[K[19;13H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h\V[ab]\(\[xy]\)\1[?25l/\V[ab]\(\[xy]\)\1[20;7H[?12l[?25h[?25lab]x[20;12H[K[20;7H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" Now search for multi-byte without composing char[?25l[20;7H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h[?25l/[21;8H[?12l[?25h[?25lx[21;9H[K[21;8H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" Now search for multi-byte with composing char[?25l[21;8H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h[?25l/[1;21r[21;1H
[1;22r[21;1Ha x x[22;1H[K[21;8H[?12l[?25h[?25lx[21;9H[K[21;8H[?12l[?25h[?25l
:[?12l[?25h" find word by change of word class[?25l[21;8H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h?\<??\>?[?25l/[2C\<[4C\>[1;21r[21;1H
[1;22r[21;1Hb ????[22;1H[K[21;3H[?12l[?25h[?25l???[21;9H[K[21;3H[?12l[?25h[?25l
:[?12l[?25h" Test \%u, [\u] and friends[?25l[21;3H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h\%u20ac[?25l/\%u20ac[1;21r[21;1H
[1;22r[21;1Hc x x[22;1H[K[21;6H[?12l[?25h[?25lx[21;7H[K[21;6H[?12l[?25h[?25l
/[?12l[?25h[\u4f7f\u5929]\+[?25l/[\u4f7f\u5929]\+[1;21r[21;1H
[1;22r[21;1Hd ??x[22;1H[K[21;3H[?12l[?25h[?25l?x [21;7H[K[21;3H[?12l[?25h[?25l
/[?12l[?25h\%U12345678[?25l/\%U12345678[1;21r[21;1H
[1;22r[21;1He [34m?[my[22;1H[K[21;3H[?12l[?25h[?25ly[21;4H[K[21;3H[?12l[?25h[?25l
/[?12l[?25h[\U1234abcd\u1234\uabcd][?25l/[\U1234abcd\u1234\uabcd][1;21r[21;1H
[1;22r[21;1Hf [34m?[mz[22;1H[K[21;3H[?12l[?25h[?25lz[21;4H[K[21;3H[?12l[?25h[?25l
/[?12l[?25h\%d21879b[?25l/\%d21879b[1;21r[21;1H
[1;22r[21;1Hg a?bb[22;1H[K[21;4H[?12l[?25h[?25lbb[21;6H[K[21;4H[?12l[?25h[?25l
:[?12l[?25h?^1?,$w! test.out[?25l"test.out" [22;12H[K[22;1H"test.out" [New] 16L, 195C written"test.out" [New] 16L, 195C written[21;4H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he! test.out[?25l"test.out" [22;12H[K[22;1H"test.out" 16L, 195C[1;1H1 a aa abb abbcc[1;17H[K[2;1H2 d dd dee deeff
3 g gg ghh ghhii
4 j jj jkk jkkll
5 m mm mnn mnnoo
6 x aa$ x[6;10H[K[7;1H7 (a)(b) abba[7;14H[K[8;1H8 axx ab]xx[8;12H[K[9;1H9 x x[9;9H[K[10;1Ha x x[10;9H[K[11;1Hb ???[11;9H[K[12;1Hc x x[12;7H[K[13;1Hd ?[13;7H[K[14;1He y[14;4H[K[15;1Hf z[15;4H[K[16;1Hg abb [16;7H[K[17;1H[1m[34m~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[16;1H[?25l[m[22;1H[K[22;1H:[?12l[?25hput =matchstr(\"\", \".\", 0, 2) " [?25l[17;1H[17;2H[K[17;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hput =matchstr(\"\", \"..\", 0, 2) " [?25l[18;1H[18;3H[K[18;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hput =matchstr(\"\", \".\", 0, 0) " [?25l[19;1H[19;2H[K[19;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hput =matchstr(\"\", \".\", 4, -1) " [?25l[20;1H[20;2H[K[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw![?25l"test.out" "test.out" 20L, 209C written"test.out" 20L, 209C written[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test45.failed test.ok test.out X* viminfo
cp test45.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test45.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test45.in" 72 lines, 1498 characters[1;1HTests for folding. vim: set ft=vim :

STARTTEST
:so small.vim
:" We also need the +syntax feature here.
:if !has("syntax")
   e! test.ok
   w! test.out
   qa!
:endif
:" basic test if a fold can be created, opened, moving to the end and closed
/^1
zf2j:call append("$", "manual " . getline(foldclosed(".")))
zo:call append("$", foldclosed("."))
]z:call append("$", getline("."))
zc:call append("$", getline(foldclosed(".")))
:" test folding with markers.
:set fdm=marker fdl=1 fdc=3
/^5
:call append("$", "marker " . foldlevel("."))
[z:call append("$", foldlevel("."))[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for folding. vim: set ft=vim :[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 55 lines, 1365 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[27m[m[H[2J[1;1H/bb$
:call append("$", "expr " . foldlevel("."))
/hh$
:call append("$", foldlevel("."))
/ii$
:call append("$", foldlevel("."))
/kk$
:call append("$", foldlevel("."))
:/^last/+1,$w! test.out
:qa!
ENDTEST

1 aa
2 bb
3 cc
4 dd {{{
5 ee {{{ }}}
6 ff }}}
7 gg
8 hh
9 ii[11;1H[?12l[?25h
[?25l[22;1H:so! Xdotest[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" We also need the +syntax feature here.[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hif !has("syntax")[?25l
:  [?12l[?25h   e! test.ok
[?25l:  [?12l[?25h   w! test.out
[?25l:  [?12l[?25h   qa!
[?25l:  [?12l[?25h:endif[1;1H[4L[?25l[1;1H/bb$
:call append("$", "expr " . foldlevel("."))
/hh$
:call append("$", foldlevel("."))[22;1H[K[12;1H[?12l[?25h[?25l[22;1H:[?12l[?25h" basic test if a fold can be created, opened, moving to the end and closed[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h^1[?25l[13;1H[?12l[?25h[?25l[34m[47m+--  3 lines: 1 aa--------------------------------------------------------------[m[14;1H4 dd {{{
5 ee {{{ }}}
6 ff }}}
7 gg[17;6H[K[18;1H8 hh[18;6H[K[19;1H9 ii
a jj
b kk[13;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hcall append("$", "manual " . getline(foldclosed(".")))[?25l[13;1H[?12l[?25h[?25l1 aa[13;5H[K[14;1H2 bb[14;6H[K[15;1H3 cc[15;6H[K[16;1H4 dd {{{
5 ee {{{ }}}
6 ff }}}
7 gg
8 hh
9 ii[13;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hcall append("$", foldclosed("."))[?25l[13;1H[?12l[?25h

[?25l[22;1H[K[22;1H:[?12l[?25hcall append("$", getline("."))[?25l[15;1H[?12l[?25h[?25l[13;1H[34m[47m+--  3 lines: 1 aa--------------------------------------------------------------[m[14;1H4 dd {{{
5 ee {{{ }}}
6 ff }}}
7 gg[17;6H[K[18;1H8 hh[18;6H[K[19;1H9 ii
a jj
b kk[13;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hcall append("$", getline(foldclosed(".")))[?25l[13;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" test folding with markers.[?25l[13;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fdm=marker fdl=1 fdc=3[?25l[1;1H[34m[47m   [m/bb$
[34m[47m   [m:call append("$", "expr " . foldlevel("."))
[34m[47m   [m/hh$
[34m[47m   [m:call append("$", foldlevel("."))
[34m[47m   [m/ii$
[34m[47m   [m:call append("$", foldlevel("."))
[34m[47m   [m/kk$
[34m[47m   [m:call append("$", foldlevel("."))
[34m[47m   [m:/^last/+1,$w! test.out
[34m[47m   [m:qa!
[34m[47m   [mENDTEST
[34m[47m   
   [m1 aa[13;8H[K[14;1H[34m[47m   [m2 bb[14;8H[K[15;1H[34m[47m   [m3 cc[15;8H[K[16;1H[34m[47m-  [m4 dd {{{
[34m[47m|- [m5 ee {{{ }}}
[34m[47m|  [m6 ff }}}
[34m[47m   [m7 gg
[34m[47m   [m8 hh
[34m[47m   [m9 ii[15;4H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h^5[?25l[17;4H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hcall append("$", "marker " . foldlevel("."))[?25l[17;4H[?12l[?25h[16;4H[?25l[22;1H[K[22;1H:[?12l[?25hcall append("$", foldlevel("."))[?25l[16;4H[?12l[?25h[17;4H[?25l[19;21r[19;1H[L[1;22r[18;4H{{ [18;7H[K[19;1H[34m[47m|  [m6 ff }}}[22;1H[K[18;6H[?12l[?25h[?25l[18;2H[34m[47m-[m[3C{[19;2H[34m[47m|
|
|[18;6H[?12l[?25h[19;6H[20;6H[?25l

[m:[?12l[?25hcall append("$", foldlevel("."))[?25l[20;6H[?12l[?25h[19;6H[?25l[20;4H6 ff }}}
[34m[47m [m[2C7 gg[20;4H[?12l[?25h[21;4H[?25l[22;1H[K[22;1H:[?12l[?25hcall append("$", foldlevel("."))[?25l[21;4H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" test folding with indent[?25l[21;4H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fdm=indent sw=2[?25l[16;1H[34m[47m 
  
  
  
 
   [?12l[?25h[?25l[m[22;1H[K[22;1H/[?12l[?25h^2 b[?25l[31msearch hit BOTTOM, continuing at TOP[14;4H[?12l[?25h[?25l[m[34m[47m-[m[2C  2 bb[?12l[?25h[15;5H[?25l[34m[47m|-[m[1C    3 cc[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hcall append("$", "indent " . foldlevel("."))[?25l[15;7H[?12l[?25h[14;7H[?25l[22;1H[K[22;1H:[?12l[?25hcall append("$", foldlevel("."))[?25l[14;7H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" test syntax folding[?25l[14;7H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset fdm=syntax fdl=0[?25l[14;1H[34m[47m 
  [14;7H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hsyn region Hup start="dd" end="hh" fold[?25l[16;1H[34m[47m+  +--  7 lines: 4 dd ----------------------------------------------------------[m[17;4H9 ii[17;9H[K[18;4Ha jj[19;4Hb kk[19;9H[K[20;4Hlast[20;9H[K[21;4Hmanual 1 aa[14;7H[?12l[?25h[?25l[1;21r[1;1H[9M[1;22r[13;1H[34m[47m   [m-1
[34m[47m   [m3 cc
[34m[47m   [m1 aa
[34m[47m   [mmarker 2
[34m[47m   [m1
[34m[47m   [m1
[34m[47m   [m0
[34m[47m   [mindent 2
[34m[47m   [m1[22;1H[K[21;4H[?12l[?25h[7;4H[?25l[22;1H:[?12l[?25hcall append("$", "folding " . getline("."))[?25l[7;4H[?12l[?25h[6;4H[?25l[22;1H[K[22;1H:[?12l[?25hcall append("$", getline("."))[?25l[6;4H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" test expression folding[?25l[6;4H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hfun Flvl()[?25l
:  [?12l[?25h  let l = getline(v:lnum)
[?25l:  [?12l[?25h  if l =~ "bb$"
[?25l:    [?12l[?25h    return 2
[?25l:    [?12l[?25h  elseif l =~ "gg$"
[?25l:    [?12l[?25h    return "s1"
[?25l:    [?12l[?25h  elseif l =~ "ii$"
[?25l:    [?12l[?25h    return ">2"
[?25l:    [?12l[?25h  elseif l =~ "kk$"
[?25l:    [?12l[?25h    return "0"
[?25l:    [?12l[?25h  endif
[?25l:  [?12l[?25h  return "="
[?25l:  [?12l[?25hendfun[1;1H[12L[?25l[1;1H[34m[47m   [m:qa!
[34m[47m   [mENDTEST
[34m[47m   
   [m1 aa
[34m[47m   [m  2 bb
[34m[47m   [m    3 cc
[34m[47m+  +--  7 lines: 4 dd ----------------------------------------------------------[8;1H   [m9 ii
[34m[47m   [ma jj
[34m[47m   [mb kk
[34m[47m   [mlast
[34m[47m   [mmanual 1 aa[22;1H[K[6;4H[?12l[?25h[?25l[22;1H:[?12l[?25hset fdm=expr fde=Flvl()[?25l[5;1H[34m[47m+  +-- 11 lines: 2 bb-----------------------------------------------------------[m[6;4Hb kk[6;8H[K[7;1H[34m[47m [m[2Clast[7;8H[K[8;4Hmanual 1 aa[9;4H-1[9;6H[K[10;4H3 cc[11;4H1 aa[12;6Hrker 2[12;13H[K[13;4H1[13;5H[K[14;4H1[14;6H[K[15;4H0[15;6H[K[16;4Hindent[18;4Hfolding 8 hh[19;4H    3 cc[20;4H[1m[34m~                                                                            [21;4H~                                                                            [5;4H[?12l[?25h[?25l[m[22;1H[K[22;1H/[?12l[?25hbb$[?25l[31msearch hit BOTTOM, continuing at TOP[m[5;1H[34m[47m--[m[1C  2 bb[5;10H[K[6;1H[34m[47m||[m[1C    3 cc
[34m[47m||[m[1C4 dd {{{
[34m[47m||[m[1C5 ee {{{ }}}
[34m[47m||[m[1C{{{
[34m[47m||[m[1C6 ff }}}
[34m[47m||[m[1C6 ff }}}
[34m[47m||[m[1C7 gg[12;8H[K[13;1H[34m[47m|[m[2C8 hh
[34m[47m|+ +---  2 lines: 9 ii----------------------------------------------------------[m[15;4Hb kk[16;4Hlast[16;8H[K[17;4Hmanual 1 aa[18;4H-1[18;6H[K[19;4H3 cc[19;8H[K[20;4H1 aa[20;8H[K[21;4Hmarker 2[21;12H[K[5;8H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hcall append("$", "expr " . foldlevel("."))[?25l[5;8H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25hhh$[?25l[13;6H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hcall append("$", foldlevel("."))[?25l[13;6H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25hii$[?25l[14;2H[34m[47m-[m[1C9 ii[14;8H[K[15;1H[34m[47m||[m[1Ca jj[16;4Hb kk[17;4Hlast[17;8H[K[18;4Hmanual 1 aa[19;4H-1[19;6H[K[20;4H3 cc[21;4H1 aa[21;8H[K[14;6H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hcall append("$", foldlevel("."))[?25l[14;6H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25hkk$[?25l[16;6H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hcall append("$", foldlevel("."))[?25l[16;6H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^last/+1,$w! test.out[?25l"test.out" [22;12H[K[22;12H[New File] 16 lines, 86 characters written[16;6H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test46.failed test.ok test.out X* viminfo
cp test46.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test46.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test46.in" 27 lines, 431 characters[1;1HTests for multi-line regexps with ":s". vim: set ft=vim :

STARTTEST
:" test if replacing a line break works with a back reference
:/^1/,/^2/s/\n\(.\)/ \1/
:" test if inserting a line break works with a back reference
:/^3/,/^4/s/\(.\)$/\r\1/
:" test if replacing a line break with another line break works
:/^5/,/^6/s/\(\_d\{3}\)/x\1x/
:/^1/,$w! test.out
:qa!
ENDTEST

1 aa
bb
cc
2 dd
ee
3 ef
gh
4 ij[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for multi-line regexps with ":s". vim: set ft=vim :[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 8 lines, 292 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[12;1H[?12l[?25h
[?25l[22;1H[K[22;1H:so! Xdotest[13;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" test if replacing a line break works with a back reference[?25l[13;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^1/,/^2/s/\n\(.\)/ \1/[?25l4 substitutions on 1 line[14;21r[14;1H[4M[1;22r[14;1H1 aa bb cc 2 dd ee[18;1H5 a8
8b c9
9d
6 e7[22;1H[K[22;1H4 substitutions on 1 line[14;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" test if inserting a line break works with a back reference[?25l[14;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^3/,/^4/s/\(.\)$/\r\1/[?25l3 substitutions on 3 lines[15;4H[K[16;1Hf[16;2H[K[17;1Hg[17;3H[K[18;1Hh[18;3H[K[19;1H4 i[19;4H[K[20;1Hj[20;2H[K[21;1H5 a8[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" test if replacing a line break with another line break works[?25l[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^5/,/^6/s/\(\_d\{3}\)/x\1x/[?25l3 substitutions on 2 lines[22;27H[K[1;21r[1;1H[4M[1;22r[17;4Hx8
8xb cx9
9xd
6 ex7
7x7f[22;1H[K[22;1H3 substitutions on 2 lines[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^1/,$w! test.out[?25l[31msearch hit BOTTOM, continuing at TOP[m"test.out" [22;12H[K[22;12H[New File] 13 lines, 70 characters written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test47.failed test.ok test.out X* viminfo
cp test47.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test47.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test47.in" 44 lines, 1040 characters[1;1HTests for vertical splits and filler lines in diff mode

STARTTEST
:so small.vim
/^1
yG:new
pkdd:w! Xtest
ddGpkkrXoxxx[34m^[[m:w! Xtest2
:file Nop
ggoyyy[34m^[[mjjjozzzz[34m^[[m
:vert diffsplit Xtest
:vert diffsplit Xtest2
:" jump to second window for a moment to have filler line appear at start of
:" first window
[34m^W^W[mgg[34m^W[mpgg:let one = winline()
j:let one = one . "-" . winline()
j:let one = one . "-" . winline()
j:let one = one . "-" . winline()
j:let one = one . "-" . winline()
j:let one = one . "-" . winline()
[34m^W^W[mgg:let two = winline()[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for vertical splits and filler lines in diff mode[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 34 lines, 939 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[27m[m[H[2J[1;1Hj:let two = two . "-" . winline()
j:let two = two . "-" . winline()
[34m^W^W[mgg:let three = winline()
j:let three = three . "-" . winline()
j:let three = three . "-" . winline()
j:let three = three . "-" . winline()
j:let three = three . "-" . winline()
j:let three = three . "-" . winline()
j:let three = three . "-" . winline()
[34m^W^W[m:call append("$", one)
:call append("$", two)
:call append("$", three)
:$-2,$w! test.out
:qa!
ENDTEST

1 aa
2 bb
3 cc
4 dd
5 ee[15;1H[?12l[?25h
[?25l[22;1H:so! Xdotest[16;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[16;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h^1[?25l[17;1H[?12l[?25h[?25l[22;1H5 lines yanked[17;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hnew[?25l[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [m[11;1H[1m[7m[No Name]                                                                       [m[12;1H[34m^W^W[m:call append("$", one)
:call append("$", two)
:call append("$", three)
:$-2,$w! test.out
:qa!
ENDTEST[18;1H[K[19;1H1 aa
2 bb
[7mtest47.in                                                                       [1;1H[?12l[?25h[?25l[m[22;1H5 more lines[2;1H1 aa[2;5H[K[3;1H2 bb[3;5H[K[4;1H3 cc[4;5H[K[5;1H4 dd[5;5H[K[6;1H5 ee[6;5H[K[11;11H[1m[7m[+][2;1H[?12l[?25h[1;1H[?25l[1;10r[m[10;1H
[1;22r[10;1H[1m[34m~                                                                               [m[22;1H[K[1;1H[?12l[?25h[?25l[22;1H:[?12l[?25hw! Xtest[?25l"Xtest" [22;9H[K[22;9H[New File] 5 lines, 25 characters written[11;1H[1m[7mXtest         [1;1H[?12l[?25h[?25l[1;10r[m[10;1H
[1;22r[10;1H[1m[34m~                                                                               [m[11;7H[1m[7m[+][m[22;1H[K[1;1H[?12l[?25h


[?25l
1 aa[5;5H[K[5;1H[?12l[?25h[4;1H[3;1H[?25lX[?12l[?25h[?25l[4;10r[4;1H[L[1;22r[4;1Hxxx[?12l[?25h[?25l[22;1H:[?12l[?25hw! Xtest2[?25l"Xtest2" [22;10H[K[22;10H[New File] 6 lines, 29 characters written[11;7H[1m[7m    [4;3H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hfile Nop[?25l"Nop" [Not edited] line 4 of 6 --66%-- col 3[11;1H[1m[7mNop   [4;3H[?12l[?25h[1;1H[?25l[2;10r[m[2;1H[L[1;22r[2;1Hyyy[11;5H[1m[7m[+][m[22;1H[K[2;3H[?12l[?25h
3 
X 
xx[?25l[6;10r[6;1H[L[1;22r[6;1Hzzzz[?12l[?25h
5 e[?25l[22;1H:[?12l[?25hvert diffsplit Xtest[?25l"Xtest" [22;9H[K[22;9H5 lines, 25 characters[1;1H[34m[47m  [m[44m1 aa                                  [m[7m|[m
[34m[47m  [m2 bb[34C[7m|[m
[34m[47m  [m[1m[34m[46m--------------------------------------[m[7m|[m
[34m[47m  [m3 cc[34C[7m|[m
[34m[47m  [m[1m[41m4[m[45m dd                                  [m[7m|[m
[34m[47m  [m[1m[34m[46m--------------------------------------[m[7m|[m
[34m[47m  [m[1m[34m[46m--------------------------------------[m[7m|[m
[34m[47m  [m5 ee[34C[7m|[9;41H|[10;41H|[m[9;1H[34m[47m  [m[1m[34m[46m--------------------------------------[m
[34m[47m  [m[1m[34m~[m
[1m[7mXtest   [m[1;42H[34m[47m  [m[1m[34m[46m-------------------------------------[m[2;42H[34m[47m  [m2 bb[3;42H[34m[47m  [m[44myyy                                  [m[4;42H[34m[47m  [m3 cc[5;42H[34m[47m  [m[1m[41mX[m[45m dd                                 [m[6;42H[34m[47m  [m[44mxxx                                  [m[7;42H[34m[47m  [m[44mzzzz                                 [m[8;42H[34m[47m  [m5 ee[9;42H[34m[47m  [m[44m1 aa                                 [m[10;42H[34m[47m  [m[1m[34m~[m[11;42H[7mNop [+]                                [1;3H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hvert diffsplit Xtest2[?25l"Xtest2" [22;10H[K[22;10H6 lines, 29 characters[27m[m[H[2J[1;1H[34m[47m  [m2 bb[20C[7m|[m
[34m[47m  [m[1m[34m[46m------------------------[m[7m|[m
[34m[47m  [m3 cc[20C[7m|[m
[34m[47m  [m[1m[41mX[m[45m dd                    [m[7m|[m
[34m[47m  [m[45mxxx                     [m[7m|[m
[34m[47m  [m[1m[34m[46m------------------------[m[7m|[m
[34m[47m  [m5 ee[20C[7m|[m
[34m[47m  [m[44m1 aa                    [m[7m|[9;27H|[10;27H|[m[9;1H[34m[47m  
  [m[9;3H[1m[34m~                       [10;3H~                       [m
[1m[7mXtest2                     [m[1;28H[34m[47m  [m2 bb[20C[7m|[m[2;28H[34m[47m  [m[1m[34m[46m------------------------[m[7m|[m[3;28H[34m[47m  [m3 cc[20C[7m|[m[4;28H[34m[47m  [m[1m[41m4[m[45m dd                    [m[7m|[m[5;28H[34m[47m  [m[1m[34m[46m------------------------[m[7m|[m[6;28H[34m[47m  [m[1m[34m[46m------------------------[m[7m|[m[7;28H[34m[47m  [m5 ee[20C[7m|[8;54H|[9;54H|[10;54H|[m[8;28H[34m[47m  [m[1m[34m[46m------------------------[m[9;28H[34m[47m  [10;28H  [m[9;30H[1m[34m~                       [10;30H~                       [m[11;28H[7mXtest                      [m[1;55H[34m[47m  [m2 bb[2;55H[34m[47m  [m[44myyy                     [m[3;55H[34m[47m  [m3 cc[4;55H[34m[47m  [m[1m[41mX[m[45m dd                    [m[5;55H[34m[47m  [m[45mxxx                     [m[6;55H[34m[47m  [m[44mzzzz                    [m[7;55H[34m[47m  [m5 ee[8;55H[34m[47m  [m[44m1 aa                    [m[9;55H[34m[47m  [10;55H  [m[9;57H[1m[34m~                       [10;57H~                       [m[11;55H[7mNop [+]                   [m[12;1H[34m^W^W[m:call append("$", one)
:call append("$", two)
:call append("$", three)
:$-2,$w! test.out
:qa!
ENDTEST

1 aa
2 bb
[7mtest47.in                                                                       [1;3H[?12l[?25h[?25l[22;1H[m:[?12l[?25h" jump to second window for a moment to have filler line appear at start of[?25l[1;3H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" first window[?25l[1;3H[?12l[?25h[?25l[11;1H[7mXtest2                     [m[1m[7mXtest                      [1;30H[?12l[?25h[?25l[m[1;3H[1m[34m[46m------------------------[m[2;3H2 bb                    [3;3H[1m[34m[46m------------------------[m[4;3H3 cc                    [5;3H[1m[41mX[m[45m dd[6;3Hxxx                     [m[7;3H[1m[34m[46m------------------------[m[8;3H5 ee                    [9;3H[44m1 aa                    [m[1;1H[27C                          [2;28H[34m[47m  [m2 bb                    [3;28H[34m[47m  [m[1m[34m[46m------------------------[m[4;28H[34m[47m  [m3 cc                    [5;28H[34m[47m  [m[1m[41m4[m[45m dd                    [m[6;28H[34m[47m  [m[1m[34m[46m------------------------[m[7;28H[34m[47m  [m[1m[34m[46m------------------------[m[8;28H[34m[47m  [m5 ee                    [9;28H[34m[47m  [m[1m[34m[46m------------------------[m[10;28H[34m[47m  [m[1m[34m~                       [m[1;28H[34m[47m  [m[44m1 aa                    [m[3C[1m[34m[46m------------------------[m[2;57H2 bb[2;61H[K[3;57H[44myyy                     [m[4;57H3 cc[4;61H[K[5;57H[1m[41mX[m[45m dd[6;57Hxxx                     [m[7;57H[44mzzzz                    [m[8;57H5 ee[8;61H[K[9;57H[44m1 aa                    [m[22;1H[K[1;30H[?12l[?25h[?25l[11;1H[1m[7mXtest2                     [m[7mXtest                      [2;3H[?12l[?25h[?25l[22;1H[m:[?12l[?25hlet one = winline()[?25l[2;3H[?12l[?25h[4;3H[?25l[22;1H[K[22;1H:[?12l[?25hlet one = one . "-" . winline()[?25l[4;3H[?12l[?25h[5;3H[?25l[22;1H[K[22;1H:[?12l[?25hlet one = one . "-" . winline()[?25l[5;3H[?12l[?25h[6;3H[?25l[22;1H[K[22;1H:[?12l[?25hlet one = one . "-" . winline()[?25l[6;3H[?12l[?25h[8;3H[?25l[22;1H[K[22;1H:[?12l[?25hlet one = one . "-" . winline()[?25l[8;3H[?12l[?25h[9;3H[?25l[22;1H[K[22;1H:[?12l[?25hlet one = one . "-" . winline()[?25l[9;3H[?12l[?25h[?25l

[7mXtest2                     [m[1m[7mXtest                      [1;30H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hlet two = winline()[?25l[1;30H[?12l[?25h[2;30H[?25l[22;1H[K[22;1H:[?12l[?25hlet two = two . "-" . winline()[?25l[2;30H[?12l[?25h[4;30H[?25l[22;1H[K[22;1H:[?12l[?25hlet two = two . "-" . winline()[?25l[4;30H[?12l[?25h[5;30H[?25l[22;1H[K[22;1H:[?12l[?25hlet two = two . "-" . winline()[?25l[5;30H[?12l[?25h[8;30H[?25l[22;1H[K[22;1H:[?12l[?25hlet two = two . "-" . winline()[?25l[8;30H[?12l[?25h[?25l[11;28H[7mXtest                      [m[1m[7mNop [+]                   [8;60H[?12l[?25h[2;57H[?25l[m[22;1H[K[22;1H:[?12l[?25hlet three = winline()[?25l[2;57H[?12l[?25h[3;57H[?25l[22;1H[K[22;1H:[?12l[?25hlet three = three . "-" . winline()[?25l[3;57H[?12l[?25h[4;57H[?25l[22;1H[K[22;1H:[?12l[?25hlet three = three . "-" . winline()[?25l[4;57H[?12l[?25h[5;57H[?25l[22;1H[K[22;1H:[?12l[?25hlet three = three . "-" . winline()[?25l[5;57H[?12l[?25h[6;57H[?25l[22;1H[K[22;1H:[?12l[?25hlet three = three . "-" . winline()[?25l[6;57H[?12l[?25h[7;57H[?25l[22;1H[K[22;1H:[?12l[?25hlet three = three . "-" . winline()[?25l[7;57H[?12l[?25h[8;57H[?25l[22;1H[K[22;1H:[?12l[?25hlet three = three . "-" . winline()[?25l[8;57H[?12l[?25h[11;55H[7mNop [+]                   [m[21;1H[1m[7mtest47.in                                                                       [19;1H[?25l[m[22;1H[K[22;1H:[?12l[?25hcall append("$", one)[?25l[21;11H[1m[7m[+][19;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hcall append("$", two)[?25l[19;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hcall append("$", three)[?25l[19;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$-2,$w! test.out[?25l"test.out" [22;12H[K[22;12H[New File] 3 lines, 36 characters written[19;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test48.failed test.ok test.out X* viminfo
cp test48.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test48.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test48.in" 74 lines, 1452 characters[1;1HThis is a test of 'virtualedit'.

STARTTEST
:so small.vim
:set noswf
:set ve=all
-dgg
:"
:"   Insert "keyword keyw", ESC, C CTRL-N, shows "keyword ykeyword".
:"    Repeating CTRL-N fixes it. (Mary Ellen Foster)
2/w
C[34m^N^[[m
:"
:"   Using "C" then then <CR> moves the last remaining character to the next
:"    line.  (Mary Ellen Foster)
j^/are
C[34m^M[mare belong to vim[34m^[[m
:"
:"   When past the end of a line that ends in a single character "b" skips
:"    that word.
^$15lbC7[34m^[[1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HThis is a test of 'virtualedit'.[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 54 lines, 1250 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[27m[m[H[2J[1;1H:set display=uhex
^xxxxxxi[This line should contain only the text between the brackets.][34m^[[m
:set display=
:"
:"   Test for ^Y/^E due to bad w_virtcol value, reported by
:"   Roy <royl@netropolis.net>.
^O[34m^[[m3li[34m^E^[[m4li[34m^E^[[m4li[34m^E[m   <-- should show the name of a noted text editor[34m^[[m
^o[34m^[[m4li[34m^Y^[[m4li[34m^Y^[[m4li[34m^Y[m   <-- and its version number[34m^[[m-dd
:"
:wq! test.out
ENDTEST
keyword keyw
all your base are belong to us
1 2 3 4 5 6
'i'
'C'
'a'
'A'
'D'
this is a test
this is a test[11;1H[?12l[?25h
[?25l[22;1H:so! Xdotest[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset noswf[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset ve=all[?25l[12;1H[?12l[?25h[11;1H[?25l[22;1H58 fewer lines[1;21r[1;1H[11M[1;22r[11;1Hthis is a test
"r"
a[34m^V[mb[34m^M[msd
abcv6efi.him0kl


[1m[34m~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [m[22;1H[K[22;1H58 fewer lines[1;1H[?12l[?25h
[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[2;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"   Insert "keyword keyw", ESC, C CTRL-N, shows "keyword ykeyword".[?25l[2;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"    Repeating CTRL-N fixes it. (Mary Ellen Foster)[?25l[2;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25hw[?25l[31msearch hit BOTTOM, continuing at TOP[1;12H[?12l[?25h[?25l[m$[22;1H[32mScanning tags.[m[22;15H[K[22;1HThe only match[1;16H[22;1H[K[1;12Hword[?12l[?25h[2;15H[?25l[22;1H:[?12l[?25h"[?25l[2;15H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"   Using "C" then then <CR> moves the last remaining character to the next[?25l[2;15H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"    line.  (Mary Ellen Foster)[?25l[2;15H[?12l[?25h[3;15H[?25l[22;1H[K[22;1H/[?12l[?25hare[?25l[31msearch hit BOTTOM, continuing at TOP[2;15H[?12l[?25h[?25l[m[15C$[2;15H[K[3;1Hare belong to vim
1 2 3 4 5 6
'i
'C
'a
'A
'D'[9;4H[K[12;1Hthis is a test
"r"[13;4H[K[14;2H[34m^V[mb[34m^M[msd[14;9H[K[15;1Habcv6efi.him0kl[17;1H[K[3;17H[?12l[?25h[4;17H[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[4;17H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"   When past the end of a line that ends in a single character "b" skips[?25l[4;17H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"    that word.[?25l[4;17H[?12l[?25h[10C[15C[4;11H[?25l$7[?12l[?25h[5;11H[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[5;11H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"   Make sure 'i' works[?25l[5;11H[?12l[?25h'i'   [?25l<-- should be 3 ' '[?12l[?25h[6;25H[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[6;25H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"   Make sure 'C' works[?25l[6;25H[?12l[?25h'C'   [?25l$<-- should be 3 ' '[?12l[?25h[7;25H[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[7;25H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"   Make sure 'a' works[?25l[7;25H[?12l[?25h'a'   [?25l <-- should be 4 ' '[?12l[?25h[8;26H[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[8;26H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"   Make sure 'A' works[?25l[8;26H[?12l[?25h'A'   [?25l<-- should be 0 ' '[?12l[?25h[9;22H[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[9;22H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"   Make sure 'D' works[?25l[9;22H[?12l[?25h'D'   [?25l<-- 'D' should be intact[?12l[?25h[10;30H[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[10;30H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"   Test for yank bug reported by Mark Waggoner.[?25l[10;30H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset ve=block[?25l[10;14H[?12l[?25h[8C[?25l[?12l[?25h[?25l[7ma[11;9Ha[12;9Ha[13;9H[?12l[?25h[?25l[m[10;9Ha[11;9Ha[12;9Ha[22;1Hblock of 4 lines yanked[10;9H[?12l[?25h[17;1H[?25l[22;1H3 more lines[22;13H[K[17;1Ha
a[18;2H[K[19;1Ha[19;2H[K[20;1H [20;2H[K[17;1H[?12l[?25h
[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[18;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" Test "r" beyond the end of the line[?25l[18;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset ve=all[?25l[18;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h^"r"[?25l[31msearch hit BOTTOM, continuing at TOP[13;1H[?12l[?25h[m"r"    [?25lx[?12l[?25h[?25lx<-- should be 'x'[?12l[?25h[14;25H[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[14;25H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"   Test to make sure 'x' can delete control characters[?25l[14;25H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset display=uhex[?25l[14;2H[34m<16>[mb[34m<0d>[msd[16C[?12l[?25h[?25l[34m<16>[mb[34m<0d>[msd[14;12H[K[14;1H[?12l[?25h[?25lb[34m<0d>[msd[14;8H[K[14;1H[?12l[?25h[?25l[34m<0d>[msd[14;7H[K[14;1H[?12l[?25h[?25lsd[14;3H[K[14;1H[?12l[?25h[?25ld[14;2H[K[14;1H[?12l[?25h[?25l[14;1H[K[14;1H[?12l[?25h[?25l[This line should contain only the text between the brackets.][?12l[?25h[15;62H[?25l[22;1H[K[22;1H:[?12l[?25hset display=[?25l[15;62H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[15;62H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"   Test for ^Y/^E due to bad w_virtcol value, reported by[?25l[15;62H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"   Roy <royl@netropolis.net>.[?25l[15;62H[?12l[?25h[?25l[15;21r[15;1H[L[1;22r[22;1H[K[15;1H[?12l[?25h   [?25lv[?12l[?25hv   [?25li[?12l[?25hi   [?25lm   <-- should show the name of a noted text editor[?12l[?25h[16;62H[?25l[17;21r[17;1H[L[1;22r[17;1H[?12l[?25h    [?25l6[?12l[?25h6   [?25l.[?12l[?25h.   [?25l0   <-- and its version number[?12l[?25h[16;1H[?25l[16;21r[21;1H
[1;22r[16;5H[?12l[?25h
    [?25l[22;1H:[?12l[?25h"[?25l[17;5H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hwq! test.out[?25l"test.out" [22;12H[K[22;12H[New File] 21 lines, 443 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test49.failed test.ok test.out X* viminfo
cp test49.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test49.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test49.in" 13 lines, 320 characters[1;1HThis is a test of the script language.

If after adding a new test, the test output doesn't appear properly in
test49.failed, try to add one ore more "G"s at the line before ENDTEST.

STARTTEST
:so small.vim
:se nocp nomore viminfo+=nviminfo
:so test49.vim
GGGGGGGGGG"rp:.-,$wq! test.out
ENDTEST

Results of test49.vim:
[1m[34m~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HThis is a test of the script language.[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[6;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[7;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 4 lines, 94 characters written[7;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[7;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[11;1H[?12l[?25h
[?25l[22;1H[K[22;1H:so! Xdotest[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hse nocp nomore viminfo+=nviminfo[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso test49.vim[?25l[1m[37m[41mError detected while processing function G:[m
[33mline   16:[m
[1m[37m[41mE171: Missing :endif:     endwhile[m
*** Test   1: OK (34695)
   function F()
1      Xpath 1[37C" X: 1
2      let first = 1
3      XloopINIT 2 8
4      while 1
5[10CXloop 1[33C" X: 2      + 0 * 16
6[10Cif first
7[14CXloop 2[29C" X: 4      + 0 * 32
8[14Clet first = 0
9[14CXloopNEXT
10[13Cbreak
11[9Celse
12[13CXloop 4[29C" X: 0      + 0 * 64
13[13Creturn
14[9Cendif
15     endwhile
   endfunction[6;1H"/tmp/v449856/0"[7;1H[K[8;1H[K[9;1H[K[10;1H[K[11;1H[K[12;1H[K[13;1H[K[14;1H[K[15;1H[K[16;1H[K[17;1H[K[18;1H[K[19;1H[K[20;1H[K[21;1H[K[22;4H[K[6;18H[noeol] 18L, 528C
15 substitutions on 15 lines
E486: Pattern not found: ^\s*$"/tmp/v449856/0" [8;19H[K[8;18H15L, 476C written"test49.in" [8;13H[K[8;13H13L, 320C
   function G()
1      Xpath 256[35C" X: 256    + 0 * 2048
2      let first = 1
3      XloopINIT 512 8
4      while 1
5[10CXloop 1[33C" X: 512    + 0 * 4096
6[10Cif first
7[14CXloop 2[29C" X: 1024   + 0 * 8192
8[14Clet first = 0
9[14CXloopNEXT
10[13Cbreak
11[9Celse
12[13CXloop 4[29C" X: 0      + 0 * 16384
13[13Creturn
14[9Cendif
15[9Cif 1    " unmatched :if
16     endwhile
   endfunction[5;1H"/tmp/v449856/1"[6;1H[K[7;1H[K[8;1H[K[9;1H[K[10;1H[K[11;1H[K[12;1H[K[13;1H[K[14;1H[K[15;1H[K[16;1H[K[17;1H[K[18;1H[K[19;1H[K[20;1H[K[21;1H[K[22;4H[K[5;18H[noeol] 19L, 588C
16 substitutions on 16 lines
E486: Pattern not found: ^\s*$"/tmp/v449856/1" [7;19H[K[7;18H16L, 534C written"test49.in" [7;13H[K[7;13H13L, 320C
[1m[37m[41mError detected while processing /tmp/v449856/1:[m
[33mline   16:[m
[1m[37m[41mE171: Missing :endif:      endwhile[m
*** Test   2: OK (34695)
*** Test   3: OK (1384648195)
*** Test   4: OK (32883)
   function F()
1      if 1
2[10CXpath 1[33C" X: 1
3[10Clet loops = 3
4[10CXloopINIT 2 16
5[10Cwhile loops > 0[25C"    3:  2:     1:
6[14CXloop 1[29C" X: 2 + 2*16 + 0*16*16
7[14Cif (loops == 2)
8[18CXloop 2[25C" X:     4*16
9[18Creturn
10[17CXloop 4[25C" X:     0
11[13Cendif
12[13CXloop 8[29C" X: 16
13[13Clet loops = loops - 1
14[13CXloopNEXT
15[9Cendwhile
16[9CXpath 8192[30C" X: 0
17     else
18[9CXpath 16384[29C" X: 0
19     endif
   endfunction[2;1H"/tmp/v449856/2"[3;1H[K[4;1H[K[5;1H[K[6;1H[K[7;1H[K[8;1H[K[9;1H[K[10;1H[K[11;1H[K[12;1H[K[13;1H[K[14;1H[K[15;1H[K[16;1H[K[17;1H[K[18;1H[K[19;1H[K[20;1H[K[21;1H[K[22;4H[K[2;18H[noeol] 22L, 784C
19 substitutions on 19 lines
E486: Pattern not found: ^\s*$"/tmp/v449856/2" [4;19H[K[4;18H19L, 724C written"test49.in" [4;13H[K[4;13H13L, 320C
*** Test   5: OK (32883)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"/tmp/v449856/3" [5;18H[K[5;18H[New] 53L, 1582C written[5;18H[K[5;18H14L, 358C appended[5;18H[K[5;18H26L, 824C appended[5;18H[K[5;18H34L, 986C appended
:!echo 'source /tmp/v449856/3' >/tmp/v449856/4[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[6;1H[K[6;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/4" [6;18H[K[6;18H130L, 2431C appended[6;18H[K[6;18H131L, 2453C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/5[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[8;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'l[9;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/5"' -S /tmp/v449856[10;1H/4[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[8;1H"/tmp/v449856/5" [8;18H[K[9;1H[K[10;1H[K[8;18H21L, 130C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [8;13H[K[8;13H13L, 320C
*** Test   6: OK (603978947)
[1m[37m[41mError detected while processing /sources/vim71/src/testdir/test49.vim:[m
[33mline  976:[m
[1m[37m[41mE492: Not an editor command: ^Iasdf[m
[33mline  988:[m
[1m[37m[41mE492: Not an editor command: ^Iasdf[m
[33mline  996:[m
[1m[37m[41mE492: Not an editor command: asdf[m
[33mline  999:[m
[1m[37m[41mE492: Not an editor command: asdf | Xpath 32768^I^I^I^I" X: 0[m
*** Test   7: OK (90563)
[1m[37m[41mError detected while processing function F:[m
[33mline    5:[m
[1m[37m[41mE492: Not an editor command: ^I    asdf[m
[33mline    7:[m
[1m[37m[41mE492: Not an editor command: ^I    asdf | Xpath 8^I^I^I" X: 0[m
[33mline   19:[m
[1m[37m[41mE492: Not an editor command: ^I    asdf[m
[33mline   21:[m
[1m[37m[41mE492: Not an editor command: ^I    asdf | Xpath 2048^I^I^I" X: 0[m
[33mline   29:[m
[1m[37m[41mE121: Undefined variable: novar[m
[1m[37m[41mE15: Invalid expression: novar^I^I" returns (default return value 0)[m
[1m[37m[41mError detected while processing function G:[m
[33mline    5:[m
[1m[37m[41mE492: Not an editor command: ^I    asdf^I^I" returns -1[m
[1m[37m[41mError detected while processing function H:[m
[33mline    5:[m
[1m[37m[41mE492: Not an editor command: ^I    asdf^I^I" returns -1[m
*** Test   8: OK (562493431)
[1m[37m[41mError detected while processing function F..G..H..I:[m
[33mline    2:[m
[1m[37m[41mE492: Not an editor command:     asdf^I^I" error[m
*** Test   9: OK (363)
[1m[37m[41mError detected while processing /sources/vim71/src/testdir/test49.vim:[m
[33mline 1201:[m
[1m[37m[41mE15: Invalid expression: | strlen("\"") | Xpath 512^I^I" X: 0[m
[1m[37m[41mE15: Invalid expression: 1 ||| strlen("\"") | Xpath 512^I^I" X: 0[m
[33mline 1211:[m
[1m[37m[41mE15: Invalid expression: | strlen("\"") | Xpath 8192^I^I" X: 0[m
[1m[37m[41mE15: Invalid expression: 1 ||| strlen("\"") | Xpath 8192^I^I" X: 0[m
[33mline 1220:[m
[1m[37m[41mE15: Invalid expression: | strlen("\"") | Xpath 131072^I^I" X: 0[m
[1m[37m[41mE15: Invalid expression: 1 ||| strlen("\"") | Xpath 131072^I^I" X: 0[m
*** Test  10: OK (559615)
[33mline 1252:[m
[1m[37m[41mE492: Not an editor command:     asdf^I^I" error[m
*** Test  11: OK (2049)
1
[33mline 1330:[m
[1m[37m[41mE492: Not an editor command:     asdf^I^I" error[m
[33mline 1338:[m
[1m[37m[41mE492: Not an editor command:     asdf^I^I" error[m
*** Test  12: OK (352256)
[33mline 1357:[m
[1m[37m[41mE121: Undefined variable: asdf[m
[1m[37m[41mE15: Invalid expression: asdf[m
[33mline 1368:[m
[1m[37m[41mE121: Undefined variable: asdf[m
[1m[37m[41mE15: Invalid expression: asdf | Xpath 32 | endwhile | Xpath 64^I" X: 0[m
*** Test  13: OK (145)
[1m[37m[41mError detected while processing function F:[m
[33mline    8:[m
[1m[37m[41mE121: Undefined variable: g:boolvar[m
[1m[37m[41mE15: Invalid expression: g:boolvar^I" possibly undefined[m
*** Test  14: OK (42413)
[1m[37m[41mE121: Undefined variable: g:boolvar[m
[1m[37m[41mE15: Invalid expression: g:boolvar | Xloop 8 | else | Xloop 16 | endif    " X: [m
[21;80H[1m[37m[41m8[m[22;1H
*** Test  15: OK (42413)
[33mline    5:[m
[1m[37m[41mE583: multiple :else:     else^I^I[m
[1m[37m[41mError detected while processing function G:[m
[33mline    5:[m
[1m[37m[41mE584: :elseif after :else:     elseif 1^I^I" aborts function[m
[1m[37m[41mError detected while processing function H:[m
[33mline    7:[m
[1m[37m[41mE583: multiple :else:     else^I^I[m
[1m[37m[41mError detected while processing function I:[m
[33mline    7:[m
[1m[37m[41mE584: :elseif after :else:     elseif 1^I^I" aborts function[m
*** Test  16: OK (8722)
[1m[37m[41mError detected while processing function F:[m
[33mline   18:[m
[1m[37m[41mE171: Missing :endif:     endwhile^I[m
[1m[37m[41mE171: Missing :endif:     endwhile^I[m
[33mline   34:[m
[1m[37m[41mE171: Missing :endif:     endwhile^I[m
[1m[37m[41mE171: Missing :endif:     endwhile^I[m
[1m[37m[41mE171: Missing :endif:     endwhile^I[m
[33mline   47:[m
[1m[37m[41mE580: :endif without :if: ^Iendif^I[m
[1m[37m[41mE580: :endif without :if: ^Iendif^I[m
[1m[37m[41mE580: :endif without :if: ^Iendif^I[m
[1m[37m[41mError detected while processing /sources/vim71/src/testdir/test49.vim:[m
[33mline 1626:[m
[1m[37m[41mE171: Missing :endif: endwhile [m
*** Test  17: OK (285127993)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/6[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/6" [22;18H[K[22;18H16L, 304C appended[22;18H[K[22;18H17L, 326C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/7[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[21;80Hc[22;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/7"' -c 'breakad
[21;80Hd[22;2Hfile 8 /tmp/v449856/6' -S /tmp/v449856/6[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/7" [20;18H[K[21;2H[K[22;2H[K[20;18H3L, 6C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/8[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/8" [21;18H[K[21;18H6L, 127C appended[21;18H[K[21;18H7L, 149C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/9[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[21;80Hc[22;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/9"' -c 'breakad
[21;80Hd[22;2Hfile 4 /tmp/v449856/8' -S /tmp/v449856/8[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/9" [20;18H[K[21;2H[K[22;2H[K[20;18H1L, 5C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/10[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/10" [21;19H[K[21;19H21L, 486C appended[21;19H[K[21;19H22L, 508C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/11[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[21;80Hc[22;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/11"' -c 'breaka
[21;80Hd[22;1Hd func 7 F' -S /tmp/v449856/10[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/11" [20;19H[K[21;2H[K[22;1H[K[20;19H3L, 18C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/12[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/12" [21;19H[K[21;19H13L, 364C appended[21;19H[K[21;19H14L, 386C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/13[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[21;80Hc[22;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/13"' -c 'breaka
[21;80Hd[22;1Hd func 3 G' -S /tmp/v449856/12[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/13" [20;19H[K[21;2H[K[22;1H[K[20;19H1L, 9C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  18: OK (67224583)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/14[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/14" [22;19H[K[22;19H12L, 201C appended[22;19H[K[22;19H13L, 223C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/15[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[21;80Hl[22;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/15"' -S /tmp/v4498
[21;80H5[22;1H6/14[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/15" [20;19H[K[21;1H[K[22;1H[K[20;19H2L, 4C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/16[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/16" [21;19H[K[21;19H12L, 205C appended[21;19H[K[21;19H13L, 227C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/17[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[21;80Hl[22;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/17"' -S /tmp/v4498
[21;80H5[22;1H6/16[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/17" [20;19H[K[21;1H[K[22;1H[K[20;19H2L, 7C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/18[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/18" [21;19H[K[21;19H6L, 122C appended[21;19H[K[21;19H7L, 144C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/19[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[21;80Hl[22;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/19"' -S /tmp/v4498
[21;80H5[22;1H6/18[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/19" [20;19H[K[21;1H[K[22;1H[K[20;19H1L, 5C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/20[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/20" [21;19H[K[21;19H8L, 176C appended[21;19H[K[21;19H9L, 198C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/21[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[21;80Hl[22;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/21"' -S /tmp/v4498
[21;80H5[22;1H6/20[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/21" [20;19H[K[21;1H[K[22;1H[K[20;19H1L, 6C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/22[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/22" [21;19H[K[21;19H10L, 215C appended[21;19H[K[21;19H11L, 237C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/23[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[21;80Hl[22;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/23"' -S /tmp/v4498
[21;80H5[22;1H6/22[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/23" [20;19H[K[21;1H[K[22;1H[K[20;19H1L, 8C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/24[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/24" [21;19H[K[21;19H7L, 149C appended[21;19H[K[21;19H8L, 171C[21;19H[K[21;19H8L, 170C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/25[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[21;80Hl[22;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/25"' -S /tmp/v4498
[21;80H5[22;1H6/24[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/25" [20;19H[K[21;1H[K[22;1H[K[20;19H1L, 9C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  19: OK (69275973)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/26[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/26" [22;19H[K[22;19H9L, 135C appended[22;19H[K[22;19H10L, 157C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/27[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[21;80Hl[22;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/27"' -S /tmp/v4498
[21;80H5[22;1H6/26[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/27" [20;19H[K[21;1H[K[22;1H[K[20;19H2L, 4C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/28[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/28" [21;19H[K[21;19H10L, 155C appended[21;19H[K[21;19H11L, 177C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/29[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[21;80Hl[22;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/29"' -S /tmp/v4498
[21;80H5[22;1H6/28[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/29" [20;19H[K[21;1H[K[22;1H[K[20;19H3L, 8C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/30[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/30" [21;19H[K[21;19H12L, 204C appended[21;19H[K[21;19H13L, 226C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/31[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[21;80Hl[22;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/31"' -S /tmp/v4498
[21;80H5[22;1H6/30[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/31" [20;19H[K[21;1H[K[22;1H[K[20;19H4L, 18C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/32[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/32" [21;19H[K[21;19H12L, 214C appended[21;19H[K[21;19H13L, 236C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/33[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[21;80Hl[22;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/33"' -S /tmp/v4498
[21;80H5[22;1H6/32[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/33" [20;19H[K[21;1H[K[22;1H[K[20;19H4L, 22C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/34[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/34" [21;19H[K[21;19H12L, 211C appended[21;19H[K[21;19H13L, 233C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/35[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[21;80Hl[22;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/35"' -S /tmp/v4498
[21;80H5[22;1H6/34[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/35" [20;19H[K[21;1H[K[22;1H[K[20;19H3L, 22C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/36[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/36" [21;19H[K[21;19H14L, 263C appended[21;19H[K[21;19H15L, 285C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/37[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[21;80Hl[22;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/37"' -S /tmp/v4498
[21;80H5[22;1H6/36[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/37" [20;19H[K[21;1H[K[22;1H[K[20;19H4L, 34C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/38[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/38" [21;19H[K[21;19H14L, 277C appended[21;19H[K[21;19H15L, 299C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/39[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[21;80Hl[22;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/39"' -S /tmp/v4498
[21;80H5[22;1H6/38[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/39" [20;19H[K[21;1H[K[22;1H[K[20;19H4L, 40C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  20: OK (1874575085)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/40[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/40" [22;19H[K[22;19H58L, 1022C appended[22;19H[K[22;19H59L, 1044C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/41[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[21;80Hl[22;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/41"' -S /tmp/v4498
[21;80H5[22;1H6/40[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/41" [20;19H[K[21;1H[K[22;1H[K[20;19H9L, 56C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  21: OK (147932225)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/42[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/42" [22;19H[K[22;19H23L, 418C appended[22;19H[K[22;19H24L, 440C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/43[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[21;80Hl[22;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/43"' -S /tmp/v4498
[21;80H5[22;1H6/42[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/43" [20;19H[K[21;1H[K[22;1H[K[20;19H1L, 2C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/44[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/44" [21;19H[K[21;19H23L, 437C appended[21;19H[K[21;19H24L, 459C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/45[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[21;80Hc[22;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/45"' -c 'breaka
[21;80Hd[22;1Hd func 2 Interrupt' -S /tmp/v449856/44[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/45" [20;19H[K[21;2H[K[22;1H[K[20;19H1L, 3C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/46[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/46" [21;19H[K[21;19H21L, 386C appended[21;19H[K[21;19H22L, 408C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/47[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[21;80Hl[22;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/47"' -S /tmp/v4498
[21;80H5[22;1H6/46[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/47" [20;19H[K[21;1H[K[22;1H[K[20;19H1L, 5C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  22: OK (4161)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/48[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/48" [22;19H[K[22;19H25L, 432C appended[22;19H[K[22;19H26L, 454C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/49[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[21;80Hl[22;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/49"' -S /tmp/v4498
[21;80H5[22;1H6/48[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/49" [20;19H[K[21;1H[K[22;1H[K[20;19H3L, 8C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  23: OK (49)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/50[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/50" [22;19H[K[22;19H16L, 392C appended[22;19H[K[22;19H17L, 414C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/51[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[21;80Hl[22;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/51"' -S /tmp/v4498
[21;80H5[22;1H6/50[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/51" [20;19H[K[21;1H[K[22;1H[K[20;19H3L, 7C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  24: OK (41)
*** Test  25: OK (260177811)
*** Test  26: OK (1681500476)
*** Test  27: OK (1996459)
   function F()
1      try
2[10CXpath 1[33C" X: 1
3[10Ctry
4[14CXpath 2[29C" X: 2
5[14Creturn
6[14CXpath 4[29C" X: 0
7[10Cfinally
8[14CXpath 8[29C" X: 8
9[10Cendtry
10[9CXpath 16[32C" X: 0
11     finally
12[9CXpath 32[32C" X: 32
13     endtry
14     Xpath 64[36C" X: 0
   endfunction[7;1H"/tmp/v449856/52"[8;1H[K[9;1H[K[10;1H[K[11;1H[K[12;1H[K[13;1H[K[14;1H[K[15;1H[K[16;1H[K[17;1H[K[18;1H[K[19;1H[K[20;1H[K[21;1H[K[22;4H[K[7;19H[noeol] 17L, 552C
14 substitutions on 14 lines
E486: Pattern not found: ^\s*$"/tmp/v449856/52"[9;19H[K[9;19H14L, 502C written"test49.in" [9;13H[K[9;13H13L, 320C
   function G()
1      try
2[10CXpath 128[31C" X: 128
3[10Creturn
4[10CXpath 256[31C" X: 0
5      finally
6[10CXpath 512[31C" X: 512
7[10Ccall F()
8[10CXpath 1024[30C" X: 1024
9      endtry
10     Xpath 2048[34C" X: 0
   endfunction[10;1H"/tmp/v449856/53"[11;1H[K[12;1H[K[13;1H[K[14;1H[K[15;1H[K[16;1H[K[17;1H[K[18;1H[K[19;1H[K[20;1H[K[21;4H[K[10;19H[noeol] 13L, 406C
10 substitutions on 10 lines
E486: Pattern not found: ^\s*$"/tmp/v449856/53"[12;19H[K[12;19H10L, 378C written"test49.in" [12;13H[K[12;13H13L, 320C
   function H()
1      try
2[10CXpath 4096[30C" X: 4096
3[10Ccall G()
4[10CXpath 8192[30C" X: 8192
5      finally
6[10CXpath 16384[29C" X: 16384
7[10Creturn
8[10CXpath 32768[29C" X: 0
9      endtry
10     Xpath 65536[33C" X: 0
   endfunction[11;1H"/tmp/v449856/54"[12;1H[K[13;1H[K[14;1H[K[15;1H[K[16;1H[K[17;1H[K[18;1H[K[19;1H[K[20;1H[K[21;1H[K[22;4H[K[11;19H[noeol] 13L, 409C
10 substitutions on 10 lines
E486: Pattern not found: ^\s*$"/tmp/v449856/54"[13;19H[K[13;19H10L, 381C written"test49.in" [13;13H[K[13;13H13L, 320C
*** Test  28: OK (1996459)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/55[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[15;1H[K[15;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/55" [15;19H[K[15;19H39L, 721C appended[15;19H[K[15;19H40L, 743C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/56[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[17;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'l[18;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/56"' -S /tmp/v44985[19;1H6/55[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[17;1H"/tmp/v449856/56" [17;19H[K[18;1H[K[19;1H[K[17;19H6L, 21C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [17;13H[K[17;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/57[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[18;1H[K[18;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/57" [18;19H[K[18;19H23L, 509C appended[18;19H[K[18;19H24L, 531C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/58[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'l[21;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/58"' -S /tmp/v44985[22;1H6/57[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/58" [20;19H[K[21;1H[K[22;1H[K[20;19H4L, 34C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  29: OK (170428555)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/59[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/59" [22;19H[K[22;19H60L, 1101C appended[22;19H[K[22;19H61L, 1123C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/60[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nv
[21;80Hi[22;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/60"' -
[21;80Hc[22;2H'breakadd func 3 F' -c 'breakadd file 19 /tmp/v449856/59' -c 'breakadd file 31
/tmp/v449856/59' -S /tmp/v449856/59[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[19;1H"/tmp/v449856/60" [19;19H[K[20;1H[K[21;2H[K[22;1H[K[19;19H16L, 89C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [19;13H[K[19;13H13L, 320C
*** Test  30: OK (190905173)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/61[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/61" [21;19H[K[21;19H60L, 1122C appended[21;19H[K[21;19H61L, 1144C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/62[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[21;80Hl[22;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/62"' -S /tmp/v4498
[21;80H5[22;1H6/61[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/62" [20;19H[K[21;1H[K[22;1H[K[20;19H16L, 89C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  31: OK (190905173)
*** Test  32: OK (354833067)
*** Test  33: OK (1216907538)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/63[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/63" [22;19H[K[22;19H63L, 1288C appended[22;19H[K[22;19H64L, 1310C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/64[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set vi
[21;80Hm[22;1Hinfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v4498
[21;80H5[22;1H6/64"' -c 'breakadd func 16 C' -S /tmp/v449856/63[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/64" [20;19H[K[21;1H[K[22;1H[K[20;19H17L, 127C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  34: OK (2146584868)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/65[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/65" [22;19H[K[22;19H63L, 1285C appended[22;19H[K[22;19H64L, 1307C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/66[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set vi
[21;80Hm[22;1Hinfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v4498
[21;80H5[22;1H6/66"' -c 'breakadd func 16 B' -S /tmp/v449856/65[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/66" [20;19H[K[21;1H[K[22;1H[K[20;19H17L, 127C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  35: OK (2146584868)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/67[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/67" [22;19H[K[22;19H66L, 1430C appended[22;19H[K[22;19H67L, 1452C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/68[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set vimin
[21;80Hf[22;1Ho+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/
[21;80H6[22;1H8"' -c 'breakadd func 16 R' -S /tmp/v449856/67[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/68" [20;19H[K[21;1H[K[22;1H[K[20;19H9L, 81C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  36: OK (1071644672)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/69[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/69" [22;19H[K[22;19H73L, 1488C appended[22;19H[K[22;19H74L, 1510C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/70[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[21;80Hl[22;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/70"' -c 'breakadd
[21;80Hf[22;1Hunc 16 F' -S /tmp/v449856/69[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/70" [20;19H[K[21;1H[K[22;1H[K[20;19H9L, 81C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  37: OK (1071644672)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/71[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/71" [22;19H[K[22;19H82L, 1519C appended[22;19H[K[22;19H83L, 1541C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/72[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set vi
[21;80Hm[22;1Hinfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v4498
[21;80H5[22;1H6/72"' -c 'breakadd func 16 E' -S /tmp/v449856/71[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/72" [20;19H[K[21;1H[K[22;1H[K[20;19H8L, 63C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  38: OK (357908480)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/73[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/73" [22;19H[K[22;19H83L, 1538C appended[22;19H[K[22;19H84L, 1560C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/74[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq' | ../vim -u NONE -N -Xes -
[21;80Hc[22;2H'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVi
[21;80Hm[22;1HResult = "/tmp/v449856/74"' -c 'breakadd func 16 I' -c 'breakadd func 22 I' -S
[21;80H/[22;1Htmp/v449856/73[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[19;1H"/tmp/v449856/74" [19;19H[K[20;2H[K[21;1H[K[22;1H[K[19;19H8L, 63C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [19;13H[K[19;13H13L, 320C
*** Test  39: OK (357908480)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/75[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/75" [21;19H[K[21;19H82L, 1519C appended[21;19H[K[21;19H83L, 1541C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/76[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set vi
[21;80Hm[22;1Hinfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v4498
[21;80H5[22;1H6/76"' -c 'breakadd func 16 T' -S /tmp/v449856/75[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/76" [20;19H[K[21;1H[K[22;1H[K[20;19H8L, 63C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  40: OK (357908480)
*** Test  41: OK (3076095)
*** Test  42: OK (1505155949)
*** Test  43: OK (1157763329)
*** Test  44: OK (1031761407)
*** Test  45: OK (1157763329)
*** Test  46: OK (739407)
*** Test  47: OK (371213935)
*** Test  48: OK (756255461)
*** Test  49: OK (179000669)
   function C()
1      try
2[10CXpath 1[33C" X: 1
3[10Cthrow "arrgh"
4[10CXpath 2[33C" X: 0
5      catch /arrgh/
6[10CXpath 4[33C" X: 4
7      endtry
8      Xpath 8[37C" X: 8
   endfunction[13;1H"/tmp/v449856/77"[14;1H[K[15;1H[K[16;1H[K[17;1H[K[18;1H[K[19;1H[K[20;1H[K[21;1H[K[22;4H[K[13;19H[noeol] 11L, 334C
8 substitutions on 8 lines
E486: Pattern not found: ^\s*$"/tmp/v449856/77"[15;19H[K[15;19H8L, 295C written"test49.in" [15;13H[K[15;13H13L, 320C
   function T1()
1      XloopNEXT
2      try
3[10CXloop 1[33C" X: 16 + 16*16
4[10Cthrow "arrgh"
5[10CXloop 2[33C" X: 0
6      finally
7[10CXloop 4[33C" X: 64 + 64*16
8      endtry
9      Xloop 8[37C" X: 0
   endfunction[12;1H"/tmp/v449856/78"[13;1H[K[14;1H[K[15;1H[K[16;1H[K[17;1H[K[18;1H[K[19;1H[K[20;1H[K[21;1H[K[22;4H[K[12;19H[noeol] 12L, 364C
9 substitutions on 9 lines
E486: Pattern not found: ^\s*$"/tmp/v449856/78"[14;19H[K[14;19H9L, 323C written"test49.in" [14;13H[K[14;13H13L, 320C
   function T2()
1      try
2[10CXpath 4096[30C" X: 4096
3[10Ccall T1()
4[10CXpath 8192[30C" X: 0
5      finally
6[10CXpath 16384[29C" X: 16384
7      endtry
8      Xpath 32768[33C" X: 0
   endfunction[13;1H"/tmp/v449856/79"[14;1H[K[15;1H[K[16;1H[K[17;1H[K[18;1H[K[19;1H[K[20;1H[K[21;1H[K[22;4H[K[13;19H[noeol] 11L, 332C
8 substitutions on 8 lines
E486: Pattern not found: ^\s*$"/tmp/v449856/79"[15;19H[K[15;19H8L, 305C written"test49.in" [15;13H[K[15;13H13L, 320C
*** Test  50: OK (363550045)
*** Test  51: OK (40744667)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/81[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[18;1H[K[18;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/81" [18;19H[K[18;19H2L, 41C appended[18;19H[K[18;19H3L, 63C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/82[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tm[21;1Hp/v449856/80' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/v449856/82"' -S /tmp/v449856/81[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/82" [20;19H[K[21;1H[K[22;1H[K[20;19H1L, 2C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/80" [20;19H[K[20;19H8L, 182C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/83[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/83" [21;19H[K[21;19H7L, 115C appended[21;19H[K[21;19H8L, 137C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/84[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/80' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/v449856/84"' -S /tmp/v449856/83[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/84" [20;19H[K[21;1H[K[22;1H[K[20;19H1L, 2C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/80" [20;19H[K[20;19H8L, 181C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/85[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/85" [21;19H[K[21;19H12L, 180C appended[21;19H[K[21;19H13L, 202C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/86[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/80' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/v449856/86"' -S /tmp/v449856/85[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/86" [20;19H[K[21;1H[K[22;1H[K[20;19H2L, 8C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/80" [20;19H[K[20;19H10L, 209C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/87[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/87" [21;19H[K[21;19H8L, 139C appended[21;19H[K[21;19H9L, 161C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/88[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/80' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/v449856/88"' -S /tmp/v449856/87[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/88" [20;19H[K[21;1H[K[22;1H[K[20;19H2L, 11C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/80" [20;19H[K[20;19H10L, 217C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/89[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/89" [21;19H[K[21;19H5L, 87C appended[21;19H[K[21;19H6L, 109C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/90[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q[34m^M[mq' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir!
[21;80H>[22;1H/tmp/v449856/80' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin =
1' -c 'let ExtraVimResult = "/tmp/v449856/90"' -c 'breakadd file 4 /tmp/v449856
[21;80H/[22;1H89' -S /tmp/v449856/89[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[19;1H"/tmp/v449856/90" [19;19H[K[20;1H[K[21;1H[K[22;1H[K[19;19H1L, 7C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [19;13H[K[19;13H13L, 320C"/tmp/v449856/80" [19;19H[K[19;19H[noeol] 9L, 202C"test49.in" [19;13H[K[19;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/91[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H[K[20;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/91" [20;19H[K[20;19H7L, 189C appended[20;19H[K[20;19H8L, 211C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/92[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/80' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/v449856/92"' -S /tmp/v449856/91[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/92" [20;19H[K[21;1H[K[22;1H[K[20;19H1L, 8C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/80" [20;19H[K[20;19H9L, 252C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/93[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/93" [21;19H[K[21;19H7L, 199C appended[21;19H[K[21;19H8L, 221C[21;19H[K[21;19H8L, 220C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/94[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/80' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/v449856/94"' -S /tmp/v449856/93[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/94" [20;19H[K[21;1H[K[22;1H[K[20;19H1L, 10C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/80" [20;19H[K[20;19H9L, 214C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  52: OK (1247112011)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/96[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/96" [22;19H[K[22;19H1L, 10C appended[22;19H[K[22;19H2L, 32C[22;19H[K[22;19H2L, 31C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/97[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/v449856/97"' -S /tmp/v449856/96[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/97" [20;19H[K[21;1H[K[22;1H[K[20;19H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/95" [20;19H[K[20;19H6L, 154C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/98[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/98" [21;19H[K[21;19H3L, 39C appended[21;19H[K[21;19H4L, 61C
3 substitutions on 3 lines"/tmp/v449856/98" [22;20H[K[22;19H4L, 58C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/99[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/v449856/99"' -S /tmp/v449856/98[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/99" [20;19H[K[21;1H[K[22;1H[K[20;19H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/95" [20;19H[K[20;19H6L, 158C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/100[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/100" [21;20H[K[21;20H4L, 45C appended[21;20H[K[21;20H5L, 67C
4 substitutions on 4 lines"/tmp/v449856/100"[22;20H[K[22;20H5L, 63C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/101[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/v449856/101"' -S /tmp/v449856/100[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/101" [20;21H[K[21;1H[K[22;1H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/95" [20;19H[K[20;19H6L, 159C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/102[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/102" [21;20H[K[21;20H3L, 33C appended[21;20H[K[21;20H4L, 55C
3 substitutions on 3 lines"/tmp/v449856/102"[22;20H[K[22;20H4L, 52C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/103[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/v449856/103"' -S /tmp/v449856/102[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/103" [20;21H[K[21;1H[K[22;1H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/95" [20;19H[K[20;19H6L, 159C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/104[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/104" [21;20H[K[21;20H5L, 65C appended[21;20H[K[21;20H6L, 87C
5 substitutions on 5 lines"/tmp/v449856/104"[22;20H[K[22;20H6L, 82C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/105[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/v449856/105"' -S /tmp/v449856/104[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/105" [20;21H[K[21;1H[K[22;1H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/95" [20;19H[K[20;19H6L, 159C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/106[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/106" [21;20H[K[21;20H1L, 9C appended[21;20H[K[21;20H2L, 31C[21;20H[K[21;20H2L, 30C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/107[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/v449856/107"' -S /tmp/v449856/106[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/107" [20;21H[K[21;1H[K[22;1H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/95" [20;19H[K[20;19H6L, 153C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/108[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/108" [21;20H[K[21;20H3L, 38C appended[21;20H[K[21;20H4L, 60C
3 substitutions on 3 lines"/tmp/v449856/108"[22;20H[K[22;20H4L, 57C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/109[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/v449856/109"' -S /tmp/v449856/108[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/109" [20;21H[K[21;1H[K[22;1H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/95" [20;19H[K[20;19H6L, 157C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/110[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/110" [21;20H[K[21;20H4L, 44C appended[21;20H[K[21;20H5L, 66C
4 substitutions on 4 lines"/tmp/v449856/110"[22;20H[K[22;20H5L, 62C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/111[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/v449856/111"' -S /tmp/v449856/110[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/111" [20;21H[K[21;1H[K[22;1H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/95" [20;19H[K[20;19H6L, 157C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/112[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/112" [21;20H[K[21;20H3L, 32C appended[21;20H[K[21;20H4L, 54C
3 substitutions on 3 lines"/tmp/v449856/112"[22;20H[K[22;20H4L, 51C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/113[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/v449856/113"' -S /tmp/v449856/112[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/113" [20;21H[K[21;1H[K[22;1H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/95" [20;19H[K[20;19H6L, 157C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/114[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/114" [21;20H[K[21;20H5L, 64C appended[21;20H[K[21;20H6L, 86C
5 substitutions on 5 lines"/tmp/v449856/114"[22;20H[K[22;20H6L, 81C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/115[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/v449856/115"' -S /tmp/v449856/114[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/115" [20;21H[K[21;1H[K[22;1H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/95" [20;19H[K[20;19H6L, 157C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/116[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/116" [21;20H[K[21;20H1L, 11C appended[21;20H[K[21;20H2L, 33C[21;20H[K[21;20H2L, 32C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/117[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/v449856/117"' -S /tmp/v449856/116[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/117" [20;21H[K[21;1H[K[22;1H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/95" [20;19H[K[20;19H6L, 157C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/118[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/118" [21;20H[K[21;20H3L, 40C appended[21;20H[K[21;20H4L, 62C
3 substitutions on 3 lines"/tmp/v449856/118"[22;20H[K[22;20H4L, 59C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/119[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/v449856/119"' -S /tmp/v449856/118[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/119" [20;21H[K[21;1H[K[22;1H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/95" [20;19H[K[20;19H6L, 161C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/120[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/120" [21;20H[K[21;20H4L, 46C appended[21;20H[K[21;20H5L, 68C
4 substitutions on 4 lines"/tmp/v449856/120"[22;20H[K[22;20H5L, 64C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/121[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/v449856/121"' -S /tmp/v449856/120[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/121" [20;21H[K[21;1H[K[22;1H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/95" [20;19H[K[20;19H6L, 161C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/122[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/122" [21;20H[K[21;20H3L, 34C appended[21;20H[K[21;20H4L, 56C
3 substitutions on 3 lines"/tmp/v449856/122"[22;20H[K[22;20H4L, 53C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/123[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/v449856/123"' -S /tmp/v449856/122[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/123" [20;21H[K[21;1H[K[22;1H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/95" [20;19H[K[20;19H6L, 161C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/124[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/124" [21;20H[K[21;20H5L, 66C appended[21;20H[K[21;20H6L, 88C
5 substitutions on 5 lines"/tmp/v449856/124"[22;20H[K[22;20H6L, 83C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/125[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/v449856/125"' -S /tmp/v449856/124[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/125" [20;21H[K[21;1H[K[22;1H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/95" [20;19H[K[20;19H6L, 161C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/126[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/126" [21;20H[K[21;20H4L, 37C appended[21;20H[K[21;20H5L, 59C
4 substitutions on 4 lines"/tmp/v449856/126"[22;20H[K[22;20H5L, 55C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/127[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/v449856/127"' -S /tmp/v449856/126[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/127" [20;21H[K[21;1H[K[22;1H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/95" [20;19H[K[20;19H6L, 150C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/128[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/128" [21;20H[K[21;20H4L, 41C appended[21;20H[K[21;20H5L, 63C
4 substitutions on 4 lines"/tmp/v449856/128"[22;20H[K[22;20H5L, 59C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/129[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/v449856/129"' -S /tmp/v449856/128[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/129" [20;21H[K[21;1H[K[22;1H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/95" [20;19H[K[20;19H6L, 159C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  53: OK (131071)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/131[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/131" [22;20H[K[22;20H1L, 13C appended[22;20H[K[22;20H2L, 35C[22;20H[K[22;20H2L, 34C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/132[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[21;80H'[22;2H-c 'let ExtraVimResult = "/tmp/v449856/132"' -S /tmp/v449856/131[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/132" [20;21H[K[21;1H[K[22;2H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/130" [20;20H[K[20;20H6L, 164C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/133[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/133" [21;20H[K[21;20H3L, 36C appended[21;20H[K[21;20H4L, 58C
3 substitutions on 3 lines"/tmp/v449856/133"[22;20H[K[22;20H4L, 55C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/134[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[21;80H'[22;2H-c 'let ExtraVimResult = "/tmp/v449856/134"' -S /tmp/v449856/133[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/134" [20;21H[K[21;1H[K[22;2H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/130" [20;20H[K[20;20H6L, 168C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/135[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/135" [21;20H[K[21;20H3L, 38C appended[21;20H[K[21;20H4L, 60C
3 substitutions on 3 lines"/tmp/v449856/135"[22;20H[K[22;20H4L, 57C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/136[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[21;80H'[22;2H-c 'let ExtraVimResult = "/tmp/v449856/136"' -S /tmp/v449856/135[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/136" [20;21H[K[21;1H[K[22;2H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/130" [20;20H[K[20;20H6L, 154C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/137[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/137" [21;20H[K[21;20H4L, 48C appended[21;20H[K[21;20H5L, 70C
4 substitutions on 4 lines"/tmp/v449856/137"[22;20H[K[22;20H5L, 66C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/138[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[21;80H'[22;2H-c 'let ExtraVimResult = "/tmp/v449856/138"' -S /tmp/v449856/137[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/138" [20;21H[K[21;1H[K[22;2H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/130" [20;20H[K[20;20H6L, 168C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/139[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/139" [21;20H[K[21;20H4L, 53C appended[21;20H[K[21;20H5L, 75C
4 substitutions on 4 lines"/tmp/v449856/139"[22;20H[K[22;20H5L, 71C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/140[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[21;80H'[22;2H-c 'let ExtraVimResult = "/tmp/v449856/140"' -S /tmp/v449856/139[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/140" [20;21H[K[21;1H[K[22;2H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/130" [20;20H[K[20;20H6L, 155C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/141[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/141" [21;20H[K[21;20H5L, 62C appended[21;20H[K[21;20H6L, 84C
5 substitutions on 5 lines"/tmp/v449856/141"[22;20H[K[22;20H6L, 79C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/142[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[21;80H'[22;2H-c 'let ExtraVimResult = "/tmp/v449856/142"' -S /tmp/v449856/141[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/142" [20;21H[K[21;1H[K[22;2H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/130" [20;20H[K[20;20H6L, 155C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/143[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/143" [21;20H[K[21;20H5L, 64C appended[21;20H[K[21;20H6L, 86C
5 substitutions on 5 lines"/tmp/v449856/143"[22;20H[K[22;20H6L, 81C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/144[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[21;80H'[22;2H-c 'let ExtraVimResult = "/tmp/v449856/144"' -S /tmp/v449856/143[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/144" [20;21H[K[21;1H[K[22;2H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/130" [20;20H[K[20;20H6L, 154C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/145[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/145" [21;20H[K[21;20H3L, 36C appended[21;20H[K[21;20H4L, 58C
3 substitutions on 3 lines"/tmp/v449856/145"[22;20H[K[22;20H4L, 55C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/146[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[21;80H'[22;2H-c 'let ExtraVimResult = "/tmp/v449856/146"' -S /tmp/v449856/145[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/146" [20;21H[K[21;1H[K[22;2H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/130" [20;20H[K[20;20H6L, 168C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/147[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/147" [21;20H[K[21;20H5L, 67C appended[21;20H[K[21;20H6L, 89C
5 substitutions on 5 lines"/tmp/v449856/147"[22;20H[K[22;20H6L, 84C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/148[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[21;80H'[22;2H-c 'let ExtraVimResult = "/tmp/v449856/148"' -S /tmp/v449856/147[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/148" [20;21H[K[21;1H[K[22;2H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/130" [20;20H[K[20;20H6L, 167C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/149[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/149" [21;20H[K[21;20H5L, 68C appended[21;20H[K[21;20H6L, 90C
5 substitutions on 5 lines"/tmp/v449856/149"[22;20H[K[22;20H6L, 85C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/150[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[21;80H'[22;2H-c 'let ExtraVimResult = "/tmp/v449856/150"' -S /tmp/v449856/149[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/150" [20;21H[K[21;1H[K[22;2H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/130" [20;20H[K[20;20H6L, 168C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/151[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/151" [21;20H[K[21;20H7L, 95C appended[21;20H[K[21;20H8L, 117C
7 substitutions on 7 lines"/tmp/v449856/151"[22;20H[K[22;20H8L, 110C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/152[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[21;80H'[22;2H-c 'let ExtraVimResult = "/tmp/v449856/152"' -S /tmp/v449856/151[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/152" [20;21H[K[21;1H[K[22;2H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/130" [20;20H[K[20;20H6L, 167C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  54: OK (2047)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/154[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/154" [22;20H[K[22;20H1L, 13C appended[22;20H[K[22;20H2L, 35C[22;20H[K[22;20H2L, 34C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/155[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/153' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[21;80H'[22;2H-c 'let ExtraVimResult = "/tmp/v449856/155"' -S /tmp/v449856/154[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/155" [20;21H[K[21;1H[K[22;2H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/153" [20;20H[K[20;20H6L, 172C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/156[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/156" [21;20H[K[21;20H3L, 36C appended[21;20H[K[21;20H4L, 58C
3 substitutions on 3 lines"/tmp/v449856/156"[22;20H[K[22;20H4L, 55C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/157[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/153' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[21;80H'[22;2H-c 'let ExtraVimResult = "/tmp/v449856/157"' -S /tmp/v449856/156[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/157" [20;21H[K[21;1H[K[22;2H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/153" [20;20H[K[20;20H6L, 176C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/158[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/158" [21;20H[K[21;20H4L, 48C appended[21;20H[K[21;20H5L, 70C
4 substitutions on 4 lines"/tmp/v449856/158"[22;20H[K[22;20H5L, 66C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/159[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/153' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[21;80H'[22;2H-c 'let ExtraVimResult = "/tmp/v449856/159"' -S /tmp/v449856/158[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/159" [20;21H[K[21;1H[K[22;2H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/153" [20;20H[K[20;20H6L, 176C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/160[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/160" [21;20H[K[21;20H3L, 36C appended[21;20H[K[21;20H4L, 58C
3 substitutions on 3 lines"/tmp/v449856/160"[22;20H[K[22;20H4L, 55C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/161[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/153' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[21;80H'[22;2H-c 'let ExtraVimResult = "/tmp/v449856/161"' -S /tmp/v449856/160[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/161" [20;21H[K[21;1H[K[22;2H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/153" [20;20H[K[20;20H6L, 176C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/162[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/162" [21;20H[K[21;20H5L, 68C appended[21;20H[K[21;20H6L, 90C
5 substitutions on 5 lines"/tmp/v449856/162"[22;20H[K[22;20H6L, 85C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/163[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/153' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[21;80H'[22;2H-c 'let ExtraVimResult = "/tmp/v449856/163"' -S /tmp/v449856/162[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/163" [20;21H[K[21;1H[K[22;2H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/153" [20;20H[K[20;20H6L, 176C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/164[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/164" [21;20H[K[21;20H1L, 10C appended[21;20H[K[21;20H2L, 32C[21;20H[K[21;20H2L, 31C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/165[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/153' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[21;80H'[22;2H-c 'let ExtraVimResult = "/tmp/v449856/165"' -S /tmp/v449856/164[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/165" [20;21H[K[21;1H[K[22;2H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/153" [20;20H[K[20;20H6L, 166C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/166[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/166" [21;20H[K[21;20H3L, 33C appended[21;20H[K[21;20H4L, 55C
3 substitutions on 3 lines"/tmp/v449856/166"[22;20H[K[22;20H4L, 52C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/167[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/153' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[21;80H'[22;2H-c 'let ExtraVimResult = "/tmp/v449856/167"' -S /tmp/v449856/166[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/167" [20;21H[K[21;1H[K[22;2H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/153" [20;20H[K[20;20H6L, 170C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/168[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/168" [21;20H[K[21;20H4L, 45C appended[21;20H[K[21;20H5L, 67C
4 substitutions on 4 lines"/tmp/v449856/168"[22;20H[K[22;20H5L, 63C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/169[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/153' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[21;80H'[22;2H-c 'let ExtraVimResult = "/tmp/v449856/169"' -S /tmp/v449856/168[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/169" [20;21H[K[21;1H[K[22;2H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/153" [20;20H[K[20;20H6L, 170C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/170[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/170" [21;20H[K[21;20H3L, 33C appended[21;20H[K[21;20H4L, 55C
3 substitutions on 3 lines"/tmp/v449856/170"[22;20H[K[22;20H4L, 52C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/171[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/153' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[21;80H'[22;2H-c 'let ExtraVimResult = "/tmp/v449856/171"' -S /tmp/v449856/170[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/171" [20;21H[K[21;1H[K[22;2H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/153" [20;20H[K[20;20H6L, 170C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/172[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/172" [21;20H[K[21;20H5L, 65C appended[21;20H[K[21;20H6L, 87C
5 substitutions on 5 lines"/tmp/v449856/172"[22;20H[K[22;20H6L, 82C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/173[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/153' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[21;80H'[22;2H-c 'let ExtraVimResult = "/tmp/v449856/173"' -S /tmp/v449856/172[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/173" [20;21H[K[21;1H[K[22;2H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/153" [20;20H[K[20;20H6L, 170C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  55: OK (1023)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/175[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/175" [22;20H[K[22;20H1L, 11C appended[22;20H[K[22;20H2L, 33C[22;20H[K[22;20H2L, 32C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/176[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/174' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[21;80H'[22;2H-c 'let ExtraVimResult = "/tmp/v449856/176"' -S /tmp/v449856/175[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/176" [20;21H[K[21;1H[K[22;2H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/174" [20;20H[K[20;20H6L, 158C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/177[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/177" [21;20H[K[21;20H3L, 34C appended[21;20H[K[21;20H4L, 56C
3 substitutions on 3 lines"/tmp/v449856/177"[22;20H[K[22;20H4L, 53C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/178[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/174' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[21;80H'[22;2H-c 'let ExtraVimResult = "/tmp/v449856/178"' -S /tmp/v449856/177[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/178" [20;21H[K[21;1H[K[22;2H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/174" [20;20H[K[20;20H6L, 162C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/179[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/179" [21;20H[K[21;20H3L, 40C appended[21;20H[K[21;20H4L, 62C
3 substitutions on 3 lines"/tmp/v449856/179"[22;20H[K[22;20H4L, 59C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/180[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/174' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[21;80H'[22;2H-c 'let ExtraVimResult = "/tmp/v449856/180"' -S /tmp/v449856/179[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/180" [20;21H[K[21;1H[K[22;2H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/174" [20;20H[K[20;20H6L, 162C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/181[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/181" [21;20H[K[21;20H3L, 32C appended[21;20H[K[21;20H4L, 54C
3 substitutions on 3 lines"/tmp/v449856/181"[22;20H[K[22;20H4L, 51C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/182[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/174' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[21;80H'[22;2H-c 'let ExtraVimResult = "/tmp/v449856/182"' -S /tmp/v449856/181[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/182" [20;21H[K[21;1H[K[22;2H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/174" [20;20H[K[20;20H6L, 152C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/183[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/183" [21;20H[K[21;20H3L, 35C appended[21;20H[K[21;20H4L, 57C
3 substitutions on 3 lines"/tmp/v449856/183"[22;20H[K[22;20H4L, 54C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/184[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/174' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[21;80H'[22;2H-c 'let ExtraVimResult = "/tmp/v449856/184"' -S /tmp/v449856/183[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/184" [20;21H[K[21;1H[K[22;2H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/174" [20;20H[K[20;20H6L, 155C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/185[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/185" [21;20H[K[21;20H4L, 44C appended[21;20H[K[21;20H5L, 66C
4 substitutions on 4 lines"/tmp/v449856/185"[22;20H[K[22;20H5L, 62C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/186[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/174' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[21;80H'[22;2H-c 'let ExtraVimResult = "/tmp/v449856/186"' -S /tmp/v449856/185[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/186" [20;21H[K[21;1H[K[22;2H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/174" [20;20H[K[20;20H6L, 152C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/187[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/187" [21;20H[K[21;20H4L, 47C appended[21;20H[K[21;20H5L, 69C
4 substitutions on 4 lines"/tmp/v449856/187"[22;20H[K[22;20H5L, 65C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/188[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/174' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[21;80H'[22;2H-c 'let ExtraVimResult = "/tmp/v449856/188"' -S /tmp/v449856/187[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/188" [20;21H[K[21;1H[K[22;2H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/174" [20;20H[K[20;20H6L, 155C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/189[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/189" [21;20H[K[21;20H5L, 64C appended[21;20H[K[21;20H6L, 86C
5 substitutions on 5 lines"/tmp/v449856/189"[22;20H[K[22;20H6L, 81C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/190[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/174' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[21;80H'[22;2H-c 'let ExtraVimResult = "/tmp/v449856/190"' -S /tmp/v449856/189[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/190" [20;21H[K[21;1H[K[22;2H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/174" [20;20H[K[20;20H6L, 152C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/191[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/191" [21;20H[K[21;20H5L, 67C appended[21;20H[K[21;20H6L, 89C
5 substitutions on 5 lines"/tmp/v449856/191"[22;20H[K[22;20H6L, 84C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/192[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[21;80Hm[22;1Hp/v449856/174' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[21;80H'[22;2H-c 'let ExtraVimResult = "/tmp/v449856/192"' -S /tmp/v449856/191[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/192" [20;21H[K[21;1H[K[22;2H[K[20;20H0L, 0C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/tmp/v449856/174" [20;20H[K[20;20H6L, 155C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  56: OK (511)
   function FuncException()
1      let g:exception = v:exception
   endfunction[20;1H"/tmp/v449856/193" [20;20H[K[21;1H[K[22;4H[K[20;20H[noeol] 4L, 80C
E486: Pattern not found: ^\s*$"/tmp/v449856/193" [21;20H[K[21;20H1L, 36C written"test49.in" [21;13H[K[21;13H13L, 320C
   function FuncThrowpoint()
1      let g:throwpoint = v:throwpoint
   endfunction[20;1H"/tmp/v449856/194" [20;20H[K[21;1H[K[22;4H[K[20;20H[noeol] 4L, 83C
E486: Pattern not found: ^\s*$"/tmp/v449856/194" [21;20H[K[21;20H1L, 38C written"test49.in" [21;13H[K[21;13H13L, 320C
   function T(arg, line)
1      if a:line == 2
2[10Cthrow a:arg[13C" in line 2
3      elseif a:line == 4
4[10Cthrow a:arg[13C" in line 4
5      elseif a:line == 6
6[10Cthrow a:arg[13C" in line 6
7      elseif a:line == 8
8[10Cthrow a:arg[13C" in line 8
9      endif
   endfunction[12;1H"/tmp/v449856/195"[12;20H[K[13;1H[K[14;1H[K[15;1H[K[16;1H[K[17;1H[K[18;1H[K[19;1H[K[20;1H[K[21;1H[K[22;4H[K[12;20H[noeol] 12L, 341C
9 substitutions on 9 lines
8 substitutions on 8 lines
E486: Pattern not found: ^\s*$"/tmp/v449856/195" [15;20H[K[15;20H9L, 292C written"test49.in" [15;13H[K[15;13H13L, 320C
   function G(arg, line)
1      call T(a:arg, a:line)
   endfunction[16;1H"/tmp/v449856/196"[16;20H[K[17;1H[K[18;4H[K[16;20H[noeol] 4L, 69C
E486: Pattern not found: ^\s*$"/tmp/v449856/196" [17;20H[K[17;20H1L, 30C written"test49.in" [17;13H[K[17;13H13L, 320C
   function F(arg, line)
1      call G(a:arg, a:line)
   endfunction[18;1H"/tmp/v449856/197"[18;20H[K[19;1H[K[20;4H[K[18;20H[noeol] 4L, 69C
E486: Pattern not found: ^\s*$"/tmp/v449856/197" [19;20H[K[19;20H1L, 30C written"test49.in" [19;13H[K[19;13H13L, 320C
*** Test  57: OK (2147450880)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/198[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/198" [21;20H[K[21;20H87L, 1700C appended[21;20H[K[21;20H88L, 1722C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/199[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[21;80Hc[22;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/199"' -c 'break
[21;80Ha[22;1Hdd func 4 T' -S /tmp/v449856/198[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/199" [20;20H[K[21;2H[K[22;1H[K[20;20H8L, 36C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  58: OK (624945)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/200[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/200" [22;20H[K[22;20H293L, 5789C appended[22;20H[K[22;20H294L, 5811C
3 substitutions on 3 lines"/tmp/v449856/200"[22;20H[K[22;20H294L, 5808C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/201[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q[34m^M[mq[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo
[21;80H'[22;2H-c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/201"' -c 'br
[21;80He[22;1Hakadd file 115 /tmp/v449856/200' -c 'breakadd file 225 /tmp/v449856/200' -S /tm
[21;80Hp[22;1H/v449856/200[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[19;1H"/tmp/v449856/201"[19;20H[K[20;2H[K[21;1H[K[22;1H[K[19;20H28L, 162C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [19;13H[K[19;13H13L, 320C
*** Test  59: OK (2038431743)"/n/o/n/w/r/i/t/a/b/l/e/_/f/i/l/e""/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/202[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/202" [21;20H[K[21;20H33L, 765C appended[21;20H[K[21;20H34L, 787C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/203[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[21;80Hc[22;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/203"' -c 'break
[21;80Ha[22;1Hdd file 7 /tmp/v449856/202' -S /tmp/v449856/202[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/203" [20;20H[K[21;2H[K[22;1H[K[20;20H3L, 27C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  60: OK (311511339)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/204[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/204" [22;20H[K[22;20H115L, 2272C appended[22;20H[K[22;20H116L, 2294C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/205[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set vimin
[21;80Hf[22;1Ho+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/
[21;80H2[22;1H05"' -c 'breakadd file 8 /tmp/v449856/204' -c 'breakadd file 36 /tmp/v449856/20
[21;80H4[22;1H' -c 'breakadd file 40 /tmp/v449856/204' -c 'breakadd file 69 /tmp/v449856/204'
-c 'breakadd file 95 /tmp/v449856/204' -c 'breakadd file 97 /tmp/v449856/204' -
[21;80HS[22;2H/tmp/v449856/204[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[17;1H"/tmp/v449856/205" [17;20H[K[18;1H[K[19;1H[K[20;1H[K[21;1H[K[22;2H[K[17;20H14L, 81C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [17;13H[K[17;13H13L, 320C
*** Test  61: OK (374889517)
   function F()
1      while 1
2      " Missing :endwhile
   endfunction[19;1H"/tmp/v449856/206"[20;1H[K[21;1H[K[22;4H[K[19;20H[noeol] 5L, 73C
E486: Pattern not found: ^\s*$"/tmp/v449856/206" [20;20H[K[20;20H2L, 40C written"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  62: OK (286331153)"/i/m/p/o/s/s/i/b/l/e" [21;24H[K[22;1H[1m[37m[41mError detected while processing /sources/vim71/src/testdir/test49.vim:[m
[33mline 6342:[m
[1m[37m[41m"/i/m/p/o/s/s/i/b/l/e" E212: Can't open file for writing[m
*** Test  63: OK (236978127)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/207[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/207" [22;20H[K[22;20H149L, 2828C appended[22;20H[K[22;20H150L, 2850C
6 substitutions on 6 lines"/tmp/v449856/207"[22;20H[K[22;20H150L, 2844C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/208[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[21;80Hc[22;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/208"' -c 'break
[21;80Ha[22;1Hdd file 63 /tmp/v449856/207' -S /tmp/v449856/207[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/208" [20;20H[K[21;2H[K[22;1H[K[20;20H16L, 97C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  64: OK (1499645335)
*** Test  65: OK (70187)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/209[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/209" [22;20H[K[22;20H78L, 1520C appended[22;20H[K[22;20H79L, 1542C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/210[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[21;80Hc[22;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/210"' -c 'break
[21;80Ha[22;1Hdd func 8 F' -S /tmp/v449856/209[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/210" [20;20H[K[21;2H[K[22;1H[K[20;20H6L, 22C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  66: OK (5464)
*** Test  67: OK (212514423)
*** Test  68: OK (212514423)
*** Test  69: OK (8995471)
*** Test  70: OK (69544277)
*** Test  71: OK (34886997)
*** Test  72: OK (1789569365)
   function F0()
   endfunction
   function F1()
   endfunction
*** Test  73: OK (9032615)"/tmp/v449856/211" [New File]"test49.in" [22;13H[K[22;13H13L, 320C"/tmp/v449856/212" [New File]"test49.in" [22;13H[K[22;13H13L, 320C
*** Test  74: OK (224907669)
*** Test  75: OK (2000403408)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/213[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/213" [22;20H[K[22;20H253L, 6369C appended[22;20H[K[22;20H254L, 6391C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/214[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|
[21;80Hs[22;1Het viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp
[21;80H/[22;1Hv449856/214"' -c 'breakadd func 2 INT' -S /tmp/v449856/213[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/214" [20;20H[K[21;1H[K[22;1H[K[20;20H28L, 167C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  76: OK (1610087935)
[1m[37m[41mError detected while processing function ERR:[m
[33mline    2:[m
[1m[37m[41mE492: Not an editor command:     asdf[m
[1m[37m[41mE492: Not an editor command:     asdf[m
[1m[37m[41mE492: Not an editor command:     asdf[m
*** Test  77: OK (1388671)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/215[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/215" [22;20H[K[22;20H161L, 4543C appended[22;20H[K[22;20H162L, 4565C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/216[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[21;80Hl[22;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/216"' -S /tmp/v449
[21;80H8[22;1H56/215[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/216" [20;21H[K[21;1H[K[22;1H[K[20;20H1L, 10C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  78: OK (134217728)
[1m[37m[41mError detected while processing function NEXT:[m
[33mline    1:[m
[1m[37m[41mE121: Undefined variable: novar[m
[1m[37m[41mE15: Invalid expression: novar | Xloop 1[m
[1m[37m[41mE121: Undefined variable: novar[m
[1m[37m[41mE488: Trailing characters[m
[1m[37m[41mE108: No such variable: "novar"[m
[1m[37m[41mE488: Trailing characters[m
[1m[37m[41mE121: Undefined variable: novar[m
[1m[37m[41mE15: Invalid expression: novar[m
[1m[37m[41mE475: Invalid argument: {novar} | Xloop 1[m
[1m[37m[41mE121: Undefined variable: novar[m
[1m[37m[41mE15: Invalid expression:  novar[m
[1m[37m[41mE475: Invalid argument: { novar} | Xloop 1[m
*** Test  79: OK (70288929)
[1m[37m[41mError detected while processing /sources/vim71/src/testdir/test49.vim:[m
[33mline 8828:[m
[1m[37m[41mE584: :elseif after :else: elseif 1 ||| 2[m
[33mline 8838:[m
[1m[37m[41mE584: :elseif after :else: elseif 1 ||| 2[m
[33mline 8846:[m
[1m[37m[41mE582: :elseif without :if: elseif 1 ||| 2[m
[33mline 8854:[m
[1m[37m[41mE582: :elseif without :if:     elseif 1 ||| 2[m
*** Test  80: OK (17895765)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/217[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/217" [22;20H[K[22;20H15L, 272C appended[22;20H[K[22;20H16L, 294C[22;20H[K[22;20H16L, 293C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/218[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[21;80Hl[22;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/218"' -S /tmp/v449
[21;80H8[22;1H56/217[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/218" [20;21H[K[21;1H[K[22;1H[K[20;20H2L, 4C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/219[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/219" [21;20H[K[21;20H12L, 227C appended[21;20H[K[21;20H13L, 249C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/220[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[21;80Hc[22;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/220"' -c 'break
[21;80Ha[22;1Hdd file 8 /tmp/v449856/219' -S /tmp/v449856/219[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/220" [20;20H[K[21;2H[K[22;1H[K[20;20H2L, 8C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  81: OK (387)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/221[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/221" [22;20H[K[22;20H20L, 417C appended[22;20H[K[22;20H21L, 439C[22;20H[K[22;20H21L, 438C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/222[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[21;80Hl[22;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/222"' -S /tmp/v449
[21;80H8[22;1H56/221[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/222" [20;21H[K[21;1H[K[22;1H[K[20;20H1L, 2C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/223[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/223" [21;20H[K[21;20H24L, 480C appended[21;20H[K[21;20H25L, 502C[21;20H[K[21;20H25L, 501C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/224[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[21;80Hl[22;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/224"' -S /tmp/v449
[21;80H8[22;1H56/223[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/224" [20;21H[K[21;1H[K[22;1H[K[20;20H1L, 4C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/225[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/225" [21;20H[K[21;20H17L, 390C appended[21;20H[K[21;20H18L, 412C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/226[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[21;80Hc[22;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/226"' -c 'break
[21;80Ha[22;1Hdd file 7 /tmp/v449856/225' -S /tmp/v449856/225[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/226" [20;20H[K[21;2H[K[22;1H[K[20;20H1L, 6C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/227[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/227" [21;20H[K[21;20H21L, 444C appended[21;20H[K[21;20H22L, 466C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/228[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[21;80Hc[22;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/228"' -c 'break
[21;80Ha[22;1Hdd func 6 I' -S /tmp/v449856/227[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/228" [20;20H[K[21;2H[K[22;1H[K[20;20H1L, 8C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  82: OK (8454401)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/229[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/229" [22;20H[K[22;20H17L, 307C appended[22;20H[K[22;20H18L, 329C[22;20H[K[22;20H18L, 328C written"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/230[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[21;80Hl[22;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/230"' -S /tmp/v449
[21;80H8[22;1H56/229[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/230" [20;21H[K[21;1H[K[22;1H[K[20;20H3L, 7C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/231[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[21;1H[K[21;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/231" [21;20H[K[21;20H14L, 266C appended[21;20H[K[21;20H15L, 288C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/232[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[21;80Hc[22;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/232"' -c 'break
[21;80Ha[22;1Hdd file 8 /tmp/v449856/231' -S /tmp/v449856/231[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/232" [20;20H[K[21;2H[K[22;1H[K[20;20H3L, 13C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  83: OK (2835)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/233[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/233" [22;20H[K[22;20H154L, 3580C appended[22;20H[K[22;20H155L, 3602C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/234[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q[34m^M[mq[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo
[21;80H'[22;2H-c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/234"' -c 'br
[21;80He[22;1Hakadd func 1 INT' -S /tmp/v449856/233[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/234"[20;20H[K[21;2H[K[22;1H[K[20;20H18L, 118C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  84: OK (934782101)
TMP"/tmp/v449856/235" [noeol] 2L, 6C[22;1H[K[22;1H/  "test49.in" 13L, 320C"/n/o/n/e/x/i/s/t/e/n/t"
"/tmp/v449856/237" 1L, 1C"test49.in" [22;13H[K[22;13H13L, 320C
:!echo XYZ >/tmp/v449856/238[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H"/tmp/v449856/239" [New File]"test49.in" [22;13H[K[22;13H13L, 320C
*** Test  85: OK (198689)"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v449856/3' >/tmp/v449856/240[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v449856/240" [22;20H[K[22;20H151L, 3929C appended[22;20H[K[22;20H152L, 3951C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v449856/241[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[22;1H
[?25l:!echo 'q[34m^M[mq[34m^M[mq[34m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nvimi
[21;80Hn[22;1Hfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v449856/241"' -c
[21;80H'[22;1Hbreakadd func 5 ThrowOnInterrupt' -S /tmp/v449856/240[?1l>[?12l[?25h[?1049l

shell returned 1

Press ENTER or type command to continue[?1049h[?1h=[?25l[20;1H"/tmp/v449856/241" [20;21H[K[21;1H[K[22;1H[K[20;20H16L, 281C"/sources/vim71/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [20;13H[K[20;13H13L, 320C
*** Test  86: OK (50443995)
[32mPress ENTER or type command to continue[27m[m[H[2J[1;1HThis is a test of the script language.

If after adding a new test, the test output doesn't appear properly in
test49.failed, try to add one ore more "G"s at the line before ENDTEST.

STARTTEST
:so small.vim
:se nocp nomore viminfo+=nviminfo
:so test49.vim
GGGGGGGGGG"rp:.-,$wq! test.out
ENDTEST

Results of test49.vim:
[1m[34m~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [12;1H[?12l[?25h
[?25l[m[22;1H91 more lines[14;1H*** Test   1: OK (34695)[14;25H[K[15;1H*** Test   2: OK (34695)[15;25H[K[16;1H*** Test   3: OK (1384648195)[16;30H[K[17;1H*** Test   4: OK (32883)[17;25H[K[18;1H*** Test   5: OK (32883)[18;25H[K[19;1H*** Test   6: OK (603978947)[19;29H[K[20;1H*** Test   7: OK (90563)[20;25H[K[21;1H*** Test   8: OK (562493431)[21;29H[K[14;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.-,$wq! test.out[?25l"test.out" [22;12H[K[22;12H[New] 92L, 2672C written[?1l>[?12l[?25h[?1049l
rm -rf X* test.ok viminfo
rm -rf test51.failed test.ok test.out X* viminfo
cp test51.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test51.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test51.in" 36 lines, 808 characters[1;1HTests for ":highlight". vim: set ft=vim :

STARTTEST
:so small.vim
:" basic test if ":highlight" doesn't crash
:highlight
:hi Search
:" test setting colors.
:" test clearing one color and all doesn't generate error or warning
:hi NewGroup term=bold cterm=italic ctermfg=DarkBlue ctermbg=Grey gui= guifg=#000[11;1Hff00 guibg=Cyan
:hi Group2 term= cterm=
:hi Group3 term=underline cterm=bold
:redir! >test.out
:hi NewGroup
:hi Group2
:hi Group3
:hi clear NewGroup
:hi NewGroup
:hi Group2
:hi Group2 NONE[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for ":highlight". vim: set ft=vim :[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 31 lines, 746 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[1;21r[1;1H[15M[1;22r[7;1H:hi Group2
:hi clear
:hi Group3
:hi Crash term='asdf
:redir END
:" filter ctermfg and ctermbg, the numbers depend on the terminal
:e test.out
:%s/ctermfg=\d*/ctermfg=2/
:%s/ctermbg=\d*/ctermbg=3/
:" filter out possibly translated error message
:%s/E475: [^:]*:/E475:/
:" fix the fileformat
:set ff&
:wq!
ENDTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" basic test if ":highlight" doesn't crash[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hhighlight[?25l
SpecialKey     [34mxxx[m [34mterm=[mbold [34mctermfg=[m4
NonText[8C[1m[34mxxx[m [34mterm=[mbold [34mcterm=[mbold [34mctermfg=[m4
Directory      [34mxxx[m [34mterm=[mbold [34mctermfg=[m4
ErrorMsg[7C[1m[37m[41mxxx[m [34mterm=[mstandout [34mcterm=[mbold [34mctermfg=[m7 [34mctermbg=[m1
IncSearch      [7mxxx[m [34mterm=[mreverse [34mcterm=[mreverse
Search[9C[30m[43mxxx[m [34mterm=[mreverse [34mctermfg=[m0 [34mctermbg=[m3
MoreMsg[8C[32mxxx[m [34mterm=[mbold [34mctermfg=[m2
ModeMsg[8C[1mxxx[m [34mterm=[mbold [34mcterm=[mbold
LineNr[9C[33mxxx[m [34mterm=[munderline [34mctermfg=[m3
Question[7C[32mxxx[m [34mterm=[mstandout [34mctermfg=[m2
StatusLine     [1m[7mxxx[m [34mterm=[mbold,reverse [34mcterm=[mbold,reverse
StatusLineNC   [7mxxx[m [34mterm=[mreverse [34mcterm=[mreverse
VertSplit      [7mxxx[m [34mterm=[mreverse [34mcterm=[mreverse
Title[10C[35mxxx[m [34mterm=[mbold [34mctermfg=[m5
Visual[9C[7mxxx[m [34mterm=[mreverse [34mcterm=[mreverse
VisualNOS      xxx cleared
WarningMsg     [31mxxx[m [34mterm=[mstandout [34mctermfg=[m1
WildMenu[7C[30m[43mxxx[m [34mterm=[mstandout [34mctermfg=[m0 [34mctermbg=[m3
Folded[9C[34m[47mxxx[m [34mterm=[mstandout [34mctermfg=[m4 [34mctermbg=[m7
FoldColumn     [34m[47mxxx[m [34mterm=[mstandout [34mctermfg=[m4 [34mctermbg=[m7
DiffAdd[8C[44mxxx[m [34mterm=[mbold [34mctermbg=[m4
DiffChange     [45mxxx[m [34mterm=[mbold [34mctermbg=[m5
DiffDelete     [1m[34m[46mxxx[m [34mterm=[mbold [34mcterm=[mbold [34mctermfg=[m4 [34mctermbg=[m6
DiffText[7C[1m[41mxxx[m [34mterm=[mreverse [34mcterm=[mbold [34mctermbg=[m1
SignColumn     xxx cleared
SpellBad[7C[41mxxx[m [34mterm=[mreverse [34mctermbg=[m1
SpellCap[7C[44mxxx[m [34mterm=[mreverse [34mctermbg=[m4
SpellRare      [45mxxx[m [34mterm=[mreverse [34mctermbg=[m5
SpellLocal     [46mxxx[m [34mterm=[munderline [34mctermbg=[m6
Pmenu[10C[45mxxx[m [34mctermbg=[m5
PmenuSel[7C[47mxxx[m [34mctermbg=[m7
PmenuSbar      [47mxxx[m [34mctermbg=[m7
PmenuThumb     [7mxxx[m [34mcterm=[mreverse
TabLine[8C[4m[30m[47mxxx[m [34mterm=[munderline [34mcterm=[munderline [34mctermfg=[m0 [34mctermbg=[m7
TabLineSel     [1mxxx[m [34mterm=[mbold [34mcterm=[mbold
TabLineFill    [7mxxx[m [34mterm=[mreverse [34mcterm=[mreverse
CursorColumn   [47mxxx[m [34mterm=[mreverse [34mctermbg=[m7
CursorLine     [4mxxx[m [34mterm=[munderline [34mcterm=[munderline
MatchParen     [46mxxx[m [34mterm=[mreverse [34mctermbg=[m6
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hhi Search[?25l
Search[9C[30m[43mxxx[m [34mterm=[mreverse [34mctermfg=[m0 [34mctermbg=[m3
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25h" test setting colors.[?25l[27m[m[H[2J[1;1H:hi Group3
:hi clear NewGroup
:hi NewGroup
:hi Group2
:hi Group2 NONE
:hi Group2
:hi clear
:hi Group3
:hi Crash term='asdf
:redir END
:" filter ctermfg and ctermbg, the numbers depend on the terminal
:e test.out
:%s/ctermfg=\d*/ctermfg=2/
:%s/ctermbg=\d*/ctermbg=3/
:" filter out possibly translated error message
:%s/E475: [^:]*:/E475:/
:" fix the fileformat
:set ff&
:wq!
ENDTEST
[?12l[?25h[?25l
:[?12l[?25h" test clearing one color and all doesn't generate error or warning[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hhi NewGroup term=bold cterm=italic ctermfg=DarkBlue ctermbg=Grey gui= guifg=#0
[21;80H0[22;1Hff00 guibg=Cyan[?25l[21;1H[1m[37m[41mE418: Illegal value: guifg=#00ff00[m[21;35H[K[22;1H[K[22;1H[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hhi Group2 term= cterm=[?25l[1m[37m[41mE418: Illegal value: cterm=[m
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hhi Group3 term=underline cterm=bold[?25l[1;1H[2L[1;1H:hi Group3
:hi clear NewGroup[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25hredir! >test.out[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hhi NewGroup[?25l
NewGroup[7C[7m[34m[47mxxx[m [34mterm=[mbold [34mcterm=[mitalic [34mctermfg=[m4 [34mctermbg=[m7
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hhi Group2[?25l
Group2[9Cxxx cleared
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hhi Group3[?25l
Group3[9C[1mxxx[m [34mterm=[munderline [34mcterm=[mbold
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hhi clear NewGroup[?25l[1;1H[6L[1;1H:hi Group3
:hi clear NewGroup
:hi NewGroup
:hi Group2
:hi Group2 NONE
:hi Group2[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25hhi NewGroup[?25l
NewGroup[7Cxxx cleared
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hhi Group2[?25l
Group2[9Cxxx cleared
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hhi Group2 NONE[?25l[1;1H[4L[1;1H:hi Group3
:hi clear NewGroup
:hi NewGroup
:hi Group2[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25hhi Group2[?25l
Group2[9Cxxx cleared
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hhi clear[?25l[27m[m[H[2J[1;1H:hi Group3
:hi clear NewGroup
:hi NewGroup
:hi Group2
:hi Group2 NONE
:hi Group2
:hi clear
:hi Group3
:hi Crash term='asdf
:redir END
:" filter ctermfg and ctermbg, the numbers depend on the terminal
:e test.out
:%s/ctermfg=\d*/ctermfg=2/
:%s/ctermbg=\d*/ctermbg=3/
:" filter out possibly translated error message
:%s/E475: [^:]*:/E475:/
:" fix the fileformat
:set ff&
:wq!
ENDTEST
[?12l[?25h[?25l
:[?12l[?25hhi Group3[?25l
Group3[9Cxxx cleared
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hhi Crash term='asdf[?25l[1m[37m[41mE475: Invalid argument: term='asdf[m
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hredir END[?25l[1;1H[3L[1;1H:hi Group3
:hi clear NewGroup
:hi NewGroup[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h" filter ctermfg and ctermbg, the numbers depend on the terminal[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he test.out[?25l"test.out" 20 lines, 289 characters[1;1H[K[2;1H[K[3;1HNewGroup       xxx term=bold cterm=italic ctermfg=4 ctermbg=7[4;1H[K[5;1HGroup2         xxx cleared[6;1H[K[7;1HGroup3         xxx term=underline cterm=bold[8;1H[K[9;1H[K[10;1HNewGroup       xxx cleared[11;1H[K[12;1HGroup2         xxx cleared[13;1H[K[14;1H[K[15;1HGroup2         xxx cleared[15;27H[K[16;1H[K[17;1H[K[18;1HGroup3  [7Cxxx cleared[19;1H[K[20;2H475: Invalid argument: term='asdf
[1m[34m~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25h%s/ctermfg=\d*/ctermfg=2/[?25l[3;51H2[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h%s/ctermbg=\d*/ctermbg=3/[?25l[3;61H3[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" filter out possibly translated error message[?25l[3;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h%s/E475: [^:]*:/E475:/[?25l[20;7Hterm='asdf[20;17H[K[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" fix the fileformat[?25l[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset ff&[?25l[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hwq![?25l"test.out" 20 lines, 271 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test52.failed test.ok test.out X* viminfo
cp test52.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test52.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test52.in" 65 lines, 1645 characters[1;1HTests for reading and writing files with conversion for Win32.

STARTTEST
:so mbyte.vim
:" make this a dummy test for non-Win32 systems
:if !has("win32") | e! test.ok | wq! test.out | endif
:"
:" write tests:
:" combine three values for 'encoding' with three values for 'fileencoding'
:" also write files for read tests
/^1
:set encoding=utf-8
:.w! ++enc=utf-8 test.out
:.w ++enc=cp1251 >>test.out
:.w ++enc=cp866 >>test.out
:.w! ++enc=utf-8 Xutf8
/^2
:set encoding=cp1251
:.w ++enc=utf-8 >>test.out
:.w ++enc=cp1251 >>test.out
:.w ++enc=cp866 >>test.out[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for reading and writing files with conversion for Win32.[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 57 lines, 1333 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[27m[m[H[2J[1;1H:set fencs=utf-8,cp866
:e Xcp866
:.w ++enc=cp1251 >>test.out
:"
:" read three 'fileencoding's with cp866 'encoding'
:set encoding=cp866 fencs=utf-8,cp1251
:e Xutf8
:.w ++enc=cp866 >>test.out
:e Xcp1251
:.w ++enc=cp866 >>test.out
:set fencs=utf-8,cp866
:e Xcp866
:.w ++enc=cp866 >>test.out
:"
:qa!
ENDTEST

1 utf-8 text: [34m~T[mл[34m~O[m Vim version 6.2.  [34m~_[mо[34m~A[mледнее изменение[19;1H: 1970 Jan 01
2 cp1251 text:  Vim version 6.2.   : 1970 Jan 01
3 cp866 text: [34m~D[m Vim version 6.2.  [34m~O[m᫥ : 1970 Jan 01[16;1H[?12l[?25h
[?25l[22;1H:so! Xdotest[17;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso mbyte.vim[?25l[17;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" make this a dummy test for non-Win32 systems[?25l[17;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hif !has("win32") | e! test.ok | wq! test.out | endif[?25l"test.ok" [22;11H[K[22;11H18 lines, 1374 characters
"test.out" [New File] 18 lines, 1374 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test53.failed test.ok test.out X* viminfo
cp test53.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test53.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test53.in" 48 lines, 952 characters[1;1HTests for string and html text objects. vim: set ft=vim :

Note that the end-of-line moves the cursor to the next test line.

Also test match() and matchstr()

STARTTEST
:so small.vim
/^start:/
da"
0va'a'rx
02f`da`
0fXdi"
03f'vi'ry
:set quoteescape=+*-
di`
$F"va"oha"i"rz
:"
/^<begin
jfXdit
0fXdit[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for string and html text objects. vim: set ft=vim :[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[7;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[8;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 24 lines, 461 characters written[8;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[8;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[1;21r[1;1H[11M[1;22r[11;1HfXdat
0fXdat
:"
:put =matchstr(\"abcd\", \".\", 0, 2) " b
:put =matchstr(\"abcd\", \"..\", 0, 2) " bc
:put =matchstr(\"abcd\", \".\", 2, 0) " c (zero and negative -> first match)
:put =matchstr(\"abcd\", \".\", 0, -1) " a
:put =match(\"abcd\", \".\", 0, 5) " -1
:put =match(\"abcd\", \".\", 0, -1) " 0
:/^start:/,/^end:/wq! test.out
ENDTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h^start:/[?25l[22;9H[K[22;1H[1;21r[21;1H
[1;22r[21;1Hstart: "wo\"rd\\" foo[22;1H[K[21;1H[?12l[?25h[?25l[7Cfo[21;11H[K[21;8H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H'foo' 'bar' 'piep'[21;8H[?12l[?25h[?25l[?12l[?25h[?25l[7m'foo'[?12l[?25h[?25l 'bar'[?12l[?25h[?25l[mxxxxxxxxxxxx[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hbla bla `quote` blah[?12l[?25h[14C[?25lblah[21;13H[K[21;9H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hout " in "noXno"[21;9H[?12l[?25h[12C[?25l"[21;12H[K[21;11H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H"'" 'blah' rep 'buh'[21;11H[?12l[?25h[9C[?25l[?12l[?25h[?25l'[7m rep[?12l[?25h[?25l[myyyyy[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hbla `s*`d-`+++`l**` b`la[21;11H[?12l[?25h[?25l
:[?12l[?25hset quoteescape=+*-[?25l[21;11H[?12l[?25h[?25l` b`la[21;12H[K[21;6H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hvoo "nah" sdf " asdf" sdf " sdf" sd[22;1H[K[21;6H[?12l[?25h[29C[?25l[?12l[?25h[?25l[7m" sdf"[?12l[?25h[?25l[m"[5C[7m [21;27H[?12l[?25h[?25l"[?12l[?25h[?25l[21;16H asdf" sdf [21;15H[?12l[?25h[?25l[21;7Hah" sdf "[mvoo "[?12l[?25h[?25lzzzzzzzzzzzzzzzzzzzzzzzzzzzzvoo "[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H[?12l[?25h[?25l
:[?12l[?25h"[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h^<begin[?25l[1;21r[21;1H
[1;22r[21;1H<begin>[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H-<b>asdf<i>Xasdf</i>asdf</b>-[?12l[?25h[11C[?25l</i>asdf</b>-[21;25H[K[21;12H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H-<b>asdX<i>a<i />sdf</i>asdf</b>-[21;12H[?12l[?25h[7C[?25l</b>-[21;10H[K[21;5H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H-<b>asdf<i>Xasdf</i>asdf</b>--<b>[?12l[?25h[7C[?25lasdf</b>-[21;18H[K[21;9H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H-<b>asdX<i>as<b />df</i>asdf</b>-[21;9H[?12l[?25h[7C[?25l--[21;3H[K[21;2H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H</begin><[?12l[?25h[?25l
:[?12l[?25h"[?25l[21;2H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hput =matchstr(\"abcd\", \".\", 0, 2) " b[?25l[1;21r[21;1H
[1;22r[21;1Hb[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25hput =matchstr(\"abcd\", \"..\", 0, 2) " bc[?25l[1;21r[21;1H
[1;22r[21;1Hbc[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25hput =matchstr(\"abcd\", \".\", 2, 0) " c (zero and negative -> first match)[?25l[1;21r[21;1H
[1;22r[21;1Hc[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25hput =matchstr(\"abcd\", \".\", 0, -1) " a[?25l[1;21r[21;1H
[1;22r[21;1Ha[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25hput =match(\"abcd\", \".\", 0, 5) " -1[?25l[1;21r[21;1H
[1;22r[21;1H-1[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25hput =match(\"abcd\", \".\", 0, -1) " 0[?25l[1;21r[21;1H
[1;22r[21;1H0[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h/^start:/,/^end:/wq! test.out[?25l[31msearch hit BOTTOM, continuing at TOP[m"test.out" [22;12H[K[22;12H[New File] 21 lines, 217 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test54.failed test.ok test.out X* viminfo
cp test54.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test54.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test54.in" 17 lines, 527 characters[1;1HSome tests for buffer-local autocommands

STARTTEST
:so small.vim
:e xx
:!rm -f test.out
:au BufLeave <buffer> :!echo buffer-local autommand in %>> test.out
:e somefile[11C" here, autocommand for xx shall write test.out
:[21C" but autocommand shall not apply to buffer named <buffer>[10;1H:bwipe xx[13C" here, autocommand shall be auto-deleted
:e xx[17C" nothing shall be written
:e somefile[11C" nothing shall be written
:qa!
ENDTEST

start of test file xx
end of test file xx
[1m[34m~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HSome tests for buffer-local autocommands[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 10 lines, 424 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[14;1H[?12l[?25h
[?25l[22;1H[K[22;1H:so! Xdotest[15;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[15;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he xx[?25l"xx" [New File][1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [1;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25h!rm -f test.out[?25l[16C[?1l>[?12l[?25h[?1049l

Press ENTER or type command to continue[?1049h[?1h=[?25l[22;1H[K[22;1H:[?12l[?25hau BufLeave <buffer> :!echo buffer-local autommand in %>> test.out[?25l[27m[m[H[2J[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[22;1H[m:[?12l[?25he somefile           " here, autocommand for xx shall write test.out [?25l:!echo buffer-local autommand in xx>> test.out[22;47H[K[22;47H
[?12l[?25h[?25l[m"somefile" [New File]
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25h                     " but autocommand shall not apply to buffer named <buffer
[21;80H>[22;1H[?25l[27m[m[H[2J[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?12l[?25h[?25l[22;1H[m:[?12l[?25hbwipe xx             " here, autocommand shall be auto-deleted[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he xx                 " nothing shall be written[?25l"xx" [New File][22;23H[K[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25he somefile           " nothing shall be written[?25l"somefile" [New File][22;23H[K[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[?1l>[?12l[?25h[?1049l
rm -rf X* test.ok viminfo
rm -rf test55.failed test.ok test.out X* viminfo
cp test55.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test55.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test55.in" 351 lines, 7196 characters[1;1HTests for List and Dictionary types.     vim: set ft=vim :

STARTTEST
:so small.vim
:fun Test(...)
:" Creating List directly with different types
:let l = [1, 'as''d', [1, 2, function("strlen")], {'a': 1},]
:$put =string(l)
:$put =string(l[-1])
:$put =string(l[-4])
:try
:  $put =string(l[-5])
:catch
:  $put =v:exception[:14]
:endtry
:" List slices
:$put =string(l[:])
:$put =string(l[1:])
:$put =string(l[:-2])
:$put =string(l[0:8])
:$put =string(l[8:-1])[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for List and Dictionary types.     vim: set ft=vim :[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 345 lines, 7110 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[27m[m[H[2J[1;1H:$put =string(split(':aa::bb:', ':', 0))
:$put =string(split(':aa::bb:', ':', 1))
:$put =string(split('aa,,bb, cc,', ',\s*', 1))
:$put =string(split('abc', '\zs'))
:$put =string(split('abc', '\zs', 1))
:"
:" compare recursively linked list and dict
:let l = [1, 2, 3, 4]
:let d = {'1': 1, '2': l, '3': 3}
:let l[1] = d
:$put =(l == l)
:$put =(d == d)
:$put =(l != deepcopy(l))
:$put =(d != deepcopy(d))
:endfun
:call Test(1, 2, [3, 4], {5: 6})  " This may take a while
:"
:/^start:/,$wq! test.out
ENDTEST

start:[19;1H[?12l[?25h
[?25l

:so! Xdotest[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[20;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hfun Test(...)[?25l
:  [?12l[?25h:" Creating List directly with different types
[?25l:  [?12l[?25h:let l = [1, 'as''d', [1, 2, function("strlen")], {'a': 1},]
[?25l:  [?12l[?25h:$put =string(l)
[?25l:  [?12l[?25h:$put =string(l[-1])
[?25l:  [?12l[?25h:$put =string(l[-4])
[?25l:  [?12l[?25h:try
[?25l:    [?12l[?25h:  $put =string(l[-5])
[?25l:    [?12l[?25h:catch
[?25l:    [?12l[?25h:  $put =v:exception[:14]
[?25l:    [?12l[?25h:endtry
[?25l:  [?12l[?25h:" List slices
[?25l:  [?12l[?25h:$put =string(l[:])
[?25l:  [?12l[?25h:$put =string(l[1:])
[?25l:  [?12l[?25h:$put =string(l[:-2])
[?25l:  [?12l[?25h:$put =string(l[0:8])
[?25l:  [?12l[?25h:$put =string(l[8:-1])
[?25l:  [?12l[?25h:"
[?25l:  [?12l[?25h:" List identity
[?25l:  [?12l[?25h:let ll = l
[?25l:  [?12l[?25h:let lx = copy(l)
[?25l:  [?12l[?25h:try
[?25l:    [?12l[?25h:  $put =(l == ll) . (l isnot ll) . (l is ll) . (l == lx) . (l is lx) . (l
isnot lx)
[?25l:    [?12l[?25h:catch
[?25l:    [?12l[?25h:  $put =v:exception
[?25l:    [?12l[?25h:endtry
[?25l:  [?12l[?25h:"
[?25l:  [?12l[?25h:" Creating Dictionary directly with different types
[?25l:  [?12l[?25h:let d = {001: 'asd', 'b': [1, 2, function('strlen')], -1: {'a': 1},}
[?25l:  [?12l[?25h:$put =string(d) . d.1
[?25l:  [?12l[?25h:$put =string(sort(keys(d)))
[?25l:  [?12l[?25h:$put =string (values(d))
[?25l:  [?12l[?25h:for [key, val] in items(d)
[?25l:    [?12l[?25h:  $put =key . ':' . string(val)
[?25l:    [?12l[?25h:  unlet key val
[?25l:    [?12l[?25h:endfor
[?25l:  [?12l[?25h:call extend  (d, {3:33, 1:99})
[?25l:  [?12l[?25h:call extend(d, {'b':'bbb', 'c':'ccc'}, "keep")
[?25l:  [?12l[?25h:try
[?25l:    [?12l[?25h:  call extend(d, {3:333,4:444}, "error")
[?25l:    [?12l[?25h:catch
[?25l:    [?12l[?25h:  $put =v:exception[:15] . v:exception[-1:-1]
[?25l:    [?12l[?25h:endtry
[?25l:  [?12l[?25h:$put =string(d)
[?25l:  [?12l[?25h:call filter(d, 'v:key =~ ''[ac391]''')
[?25l:  [?12l[?25h:$put =string(d)
[?25l:  [?12l[?25h:"
[?25l:  [?12l[?25h:" Dictionary identity
[?25l:  [?12l[?25h:let dd = d
[?25l:  [?12l[?25h:let dx = copy(d)
[?25l:  [?12l[?25h:try
[?25l:    [?12l[?25h:  $put =(d == dd) . (d isnot dd) . (d is dd) . (d == dx) . (d is dx) . (d
isnot dx)
[?25l:    [?12l[?25h:catch
[?25l:    [?12l[?25h:  $put =v:exception
[?25l:    [?12l[?25h:endtry
[?25l:  [?12l[?25h:"
[?25l:  [?12l[?25h:" Changing var type should fail
[?25l:  [?12l[?25h:try
[?25l:    [?12l[?25h:  let d = []
[?25l:    [?12l[?25h:catch
[?25l:    [?12l[?25h:  $put =v:exception[:14] . v:exception[-1:-1]
[?25l:    [?12l[?25h:endtry
[?25l:  [?12l[?25h:try
[?25l:    [?12l[?25h:  let l = {}
[?25l:    [?12l[?25h:catch
[?25l:    [?12l[?25h:  $put =v:exception[:14] . v:exception[-1:-1]
[?25l:    [?12l[?25h:endtry
[?25l:  [?12l[?25h:"
[?25l:  [?12l[?25h:" removing items with :unlet
[?25l:  [?12l[?25h:unlet l[2]
[?25l:  [?12l[?25h:$put =string(l)
[?25l:  [?12l[?25h:let l = range(8)
[?25l:  [?12l[?25h:try
[?25l:    [?12l[?25h:unlet l[:3]
[?25l:    [?12l[?25h:unlet l[1:]
[?25l:    [?12l[?25h:catch
[?25l:    [?12l[?25h:$put =v:exception
[?25l:    [?12l[?25h:endtry
[?25l:  [?12l[?25h:$put =string(l)
[?25l:  [?12l[?25h:"
[?25l:  [?12l[?25h:unlet d.c
[?25l:  [?12l[?25h:unlet d[-1]
[?25l:  [?12l[?25h:$put =string(d)
[?25l:  [?12l[?25h:"
[?25l:  [?12l[?25h:" removing items out of range: silently skip items that don't exist
[?25l:  [?12l[?25hlet l = [0, 1, 2, 3]
[?25l:  [?12l[?25h:unlet l[2:1]
[?25l:  [?12l[?25h:$put =string(l)
[?25l:  [?12l[?25hlet l = [0, 1, 2, 3]
[?25l:  [?12l[?25h:unlet l[2:2]
[?25l:  [?12l[?25h:$put =string(l)
[?25l:  [?12l[?25hlet l = [0, 1, 2, 3]
[?25l:  [?12l[?25h:unlet l[2:3]
[?25l:  [?12l[?25h:$put =string(l)
[?25l:  [?12l[?25hlet l = [0, 1, 2, 3]
[?25l:  [?12l[?25h:unlet l[2:4]
[?25l:  [?12l[?25h:$put =string(l)
[?25l:  [?12l[?25hlet l = [0, 1, 2, 3]
[?25l:  [?12l[?25h:unlet l[2:5]
[?25l:  [?12l[?25h:$put =string(l)
[?25l:  [?12l[?25hlet l = [0, 1, 2, 3]
[?25l:  [?12l[?25h:unlet l[-1:2]
[?25l:  [?12l[?25h:$put =string(l)
[?25l:  [?12l[?25hlet l = [0, 1, 2, 3]
[?25l:  [?12l[?25h:unlet l[-2:2]
[?25l:  [?12l[?25h:$put =string(l)
[?25l:  [?12l[?25hlet l = [0, 1, 2, 3]
[?25l:  [?12l[?25h:unlet l[-3:2]
[?25l:  [?12l[?25h:$put =string(l)
[?25l:  [?12l[?25hlet l = [0, 1, 2, 3]
[?25l:  [?12l[?25h:unlet l[-4:2]
[?25l:  [?12l[?25h:$put =string(l)
[?25l:  [?12l[?25hlet l = [0, 1, 2, 3]
[?25l:  [?12l[?25h:unlet l[-5:2]
[?25l:  [?12l[?25h:$put =string(l)
[?25l:  [?12l[?25hlet l = [0, 1, 2, 3]
[?25l:  [?12l[?25h:unlet l[-6:2]
[?25l:  [?12l[?25h:$put =string(l)
[?25l:  [?12l[?25h:"
[?25l:  [?12l[?25h:" assignment to a list
[?25l:  [?12l[?25h:let l = [0, 1, 2, 3]
[?25l:  [?12l[?25h:let [va, vb] = l[2:3]
[?25l:  [?12l[?25h:$put =va
[?25l:  [?12l[?25h:$put =vb
[?25l:  [?12l[?25h:try
[?25l:    [?12l[?25h:  let [va, vb] = l
[?25l:    [?12l[?25h:catch
[?25l:    [?12l[?25h:  $put =v:exception[:14]
[?25l:    [?12l[?25h:endtry
[?25l:  [?12l[?25h:try
[?25l:    [?12l[?25h:  let [va, vb] = l[1:1]
[?25l:    [?12l[?25h:catch
[?25l:    [?12l[?25h:  $put =v:exception[:14]
[?25l:    [?12l[?25h:endtry
[?25l:  [?12l[?25h:"
[?25l:  [?12l[?25h:" manipulating a big Dictionary (hashtable.c has a border of 1000 entries)
[?25l:  [?12l[?25h:let d = {}
[?25l:  [?12l[?25h:for i in range(1500)
[?25l:    [?12l[?25h: let d[i] = 3000 - i
[?25l:    [?12l[?25h:endfor
[?25l:  [?12l[?25h:$put =d[0] . ' ' . d[100] . ' ' . d[999] . ' ' . d[1400] . ' ' . d[1499]
[?25l:  [?12l[?25h:try
[?25l:    [?12l[?25h:  let n = d[1500]
[?25l:    [?12l[?25h:catch
[?25l:    [?12l[?25h:  $put =v:exception[:14] . v:exception[-4:-1]
[?25l:    [?12l[?25h:endtry
[?25l:  [?12l[?25h:" lookup each items
[?25l:  [?12l[?25h:for i in range(1500)
[?25l:    [?12l[?25h: if d[i] != 3000 - i
[?25l:      [?12l[?25h:  $put =d[i]
[?25l:      [?12l[?25h: endif
[?25l:    [?12l[?25h:endfor
[?25l:  [?12l[?25h: let i += 1
[?25l:  [?12l[?25h:" delete even items
[?25l:  [?12l[?25h:while i >= 2
[?25l:    [?12l[?25h: let i -= 2
[?25l:    [?12l[?25h: unlet d[i]
[?25l:    [?12l[?25h:endwhile
[?25l:  [?12l[?25h:$put =get(d, 1500 - 100, 'NONE') . ' ' . d[1]
[?25l:  [?12l[?25h:" delete odd items, checking value, one intentionally wrong
[?25l:  [?12l[?25h:let d[33] = 999
[?25l:  [?12l[?25h:let i = 1
[?25l:  [?12l[?25h:while i < 1500
[?25l:    [?12l[?25h: if d[i] != 3000 - i
[?25l:      [?12l[?25h:  $put =i . '=' . d[i]
[?25l:      [?12l[?25h: else
[?25l:      [?12l[?25h:  unlet d[i]
[?25l:      [?12l[?25h: endif
[?25l:    [?12l[?25h: let i += 2
[?25l:    [?12l[?25h:endwhile
[?25l:  [?12l[?25h:$put =string(d)  " must be almost empty now
[?25l:  [?12l[?25h:unlet d
[?25l:  [?12l[?25h:"
[?25l:  [?12l[?25h:" Dictionary function
[?25l:  [?12l[?25h:let dict = {}
[?25l:  [?12l[?25h:func dict.func(a) dict
[?25l:    [?12l[?25h:  $put =a:a . len(self.data)
[?25l:    [?12l[?25h:endfunc
[?25l:    [?12l[?25h:let dict.data = [1,2,3]
[?25l:    [?12l[?25h:call dict.func("len: ")
[?25l:    [?12l[?25h:let x = dict.func("again: ")
[?25l:    [?12l[?25h:try
[?25l:      [?12l[?25h:  let Fn = dict.func
[?25l:      [?12l[?25h:  call Fn('xxx')
[?25l:      [?12l[?25h:catch
[?25l:      [?12l[?25h:  $put =v:exception[:15]
[?25l:      [?12l[?25h:endtry
[?25l:    [?12l[?25h:" 
[?25l:    [?12l[?25h:" Function in script-local List or Dict
[?25l:    [?12l[?25h:let g:dict = {}
[?25l:    [?12l[?25h:function g:dict.func() dict
[?25l:      [?12l[?25h:  $put ='g:dict.func'.self.foo[1].self.foo[0]('asdf')
[?25l:      [?12l[?25h:endfunc
[?25l:      [?12l[?25h:let g:dict.foo = ['-', 2, 3]
[?25l:      [?12l[?25h:call insert(g:dict.foo, function('strlen'))
[?25l:      [?12l[?25h:call g:dict.func()
[?25l:      [?12l[?25h:" 
[?25l:      [?12l[?25h:" Nasty: remove func from Dict that's being called (works)
[?25l:      [?12l[?25h:let d = {1:1}
[?25l:      [?12l[?25h:func d.func(a)
[?25l:[8C[?12l[?25h:  return "a:". a:a
[?25l:[8C[?12l[?25h:endfunc
[?25l:[8C[?12l[?25h:$put =d.func(string(remove(d, 'func')))
[?25l:[8C[?12l[?25h:"
[?25l:[8C[?12l[?25h:" Nasty: deepcopy() dict that refers to itself (fails when noref used
[21;80H)[22;1H
[?25l:[8C[?12l[?25h:let d = {1:1, 2:2}
[?25l:[8C[?12l[?25h:let l = [4, d, 6]
[?25l:[8C[?12l[?25h:let d[3] = l
[?25l:[8C[?12l[?25h:let dc = deepcopy(d)
[?25l:[8C[?12l[?25h:try
[?25l:[10C[?12l[?25h:  let dc = deepcopy(d, 1)
[?25l:[10C[?12l[?25h:catch
[?25l:[10C[?12l[?25h:  $put =v:exception[:14]
[?25l:[10C[?12l[?25h:endtry
[?25l:[8C[?12l[?25h:let l2 = [0, l, l, 3]
[?25l:[8C[?12l[?25h:let l[1] = l2
[?25l:[8C[?12l[?25h:let l3 = deepcopy(l2)
[?25l:[8C[?12l[?25h:$put ='same list: ' . (l3[1] is l3[2])
[?25l:[8C[?12l[?25h:"
[?25l:[8C[?12l[?25h:" Locked variables
[?25l:[8C[?12l[?25h:for depth in range(5)
[?25l:[10C[?12l[?25h:  $put ='depth is ' . depth
[?25l:[10C[?12l[?25h:  for u in range(3)
[?25l:[12C[?12l[?25h:    unlet l
[?25l:[12C[?12l[?25h:    let l = [0, [1, [2, 3]], {4: 5, 6: {7: 8}}]
[?25l:[12C[?12l[?25h:    exe "lockvar " . depth . " l"
[?25l:[12C[?12l[?25h:    if u == 1
[?25l:[14C[?12l[?25h:      exe "unlockvar l"
[?25l:[14C[?12l[?25h:    elseif u == 2
[?25l:[14C[?12l[?25h:      exe "unlockvar " . depth . " l"
[?25l:[14C[?12l[?25h:    endif
[?25l:[12C[?12l[?25h:    let ps = islocked("l").islocked("l[1]").islocked("l[1][1]").i
[21;80Hs[22;1Hlocked("l[1][1][0]").'-'.islocked("l[2]").islocked("l[2]['6']").islocked("l[2][
[21;80H'[22;1H6'][7]")
[?25l:[12C[?12l[?25h:    $put =ps
[?25l:[12C[?12l[?25h:    let ps = ''
[?25l:[12C[?12l[?25h:    try
[?25l:[14C[?12l[?25h:      let l[1][1][0] = 99
[?25l:[14C[?12l[?25h:      let ps .= 'p'
[?25l:[14C[?12l[?25h:    catch
[?25l:[14C[?12l[?25h:      let ps .= 'F'
[?25l:[14C[?12l[?25h:    endtry
[?25l:[12C[?12l[?25h:    try
[?25l:[14C[?12l[?25h:      let l[1][1] = [99]
[?25l:[14C[?12l[?25h:      let ps .= 'p'
[?25l:[14C[?12l[?25h:    catch
[?25l:[14C[?12l[?25h:      let ps .= 'F'
[?25l:[14C[?12l[?25h:    endtry
[?25l:[12C[?12l[?25h:    try
[?25l:[14C[?12l[?25h:      let l[1] = [99]
[?25l:[14C[?12l[?25h:      let ps .= 'p'
[?25l:[14C[?12l[?25h:    catch
[?25l:[14C[?12l[?25h:      let ps .= 'F'
[?25l:[14C[?12l[?25h:    endtry
[?25l:[12C[?12l[?25h:    try
[?25l:[14C[?12l[?25h:      let l[2]['6'][7] = 99
[?25l:[14C[?12l[?25h:      let ps .= 'p'
[?25l:[14C[?12l[?25h:    catch
[?25l:[14C[?12l[?25h:      let ps .= 'F'
[?25l:[14C[?12l[?25h:    endtry
[?25l:[12C[?12l[?25h:    try
[?25l:[14C[?12l[?25h:      let l[2][6] = {99: 99}
[?25l:[14C[?12l[?25h:      let ps .= 'p'
[?25l:[14C[?12l[?25h:    catch
[?25l:[14C[?12l[?25h:      let ps .= 'F'
[?25l:[14C[?12l[?25h:    endtry
[?25l:[12C[?12l[?25h:    try
[?25l:[14C[?12l[?25h:      let l[2] = {99: 99}
[?25l:[14C[?12l[?25h:      let ps .= 'p'
[?25l:[14C[?12l[?25h:    catch
[?25l:[14C[?12l[?25h:      let ps .= 'F'
[?25l:[14C[?12l[?25h:    endtry
[?25l:[12C[?12l[?25h:    try
[?25l:[14C[?12l[?25h:      let l = [99]
[?25l:[14C[?12l[?25h:      let ps .= 'p'
[?25l:[14C[?12l[?25h:    catch
[?25l:[14C[?12l[?25h:      let ps .= 'F'
[?25l:[14C[?12l[?25h:    endtry
[?25l:[12C[?12l[?25h:    $put =ps
[?25l:[12C[?12l[?25h:  endfor
[?25l:[10C[?12l[?25h:endfor
[?25l:[8C[?12l[?25h:"
[?25l:[8C[?12l[?25h:" a:000 function argument
[?25l:[8C[?12l[?25h:" first the tests that should fail
[?25l:[8C[?12l[?25h:try
[?25l:[10C[?12l[?25h:  let a:000 = [1, 2]
[?25l:[10C[?12l[?25h:catch
[?25l:[10C[?12l[?25h:  $put ='caught a:000'
[?25l:[10C[?12l[?25h:endtry
[?25l:[8C[?12l[?25h:try
[?25l:[10C[?12l[?25h:  let a:000[0] = 9
[?25l:[10C[?12l[?25h:catch
[?25l:[10C[?12l[?25h:  $put ='caught a:000[0]'
[?25l:[10C[?12l[?25h:endtry
[?25l:[8C[?12l[?25h:try
[?25l:[10C[?12l[?25h:  let a:000[2] = [9, 10]
[?25l:[10C[?12l[?25h:catch
[?25l:[10C[?12l[?25h:  $put ='caught a:000[2]'
[?25l:[10C[?12l[?25h:endtry
[?25l:[8C[?12l[?25h:try
[?25l:[10C[?12l[?25h:  let a:000[3] = {9: 10}
[?25l:[10C[?12l[?25h:catch
[?25l:[10C[?12l[?25h:  $put ='caught a:000[3]'
[?25l:[10C[?12l[?25h:endtry
[?25l:[8C[?12l[?25h:" now the tests that should pass
[?25l:[8C[?12l[?25h:try
[?25l:[10C[?12l[?25h:  let a:000[2][1] = 9
[?25l:[10C[?12l[?25h:  call extend(a:000[2], [5, 6])
[?25l:[10C[?12l[?25h:  let a:000[3][5] = 8
[?25l:[10C[?12l[?25h:  let a:000[3]['a'] = 12
[?25l:[10C[?12l[?25h:  $put =string(a:000)
[?25l:[10C[?12l[?25h:catch
[?25l:[10C[?12l[?25h:  $put ='caught ' . v:exception
[?25l:[10C[?12l[?25h:endtry
[?25l:[8C[?12l[?25h:"
[?25l:[8C[?12l[?25h:" reverse() and sort()
[?25l:[8C[?12l[?25h:let l = ['-0', 'A11', 2, 'xaaa', 4, 'foo', 'foo6', [0, 1, 2], 'x8']
[?25l:[8C[?12l[?25h:$put =string(reverse(l))
[?25l:[8C[?12l[?25h:$put =string(reverse(reverse(l)))
[?25l:[8C[?12l[?25h:$put =string(sort(l))
[?25l:[8C[?12l[?25h:$put =string(reverse(sort(l)))
[?25l:[8C[?12l[?25h:$put =string(sort(reverse(sort(l))))
[?25l:[8C[?12l[?25h:"
[?25l:[8C[?12l[?25h:" splitting a string to a List
[?25l:[8C[?12l[?25h:$put =string(split('  aa  bb '))
[?25l:[8C[?12l[?25h:$put =string(split('  aa  bb  ', '\W\+', 0))
[?25l:[8C[?12l[?25h:$put =string(split('  aa  bb  ', '\W\+', 1))
[?25l:[8C[?12l[?25h:$put =string(split('  aa  bb  ', '\W', 1))
[?25l:[8C[?12l[?25h:$put =string(split(':aa::bb:', ':', 0))
[?25l:[8C[?12l[?25h:$put =string(split(':aa::bb:', ':', 1))
[?25l:[8C[?12l[?25h:$put =string(split('aa,,bb, cc,', ',\s*', 1))
[?25l:[8C[?12l[?25h:$put =string(split('abc', '\zs'))
[?25l:[8C[?12l[?25h:$put =string(split('abc', '\zs', 1))
[?25l:[8C[?12l[?25h:"
[?25l:[8C[?12l[?25h:" compare recursively linked list and dict
[?25l:[8C[?12l[?25h:let l = [1, 2, 3, 4]
[?25l:[8C[?12l[?25h:let d = {'1': 1, '2': l, '3': 3}
[?25l:[8C[?12l[?25h:let l[1] = d
[?25l:[8C[?12l[?25h:$put =(l == l)
[?25l:[8C[?12l[?25h:$put =(d == d)
[?25l:[8C[?12l[?25h:$put =(l != deepcopy(l))
[?25l:[8C[?12l[?25h:$put =(d != deepcopy(d))
[?25l:[8C[?12l[?25h:endfun[27m[m[H[2J[?25l[1;1H:$put =string(split(':aa::bb:', ':', 0))
:$put =string(split(':aa::bb:', ':', 1))
:$put =string(split('aa,,bb, cc,', ',\s*', 1))
:$put =string(split('abc', '\zs'))
:$put =string(split('abc', '\zs', 1))
:"
:" compare recursively linked list and dict
:let l = [1, 2, 3, 4]
:let d = {'1': 1, '2': l, '3': 3}
:let l[1] = d
:$put =(l == l)
:$put =(d == d)
:$put =(l != deepcopy(l))
:$put =(d != deepcopy(d))
:endfun
:call Test(1, 2, [3, 4], {5: 6})  " This may take a while
:"
:/^start:/,$wq! test.out
ENDTEST

start:[20;1H[?12l[?25h[?25l

:[?12l[?25hcall Test(1, 2, [3, 4], {5: 6})  " This may take a while[?25l[1;1Hcaught a:000[2][1;16H[K[2;1Hcaught a:000[3][2;16H[K[3;1H[1, 2, [3, 9, 5, 6], {'a': 12, '5': 8}][3;40H[K[4;1H['x8', [0, 1, 2], 'foo6', 'foo', 4, 'xaaa', 2, 'A11', '-0']
['x8', [0, 1, 2], 'foo6', 'foo', 4, 'xaaa', 2, 'A11', '-0']
['-0', 'A11', 'foo', 'foo6', 'x8', 'xaaa', 2, 4, [0, 1, 2]]
[[0, 1, 2], 4, 2, 'xaaa', 'x8', 'foo6', 'foo', 'A11', '-0']
['-0', 'A11', 'foo', 'foo6', 'x8', 'xaaa', 2, 4, [0, 1, 2]]
['aa', 'bb'][9;13H[K[10;1H['aa', 'bb'][10;13H[K[11;1H['', 'aa', 'bb', '']
['', '', 'aa', '', 'bb', '', '']
['aa', '', 'bb'][13;17H[K[14;1H['', 'aa', '', 'bb', ''][14;25H[K[15;1H['aa', '', 'bb', 'cc', '']
['a', 'b', 'c'][16;16H[K[17;1H['', 'a', '', 'b', '', 'c', '']
1[18;2H[K[19;1H1[19;2H[K[20;1H0
0[21;2H[K[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^start:/,$wq! test.out[?25l[31msearch hit BOTTOM, continuing at TOP[m"test.out" [22;12H[K[22;12H[New File] 111 lines, 1899 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test56.failed test.ok test.out X* viminfo
cp test56.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test56.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test56.in" 21 lines, 406 characters[1;1HTest for script-local function.     vim: set ft=vim :

STARTTEST
:so small.vim
:"
:set nocp viminfo+=nviminfo
:/^start:/+1,/^end:/-1w! Xtest.vim
:source Xtest.vim
_x
:$-1,$wq! test.out
ENDTEST

start:
fun <SID>DoLast()
  call append(line('$'), "last line")
endfun
fun s:DoNothing()
  call append(line('$'), "nothing line")
endfun
nnoremap <buffer> _x    :call <SID>DoNothing()<bar>call <SID>DoLast()<cr>
end:[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTest for script-local function.     vim: set ft=vim :[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 7 lines, 120 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[11;1H[?12l[?25h
[?25l[22;1H[K[22;1H:so! Xdotest[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset nocp viminfo+=nviminfo[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^start:/+1,/^end:/-1w! Xtest.vim[?25l"Xtest.vim" [22;13H[K[22;13H[New] 7L, 200C written[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hsource Xtest.vim[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:call <SNR>3_DoNothing()|call <SNR>3_DoLast()[12;1H[?12l[?25h
[?25l[22;1H[K[22;1H:[?12l[?25h$-1,$wq! test.out[?25l"test.out" [22;12H[K[22;12H[New] 2L, 23C written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test57.failed test.ok test.out X* viminfo
cp test57.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test57.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test57.in" 496 lines, 3654 characters[1;1HTests for :sort command.     vim: set ft=vim :

STARTTEST
:so small.vim
:"
:/^t01:/+1,/^t02/-1sort
:/^t02:/+1,/^t03/-1sort n
:/^t03:/+1,/^t04/-1sort x
:/^t04:/+1,/^t05/-1sort u
:/^t05:/+1,/^t06/-1sort!
:/^t06:/+1,/^t07/-1sort! n
:/^t07:/+1,/^t08/-1sort! u
:/^t08:/+1,/^t09/-1sort o
:/^t09:/+1,/^t10/-1sort! x
:/^t10:/+1,/^t11/-1sort/./
:/^t11:/+1,/^t12/-1sort/../
:/^t12:/+1,/^t13/-1sort/../u
:/^t13:/+1,/^t14/-1sort/./n
:/^t14:/+1,/^t15/-1sort/./r
:/^t15:/+1,/^t16/-1sort/../r
:/^t16:/+1,/^t17/-1sort/./rn[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for :sort command.     vim: set ft=vim :[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 30 lines, 842 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[27m[m[H[2J[1;1H:/^t19:/+1,/^t20/-1sort/\d/n
:/^t20:/+1,/^t21/-1sort/\d/rn
:/^t21:/+1,/^t22/-1sort/\d\d/
:/^t22:/+1,/^t23/-1sort/\d\d/n
:/^t23:/+1,/^t24/-1sort/\d\d/x
:/^t24:/+1,/^t25/-1sort/\d\d/r
:/^t25:/+1,/^t26/-1sort/\d\d/rn
:/^t26:/+1,/^t27/-1sort/\d\d/rx
:/^t27:/+1,/^t28/-1sort no
:/^t01:/,$wq! test.out
ENDTEST

t01: alphebetical
abc
ab
a
a321
a123
a122
b321
b123[11;1H[?12l[?25h
[?25l[22;1H:so! Xdotest[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^t01:/+1,/^t02/-1sort[?25l[14;1H[K[15;1H[K[16;1H 123b[17;2H[K[18;4H2
a123
a
ab[21;3H[K[14;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^t02:/+1,/^t03/-1sort n[?25l[1;21r[1;1H[10M[1;22r[12;1Habc
b123
b321
b321
b321b
b322b
c123d
c321d
t02: numeric
abc[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h/^t03:/+1,/^t04/-1sort x[?25l[27m[m[H[2J[1;1Hb123
c123d
 123b
a321
b321
c321d
b321
b321b
b322b
t03: hexadecimal


a
ab
abc
 123b
a122
a123
a321
b123
b321[11;1H[?12l[?25h[?25l[22;1H:[?12l[?25h/^t04:/+1,/^t05/-1sort u[?25l[1;21r[1;1H[7M[1;22r[15;1Hb321
b321b
b322b
c123d
c321d
t04: alpha, unique[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h/^t05:/+1,/^t06/-1sort![?25l[27m[m[H[2J[1;1Ha321
ab
abc
b123
b321
b321b
b322b
c123d
c321d
t05: alpha, reverse
c321d
c123d
b322b
b321b
b321
b321
b123
abc
ab
a321
a123[11;1H[?12l[?25h[?25l[22;1H:[?12l[?25h/^t06:/+1,/^t07/-1sort! n        [?25l[1;21r[1;1H[7M[1;22r[15;1Ha122
a
 123b


t06: numeric, reverse
b322b[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h/^t07:/+1,/^t08/-1sort! u[?25l[27m[m[H[2J[1;1Hc123d
b123
a123
a122


a
ab
abc
t07: unique, reverse
c321d
c123d
b322b
b321b
b321
b123
abc
ab
a321
a123
a122[11;1H[?12l[?25h[?25l[22;1H:[?12l[?25h/^t08:/+1,/^t09/-1sort o         [?25l[1;21r[1;1H[5M[1;22r[17;1Ha
 123b

t08: octal
abc[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h/^t09:/+1,/^t10/-1sort! x        [?25l[27m[m[H[2J[1;1Hb123
c123d
 123b
a321
b321
c321d
b321
b321b
b322b
t09: reverse, hexadecimal
c321d
c123d
b322b
b321b
b321
b321
b123
a321
a123
a122
 123b[11;1H[?12l[?25h[?25l[22;1H:[?12l[?25h/^t10:/+1,/^t11/-1sort/./        [?25l[1;21r[1;1H[7M[1;22r[15;1Habc
ab
a


t10: alpha, skip first character
a[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h/^t11:/+1,/^t12/-1sort/../       [?25l[27m[m[H[2J[1;1Hc123d
a321
b321
b321
b321b
c321d
b322b
ab
abc
t11: alpha, skip first 2 characters
ab
a


a321
b321
b321
b321b
c321d
a122
b322b[11;1H[?12l[?25h[?25l[22;1H:[?12l[?25h/^t12:/+1,/^t13/-1sort/../u[?25l[1;21r[1;1H[7M[1;22r[15;1Ha123
b123
 123b
c123d
abc
t12: alpha, unique, skip first 2 characters
ab[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h/^t13:/+1,/^t14/-1sort/./n[?25l[27m[m[H[2J[1;1Hb321b
c321d
a122
b322b
a123
b123
 123b
c123d
abc
t13: numeric, skip first character
abc
ab
a


a122
a123
b123
c123d
 123b
a321[11;1H[?12l[?25h[?25l[22;1H:[?12l[?25h/^t14:/+1,/^t15/-1sort/./r[?25l[1;21r[1;1H[7M[1;22r[15;1Hb321
c321d
b321
b321b
b322b
t14: alpha, sort on first character[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h/^t15:/+1,/^t16/-1sort/../r[?25l[27m[m[H[2J[1;1Ha123
a122
b321
b123
b322b
b321
b321b
c123d
c321d
t15: alpha, sort on first 2 characters
a[14;2H123b
a123
a122
a321
abc
ab
b123
b321[11;1H[?12l[?25h[?25l[22;1H:[?12l[?25h/^t16:/+1,/^t17/-1sort/./rn[?25l[1;21r[1;1H[7M[1;22r[15;1Hb322b
b321
b321b
c123d
c321d
t16: numeric, sort on first character
abc[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h/^t17:/+1,/^t18/-1sort/\d/[?25l[27m[m[H[2J[1;1Hb123
c123d
 123b
c321d
b322b
b321
b321b


t17: alpha, skip past first digit
abc
ab
a


a321
b321
b321
b321b
c321d
a122[11;1H[?12l[?25h[?25l[22;1H:[?12l[?25h/^t18:/+1,/^t19/-1sort/\d/r[?25l[1;21r[1;1H[7M[1;22r[15;1Hb322b
a123
b123
 123b
c123d
t18: alpha, sort on first digit
abc[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h/^t19:/+1,/^t20/-1sort/\d/n[?25l[27m[m[H[2J[1;1Hb123
c123d
 123b
a321
b321
c321d
b322b
b321
b321b
t19: numeric, skip past first digit
abc
ab
a


a321
b321
c321d
b321
b321b
a122[11;1H[?12l[?25h[?25l[22;1H:[?12l[?25h/^t20:/+1,/^t21/-1sort/\d/rn[?25l[1;21r[1;1H[7M[1;22r[15;1Hb322b
a123
b123
c123d
 123b
t20: numeric, sort on first digit
abc[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h/^t21:/+1,/^t22/-1sort/\d\d/[?25l[27m[m[H[2J[1;1Hb123
c123d
 123b
a321
b321
c321d
b322b
b321
b321b
t21: alpha, skip past first 2 digits
abc
ab
a


a321
b321
b321
b321b
c321d
a122[11;1H[?12l[?25h[?25l[22;1H:[?12l[?25h/^t22:/+1,/^t23/-1sort/\d\d/n[?25l[1;21r[1;1H[7M[1;22r[15;1Hb322b
a123
b123
 123b
c123d
t22: numeric, skip past first 2 digits
abc[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h/^t23:/+1,/^t24/-1sort/\d\d/x[?25l[27m[m[H[2J[1;1Hc321d
b321
b321b
a122
b322b
a123
b123
c123d
 123b
t23: hexadecimal, skip past first 2 digits
abc
ab
a


a321
b321
b321
a122
a123
b123[11;1H[?12l[?25h[?25l[22;1H:[?12l[?25h/^t24:/+1,/^t25/-1sort/\d\d/r[?25l[1;21r[1;1H[7M[1;22r[15;1Hb321b
c321d
b322b
 123b
c123d
t24: alpha, sort on first 2 digits
abc[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h/^t25:/+1,/^t26/-1sort/\d\d/rn[?25l[27m[m[H[2J[1;1Hb123
c123d
 123b
a321
b321
c321d
b322b
b321
b321b
t25: numeric, sort on first 2 digits
abc
ab
a


a123
a122
b123
c123d
 123b
a321[11;1H[?12l[?25h[?25l[22;1H:[?12l[?25h/^t26:/+1,/^t27/-1sort/\d\d/rx[?25l[1;21r[1;1H[7M[1;22r[15;1Hb321
c321d
b322b
b321
b321b
t26: hexadecimal, sort on first 2 digits
abc[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h/^t27:/+1,/^t28/-1sort no[?25l[1m[37m[41mE474: Invalid argument[m[22;23H[K[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^t01:/,$wq! test.out[?25l[31msearch hit BOTTOM, continuing at TOP[m"test.out" [22;12H[K[22;12H[New File] 455 lines, 2727 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test58.failed test.ok test.out X* viminfo
cp test58.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test58.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test58.in" 630 lines, 10705 characters[1;1HTests for spell checking.     vim: set ft=vim :

STARTTEST
:so small.vim
:"
:" Don't want to depend on the locale from the environment
:set enc=latin1
:e!
:"
:" Function to test .aff/.dic with list of good and bad words.
:func TestOne(aff, dic)
  set spellfile=
  $put =''
  $put ='test '. a:aff . '-' . a:dic
  " Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
  mkspell! Xtest Xtest
  " use that spell file
  set spl=Xtest.latin1.spl spell
  " list all valid words[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for spell checking.     vim: set ft=vim :[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 100 lines, 2377 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[27m[m[H[2J[1;1H:call TestOne('4', '4')
:call TestOne('5', '5')
:call TestOne('6', '6')
:call TestOne('7', '7')
:"
:" NOSLITSUGS
:call TestOne('8', '8')
:"
gg:/^test output:/,$wq! test.out
ENDTEST

1affstart
SET ISO8859-1
TRY esianrtolcdugmphbyfvkwjkqxz-'ESIANRTOLCDUGMPHBYFVKWJKQXZ

FOL  
LOW  
UPP  

SOFOFROM abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ[21;1H޿[10;1H[?12l[?25h
[?25l[22;1H:so! Xdotest[11;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[11;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[11;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" Don't want to depend on the locale from the environment[?25l[11;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset enc=latin1[?25l[27m[m[H[2J[1;1H:call TestOne('4', '4')
:call TestOne('5', '5')
:call TestOne('6', '6')
:call TestOne('7', '7')
:"
:" NOSLITSUGS
:call TestOne('8', '8')
:"
gg:/^test output:/,$wq! test.out
ENDTEST

1affstart
SET ISO8859-1
TRY esianrtolcdugmphbyfvkwjkqxz-'ESIANRTOLCDUGMPHBYFVKWJKQXZ

FOL  
LOW  
UPP  

SOFOFROM abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ[21;1H޿[11;1H[?12l[?25h[?25l[22;1H:[?12l[?25he![?25l"test58.in" 630 lines, 10705 characters[1;1HTests for spell checking.     vim: set ft=vim :[2;1H[K[3;1HSTARTTEST[3;10H[K[4;2Hso small.vim[4;14H[K[6;4HDon't want to depend on the locale from the environment
:set enc=latin1[7;16H[K[8;2He!
:"[9;3H[K[10;1H:" Function to test .aff/.dic with list of good and bad words.
:func TestOne(aff, dic)
  set spellfile=
  $put =''[13;11H[K[14;1H  $put ='test '. a:aff . '-' . a:dic[14;37H[K[15;3H" Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
  mkspell! Xtest Xtest[18;23H[K[19;3H" use that spell file
  set spl=Xtest.latin1.spl spell[20;33H[K[21;1H  " list all valid words[21;25H[K[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" Function to test .aff/.dic with list of good and bad words.[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hfunc TestOne(aff, dic)[?25l
:  [?12l[?25h  set spellfile=
[?25l:  [?12l[?25h  $put =''
[?25l:  [?12l[?25h  $put ='test '. a:aff . '-' . a:dic
[?25l:  [?12l[?25h  " Generate a .spl file from a .dic and .aff file.
[?25l:  [?12l[?25h  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
[?25l:  [?12l[?25h  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
[?25l:  [?12l[?25h  mkspell! Xtest Xtest
[?25l:  [?12l[?25h  " use that spell file
[?25l:  [?12l[?25h  set spl=Xtest.latin1.spl spell
[?25l:  [?12l[?25h  " list all valid words
[?25l:  [?12l[?25h  spelldump
[?25l:  [?12l[?25h  %yank
[?25l:  [?12l[?25h  quit
[?25l:  [?12l[?25h  $put
[?25l:  [?12l[?25h  $put ='-------'
[?25l:  [?12l[?25h  " find all bad words and suggestions for them
[?25l:  [?12l[?25h  exe '1;/^' . a:aff . 'good:'
[?25l:  [?12l[?25h  normal 0f:]s
[?25l:  [?12l[?25h  let prevbad = ''
[?25l:  [?12l[?25h  while 1
[?25l:    [?12l[?25h    let [bad, a] = spellbadword()
[?25l:    [?12l[?25h    if bad == '' || bad == prevbad || bad == 'badend'
[?25l:      [?12l[?25h      break
[?25l:      [?12l[?25h    endif
[?25l:    [?12l[?25h    let prevbad = bad
[?25l:    [?12l[?25h    let lst = spellsuggest(bad, 3)
[?25l:    [?12l[?25h    normal mm
[?25l:    [?12l[?25h    $put =bad
[?25l:    [?12l[?25h    $put =string(lst)
[?25l:    [?12l[?25h    normal `m]s
[?25l:    [?12l[?25h  endwhile
[?25l:  [?12l[?25hendfunc[27m[m[H[2J[?25l[1;1HTests for spell checking.     vim: set ft=vim :

STARTTEST
:so small.vim
:"
:" Don't want to depend on the locale from the environment
:set enc=latin1
:e!
:"
:" Function to test .aff/.dic with list of good and bad words.
:func TestOne(aff, dic)
  set spellfile=
  $put =''
  $put ='test '. a:aff . '-' . a:dic
  " Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
  mkspell! Xtest Xtest
  " use that spell file
  set spl=Xtest.latin1.spl spell
  " list all valid words[1;1H[?12l[?25h[?25l[22;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hcall TestOne('1', '1')[?25l"Xtest.aff" [22;13H[K[22;13H[New File] 46 lines, 754 characters written
"Xtest.dic" [New File] 11 lines, 71 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - testCompressing word tree...[22;26H[K[22;1H
Compressed 29 of 127 nodes; 98 (77%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 490 bytes
Reading back spell file...
Performing soundfolding...
Total number of words: 16
Number of words after soundfolding: 16
Compressing word tree...
Compressed 39 of 104 nodes; 65 (62%) remaining
Writing suggestion file Xtest.latin1.sug ...
Estimated runtime memory use: 357 bytes
17 lines yanked
17 more lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25h$put =soundfold('goobledygoook')[?25l[27m[m[H[2J[1;1Hwrong
-------
[41mbad[m
['put', 'uk', 'OK']
[41minputs[m
['input', 'puts', 'outputs']
[41mcomment[m
['Comment', 'outtest', 'the end']
[41mok[m
['OK', 'uk', 'put']
[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdl[m
['deol', 'dr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek[?12l[?25h[?25l
[m:[?12l[?25h$put =soundfold('koprnven')[?25l[1;21r[21;1H
[1;22r[21;1H[41mkepereneven[m[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h$put =soundfold('oeverloos gezwets edale')[?25l[1;21r[21;1H
[1;22r[21;1H[41meverles[m [41mgesvets[m [41metele[m[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h"[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" and now with SAL instead of SOFO items; test automatic reloading[?25l[21;1H[?12l[?25h[?25l[27m[m[H[2J[1;1H[41mTests[m [41mfor[m [41mspell[m [41mchecking[m.     [41mvim[m: [41mset[m [41mft[m=[41mvim[m :

[41mSTARTTEST[m
:[41mso[m [41msmall[m.[41mvim[m
:"
:" [41mDon't[m [41mwant[m [41mto[m [41mdepend[m [41mon[m [41mthe[m [41mlocale[m [41mfrom[m [41mthe[m [41menvironment[m
:[41mset[m [41menc[m=[41mlatin1[m
:[41me[m!
:"
:" [41mFunction[m [41mto[m test .[41maff[m/.[41mdic[m [41mwith[m [41mlist[m [41mof[m [41mgood[m [41mand[m [41mbad[m [41mwords[m.
:[41mfunc[m [41mTestOne[m([41maff[m, [41mdic[m)
  [41mset[m [41mspellfile[m=
  $put =''
  $put ='test '. [41ma[m:[41maff[m . '-' . [41ma[m:[41mdic[m
  " [41mGenerate[m [41ma[m .[41mspl[m [41mfile[m [41mfrom[m [41ma[m .[41mdic[m [41mand[m .[41maff[m [41mfile[m.
  [41mexe[m '1;/^' . [41ma[m:[41maff[m . '[41maffstart[m/+1,/^' . [41ma[m:[41maff[m . '[41maffend[m/-1[41mw[m! [41mXtest[m.[41maff[m'
  [41mexe[m '1;/^' . [41ma[m:[41mdic[m . '[41mdicstart[m/+1,/^' . [41ma[m:[41mdic[m . '[41mdicend[m/-1[41mw[m! [41mXtest[m.[41mdic[m'
  [41mmkspell[m! [41mXtest[m [41mXtest[m
  " [41muse[m [41mthat[m [41mspell[m [41mfile
[m  [41mset[m [41mspl[m=[41mXtest[m.[41mlatin1[m.[41mspl[m [41mspell[m
  " [41mlist[m [41mall[m [41mvalid[m [41mwords[1;1H[?12l[?25h[?25l[22;1H[m:[?12l[?25h/^affstart_sal/+1,/^affend_sal/-1w! Xtest.aff[?25l"Xtest.aff" [22;13H[K[22;13H151 lines, 3412 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmkspell! Xtest Xtest[?25lReading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - testCompressing word tree...[22;26H[K[22;1H
Compressed 29 of 127 nodes; 98 (77%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 490 bytes
Performing soundfolding...
Total number of words: 16
Number of words after soundfolding: 15
Compressing word tree...
Compressed 33 of 75 nodes; 42 (56%) remaining
Writing suggestion file Xtest.latin1.sug ...
Estimated runtime memory use: 241 bytes
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25h$put =soundfold('goobledygoook')[?25l[1;1H[14L[1;1H['put', 'uk', 'OK']
[41minputs[m
['input', 'puts', 'outputs']
[41mcomment[m
['Comment', 'outtest', 'the end']
[41mok[m
['OK', 'uk', 'put']
[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdl[m
['deol', 'dr', 'test']
[41mend[m
['put', 'uk', 'test'][15;22H[K[16;1H[41mth[m[16;4H[K[17;1H['put', 'uk', 'test'][17;22H[K[18;1H[41mgebletegek[m[18;12H[K[19;1H[41mkepereneven[m[19;12H[K[20;1H[41meverle[m[1C [41mgesvets[m [41metele[m[20;22H[K[21;1H[41mkbltykk[m[21;8H[K[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h$put =soundfold('koprnven')[?25l[1;21r[21;1H
[1;22r[21;1H[41mkprnfn[m[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h$put =soundfold('oeverloos gezwets edale')[?25l[1;21r[21;1H
[1;22r[21;1H*[41mfls[m [41mkswts[m [41mtl[m[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h"[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" also use an addition file[?25l[21;1H[?12l[?25h[?25l[27m[m[H[2J[1;1H[41mTests[m [41mfor[m [41mspell[m [41mchecking[m.     [41mvim[m: [41mset[m [41mft[m=[41mvim[m :

[41mSTARTTEST[m
:[41mso[m [41msmall[m.[41mvim[m
:"
:" [41mDon't[m [41mwant[m [41mto[m [41mdepend[m [41mon[m [41mthe[m [41mlocale[m [41mfrom[m [41mthe[m [41menvironment[m
:[41mset[m [41menc[m=[41mlatin1[m
:[41me[m!
:"
:" [41mFunction[m [41mto[m test .[41maff[m/.[41mdic[m [41mwith[m [41mlist[m [41mof[m [41mgood[m [41mand[m [41mbad[m [41mwords[m.
:[41mfunc[m [41mTestOne[m([41maff[m, [41mdic[m)
  [41mset[m [41mspellfile[m=
  $put =''
  $put ='test '. [41ma[m:[41maff[m . '-' . [41ma[m:[41mdic[m
  " [41mGenerate[m [41ma[m .[41mspl[m [41mfile[m [41mfrom[m [41ma[m .[41mdic[m [41mand[m .[41maff[m [41mfile[m.
  [41mexe[m '1;/^' . [41ma[m:[41maff[m . '[41maffstart[m/+1,/^' . [41ma[m:[41maff[m . '[41maffend[m/-1[41mw[m! [41mXtest[m.[41maff[m'
  [41mexe[m '1;/^' . [41ma[m:[41mdic[m . '[41mdicstart[m/+1,/^' . [41ma[m:[41mdic[m . '[41mdicend[m/-1[41mw[m! [41mXtest[m.[41mdic[m'
  [41mmkspell[m! [41mXtest[m [41mXtest[m
  " [41muse[m [41mthat[m [41mspell[m [41mfile
[m  [41mset[m [41mspl[m=[41mXtest[m.[41mlatin1[m.[41mspl[m [41mspell[m
  " [41mlist[m [41mall[m [41mvalid[m [41mwords[1;1H[?12l[?25h[?25l[22;1H[m:[?12l[?25h/^addstart/+1,/^addend/-1w! Xtest.latin1.add[?25l"Xtest.latin1.add" [22;20H[K[22;20H[New File] 3 lines, 38 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmkspell! Xtest.latin1.add.spl Xtest.latin1.add[?25lReading word file Xtest.latin1.add ...[22;39H[K[22;1H
Compressing word tree...
Compressed 0 of 29 nodes; 29 (100%) remaining
Writing spell file Xtest.latin1.add.spl ...
Done!
Estimated runtime memory use: 145 bytes
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hset spellfile=Xtest.latin1.add[?25l[1;1H[6L[1;1H[41mTests[m [41mfor[m [41mspell[m [41mchecking[m.     [41mvim[m: [41mset[m [41mft[m=[41mvim[m :

[41mSTARTTEST[m
:[41mso[m [41msmall[m.[41mvim[m
:"
:" [41mDon't[m [41mwant[m [41mto[m [41mdepend[m [41mon[m [41mthe[m [41mlocale[m [41mfrom[m [41mthe[m [41menvironment[m[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/[?12l[?25h^test2:[?25l[27m[m[H[2J[1;1H2[41mgood[m: puts
[41mbad[m: [41minputs[m [41mcomment[m [41mok[m [41mOk[m [41mend[m [41mthe[m. [44mtest[m [41mdl
badend

addstart[m
/[41mregions[m=[41musgbnz[m
elequint/2
elekwint/3
[41maddend

test2[m:
elequint test elekwint test [41melekwent[m [41masdf[m

Test [41mrules[m [41mfor[m [41mcompounding[m.

3[41maffstart
SET[m [41mISO8859-1

COMPOUNDMIN[m 3
[41mCOMPOUNDRULE[m [41mm[m*
[41mNEEDCOMPOUND[m [41mx[11;1H[?12l[?25h[12;29H[?25l[22;1H[m:[?12l[?25hlet [str, a] = spellbadword()[?25l[12;29H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H[41mcomment[m
['Comment', 'outtest', 'the end']
[41mok[m
['OK', 'uk', 'put']
[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdl[m
['deol', 'dr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent[?12l[?25h[?25l
[m:[?12l[?25hset spl=Xtest_us.latin1.spl[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h^test2:[?25l[31msearch hit BOTTOM, continuing at TOP[27m[m[H[2J[1;1H2[41mgood[m: puts
[41mbad[m: [41minputs[m [41mcomment[m [41mok[m [41mOk[m [41mend[m [41mthe[m. [44mtest[m [41mdl
badend

addstart[m
/[41mregions[m=[41musgbnz[m
[46melequint[m/2
[46melekwint[m/3
[41maddend

test2[m:
[46melequint[m test [46melekwint[m test [41melekwent[m [41masdf[m

Test [41mrules[m [41mfor[m [41mcompounding[m.

3[41maffstart
SET[m [41mISO8859-1

COMPOUNDMIN[m 3
[41mCOMPOUNDRULE[m [41mm[m*
[41mNEEDCOMPOUND[m [41mx[m
[31msearch hit BOTTOM, continuing at TOP[11;1H[?12l[?25h
[?25l[m[22;1H[K[22;1H:[?12l[?25hlet [str, a] = spellbadword()[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H['Comment', 'outtest', 'the end']
[41mok[m
['OK', 'uk', 'put']
[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdl[m
['deol', 'dr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent[m
[46melequint[?12l[?25h[?25l[27m[m[H[2J[1;1H[41mbad[m: [41minputs[m [41mcomment[m [41mok[m [41mOk[m [41mend[m [41mthe[m. [44mtest[m [41mdl
badend

addstart[m
/[41mregions[m=[41musgbnz[m
[46melequint[m/2
[46melekwint[m/3
[41maddend

test2[m:
[46melequint[m test [46melekwint[m test [41melekwent[m [41masdf[m

Test [41mrules[m [41mfor[m [41mcompounding[m.

3[41maffstart
SET[m [41mISO8859-1

COMPOUNDMIN[m 3
[41mCOMPOUNDRULE[m [41mm[m*
[41mNEEDCOMPOUND[m [41mx[m
3[41maffend[11;1H[?12l[?25h[14C[?25l[22;1H[m:[?12l[?25hlet [str, a] = spellbadword()[?25l[11;15H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H[41mok[m
['OK', 'uk', 'put']
[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdl[m
['deol', 'dr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent[m
[46melequint
elekwint[?12l[?25h[?25l
[m:[?12l[?25hset spl=Xtest_gb.latin1.spl[?25l[20;1Helequint
[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h^test2:[?25l[31msearch hit BOTTOM, continuing at TOP[27m[m[H[2J[1;1H2[41mgood[m: puts
[41mbad[m: [41minputs[m [41mcomment[m [41mok[m [41mOk[m [41mend[m [41mthe[m. [44mtest[m [41mdl
badend

addstart[m
/[41mregions[m=[41musgbnz[m
elequint/2
[46melekwint[m/3
[41maddend

test2[m:
elequint test [46melekwint[m test [41melekwent[m [41masdf[m

Test [41mrules[m [41mfor[m [41mcompounding[m.

3[41maffstart
SET[m [41mISO8859-1

COMPOUNDMIN[m 3
[41mCOMPOUNDRULE[m [41mm[m*
[41mNEEDCOMPOUND[m [41mx[m
[31msearch hit BOTTOM, continuing at TOP[11;1H[?12l[?25h[12;15H[?25l[m[22;1H[K[22;1H:[?12l[?25hlet [str, a] = spellbadword()[?25l[12;15H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H['OK', 'uk', 'put']
[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdl[m
['deol', 'dr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent[m
elequint
[46melekwint
elekwint[?12l[?25h[?25l[27m[m[H[2J[1;1H[41mbad[m: [41minputs[m [41mcomment[m [41mok[m [41mOk[m [41mend[m [41mthe[m. [44mtest[m [41mdl
badend

addstart[m
/[41mregions[m=[41musgbnz[m
elequint/2
[46melekwint[m/3
[41maddend

test2[m:
elequint test [46melekwint[m test [41melekwent[m [41masdf[m

Test [41mrules[m [41mfor[m [41mcompounding[m.

3[41maffstart
SET[m [41mISO8859-1

COMPOUNDMIN[m 3
[41mCOMPOUNDRULE[m [41mm[m*
[41mNEEDCOMPOUND[m [41mx[m
3[41maffend[11;15H[?12l[?25h[14C[?25l[22;1H[m:[?12l[?25hlet [str, a] = spellbadword()[?25l[11;29H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdl[m
['deol', 'dr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent[m
elequint
[46melekwint
elekwint[m
[41melekwent[?12l[?25h[?25l
[m:[?12l[?25hset spl=Xtest_nz.latin1.spl[?25l[18;1H[46melequint[m
elekwint
elekwint
[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h^test2:[?25l[31msearch hit BOTTOM, continuing at TOP[27m[m[H[2J[1;1H2[41mgood[m: puts
[41mbad[m: [41minputs[m [41mcomment[m [41mok[m [41mOk[m [41mend[m [41mthe[m. [44mtest[m [41mdl
badend

addstart[m
/[41mregions[m=[41musgbnz[m
[46melequint[m/2
elekwint/3
[41maddend

test2[m:
[46melequint[m test elekwint test [41melekwent[m [41masdf[m

Test [41mrules[m [41mfor[m [41mcompounding[m.

3[41maffstart
SET[m [41mISO8859-1

COMPOUNDMIN[m 3
[41mCOMPOUNDRULE[m [41mm[m*
[41mNEEDCOMPOUND[m [41mx[m
[31msearch hit BOTTOM, continuing at TOP[11;1H[?12l[?25h
[?25l[m[22;1H[K[22;1H:[?12l[?25hlet [str, a] = spellbadword()[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdl[m
['deol', 'dr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent[m
[46melequint[m
elekwint
elekwint
[41melekwent[m
[46melequint[?12l[?25h[?25l[27m[m[H[2J[1;1H[41mbad[m: [41minputs[m [41mcomment[m [41mok[m [41mOk[m [41mend[m [41mthe[m. [44mtest[m [41mdl
badend

addstart[m
/[41mregions[m=[41musgbnz[m
[46melequint[m/2
elekwint/3
[41maddend

test2[m:
[46melequint[m test elekwint test [41melekwent[m [41masdf[m

Test [41mrules[m [41mfor[m [41mcompounding[m.

3[41maffstart
SET[m [41mISO8859-1

COMPOUNDMIN[m 3
[41mCOMPOUNDRULE[m [41mm[m*
[41mNEEDCOMPOUND[m [41mx[m
3[41maffend[11;1H[?12l[?25h[28C[?25l[22;1H[m:[?12l[?25hlet [str, a] = spellbadword()[?25l[11;29H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1Htest
['Test', 'testn', 'testen']
[41mdl[m
['deol', 'dr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent[m
[46melequint[m
elekwint
elekwint
[41melekwent[m
[46melequint[m
[41melekwent[?12l[?25h[?25l
[m:[?12l[?25hset spl=Xtest_ca.latin1.spl[?25l[16;1H[41melequint
elekwint
elekwint

elequint
[?12l[?25h[?25l[m[22;1H[K[22;1H/[?12l[?25h^test2:[?25l[31msearch hit BOTTOM, continuing at TOP[27m[m[H[2J[1;1H2[41mgood[m: puts
[41mbad[m: [41minputs[m [41mcomment[m [41mok[m [41mOk[m [41mend[m [41mthe[m. [44mtest[m [41mdl
badend

addstart[m
/[41mregions[m=[41musgbnz
elequint[m/2
[41melekwint[m/3
[41maddend

test2[m:
[41melequint[m test [41melekwint[m test [41melekwent[m [41masdf[m

Test [41mrules[m [41mfor[m [41mcompounding[m.

3[41maffstart
SET[m [41mISO8859-1

COMPOUNDMIN[m 3
[41mCOMPOUNDRULE[m [41mm[m*
[41mNEEDCOMPOUND[m [41mx[m
[31msearch hit BOTTOM, continuing at TOP[11;1H[?12l[?25h
[?25l[m[22;1H[K[22;1H:[?12l[?25hlet [str, a] = spellbadword()[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H['Test', 'testn', 'testen']
[41mdl[m
['deol', 'dr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent
elequint
elekwint
elekwint
elekwent
elequint
elekwent
elequint[?12l[?25h[?25l[27m[m[H[2J[1;1H[41mbad[m: [41minputs[m [41mcomment[m [41mok[m [41mOk[m [41mend[m [41mthe[m. [44mtest[m [41mdl
badend

addstart[m
/[41mregions[m=[41musgbnz
elequint[m/2
[41melekwint[m/3
[41maddend

test2[m:
[41melequint[m test [41melekwint[m test [41melekwent[m [41masdf[m

Test [41mrules[m [41mfor[m [41mcompounding[m.

3[41maffstart
SET[m [41mISO8859-1

COMPOUNDMIN[m 3
[41mCOMPOUNDRULE[m [41mm[m*
[41mNEEDCOMPOUND[m [41mx[m
3[41maffend[11;1H[?12l[?25h[14C[?25l[22;1H[m:[?12l[?25hlet [str, a] = spellbadword()[?25l[11;15H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H[41mdl[m
['deol', 'dr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent
elequint
elekwint
elekwint
elekwent
elequint
elekwent
elequint
elekwint[?12l[?25h[?25l
[m:[?12l[?25h"[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" Postponed prefixes[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hcall TestOne('2', '1')[?25l"Xtest.aff" [22;13H[K[22;13H44 lines, 447 characters written
"Xtest.dic" 11 lines, 71 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - testCompressing word tree...[22;26H[K[22;1H
Compressed 10 of 98 nodes; 88 (89%) remaining
Compressed 0 of 13 nodes; 13 (100%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 505 bytes
17 lines yanked
17 more lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25h"[?25l[1;1H[12L[1;1H[41mMAP[m [41mi
MAP[m [41mo
MAP[m [41mu
MAP[m [41mn
MAP[m [41mc
MAP[m [41my
MAP[m [41ms[m
2[41maffend[m

2[41mgood[m: puts
[41mbad[m: [41minputs[m [41mcomment[m [41mok[m [41mOk[m [41mend[m [41mthe[m. [44mtest[m [41mdl
badend[m[13;1H[K[14;1H[41maddstar[m
/[41mregions[m=[41musgbnz
elequ[m[3C/2[17;6H[41mi[m[2C/3
[41maddend[m[18;7H[K[19;1H[K[20;1H[41mtest2[m:[20;7H[K[21;4H[41mqu[m[4Ctest [41melekwint[m test [41melekwent[m [41masdf[m[22;1H[K[12;1H[?12l[?25h[?25l[22;1H:[?12l[?25h" Compound words[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hcall TestOne('3', '3')[?25l"Xtest.aff" [22;13H[K[22;13H5 lines, 60 characters written
"Xtest.dic" 5 lines, 29 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - fooCompressing word tree...[22;26H[K[22;1H
Compressed 6 of 29 nodes; 23 (79%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 115 bytes
3 lines yanked
3 more lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hcall TestOne('4', '4')[?25l"Xtest.aff" [22;13H[K[22;13H45 lines, 559 characters written
"Xtest.dic" 8 lines, 59 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - wordCompressing word tree...[22;26H[K[22;1H
Compressed 2 of 91 nodes; 89 (97%) remaining
Compressed 0 of 15 nodes; 15 (100%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 520 bytes
12 lines yanked
12 more lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hcall TestOne('5', '5')[?25l"Xtest.aff" [22;13H[K[22;13H25 lines, 237 characters written
"Xtest.dic" 6 lines, 57 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - fooCompressing word tree...[22;26H[K[22;1H
Compressed 19 of 105 nodes; 86 (81%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 440 bytes
10 lines yanked
10 more lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hcall TestOne('6', '6')[?25l"Xtest.aff" [22;13H[K[22;13H23 lines, 211 characters written
"Xtest.dic" 6 lines, 53 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - meeCompressing word tree...[22;26H[K[22;1H
Compressed 19 of 87 nodes; 68 (78%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 350 bytes
9 lines yanked
9 more lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hcall TestOne('7', '7')[?25l"Xtest.aff" [22;13H[K[22;13H22 lines, 223 characters written
"Xtest.dic" 6 lines, 67 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - meeCompressing word tree...[22;26H[K[22;1H
Compressed 19 of 89 nodes; 70 (78%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 360 bytes
9 lines yanked
9 more lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25h"[?25l[27m[m[H[2J[1;1H[41mmee[m/391,111,9999
bar/17,61003,123
lead/2
tail/123
[41mmiddle[m/77,1
7[41mdicend[m

7[41mgood[m: meea1 meea bar prebar barmeat prebarmeat  leadprebar[9;7Hlead tail leadtail  leadmiddletail
[41mbad[m: [41mmee[m [41mmeea2[m [41mprabar[m [41mprobarmaat[m [41mmiddle[m [41mleadmiddle[m [41mmiddletail[m [41mtaillead[11;9Hleadprobar
badend

Test[m [41mNOSLITSUGS[m

8[41maffstart
SET[m [41mISO8859[m-1

[41mNOSPLITSUGS[m
8[41maffend[12;1H[?12l[?25h[?25l[22;1H[m:[?12l[?25h" NOSLITSUGS[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hcall TestOne('8', '8')[?25l"Xtest.aff" [22;13H[K[22;13H3 lines, 27 characters written
"Xtest.dic" 4 lines, 20 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - fooCompressing word tree...[22;26H[K[22;1H
Compressed 8 of 26 nodes; 18 (69%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 90 bytes
4 lines yanked
4 more lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25h"[?25l[1;1H[11L[1;1H8[41maffend[m

8[41mdicstart[m
1234
foo
bar
faabar
8[41mdicend[m

8[41mgood[m: foo bar faabar
[41mbad[m: [41mfoobar[m [41mbarfoo[m[14;1H[K[15;1H[41mtest[m [41moutput[m:[16;1H[K[17;1H[41mtest[m 1-1[17;9H[K[18;1H# [41mfile[m: [41mXtest[m.[41mlatin1[m.[41mspl
Comment[m[19;8H[K[20;1H[41mdeol[m[20;5H[K[21;1H[41mdr[m[22;1H[K[12;1H[?12l[?25h[?25l[27m[m[H[2J[1;1H[41mTests[m [41mfor[m [41mspell[m [41mchecking[m.     [41mvim[m: [41mset[m [41mft[m=[41mvim[m :

[41mSTARTTEST[m
:[41mso[m [41msmall[m.[41mvim[m
:"
:" [41mDon[m'[41mt[m [41mwant[m [41mto[m [41mdepend[m [41mon[m [41mthe[m [41mlocale[m [41mfrom[m [41mthe[m [41menvironment[m
:[41mset[m [41menc[m=[41mlatin1[m
:[41me[m!
:"
:" [41mFunction[m [41mto[m [41mtest[m .[41maff[m/.[41mdic[m [41mwith[m [41mlist[m [41mof[m [41mgood[m [41mand[m [41mbad[m [41mwords[m.
:[41mfunc[m [41mTestOne[m([41maff[m, [41mdic[m)
  [41mset[m [41mspellfile[m=
  $[41mput[m =''
  $[41mput[m ='[41mtest[m '. [41ma[m:[41maff[m . '-' . [41ma[m:[41mdic[m
  " [41mGenerate[m [41ma[m .[41mspl[m [41mfile[m [41mfrom[m [41ma[m .[41mdic[m [41mand[m .[41maff[m [41mfile[m.
  [41mexe[m '1;/^' . [41ma[m:[41maff[m . '[41maffstart[m/+1,/^' . [41ma[m:[41maff[m . '[41maffend[m/-1[41mw[m! [41mXtest[m.[41maff[m'
  [41mexe[m '1;/^' . [41ma[m:[41mdic[m . '[41mdicstart[m/+1,/^' . [41ma[m:[41mdic[m . '[41mdicend[m/-1[41mw[m! [41mXtest[m.[41mdic[m'
  [41mmkspell[m! [41mXtest[m [41mXtest[m
  " [41muse[m [41mthat[m [41mspell[m [41mfile
[m  [41mset[m [41mspl[m=[41mXtest[m.[41mlatin1[m.[41mspl[m [41mspell[m
  " [41mlist[m [41mall[m [41mvalid[m [41mwords[1;1H[?12l[?25h[?25l[22;1H[m:[?12l[?25h/^test output:/,$wq! test.out[?25l"test.out" [22;12H[K[22;12H[New File] 283 lines, 3793 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test59.failed test.ok test.out X* viminfo
cp test59.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test59.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test59.in" 621 lines, 10818 characters[1;1HTests for spell checking with 'encoding' set to "utf-8".  vim: set ft=vim :

STARTTEST
:so small.vim
:so mbyte.vim
:"
:" Don't want to depend on the locale from the environment.  The .aff and .dic
:" text is in latin1, the test text is utf-8.
:set enc=latin1
:e!
:set enc=utf-8
:set fenc=
:"
:" Function to test .aff/.dic with list of good and bad words.
:func TestOne(aff, dic)
  set spellfile=
  $put =''
  $put ='test '. a:aff . '-' . a:dic
  " Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for spell checking with 'encoding' set to "utf-8".  vim: set ft=vim :[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 101 lines, 2441 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[27m[m[H[2J[1;1H:"
:" Compound words
:call TestOne('3', '3')
:call TestOne('4', '4')
:call TestOne('5', '5')
:call TestOne('6', '6')
:call TestOne('7', '7')
:"
gg:/^test output:/,$wq! test.out
ENDTEST

1affstart
SET ISO8859-1
TRY esianrtolcdugmphbyfvkwjkqxz-'ESIANRTOLCDUGMPHBYFVKWJKQXZ

FOL  
LOW  
UPP  

SOFOFROM abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ[21;1H޿[10;1H[?12l[?25h
[?25l[22;1H:so! Xdotest[11;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[11;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso mbyte.vim[?25l[11;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[11;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" Don't want to depend on the locale from the environment.  The .aff and .dic[?25l[11;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" text is in latin1, the test text is utf-8.[?25l[11;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset enc=latin1[?25l[27m[m[H[2J[1;1H:"
:" Compound words
:call TestOne('3', '3')
:call TestOne('4', '4')
:call TestOne('5', '5')
:call TestOne('6', '6')
:call TestOne('7', '7')
:"
gg:/^test output:/,$wq! test.out
ENDTEST

1affstart
SET ISO8859-1
TRY esianrtolcdugmphbyfvkwjkqxz-'ESIANRTOLCDUGMPHBYFVKWJKQXZ

FOL  
LOW  
UPP  

SOFOFROM abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ[21;1H޿[11;1H[?12l[?25h[?25l[22;1H:[?12l[?25he![?25l"test59.in" 621 lines, 10818 characters[1;1HTests for spell checking with 'encoding' set to "utf-8".  vim: set ft=vim :[2;1H[K[3;1HSTARTTEST[3;10H[K[4;2Hso small.vim[4;14H[K[5;2Hso mbyte.vim[5;14H[K[6;2H"[6;3H[K[7;2H" Don't want to depend on the locale from the environment.  The .aff and .dic
:" text is in latin1, the test text is utf-8.
:set enc=latin1[9;16H[K[10;1H:e![10;4H[K[11;1H:set enc=utf-8
:set fenc=
:"[13;3H[K[14;1H:" Function to test .aff/.dic with list of good and bad words.[14;63H[K[15;1H:func TestOne(aff, dic)
  set spellfile=[16;17H[K[17;1H  $put =''[17;11H[K[18;1H  $put ='test '. a:aff . '-' . a:dic[18;37H[K[19;3H" Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'[20;74H[K[21;1H  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset enc=utf-8[?25l[27m[m[H[2J[1;1HTests for spell checking with 'encoding' set to "utf-8".  vim: set ft=vim :

STARTTEST
:so small.vim
:so mbyte.vim
:"
:" Don't want to depend on the locale from the environment.  The .aff and .dic
:" text is in latin1, the test text is utf-8.
:set enc=latin1
:e!
:set enc=utf-8
:set fenc=
:"
:" Function to test .aff/.dic with list of good and bad words.
:func TestOne(aff, dic)
  set spellfile=
  $put =''
  $put ='test '. a:aff . '-' . a:dic
  " Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'[1;1H[?12l[?25h[?25l[22;1H:[?12l[?25hset fenc=[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" Function to test .aff/.dic with list of good and bad words.[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hfunc TestOne(aff, dic)[?25l
:  [?12l[?25h  set spellfile=
[?25l:  [?12l[?25h  $put =''
[?25l:  [?12l[?25h  $put ='test '. a:aff . '-' . a:dic
[?25l:  [?12l[?25h  " Generate a .spl file from a .dic and .aff file.
[?25l:  [?12l[?25h  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
[?25l:  [?12l[?25h  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
[?25l:  [?12l[?25h  mkspell! Xtest Xtest
[?25l:  [?12l[?25h  " use that spell file
[?25l:  [?12l[?25h  set spl=Xtest.utf-8.spl spell
[?25l:  [?12l[?25h  " list all valid words
[?25l:  [?12l[?25h  spelldump
[?25l:  [?12l[?25h  %yank
[?25l:  [?12l[?25h  quit
[?25l:  [?12l[?25h  $put
[?25l:  [?12l[?25h  $put ='-------'
[?25l:  [?12l[?25h  " find all bad words and suggestions for them
[?25l:  [?12l[?25h  exe '1;/^' . a:aff . 'good:'
[?25l:  [?12l[?25h  normal 0f:]s
[?25l:  [?12l[?25h  let prevbad = ''
[?25l:  [?12l[?25h  while 1
[?25l:    [?12l[?25h    let [bad, a] = spellbadword()
[?25l:    [?12l[?25h    if bad == '' || bad == prevbad || bad == 'badend'
[?25l:      [?12l[?25h      break
[?25l:      [?12l[?25h    endif
[?25l:    [?12l[?25h    let prevbad = bad
[?25l:    [?12l[?25h    let lst = spellsuggest(bad, 3)
[?25l:    [?12l[?25h    normal mm
[?25l:    [?12l[?25h    $put =bad
[?25l:    [?12l[?25h    $put =string(lst)
[?25l:    [?12l[?25h    normal `m]s
[?25l:    [?12l[?25h  endwhile
[?25l:  [?12l[?25hendfunc[27m[m[H[2J[?25l[1;1HTests for spell checking with 'encoding' set to "utf-8".  vim: set ft=vim :

STARTTEST
:so small.vim
:so mbyte.vim
:"
:" Don't want to depend on the locale from the environment.  The .aff and .dic
:" text is in latin1, the test text is utf-8.
:set enc=latin1
:e!
:set enc=utf-8
:set fenc=
:"
:" Function to test .aff/.dic with list of good and bad words.
:func TestOne(aff, dic)
  set spellfile=
  $put =''
  $put ='test '. a:aff . '-' . a:dic
  " Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'[1;1H[?12l[?25h[?25l[22;1H:[?12l[?25h"[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hcall TestOne('1', '1')[?25l"Xtest.aff" [22;13H[K[22;1H"Xtest.aff" [New File] 48 lines, 768 characters written
"Xtest.dic" "Xtest.dic" [New File] 11 lines, 71 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - testCompressing word tree...[22;26H[K[22;1H
Compressed 29 of 131 nodes; 102 (77%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 510 bytes
Reading back spell file...
Performing soundfolding...
Total number of words: 16
Number of words after soundfolding: 16
Compressing word tree...
Compressed 39 of 104 nodes; 65 (62%) remaining
Writing suggestion file Xtest.utf-8.sug ...
Estimated runtime memory use: 357 bytes
17 lines yanked
17 more lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25h$put =soundfold('goobledygoook')[?25l[27m[m[H[2J[1;1Hwrong
-------
[41mbad[m
['put', 'uk', 'OK']
[41minputs[m
['input', 'puts', 'outputs']
[41mcomment[m
['Comment', 'outtest', 'the end']
[41mok[m
['OK', 'uk', 'put']
[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdéôl[m
['deol', 'déôr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek[?12l[?25h[?25l
[m:[?12l[?25h$put =soundfold('kóopërÿnôven')[?25l[1;21r[21;1H
[1;22r[21;1H[41mkepereneven[m[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h$put =soundfold('oeverloos gezwets edale')[?25l[1;21r[21;1H
[1;22r[21;1H[41meverles[m [41mgesvets[m [41metele[m[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h"[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" and now with SAL instead of SOFO items; test automatic reloading[?25l[21;1H[?12l[?25h[?25l[27m[m[H[2J[1;1H[41mTests[m [41mfor[m [41mspell[m [41mchecking[m [41mwith[m '[41mencoding[m' [41mset[m [41mto[m "[41mutf-8[m".  [41mvim[m: [41mset[m [41mft[m=[41mvim[m :

[41mSTARTTEST[m
:[41mso[m [41msmall[m.[41mvim[m
:[41mso[m [41mmbyte[m.[41mvim[m
:"
:" [41mDon't[m [41mwant[m [41mto[m [41mdepend[m [41mon[m [41mthe[m [41mlocale[m [41mfrom[m [41mthe[m [41menvironment[m.  [41mThe[m .[41maff[m [41mand[m .[41mdic[m
:" [41mtext[m [41mis[m [41min[m [41mlatin1[m, [41mthe[m test [41mtext[m [41mis[m [41mutf-8[m.
:[41mset[m [41menc[m=[41mlatin1[m
:[41me[m!
:[41mset[m [41menc[m=[41mutf-8[m
:[41mset[m [41mfenc[m=
:"
:" [41mFunction[m [41mto[m test .[41maff[m/.[41mdic[m [41mwith[m [41mlist[m [41mof[m [41mgood[m [41mand[m [41mbad[m [41mwords[m.
:[41mfunc[m [41mTestOne[m([41maff[m, [41mdic[m)
  [41mset[m [41mspellfile[m=
  $put =''
  $put ='test '. [41ma[m:[41maff[m . '-' . [41ma[m:[41mdic[m
  " [41mGenerate[m [41ma[m .[41mspl[m [41mfile[m [41mfrom[m [41ma[m .[41mdic[m [41mand[m .[41maff[m [41mfile[m.
  [41mexe[m '1;/^' . [41ma[m:[41maff[m . '[41maffstart[m/+1,/^' . [41ma[m:[41maff[m . '[41maffend[m/-1[41mw[m! [41mXtest[m.[41maff[m'
  [41mexe[m '1;/^' . [41ma[m:[41mdic[m . '[41mdicstart[m/+1,/^' . [41ma[m:[41mdic[m . '[41mdicend[m/-1[41mw[m! [41mXtest[m.[41mdic[m'[1;1H[?12l[?25h[?25l[22;1H:[?12l[?25h/^affstart_sal/+1,/^affend_sal/-1w! Xtest.aff[?25l"Xtest.aff" [22;13H[K[22;1H"Xtest.aff" 153 lines, 3426 characters written"Xtest.aff" 153 lines, 3426 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmkspell! Xtest Xtest[?25lReading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - testCompressing word tree...[22;26H[K[22;1H
Compressed 29 of 131 nodes; 102 (77%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 510 bytes
Performing soundfolding...
Total number of words: 16
Number of words after soundfolding: 15
Compressing word tree...
Compressed 33 of 75 nodes; 42 (56%) remaining
Writing suggestion file Xtest.utf-8.sug ...
Estimated runtime memory use: 241 bytes
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25h$put =soundfold('goobledygoook')[?25l[1;1H[14L[1;1H['put', 'uk', 'OK']
[41minputs[m
['input', 'puts', 'outputs']
[41mcomment[m
['Comment', 'outtest', 'the end']
[41mok[m
['OK', 'uk', 'put']
[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdéôl[m
['deol', 'déôr', 'test']
[41mend[m
['put', 'uk', 'test'][15;22H[K[16;1H[41mthe[m[16;4H[K[17;1H['put', 'uk', 'test']
[41mgebletegek[m[18;11H[K[19;1H[41mkepereneven[m[19;12H[K[20;1H[41meverles[m [41mgesvets[m [41metele[m[20;22H[K[21;1H[41mkbltykk[m[21;8H[K[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h$put =soundfold('kóopërÿnôven')[?25l[1;21r[21;1H
[1;22r[21;1H[41mkprnfn[m[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h$put =soundfold('oeverloos gezwets edale')[?25l[1;21r[21;1H
[1;22r[21;1H*[41mfls[m [41mkswts[m [41mtl[m[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25h"[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" also use an addition file[?25l[21;1H[?12l[?25h[?25l[27m[m[H[2J[1;1H[41mTests[m [41mfor[m [41mspell[m [41mchecking[m [41mwith[m '[41mencoding[m' [41mset[m [41mto[m "[41mutf-8[m".  [41mvim[m: [41mset[m [41mft[m=[41mvim[m :

[41mSTARTTEST[m
:[41mso[m [41msmall[m.[41mvim[m
:[41mso[m [41mmbyte[m.[41mvim[m
:"
:" [41mDon't[m [41mwant[m [41mto[m [41mdepend[m [41mon[m [41mthe[m [41mlocale[m [41mfrom[m [41mthe[m [41menvironment[m.  [41mThe[m .[41maff[m [41mand[m .[41mdic[m
:" [41mtext[m [41mis[m [41min[m [41mlatin1[m, [41mthe[m test [41mtext[m [41mis[m [41mutf-8[m.
:[41mset[m [41menc[m=[41mlatin1[m
:[41me[m!
:[41mset[m [41menc[m=[41mutf-8[m
:[41mset[m [41mfenc[m=
:"
:" [41mFunction[m [41mto[m test .[41maff[m/.[41mdic[m [41mwith[m [41mlist[m [41mof[m [41mgood[m [41mand[m [41mbad[m [41mwords[m.
:[41mfunc[m [41mTestOne[m([41maff[m, [41mdic[m)
  [41mset[m [41mspellfile[m=
  $put =''
  $put ='test '. [41ma[m:[41maff[m . '-' . [41ma[m:[41mdic[m
  " [41mGenerate[m [41ma[m .[41mspl[m [41mfile[m [41mfrom[m [41ma[m .[41mdic[m [41mand[m .[41maff[m [41mfile[m.
  [41mexe[m '1;/^' . [41ma[m:[41maff[m . '[41maffstart[m/+1,/^' . [41ma[m:[41maff[m . '[41maffend[m/-1[41mw[m! [41mXtest[m.[41maff[m'
  [41mexe[m '1;/^' . [41ma[m:[41mdic[m . '[41mdicstart[m/+1,/^' . [41ma[m:[41mdic[m . '[41mdicend[m/-1[41mw[m! [41mXtest[m.[41mdic[m'[1;1H[?12l[?25h[?25l[22;1H:[?12l[?25h/^addstart/+1,/^addend/-1w! Xtest.utf-8.add[?25l"Xtest.utf-8.add" [22;19H[K[22;1H"Xtest.utf-8.add" [New File] 3 lines, 38 characters written"Xtest.utf-8.add" [New File] 3 lines, 38 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmkspell! Xtest.utf-8.add.spl Xtest.utf-8.add[?25lReading word file Xtest.utf-8.add ...[22;38H[K[22;1H
Compressing word tree...
Compressed 0 of 29 nodes; 29 (100%) remaining
Writing spell file Xtest.utf-8.add.spl ...
Done!
Estimated runtime memory use: 145 bytes
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hset spellfile=Xtest.utf-8.add[?25l[1;1H[6L[1;1H[41mTests[m [41mfor[m [41mspell[m [41mchecking[m [41mwith[m '[41mencoding[m' [41mset[m [41mto[m "[41mutf-8[m".  [41mvim[m: [41mset[m [41mft[m=[41mvim[m :

[41mSTARTTEST[m
:[41mso[m [41msmall[m.[41mvim[m
:[41mso[m [41mmbyte[m.[41mvim[m
:"[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/[?12l[?25h^test2:[?25l/^test2:[27m[m[H[2J[1;9H[41mstartwordwordend[m [41mstartwordwordwordend[m [41mprebork[m [41mpreborkbork[2;9Hpreborkborkbork[3;9Hnouword
bad[m: [41mwordutilize[m [41mpro[m [41mborkborkborkborkborkbork[m [41mtomatotomatotomato[5;9Hendstart[m [41mendend[m [41mstartstart[m [41mwordend[m [41mwordstart[6;9Hpreborkprebork[m  [41mpreborkpreborkbork[7;9Hstartwordwordwordwordend[m [41mborkpreborkpreborkbork[8;9Hutilsbork[m  [41mstartnouword
badend

test2[m:
elequint test elekwint test [41melekwent[m [41masdf[m

Test [41maffix[m [41mflags[m [41mwith[m [41mtwo[m [41mcharacters[m

5[41maffstart
SET[m [41mISO8859-1

FLAG[m [41mlong

NEEDAFFIX[m !![11;1H[?12l[?25h[12;29H[?25l[22;1H:[?12l[?25hlet [str, a] = spellbadword()[?25l[12;29H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H[41mcomment[m
['Comment', 'outtest', 'the end']
[41mok[m
['OK', 'uk', 'put']
[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdéôl[m
['deol', 'déôr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent[?12l[?25h[?25l
[m:[?12l[?25hset spl=Xtest_us.utf-8.spl[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h^test2:[?25l/^test2:[31msearch hit BOTTOM, continuing at TOP[27m[m[H[2J[1;9H[41mstartwordwordend[m [41mstartwordwordwordend[m [41mprebork[m [41mpreborkbork[2;9Hpreborkborkbork[3;9Hnouword
bad[m: [41mwordutilize[m [41mpro[m [41mborkborkborkborkborkbork[m [41mtomatotomatotomato[5;9Hendstart[m [41mendend[m [41mstartstart[m [41mwordend[m [41mwordstart[6;9Hpreborkprebork[m  [41mpreborkpreborkbork[7;9Hstartwordwordwordwordend[m [41mborkpreborkpreborkbork[8;9Hutilsbork[m  [41mstartnouword
badend

test2[m:
[46melequint[m test [46melekwint[m test [41melekwent[m [41masdf[m

Test [41maffix[m [41mflags[m [41mwith[m [41mtwo[m [41mcharacters[m

5[41maffstart
SET[m [41mISO8859-1

FLAG[m [41mlong

NEEDAFFIX[m !!
[31msearch hit BOTTOM, continuing at TOP[11;1H[?12l[?25h
[?25l[m[22;1H[K[22;1H:[?12l[?25hlet [str, a] = spellbadword()[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H['Comment', 'outtest', 'the end']
[41mok[m
['OK', 'uk', 'put']
[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdéôl[m
['deol', 'déôr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent[m
[46melequint[?12l[?25h[?25l[27m[m[H[2J[1;9H[41mpreborkborkbork[2;9Hnouword
bad[m: [41mwordutilize[m [41mpro[m [41mborkborkborkborkborkbork[m [41mtomatotomatotomato[4;9Hendstart[m [41mendend[m [41mstartstart[m [41mwordend[m [41mwordstart[5;9Hpreborkprebork[m  [41mpreborkpreborkbork[6;9Hstartwordwordwordwordend[m [41mborkpreborkpreborkbork[7;9Hutilsbork[m  [41mstartnouword
badend

test2[m:
[46melequint[m test [46melekwint[m test [41melekwent[m [41masdf[m

Test [41maffix[m [41mflags[m [41mwith[m [41mtwo[m [41mcharacters[m

5[41maffstart
SET[m [41mISO8859-1

FLAG[m [41mlong

NEEDAFFIX[m !![11;1H[?12l[?25h[14C[?25l[22;1H:[?12l[?25hlet [str, a] = spellbadword()[?25l[11;15H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H[41mok[m
['OK', 'uk', 'put']
[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdéôl[m
['deol', 'déôr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent[m
[46melequint
elekwint[?12l[?25h[?25l
[m:[?12l[?25hset spl=Xtest_gb.utf-8.spl[?25l[20;1Helequint
[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h^test2:[?25l/^test2:[31msearch hit BOTTOM, continuing at TOP[27m[m[H[2J[1;9H[41mstartwordwordend[m [41mstartwordwordwordend[m [41mprebork[m [41mpreborkbork[2;9Hpreborkborkbork[3;9Hnouword
bad[m: [41mwordutilize[m [41mpro[m [41mborkborkborkborkborkbork[m [41mtomatotomatotomato[5;9Hendstart[m [41mendend[m [41mstartstart[m [41mwordend[m [41mwordstart[6;9Hpreborkprebork[m  [41mpreborkpreborkbork[7;9Hstartwordwordwordwordend[m [41mborkpreborkpreborkbork[8;9Hutilsbork[m  [41mstartnouword
badend

test2[m:
elequint test [46melekwint[m test [41melekwent[m [41masdf[m

Test [41maffix[m [41mflags[m [41mwith[m [41mtwo[m [41mcharacters[m

5[41maffstart
SET[m [41mISO8859-1

FLAG[m [41mlong

NEEDAFFIX[m !!
[31msearch hit BOTTOM, continuing at TOP[11;1H[?12l[?25h[12;15H[?25l[m[22;1H[K[22;1H:[?12l[?25hlet [str, a] = spellbadword()[?25l[12;15H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H['OK', 'uk', 'put']
[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdéôl[m
['deol', 'déôr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent[m
elequint
[46melekwint
elekwint[?12l[?25h[?25l[27m[m[H[2J[1;9H[41mpreborkborkbork[2;9Hnouword
bad[m: [41mwordutilize[m [41mpro[m [41mborkborkborkborkborkbork[m [41mtomatotomatotomato[4;9Hendstart[m [41mendend[m [41mstartstart[m [41mwordend[m [41mwordstart[5;9Hpreborkprebork[m  [41mpreborkpreborkbork[6;9Hstartwordwordwordwordend[m [41mborkpreborkpreborkbork[7;9Hutilsbork[m  [41mstartnouword
badend

test2[m:
elequint test [46melekwint[m test [41melekwent[m [41masdf[m

Test [41maffix[m [41mflags[m [41mwith[m [41mtwo[m [41mcharacters[m

5[41maffstart
SET[m [41mISO8859-1

FLAG[m [41mlong

NEEDAFFIX[m !![11;15H[?12l[?25h[14C[?25l[22;1H:[?12l[?25hlet [str, a] = spellbadword()[?25l[11;29H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H[41mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdéôl[m
['deol', 'déôr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent[m
elequint
[46melekwint
elekwint[m
[41melekwent[?12l[?25h[?25l
[m:[?12l[?25hset spl=Xtest_nz.utf-8.spl[?25l[18;1H[46melequint[m
elekwint
elekwint
[?12l[?25h[?25l[22;1H[K[22;1H/[?12l[?25h^test2:[?25l/^test2:[31msearch hit BOTTOM, continuing at TOP[27m[m[H[2J[1;9H[41mstartwordwordend[m [41mstartwordwordwordend[m [41mprebork[m [41mpreborkbork[2;9Hpreborkborkbork[3;9Hnouword
bad[m: [41mwordutilize[m [41mpro[m [41mborkborkborkborkborkbork[m [41mtomatotomatotomato[5;9Hendstart[m [41mendend[m [41mstartstart[m [41mwordend[m [41mwordstart[6;9Hpreborkprebork[m  [41mpreborkpreborkbork[7;9Hstartwordwordwordwordend[m [41mborkpreborkpreborkbork[8;9Hutilsbork[m  [41mstartnouword
badend

test2[m:
[46melequint[m test elekwint test [41melekwent[m [41masdf[m

Test [41maffix[m [41mflags[m [41mwith[m [41mtwo[m [41mcharacters[m

5[41maffstart
SET[m [41mISO8859-1

FLAG[m [41mlong

NEEDAFFIX[m !!
[31msearch hit BOTTOM, continuing at TOP[11;1H[?12l[?25h
[?25l[m[22;1H[K[22;1H:[?12l[?25hlet [str, a] = spellbadword()[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdéôl[m
['deol', 'déôr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent[m
[46melequint[m
elekwint
elekwint
[41melekwent[m
[46melequint[?12l[?25h[?25l[27m[m[H[2J[1;9H[41mpreborkborkbork[2;9Hnouword
bad[m: [41mwordutilize[m [41mpro[m [41mborkborkborkborkborkbork[m [41mtomatotomatotomato[4;9Hendstart[m [41mendend[m [41mstartstart[m [41mwordend[m [41mwordstart[5;9Hpreborkprebork[m  [41mpreborkpreborkbork[6;9Hstartwordwordwordwordend[m [41mborkpreborkpreborkbork[7;9Hutilsbork[m  [41mstartnouword
badend

test2[m:
[46melequint[m test elekwint test [41melekwent[m [41masdf[m

Test [41maffix[m [41mflags[m [41mwith[m [41mtwo[m [41mcharacters[m

5[41maffstart
SET[m [41mISO8859-1

FLAG[m [41mlong

NEEDAFFIX[m !![11;1H[?12l[?25h[28C[?25l[22;1H:[?12l[?25hlet [str, a] = spellbadword()[?25l[11;29H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1Htest
['Test', 'testn', 'testen']
[41mdéôl[m
['deol', 'déôr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent[m
[46melequint[m
elekwint
elekwint
[41melekwent[m
[46melequint[m
[41melekwent[?12l[?25h[?25l
[m:[?12l[?25hset spl=Xtest_ca.utf-8.spl[?25l[16;1H[41melequint
elekwint
elekwint

elequint
[?12l[?25h[?25l[m[22;1H[K[22;1H/[?12l[?25h^test2:[?25l/^test2:[31msearch hit BOTTOM, continuing at TOP[27m[m[H[2J[1;9H[41mstartwordwordend[m [41mstartwordwordwordend[m [41mprebork[m [41mpreborkbork[2;9Hpreborkborkbork[3;9Hnouword
bad[m: [41mwordutilize[m [41mpro[m [41mborkborkborkborkborkbork[m [41mtomatotomatotomato[5;9Hendstart[m [41mendend[m [41mstartstart[m [41mwordend[m [41mwordstart[6;9Hpreborkprebork[m  [41mpreborkpreborkbork[7;9Hstartwordwordwordwordend[m [41mborkpreborkpreborkbork[8;9Hutilsbork[m  [41mstartnouword
badend

test2[m:
[41melequint[m test [41melekwint[m test [41melekwent[m [41masdf[m

Test [41maffix[m [41mflags[m [41mwith[m [41mtwo[m [41mcharacters[m

5[41maffstart
SET[m [41mISO8859-1

FLAG[m [41mlong

NEEDAFFIX[m !!
[31msearch hit BOTTOM, continuing at TOP[11;1H[?12l[?25h
[?25l[m[22;1H[K[22;1H:[?12l[?25hlet [str, a] = spellbadword()[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H['Test', 'testn', 'testen']
[41mdéôl[m
['deol', 'déôr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent
elequint
elekwint
elekwint
elekwent
elequint
elekwent
elequint[?12l[?25h[?25l[27m[m[H[2J[1;9H[41mpreborkborkbork[2;9Hnouword
bad[m: [41mwordutilize[m [41mpro[m [41mborkborkborkborkborkbork[m [41mtomatotomatotomato[4;9Hendstart[m [41mendend[m [41mstartstart[m [41mwordend[m [41mwordstart[5;9Hpreborkprebork[m  [41mpreborkpreborkbork[6;9Hstartwordwordwordwordend[m [41mborkpreborkpreborkbork[7;9Hutilsbork[m  [41mstartnouword
badend

test2[m:
[41melequint[m test [41melekwint[m test [41melekwent[m [41masdf[m

Test [41maffix[m [41mflags[m [41mwith[m [41mtwo[m [41mcharacters[m

5[41maffstart
SET[m [41mISO8859-1

FLAG[m [41mlong

NEEDAFFIX[m !![11;1H[?12l[?25h[14C[?25l[22;1H:[?12l[?25hlet [str, a] = spellbadword()[?25l[11;15H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h$put =str[?25l[27m[m[H[2J[1;1H[41mdéôl[m
['deol', 'déôr', 'test']
[41mend[m
['put', 'uk', 'test']
[41mthe[m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[m [41mgesvets[m [41metele
kbltykk
kprnfn[m
*[41mfls[m [41mkswts[m [41mtl
elekwent
elequint
elekwint
elekwint
elekwent
elequint
elekwent
elequint
elekwint[?12l[?25h[?25l
[m:[?12l[?25h"[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" Postponed prefixes[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hcall TestOne('2', '1')[?25l"Xtest.aff" [22;13H[K[22;1H"Xtest.aff" 46 lines, 461 characters written
"Xtest.dic" "Xtest.dic" 11 lines, 71 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - testCompressing word tree...[22;26H[K[22;1H
Compressed 10 of 102 nodes; 92 (90%) remaining
Compressed 0 of 13 nodes; 13 (100%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 525 bytes
17 lines yanked
17 more lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25h"[?25l[1;1H[12L[1;1H/[41mregions[m=[41musgbnz
elequint[m/2
[41melekwint[m/3
[41maddend[m

1[41mgood[m: wrong OK puts. Test the end
[41mbad[m:  [41minputs[m [41mcomment[m [41mok[m [41mOk[m. [44mtest[m [41mdéôl[m [41mend[m [41mthe
badend[m

2[41mgood[m: puts
[41mbad[m: [41minputs[m [41mcomment[m [41mok[m [41mOk[m [41mend[m [41mthe[m. [44mtest[m [41mdéôl
badend[m[13;1H[K[14;1HTest [41mrules[m [41mfor[m [41mcompounding[m.[15;1H[K[16;1H3[41maffstart
SET[m [41mISO8859-1[m[18;1H[K[19;1H[41mCOMPOUNDMIN[m 3
[41mCOMPOUNDRULE[m [41mm[m*
[41mNEEDCOMPOUND[m [41mx[m[22;1H[K[12;1H[?12l[?25h[?25l[22;1H:[?12l[?25h" Compound words[?25l[12;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hcall TestOne('3', '3')[?25l"Xtest.aff" [22;13H[K[22;1H"Xtest.aff" 5 lines, 60 characters written
"Xtest.dic" "Xtest.dic" 5 lines, 29 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - fooCompressing word tree...[22;26H[K[22;1H
Compressed 6 of 31 nodes; 25 (80%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 125 bytes
3 lines yanked
3 more lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hcall TestOne('4', '4')[?25l"Xtest.aff" [22;13H[K[22;1H"Xtest.aff" 45 lines, 559 characters written
"Xtest.dic" "Xtest.dic" 8 lines, 59 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - wordCompressing word tree...[22;26H[K[22;1H
Compressed 2 of 91 nodes; 89 (97%) remaining
Compressed 0 of 15 nodes; 15 (100%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 520 bytes
12 lines yanked
12 more lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hcall TestOne('5', '5')[?25l"Xtest.aff" [22;13H[K[22;1H"Xtest.aff" 25 lines, 237 characters written
"Xtest.dic" "Xtest.dic" 6 lines, 57 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - fooCompressing word tree...[22;26H[K[22;1H
Compressed 19 of 107 nodes; 88 (82%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 440 bytes
10 lines yanked
10 more lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hcall TestOne('6', '6')[?25l"Xtest.aff" [22;13H[K[22;1H"Xtest.aff" 23 lines, 211 characters written
"Xtest.dic" "Xtest.dic" 6 lines, 53 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - meeCompressing word tree...[22;26H[K[22;1H
Compressed 19 of 89 nodes; 70 (78%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 350 bytes
9 lines yanked
9 more lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hcall TestOne('7', '7')[?25l"Xtest.aff" [22;13H[K[22;1H"Xtest.aff" 26 lines, 338 characters written
"Xtest.dic" "Xtest.dic" 6 lines, 67 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - meeCompressing word tree...[22;26H[K[22;1H
Compressed 19 of 91 nodes; 72 (79%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 360 bytes
9 lines yanked
9 more lines
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25h"[?25l[27m[m[H[2J[1;1H[41mmee[m/391,111,9999
bar/17,61003,123
lead/2
tail/123
[41mmiddle[m/77,1
7[41mdicend[m

7[41mgood[m: meea1 meeaé bar prebar barmeat prebarmeat  leadprebar[9;7Hlead tail leadtail  leadmiddletail
[41mbad[m: [41mmee[m [41mmeea2[m [41mprabar[m [41mprobarmaat[m [41mmiddle[m [41mleadmiddle[m [41mmiddletail[m [41mtaillead[11;9Hleadprobar
badend

test[m [41moutput[m:

[41mtest[m 1-1
# [41mfile[m: [41mXtest[m.[41mutf[m-8.[41mspl
Comment
deol
déôr
input[12;1H[?12l[?25h[?25l[27m[m[H[2J[1;1H[41mTests[m [41mfor[m [41mspell[m [41mchecking[m [41mwith[m '[41mencoding[m' [41mset[m [41mto[m "[41mutf[m-8".  [41mvim[m: [41mset[m [41mft[m=[41mvim[m :

[41mSTARTTEST[m
:[41mso[m [41msmall[m.[41mvim[m
:[41mso[m [41mmbyte[m.[41mvim[m
:"
:" [41mDon[m'[41mt[m [41mwant[m [41mto[m [41mdepend[m [41mon[m [41mthe[m [41mlocale[m [41mfrom[m [41mthe[m [41menvironment[m.  [41mThe[m .[41maff[m [41mand[m .[41mdic[m
:" [41mtext[m [41mis[m [41min[m [41mlatin1[m, [41mthe[m [41mtest[m [41mtext[m [41mis[m [41mutf[m-8.
:[41mset[m [41menc[m=[41mlatin1[m
:[41me[m!
:[41mset[m [41menc[m=[41mutf[m-8
:[41mset[m [41mfenc[m=
:"
:" [41mFunction[m [41mto[m [41mtest[m .[41maff[m/.[41mdic[m [41mwith[m [41mlist[m [41mof[m [41mgood[m [41mand[m [41mbad[m [41mwords[m.
:[41mfunc[m [41mTestOne[m([41maff[m, [41mdic[m)
  [41mset[m [41mspellfile[m=
  $[41mput[m =''
  $[41mput[m ='[41mtest[m '. [41ma[m:[41maff[m . '-' . [41ma[m:[41mdic[m
  " [41mGenerate[m [41ma[m .[41mspl[m [41mfile[m [41mfrom[m [41ma[m .[41mdic[m [41mand[m .[41maff[m [41mfile[m.
  [41mexe[m '1;/^' . [41ma[m:[41maff[m . '[41maffstart[m/+1,/^' . [41ma[m:[41maff[m . '[41maffend[m/-1[41mw[m! [41mXtest[m.[41maff[m'
  [41mexe[m '1;/^' . [41ma[m:[41mdic[m . '[41mdicstart[m/+1,/^' . [41ma[m:[41mdic[m . '[41mdicend[m/-1[41mw[m! [41mXtest[m.[41mdic[m'[1;1H[?12l[?25h[?25l[22;1H:[?12l[?25h/^test output:/,$wq! test.out[?25l"test.out" [22;12H[K[22;1H"test.out" [New File] 270 lines, 3685 characters written
[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test60.failed test.ok test.out X* viminfo
cp test60.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test60.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test60.in" 577 lines, 12425 characters[1;1HTests for the exists() function.  vim: set ft=vim :

STARTTEST
:so small.vim
:function! RunTest(str, result)
    if exists(a:str) == a:result[7;9Hecho "OK"
    else[9;9Hecho "FAILED: Checking for " . a:str
    endif
endfunction
:function! TestExists()
    augroup myagroup[14;9Hautocmd! BufEnter *.my echo 'myfile edited'
    augroup END[17;5Hlet test_cases = [][19;5H" valid autocmd group
    let test_cases += [['#myagroup', 1]]
    " valid autocmd group with garbage[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for the exists() function.  vim: set ft=vim :[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 572 lines, 12353 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[27m[m[H[2J[1;9Hendif[3;9Hecho 'a:2: 0'[4;9Hif !exists('a:2')[5;13Hecho "OK"[6;9Helse[7;13Hecho "FAILED"[8;9Hendif
    endfunction[11;5Hcall TestFuncArg("arg1", "arg2")[13;5Hredir END
endfunction
:call TestExists()
:edit! test.out
:set ff=unix
:w
:qa!
ENDTEST[?12l[?25h
[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hfunction! RunTest(str, result)[?25l
:  [?12l[?25h    if exists(a:str) == a:result
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED: Checking for " . a:str
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25hendfunction[1;1H[6L[?25l[1;9Hendif[3;9Hecho 'a:2: 0'[4;9Hif !exists('a:2')[5;13Hecho "OK"[6;9Helse[22;1H[K[21;1H[?12l[?25h[?25l
:[?12l[?25hfunction! TestExists()[?25l
:  [?12l[?25h    augroup myagroup
[?25l:  [?12l[?25h[34m^I[mautocmd! BufEnter *.my echo 'myfile edited'
[?25l:  [?12l[?25h    augroup END
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    let test_cases = []
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " valid autocmd group
[?25l:  [?12l[?25h    let test_cases += [['#myagroup', 1]]
[?25l:  [?12l[?25h    " valid autocmd group with garbage
[?25l:  [?12l[?25h    let test_cases += [['#myagroup+b', 0]]
[?25l:  [?12l[?25h    " Valid autocmd group and event
[?25l:  [?12l[?25h    let test_cases += [['#myagroup#BufEnter', 1]]
[?25l:  [?12l[?25h    " Valid autocmd group, event and pattern
[?25l:  [?12l[?25h    let test_cases += [['#myagroup#BufEnter#*.my', 1]]
[?25l:  [?12l[?25h    " Valid autocmd event
[?25l:  [?12l[?25h    let test_cases += [['#BufEnter', 1]]
[?25l:  [?12l[?25h    " Valid autocmd event and pattern
[?25l:  [?12l[?25h    let test_cases += [['#BufEnter#*.my', 1]]
[?25l:  [?12l[?25h    " Non-existing autocmd group or event
[?25l:  [?12l[?25h    let test_cases += [['#xyzagroup', 0]]
[?25l:  [?12l[?25h    " Non-existing autocmd group and valid autocmd event
[?25l:  [?12l[?25h    let test_cases += [['#xyzagroup#BufEnter', 0]]
[?25l:  [?12l[?25h    " Valid autocmd group and event with no matching pattern
[?25l:  [?12l[?25h    let test_cases += [['#myagroup#CmdwinEnter', 0]]
[?25l:  [?12l[?25h    " Valid autocmd group and non-existing autocmd event
[?25l:  [?12l[?25h    let test_cases += [['#myagroup#xyzacmd', 0]]
[?25l:  [?12l[?25h    " Valid autocmd group and event and non-matching pattern
[?25l:  [?12l[?25h    let test_cases += [['#myagroup#BufEnter#xyzpat', 0]]
[?25l:  [?12l[?25h    " Valid autocmd event and non-matching pattern
[?25l:  [?12l[?25h    let test_cases += [['#BufEnter#xyzpat', 0]]
[?25l:  [?12l[?25h    " Empty autocmd group, event and pattern
[?25l:  [?12l[?25h    let test_cases += [['###', 0]]
[?25l:  [?12l[?25h    " Empty autocmd group and event or empty event and pattern
[?25l:  [?12l[?25h    let test_cases += [['##', 0]]
[?25l:  [?12l[?25h    " Valid autocmd event
[?25l:  [?12l[?25h    let test_cases += [['##FileReadCmd', 1]]
[?25l:  [?12l[?25h    " Non-existing autocmd event
[?25l:  [?12l[?25h    let test_cases += [['##MySpecialCmd', 0]]
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing and working option (long form)
[?25l:  [?12l[?25h    let test_cases += [['&textwidth', 1]]
[?25l:  [?12l[?25h    " Existing and working option (short form)
[?25l:  [?12l[?25h    let test_cases += [['&tw', 1]]
[?25l:  [?12l[?25h    " Existing and working option with garbage
[?25l:  [?12l[?25h    let test_cases += [['&tw-', 0]]
[?25l:  [?12l[?25h    " Global option
[?25l:  [?12l[?25h    let test_cases += [['&g:errorformat', 1]]
[?25l:  [?12l[?25h    " Local option
[?25l:  [?12l[?25h    let test_cases += [['&l:errorformat', 1]]
[?25l:  [?12l[?25h    " Negative form of existing and working option (long form)
[?25l:  [?12l[?25h    let test_cases += [['&nojoinspaces', 0]]
[?25l:  [?12l[?25h    " Negative form of existing and working option (short form)
[?25l:  [?12l[?25h    let test_cases += [['&nojs', 0]]
[?25l:  [?12l[?25h    " Non-existing option
[?25l:  [?12l[?25h    let test_cases += [['&myxyzoption', 0]]
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing and working option (long form)
[?25l:  [?12l[?25h    let test_cases += [['+incsearch', 1]]
[?25l:  [?12l[?25h    " Existing and working option with garbage
[?25l:  [?12l[?25h    let test_cases += [['+incsearch!1', 0]]
[?25l:  [?12l[?25h    " Existing and working option (short form)
[?25l:  [?12l[?25h    let test_cases += [['+is', 1]]
[?25l:  [?12l[?25h    " Existing option that is hidden.
[?25l:  [?12l[?25h    let test_cases += [['+autoprint', 0]]
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing environment variable
[?25l:  [?12l[?25h    let $EDITOR_NAME = 'Vim Editor'
[?25l:  [?12l[?25h    let test_cases += [['$EDITOR_NAME', 1]]
[?25l:  [?12l[?25h    " Non-existing environment variable
[?25l:  [?12l[?25h    let test_cases += [['$NON_ENV_VAR', 0]]
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Valid internal function
[?25l:  [?12l[?25h    let test_cases += [['*bufnr', 1]]
[?25l:  [?12l[?25h    " Valid internal function with ()
[?25l:  [?12l[?25h    let test_cases += [['*bufnr()', 1]]
[?25l:  [?12l[?25h    " Non-existing internal function
[?25l:  [?12l[?25h    let test_cases += [['*myxyzfunc', 0]]
[?25l:  [?12l[?25h    " Valid internal function with garbage
[?25l:  [?12l[?25h    let test_cases += [['*bufnr&6', 0]]
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Valid user defined function
[?25l:  [?12l[?25h    let test_cases += [['*TestExists', 1]]
[?25l:  [?12l[?25h    " Non-existing user defined function
[?25l:  [?12l[?25h    let test_cases += [['*MyxyzFunc', 0]]
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    redir! > test.out
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    for [test_case, result] in test_cases
[?25l:    [?12l[?25h      [34m^I[mecho test_case . ": " . result
[?25l:    [?12l[?25h        call RunTest(test_case, result)
[?25l:    [?12l[?25h    endfor
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Valid internal command (full match)
[?25l:  [?12l[?25h    echo ':edit: 2'
[?25l:  [?12l[?25h    if exists(':edit') == 2
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Valid internal command (full match) with garbage
[?25l:  [?12l[?25h    echo ':edit/a: 0'
[?25l:  [?12l[?25h    if exists(':edit/a') == 0
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Valid internal command (partial match)
[?25l:  [?12l[?25h    echo ':q: 1'
[?25l:  [?12l[?25h    if exists(':q') == 1
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing internal command
[?25l:  [?12l[?25h    echo ':invalidcmd: 0'
[?25l:  [?12l[?25h    if !exists(':invalidcmd')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " User defined command (full match)
[?25l:  [?12l[?25h    command! MyCmd :echo 'My command'
[?25l:  [?12l[?25h    echo ':MyCmd: 2'
[?25l:  [?12l[?25h    if exists(':MyCmd') == 2
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " User defined command (partial match)
[?25l:  [?12l[?25h    command! MyOtherCmd :echo 'Another command'
[?25l:  [?12l[?25h    echo ':My: 3'
[?25l:  [?12l[?25h    if exists(':My') == 3
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Command modifier
[?25l:  [?12l[?25h    echo ':rightbelow: 2'
[?25l:  [?12l[?25h    if exists(':rightbelow') == 2
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing user defined command (full match)
[?25l:  [?12l[?25h    delcommand MyCmd
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    echo ':MyCmd: 0'
[?25l:  [?12l[?25h    if !exists(':MyCmd')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing user defined command (partial match)
[?25l:  [?12l[?25h    delcommand MyOtherCmd
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    echo ':My: 0'
[?25l:  [?12l[?25h    if !exists(':My')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Valid local variable
[?25l:  [?12l[?25h    let local_var = 1
[?25l:  [?12l[?25h    echo 'local_var: 1'
[?25l:  [?12l[?25h    if exists('local_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Valid local variable with garbage
[?25l:  [?12l[?25h    let local_var = 1
[?25l:  [?12l[?25h    echo 'local_var%n: 0'
[?25l:  [?12l[?25h    if !exists('local_var%n')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing local variable
[?25l:  [?12l[?25h    unlet local_var
[?25l:  [?12l[?25h    echo 'local_var: 0'
[?25l:  [?12l[?25h    if !exists('local_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Valid local list
[?25l:  [?12l[?25h    let local_list = ["blue", "orange"]
[?25l:  [?12l[?25h    echo 'local_list: 1'
[?25l:  [?12l[?25h    if exists('local_list')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Valid local list item
[?25l:  [?12l[?25h    echo 'local_list[1]: 1'
[?25l:  [?12l[?25h    if exists('local_list[1]')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Valid local list item with garbage
[?25l:  [?12l[?25h    echo 'local_list[1]+5: 0'
[?25l:  [?12l[?25h    if !exists('local_list[1]+5')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Invalid local list item
[?25l:  [?12l[?25h    echo 'local_list[2]: 0'
[?25l:  [?12l[?25h    if !exists('local_list[2]')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing local list
[?25l:  [?12l[?25h    unlet local_list
[?25l:  [?12l[?25h    echo 'local_list: 0'
[?25l:  [?12l[?25h    if !exists('local_list')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Valid local dictionary
[?25l:  [?12l[?25h    let local_dict = {"xcord":100, "ycord":2}
[?25l:  [?12l[?25h    echo 'local_dict: 1'
[?25l:  [?12l[?25h    if exists('local_dict')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing local dictionary
[?25l:  [?12l[?25h    unlet local_dict
[?25l:  [?12l[?25h    echo 'local_dict: 0'
[?25l:  [?12l[?25h    if !exists('local_dict')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing local curly-brace variable
[?25l:  [?12l[?25h    let str = "local"
[?25l:  [?12l[?25h    let curly_{str}_var = 1
[?25l:  [?12l[?25h    echo 'curly_' . str . '_var: 1'
[?25l:  [?12l[?25h    if exists('curly_{str}_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing local curly-brace variable
[?25l:  [?12l[?25h    unlet curly_{str}_var
[?25l:  [?12l[?25h    echo 'curly_' . str . '_var: 0'
[?25l:  [?12l[?25h    if !exists('curly_{str}_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing global variable
[?25l:  [?12l[?25h    let g:global_var = 1
[?25l:  [?12l[?25h    echo 'g:global_var: 1'
[?25l:  [?12l[?25h    if exists('g:global_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing global variable with garbage
[?25l:  [?12l[?25h    echo 'g:global_var-n: 1'
[?25l:  [?12l[?25h    if !exists('g:global_var-n')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing global variable
[?25l:  [?12l[?25h    unlet g:global_var
[?25l:  [?12l[?25h    echo 'g:global_var: 0'
[?25l:  [?12l[?25h    if !exists('g:global_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing global list
[?25l:  [?12l[?25h    let g:global_list = ["blue", "orange"]
[?25l:  [?12l[?25h    echo 'g:global_list: 1'
[?25l:  [?12l[?25h    if exists('g:global_list')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing global list
[?25l:  [?12l[?25h    unlet g:global_list
[?25l:  [?12l[?25h    echo 'g:global_list: 0'
[?25l:  [?12l[?25h    if !exists('g:global_list')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing global dictionary
[?25l:  [?12l[?25h    let g:global_dict = {"xcord":100, "ycord":2}
[?25l:  [?12l[?25h    echo 'g:global_dict: 1'
[?25l:  [?12l[?25h    if exists('g:global_dict')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing global dictionary
[?25l:  [?12l[?25h    unlet g:global_dict
[?25l:  [?12l[?25h    echo 'g:global_dict: 0'
[?25l:  [?12l[?25h    if !exists('g:global_dict')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing global curly-brace variable
[?25l:  [?12l[?25h    let str = "global"
[?25l:  [?12l[?25h    let g:curly_{str}_var = 1
[?25l:  [?12l[?25h    echo 'g:curly_' . str . '_var: 1'
[?25l:  [?12l[?25h    if exists('g:curly_{str}_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing global curly-brace variable
[?25l:  [?12l[?25h    unlet g:curly_{str}_var
[?25l:  [?12l[?25h    echo 'g:curly_' . str . '_var: 0'
[?25l:  [?12l[?25h    if !exists('g:curly_{str}_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing window variable
[?25l:  [?12l[?25h    echo 'w:window_var: 1'
[?25l:  [?12l[?25h    let w:window_var = 1
[?25l:  [?12l[?25h    if exists('w:window_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing window variable
[?25l:  [?12l[?25h    unlet w:window_var
[?25l:  [?12l[?25h    echo 'w:window_var: 0'
[?25l:  [?12l[?25h    if !exists('w:window_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing window list
[?25l:  [?12l[?25h    let w:window_list = ["blue", "orange"]
[?25l:  [?12l[?25h    echo 'w:window_list: 1'
[?25l:  [?12l[?25h    if exists('w:window_list')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing window list
[?25l:  [?12l[?25h    unlet w:window_list
[?25l:  [?12l[?25h    echo 'w:window_list: 0'
[?25l:  [?12l[?25h    if !exists('w:window_list')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing window dictionary
[?25l:  [?12l[?25h    let w:window_dict = {"xcord":100, "ycord":2}
[?25l:  [?12l[?25h    echo 'w:window_dict: 1'
[?25l:  [?12l[?25h    if exists('w:window_dict')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing window dictionary
[?25l:  [?12l[?25h    unlet w:window_dict
[?25l:  [?12l[?25h    echo 'w:window_dict: 0'
[?25l:  [?12l[?25h    if !exists('w:window_dict')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing window curly-brace variable
[?25l:  [?12l[?25h    let str = "window"
[?25l:  [?12l[?25h    let w:curly_{str}_var = 1
[?25l:  [?12l[?25h    echo 'w:curly_' . str . '_var: 1'
[?25l:  [?12l[?25h    if exists('w:curly_{str}_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing window curly-brace variable
[?25l:  [?12l[?25h    unlet w:curly_{str}_var
[?25l:  [?12l[?25h    echo 'w:curly_' . str . '_var: 0'
[?25l:  [?12l[?25h    if !exists('w:curly_{str}_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing buffer variable
[?25l:  [?12l[?25h    echo 'b:buffer_var: 1'
[?25l:  [?12l[?25h    let b:buffer_var = 1
[?25l:  [?12l[?25h    if exists('b:buffer_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing buffer variable
[?25l:  [?12l[?25h    unlet b:buffer_var
[?25l:  [?12l[?25h    echo 'b:buffer_var: 0'
[?25l:  [?12l[?25h    if !exists('b:buffer_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing buffer list
[?25l:  [?12l[?25h    let b:buffer_list = ["blue", "orange"]
[?25l:  [?12l[?25h    echo 'b:buffer_list: 1'
[?25l:  [?12l[?25h    if exists('b:buffer_list')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing buffer list
[?25l:  [?12l[?25h    unlet b:buffer_list
[?25l:  [?12l[?25h    echo 'b:buffer_list: 0'
[?25l:  [?12l[?25h    if !exists('b:buffer_list')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing buffer dictionary
[?25l:  [?12l[?25h    let b:buffer_dict = {"xcord":100, "ycord":2}
[?25l:  [?12l[?25h    echo 'b:buffer_dict: 1'
[?25l:  [?12l[?25h    if exists('b:buffer_dict')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing buffer dictionary
[?25l:  [?12l[?25h    unlet b:buffer_dict
[?25l:  [?12l[?25h    echo 'b:buffer_dict: 0'
[?25l:  [?12l[?25h    if !exists('b:buffer_dict')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing buffer curly-brace variable
[?25l:  [?12l[?25h    let str = "buffer"
[?25l:  [?12l[?25h    let b:curly_{str}_var = 1
[?25l:  [?12l[?25h    echo 'b:curly_' . str . '_var: 1'
[?25l:  [?12l[?25h    if exists('b:curly_{str}_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing buffer curly-brace variable
[?25l:  [?12l[?25h    unlet b:curly_{str}_var
[?25l:  [?12l[?25h    echo 'b:curly_' . str . '_var: 0'
[?25l:  [?12l[?25h    if !exists('b:curly_{str}_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Script-local tests
[?25l:  [?12l[?25h    source test60.vim
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Existing Vim internal variable
[?25l:  [?12l[?25h    echo 'v:version: 1'
[?25l:  [?12l[?25h    if exists('v:version')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Non-existing Vim internal variable
[?25l:  [?12l[?25h    echo 'v:non_exists_var: 0'
[?25l:  [?12l[?25h    if !exists('v:non_exists_var')
[?25l:    [?12l[?25h[34m^I[mecho "OK"
[?25l:    [?12l[?25h    else
[?25l:    [?12l[?25h[34m^I[mecho "FAILED"
[?25l:    [?12l[?25h    endif
[?25l:  [?12l[?25h
[?25l:  [?12l[?25h    " Function arguments
[?25l:  [?12l[?25h    function TestFuncArg(func_arg, ...)
[?25l:    [?12l[?25h        echo 'a:func_arg: 1'
[?25l:    [?12l[?25h        if exists('a:func_arg')
[?25l:      [?12l[?25h            echo "OK"
[?25l:      [?12l[?25h        else
[?25l:      [?12l[?25h            echo "FAILED"
[?25l:      [?12l[?25h        endif
[?25l:    [?12l[?25h
[?25l:    [?12l[?25h        echo 'a:non_exists_arg: 0'
[?25l:    [?12l[?25h        if !exists('a:non_exists_arg')
[?25l:      [?12l[?25h            echo "OK"
[?25l:      [?12l[?25h        else
[?25l:      [?12l[?25h            echo "FAILED"
[?25l:      [?12l[?25h        endif
[?25l:    [?12l[?25h
[?25l:    [?12l[?25h        echo 'a:1: 1'
[?25l:    [?12l[?25h        if exists('a:1')
[?25l:      [?12l[?25h            echo "OK"
[?25l:      [?12l[?25h        else
[?25l:      [?12l[?25h            echo "FAILED"
[?25l:      [?12l[?25h        endif
[?25l:    [?12l[?25h
[?25l:    [?12l[?25h        echo 'a:2: 0'
[?25l:    [?12l[?25h        if !exists('a:2')
[?25l:      [?12l[?25h            echo "OK"
[?25l:      [?12l[?25h        else
[?25l:      [?12l[?25h            echo "FAILED"
[?25l:      [?12l[?25h        endif
[?25l:    [?12l[?25h    endfunction
[?25l:    [?12l[?25h
[?25l:    [?12l[?25h    call TestFuncArg("arg1", "arg2")
[?25l:    [?12l[?25h
[?25l:    [?12l[?25h    redir END
[?25l:    [?12l[?25hendfunction[27m[m[H[2J[?25l[1;9Hendif[3;9Hecho 'a:2: 0'[4;9Hif !exists('a:2')[5;13Hecho "OK"[6;9Helse[7;13Hecho "FAILED"[8;9Hendif
    endfunction[11;5Hcall TestFuncArg("arg1", "arg2")[13;5Hredir END
endfunction
:call TestExists()
:edit! test.out
:set ff=unix
:w
:qa!
ENDTEST
[?12l[?25h[?25l
:[?12l[?25hcall TestExists()[?25l#myagroup: 1[22;13H[K[22;1H
OK
#myagroup+b: 0
OK
#myagroup#BufEnter: 1
OK
#myagroup#BufEnter#*.my: 1
OK
#BufEnter: 1
OK
#BufEnter#*.my: 1
OK
#xyzagroup: 0
OK
#xyzagroup#BufEnter: 0
OK
#myagroup#CmdwinEnter: 0
OK
#myagroup#xyzacmd: 0
OK
#myagroup#BufEnter#xyzpat: 0
OK
#BufEnter#xyzpat: 0
OK
###: 0
OK
##: 0
OK
##FileReadCmd: 1
OK
##MySpecialCmd: 0
OK
&textwidth: 1
OK
&tw: 1
OK
&tw-: 0
OK
&g:errorformat: 1
OK
&l:errorformat: 1
OK
&nojoinspaces: 0
OK
&nojs: 0
OK
&myxyzoption: 0
OK
+incsearch: 1
OK
+incsearch!1: 0
OK
+is: 1
OK
+autoprint: 0
OK
$EDITOR_NAME: 1
OK
$NON_ENV_VAR: 0
OK
*bufnr: 1
OK
*bufnr(): 1
OK
*myxyzfunc: 0
OK
*bufnr&6: 0
OK
*TestExists: 1
OK
*MyxyzFunc: 0
OK
:edit: 2
OK
:edit/a: 0
OK
:q: 1
OK
:invalidcmd: 0
OK
:MyCmd: 2
OK
:My: 3
OK
:rightbelow: 2
OK
:MyCmd: 0
OK
:My: 0
OK
local_var: 1
OK
local_var%n: 0
OK
local_var: 0
OK
local_list: 1
OK
local_list[1]: 1
OK
local_list[1]+5: 0
OK
local_list[2]: 0
OK
local_list: 0
OK
local_dict: 1
OK
local_dict: 0
OK
curly_local_var: 1
OK
curly_local_var: 0
OK
g:global_var: 1
OK
g:global_var-n: 1
OK
g:global_var: 0
OK
g:global_list: 1
OK
g:global_list: 0
OK
g:global_dict: 1
OK
g:global_dict: 0
OK
g:curly_global_var: 1
OK
g:curly_global_var: 0
OK
w:window_var: 1
OK
w:window_var: 0
OK
w:window_list: 1
OK
w:window_list: 0
OK
w:window_dict: 1
OK
w:window_dict: 0
OK
w:curly_window_var: 1
OK
w:curly_window_var: 0
OK
b:buffer_var: 1
OK
b:buffer_var: 0
OK
b:buffer_list: 1
OK
b:buffer_list: 0
OK
b:buffer_dict: 1
OK
b:buffer_dict: 0
OK
b:curly_buffer_var: 1
OK
b:curly_buffer_var: 0
OK
s:script_var: 1
OK
s:script_var: 0
OK
s:script_list: 1
OK
s:script_list: 0
OK
s:script_dict: 1
OK
s:script_dict: 0
OK
s:curly_script_var: 1
OK
s:curly_script_var: 0
OK
*s:my_script_func: 1
OK
*s:my_script_func: 0
OK
v:version: 1
OK
v:non_exists_var: 0
OK
a:func_arg: 1
OK
a:non_exists_arg: 0
OK
a:1: 1
OK
a:2: 0
OK
[32mPress ENTER or type command to continue[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hedit! test.out[?25l"test.out" [22;12H[K[22;12H[Incomplete last line] 197 lines, 1844 characters[27m[m[H[2J[2;1H#myagroup: 1
OK
#myagroup+b: 0
OK
#myagroup#BufEnter: 1
OK
#myagroup#BufEnter#*.my: 1
OK
#BufEnter: 1
OK
#BufEnter#*.my: 1
OK
#xyzagroup: 0
OK
#xyzagroup#BufEnter: 0
OK
#myagroup#CmdwinEnter: 0
OK
#myagroup#xyzacmd: 0
OK
"test.out" [Incomplete last line] 197 lines, 1844 characters[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset ff=unix[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hw[?25l"test.out" 197 lines, 1845 characters written[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test61.failed test.ok test.out X* viminfo
cp test61.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test61.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test61.in" 59 lines, 1011 characters[1;1HTests for undo tree.
Since this script is sourced we need to explicitly break changes up in
undo-able pieces.  Do that by setting 'undolevels'.

STARTTEST
:" Delete three characters and undo
Gx:set ul=100
x:set ul=100
x:.w! test.out
g-:.w >>test.out
g-:.w >>test.out
g-:.w >>test.out
g-:.w >>test.out
:"
:/^111/w >>test.out
:" Delete three other characters and go back in time step by step
$x:set ul=100
x:set ul=100
x:.w >>test.out
:sleep 1
g-:.w >>test.out[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for undo tree.[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[5;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[6;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 48 lines, 814 characters written[6;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[6;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[27m[m[H[2J[1;1H:.w >>test.out
:ear 3s
:.w >>test.out
:later 1s
:.w >>test.out
:later 1h
:.w >>test.out
:"
:" test undojoin
Goaaaa[34m^[[m:set ul=100
obbbb[34m^[[mu:.w >>test.out
obbbb[34m^[[m:set ul=100
:undojoin
occcc[34m^[[mu:.w >>test.out
:qa!
ENDTEST

1111 -----
2222 -----

123456789[16;1H[?12l[?25h
[?25l[22;1H:so! Xdotest[17;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" Delete three characters and undo[?25l[17;1H[?12l[?25h[21;1H[?25l23456789[21;9H[K[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset ul=100[?25l[21;1H[?12l[?25h[?25l3456789[21;8H[K[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset ul=100[?25l[21;1H[?12l[?25h[?25l456789[21;7H[K[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w! test.out[?25l"test.out" [22;12H[K[22;12H[New File] 1 line, 7 characters written[21;1H[?12l[?25h[?25l
1 change; before #3  0 seconds ago[22;35H[K[21;1H3456789[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 8 characters appended[21;1H[?12l[?25h[?25l
1 change; before #2  0 seconds ago[22;35H[K[21;1H23456789[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 9 characters appended[21;1H[?12l[?25h[?25l
1 change; before #1  0 seconds ago[22;35H[K[21;1H123456789[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 10 characters appended[21;1H[?12l[?25h[?25l
Already at oldest change[22;25H[K[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 10 characters appended[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^111/w >>test.out[?25l[31msearch hit BOTTOM, continuing at TOP[m"test.out" [22;12H[K[22;12H1 line, 11 characters appended[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" Delete three other characters and go back in time step by step[?25l[21;1H[?12l[?25h[8C[?25l[21;9H[K[21;8H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset ul=100[?25l[21;8H[?12l[?25h[?25l[21;8H[K[21;7H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset ul=100[?25l[21;7H[?12l[?25h[?25l[21;7H[K[21;6H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 7 characters appended[21;6H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hsleep 1[?25l[21;6H[?12l[?25h[?25l
1 change; before #6  1 seconds ago[21;7H7[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 8 characters appended[21;7H[?12l[?25h[?25l
1 change; before #5  1 seconds ago[22;35H[K[21;8H8[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 9 characters appended[21;8H[?12l[?25h[?25l
4 changes; after #3  1 seconds ago[22;35H[K[21;1H456789[21;7H[K[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 7 characters appended[21;1H[?12l[?25h[?25l
1 change; before #3  1 seconds ago[22;35H[K[21;1H3456789[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 8 characters appended[21;1H[?12l[?25h[?25l
1 change; before #2  1 seconds ago[22;35H[K[21;1H23456789[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 9 characters appended[21;1H[?12l[?25h[?25l
1 change; before #1  1 seconds ago[22;35H[K[21;1H123456789[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 10 characters appended[21;1H[?12l[?25h[?25l
Already at oldest change[22;25H[K[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 10 characters appended[21;1H[?12l[?25h[?25l
Already at oldest change[22;25H[K[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 10 characters appended[21;1H[?12l[?25h[?25l
3 changes; after #6  1 seconds ago[22;35H[K[21;7H[K[21;6H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 7 characters appended[21;6H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[21;6H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^222/w >>test.out[?25l[31msearch hit BOTTOM, continuing at TOP[m"test.out" [22;12H[K[22;12H1 line, 11 characters appended[21;6H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" Delay for three seconds and go some seconds forward and backward[?25l[21;6H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hsleep 2[?25l[21;6H[?12l[?25h[?25l6a[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset ul=100[?25l[21;7H[?12l[?25h[?25lab[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset ul=100[?25l[21;8H[?12l[?25h[?25lbc[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset ul=100[?25l[21;9H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 10 characters appended[21;9H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hear 1s[?25l3 changes; before #7  0 seconds ago[21;7H[K[21;6H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 7 characters appended[21;6H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hear 3s[?25l3 changes; before #1  3 seconds ago[21;7H789[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 10 characters appended[21;9H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hlater 1s[?25l3 changes; after #6  3 seconds ago[21;7H[K[21;6H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 7 characters appended[21;6H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hlater 1h[?25l3 changes; after #9  0 seconds ago[21;7Habc[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 10 characters appended[21;9H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[21;9H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" test undojoin[?25l[21;9H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Haaaa[22;1H[K[21;4H[?12l[?25h[?25l
:[?12l[?25hset ul=100[?25l[21;4H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hbbbb[22;1H[K[21;4H[?12l[?25h[?25l
1 line less; before #11  0 seconds ago[21;1H[1m[34m~                                                                               [20;4H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 5 characters appended[20;4H[?12l[?25h[?25l
bbbb[21;5H[K[21;4H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset ul=100[?25l[21;4H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hundojoin[?25l[21;4H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1Hcccc[22;1H[K[21;4H[?12l[?25h[?25l
2 fewer lines; before #12  0 seconds ago[20;1H[1m[34m~                                                                               [21;1H~                                                                               [19;4H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25h.w >>test.out[?25l"test.out" [22;12H[K[22;12H1 line, 5 characters appended[19;4H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo
rm -rf test62.failed test.ok test.out X* viminfo
cp test62.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test62.in
Vim: Warning: Output is not to a terminal
[?1049h[?1h=[1;22r[?12;25h[?12l[?25h[27m[m[H[2J[?25l[22;1H"test62.in" 32 lines, 522 characters[1;1HTests for tab pages

STARTTEST
:so small.vim
:" Simple test for opening and closing a tab page
:tabnew
:let nr = tabpagenr()
:q
:call append(line('$'), 'tab page ' . nr)
:"
:" Open three tab pages and use ":tabdo"
:0tabnew
:1tabnew
:888tabnew
:tabdo call append(line('$'), 'this is tab page ' . tabpagenr())
:tabclose! 2
:tabrewind
:let line1 = getline('$')
:undo
:q
:tablast[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hset cp[?25l[1;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hmap dotest /^STARTTEST^[34m^M[mj:set ff=unix cpo-=A^[34m^M[m:.,/ENDTEST/-1w! Xdotest^[34m^M[m:set f
[21;80Hf[22;1H& cpo+=A^[34m^M[mnj0:so! Xdotest^[34m^M[mdotest[?25l[1;1H[L[1;1HTests for tab pages[22;1H[K[1;1H[?12l[?25h[?25l[22;1H/^STARTTEST[3;1H[?12l[?25h
[?25l[22;1H[K[22;1H:set ff=unix cpo-=A[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [22;11H[K[22;11H[New File] 26 lines, 473 characters written[4;1H[?12l[?25h[?25l[22;1H[K[22;1H:set ff& cpo+=A[4;1H[?12l[?25h[?25l[22;1H/ENDTEST[22;10H[K[22;1H[1;21r[1;1H[9M[1;22r[13;1H:let line2 = getline('$')
:q!
:call append(line('$'), line1)
:call append(line('$'), line2)
:"
:"
:/^Results/,$w! test.out
:qa!
ENDTEST[22;1H[K[21;1H[?12l[?25h[?25l[1;21r[21;1H
[1;22r[21;1H[?12l[?25h[?25l
:so! Xdotest[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hso small.vim[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" Simple test for opening and closing a tab page[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25htabnew[?25l[27m[m[H[2J[1;1H[4m[30m[47m test62.in [m[1m [No Name] [m[7m                                                          [m[1;80H[4m[30m[47mX[m[3;1H[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [2;1H[?12l[?25h[?25l[22;1H[m:[?12l[?25hlet nr = tabpagenr()[?25l[2;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hq[?25l[27m[m[H[2J[1;1H:" Open three tab pages and use ":tabdo"
:0tabnew
:1tabnew
:888tabnew
:tabdo call append(line('$'), 'this is tab page ' . tabpagenr())
:tabclose! 2
:tabrewind
:let line1 = getline('$')
:undo
:q
:tablast
:let line2 = getline('$')
:q!
:call append(line('$'), line1)
:call append(line('$'), line2)
:"
:"
:/^Results/,$w! test.out
:qa!
ENDTEST
[?12l[?25h[?25l
:[?12l[?25hcall append(line('$'), 'tab page ' . nr)[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h" Open three tab pages and use ":tabdo"[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h0tabnew[?25l[27m[m[H[2J[1;1H[1m [No Name] [m[4m[30m[47m + test62.in [m[7m                                                        [m[1;80H[4m[30m[47mX[m[3;1H[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [2;1H[?12l[?25h[?25l[22;1H[m:[?12l[?25h1tabnew[?25l[27m[m[H[2J[1;1H[4m[30m[47m [No Name] [m[1m [No Name] [m[4m[30m[47m + test62.in [m[7m                                             [m[1;80H[4m[30m[47mX[m[3;1H[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [2;1H[?12l[?25h[?25l[22;1H[m:[?12l[?25h888tabnew[?25l[27m[m[H[2J[1;1H[4m[30m[47m [No Name]  [No Name]  + test62.in [m[1m [No Name] [m[7m                                  [m[1;80H[4m[30m[47mX[m[3;1H[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [2;1H[?12l[?25h[?25l[22;1H[m:[?12l[?25htabdo call append(line('$'), 'this is tab page ' . tabpagenr())[?25l[27m[m[H[2J[1;1H[4m[30m[47m + [No Name]  + [No Name]  + test62.in [m[1m + [No Name] [m[7m                            [m[1;80H[4m[30m[47mX[m[3;1Hthis is tab page 4
[1m[34m~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [2;1H[?12l[?25h[?25l[22;1H[m:[?12l[?25htabclose! 2[?25l[1;17H[4m[30m[47mtest62.in[m[1C[1m + [No Name] [m[7m             [27C [m[1;80H[4m[30m[47mX[2;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25htabrewind[?25l[27m[m[H[2J[1;1H[1m + [No Name] [m[4m[30m[47m + test62.in  + [No Name] [m[7m                                         [m[1;80H[4m[30m[47mX[m[3;1Hthis is tab page 1
[1m[34m~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [2;1H[?12l[?25h[?25l[22;1H[m:[?12l[?25hlet line1 = getline('$')[?25l[2;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hundo[?25l2 fewer lines; before #1  0 seconds ago[1;2H[1m[No Name] [m[4m[30m[47m + test62.in  + [No Name] [m[7m  [40C [m[1;80H[4m[30m[47mX[m[3;1H[1m[34m~                                                                               [2;1H[?12l[?25h[?25l[m[22;1H[K[22;1H:[?12l[?25hq[?25l[27m[m[H[2J[1;1H[1m + test62.in [m[4m[30m[47m + [No Name] [m[7m                                                      [m[1;80H[4m[30m[47mX[m[2;1H:0tabnew
:1tabnew
:888tabnew
:tabdo call append(line('$'), 'this is tab page ' . tabpagenr())
:tabclose! 2
:tabrewind
:let line1 = getline('$')
:undo
:q
:tablast
:let line2 = getline('$')
:q!
:call append(line('$'), line1)
:call append(line('$'), line2)
:"
:"
:/^Results/,$w! test.out
:qa!
ENDTEST
[?12l[?25h[?25l
:[?12l[?25htablast[?25l[27m[m[H[2J[1;1H[4m[30m[47m + test62.in [m[1m + [No Name] [m[7m                                                      [m[1;80H[4m[30m[47mX[m[3;1Hthis is tab page 4
[1m[34m~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [2;1H[?12l[?25h[?25l[22;1H[m:[?12l[?25hlet line2 = getline('$')[?25l[2;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hq![?25l[27m[m[H[2J[1;1H:" Open three tab pages and use ":tabdo"
:0tabnew
:1tabnew
:888tabnew
:tabdo call append(line('$'), 'this is tab page ' . tabpagenr())
:tabclose! 2
:tabrewind
:let line1 = getline('$')
:undo
:q
:tablast
:let line2 = getline('$')
:q!
:call append(line('$'), line1)
:call append(line('$'), line2)
:"
:"
:/^Results/,$w! test.out
:qa!
ENDTEST
[?12l[?25h[?25l
:[?12l[?25hcall append(line('$'), line1)[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hcall append(line('$'), line2)[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h"[?25l[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25h/^Results/,$w! test.out[?25l"test.out" [22;12H[K[22;12H[New File] 5 lines, 77 characters written[21;1H[?12l[?25h[?25l[22;1H[K[22;1H:[?12l[?25hqa![?25l[22;1H[K[22;1H[?1l>[?12l[?25h[?1049lrm -rf X* test.ok viminfo

Test results:
test3 FAILED
ALL DONE
make[3]: Leaving directory `/sources/vim71/src/testdir'
make[2]: Leaving directory `/sources/vim71/src'
make[1]: Leaving directory `/sources/vim71'
