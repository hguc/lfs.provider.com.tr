
Fri Aug 25 01:44:45 EEST 2006

Starting make in the src directory.
If there are problems, cd to the src directory and run make there
cd src && make test
make[1]: Entering directory `/sources/vim70/src'
make -f Makefile vim
make[2]: Entering directory `/sources/vim70/src'
make[2]: `vim' is up to date.
make[2]: Leaving directory `/sources/vim70/src'
if test -n "" -a -f po/Makefile; then \
	cd po; make -f Makefile check VIM=../vim; \
fi
if test vim != vim -a ! -e vim; then \
	ln -s vim vim; \
fi
cd testdir; make -f Makefile  VIMPROG=../vim 
make[2]: Entering directory `/sources/vim70/src/testdir'
echo Test results: >test.log
rm -f test1.failed tiny.vim small.vim mbyte.vim test.ok X* viminfo
../vim -u unix.vim -U NONE --noplugin -s dotest.in test1.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test1.in" 40 lines, 1465 characters[2;1HFirst a simple test to check if the test script works.

If Vim was not compiled with the +eval feature, the small.vim script will be
set to copy the test.ok file to test.out, so that it looks like the test
succeeded.  Otherwise an empty small.vim is written.  small.vim is sourced by
tests that require the +eval feature or other features that are missing in the
small version.

If Vim was not compiled with the +windows feature, the tiny.vim script will be
set like small.vim above.  tiny.vim is sourced by tests that require the
+windows feature or other features that are missing in the tiny version.

If Vim was not compiled with the +multi_byte feature, the mbyte.vim script will be set like small.vim above.  mbyte.vim is sourr[15;1Hced by tests that require the
+multi_byte feature.

STARTTEST
:" Write a single line to test.out to check if testing works at all.
:%d
athis is a test[1m^[[m:w! test.out
:" Create small.vim and tiny.vim empty, create mbyte.vim to skip the test.
0D:w! small.vim
:w! tiny.vim
ae! test.ok
w! test.out
qa!
[1m^[[m:w! mbyte.vim
:" If +multi_byte feature supported, make mbyte.vim empty.
:if has("multi_byte") | sp another | w! mbyte.vim | q | endif
:" If +eval feature supported quit here, leaving tiny.vim and small.vim empty.
:" Otherwise write small.vim to skip the test.
:if 1 | q! | endif
:w! small.vim
:" If +windows feature not supported :sp will fail and tiny.vim will be
:" written to skip the test.
:sp another
:wq! tiny.vim
:qa!
ENDTEST

[1m~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[18;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[19;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 21 lines, 661 characters written[19;1H[47;1H[K[47;1H:set ff& cpo+=A[19;1H[47;1H/ENDTEST[47;10H[K[47;1H[40;1H
[47;1H[K[47;1H:so! Xdotest[41;1H[47;1H[K[47;1H:" Write a single line to test.out to check if testing works at all.[41;1H[47;1H[K[47;1H:%d[2;2H[K[2;1H[1m~
~[m[4;2H[K[4;1H[1m~[m[5;2H[K[5;1H[1m~[m[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~
~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~
~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~
~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;2H[K[37;1H[1m~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~
~[m[47;1H--No lines in buffer--[1;1Hthis is a test[47;1H[K[47;1H:w! test.out"test.out" [47;12H[K[47;12H[New File] 1 line, 15 characters written[1;14H[47;1H[K[47;1H:" Create small.vim and tiny.vim empty, create mbyte.vim to skip the test.[1;14H[1;1H[K[1;1H[47;1H[K[47;1H:w! small.vim"small.vim" [47;13H[K[47;13H[New File] 1 line, 1 character written[1;1H[47;1H[K[47;1H:w! tiny.vim"tiny.vim" [47;12H[K[47;12H[New File] 1 line, 1 character written[1;1He! test.ok
w! test.out
qa![4;1H[K[4;1H[47;1H[K[47;1H:w! mbyte.vim"mbyte.vim" [47;13H[K[47;13H[New File] 4 lines, 28 characters written[4;1H[47;1H[K[47;1H:" If +multi_byte feature supported, make mbyte.vim empty.[4;1H[47;1H[K[47;1H:if has("multi_byte") | sp another | w! mbyte.vim | q | endif"another" [New File][47;21H[K[47;1H
"mbyte.vim" 0 lines, 0 characters written[1;1H[L[1;1He! test.ok[47;1H[K[4;1H[47;1H:" If +eval feature supported quit here, leaving tiny.vim and small.vim empty.[4;1H[47;1H[K[47;1H:" Otherwise write small.vim to skip the test.[4;1H[47;1H[K[47;1H:if 1 | q! | endif[?1l>[47;1H[K[47;1Hrm -rf X* viminfo
rm -rf test2.failed test.ok test.out X* viminfo
cp test2.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test2.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test2.in" 29 lines, 717 characters[2;1HThis is a test if a URL is recognized by "gf", with the cursor before and
after the "://".  Also test ":\\".

STARTTEST
:so small.vim
/^first
/tmp
:call append(0, expand("<cfile>"))
/^second
/URL
:call append(1, expand("<cfile>"))
:if has("ebcdic")
: set isf=@,240-249,/,.,-,_,+,,,$,:,~,\
:else
: set isf=@,48-57,/,.,-,_,+,,,$,:,~,\
:endif
/^third
/name
:call append(2, expand("<cfile>"))
/^fourth
/URL
:call append(3, expand("<cfile>"))
5GdG:wq! test.out
ENDTEST
first test for URL://machine.name/tmp/vimtest2a and other text
second test for URL://machine.name/tmp/vimtest2b. And other text
third test for URL:\\machine.name\vimtest2c and other text
fourth test for URL:\\machine.name\tmp\vimtest2d, and other text
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[5;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[6;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 19 lines, 336 characters written[6;1H[47;1H[K[47;1H:set ff& cpo+=A[6;1H[47;1H/ENDTEST[47;10H[K[47;1H[25;1H
[47;1H[K[47;1H:so! Xdotest[26;1H[47;1H[K[47;1H:so small.vim[26;1H[47;1H[K[47;1H/^first[7msearch hit BOTTOM, continuing at TOP[26;1H[m[47;1H[K[47;1H/tmp[26;35H[47;1H[K[47;1H:call append(0, expand("<cfile>"))[1;46r[1;1H[L[1;47r[1;1HURL://machine.name/tmp/vimtest2a[47;1H[K[27;35H[47;1H/^second[28;1H[47;1H[K[47;1H/URL[28;17H[47;1H[K[47;1H:call append(1, expand("<cfile>"))[2;46r[2;1H[L[1;47r[2;1HURL://machine.name/tmp/vimtest2b[47;1H[K[29;17H[47;1H:if has("ebcdic")
:  : set isf=@,240-249,/,.,-,_,+,,,$,:,~,\
:  :else
:  : set isf=@,48-57,/,.,-,_,+,,,$,:,~,\
:  :endif[1;1H[4L[1;1HURL://machine.name/tmp/vimtest2a
URL://machine.name/tmp/vimtest2b

This is a test if a URL is recognized by "gf", with the cursor before and[47;1H[K[29;17H[47;1H/^third[30;1H[47;1H[K[47;1H/name[30;30H[47;1H[K[47;1H:call append(2, expand("<cfile>"))[3;46r[3;1H[L[1;47r[3;1HURL:\\machine.name\vimtest2c[47;1H[K[31;30H[47;1H/^fourth[32;1H[47;1H[K[47;1H/URL[32;17H[47;1H[K[47;1H:call append(3, expand("<cfile>"))[4;46r[4;1H[L[1;47r[4;1HURL:\\machine.name\tmp\vimtest2d[47;1H[K[33;17H[5;1H[47;1H29 fewer lines[5;1H[1m~[m[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~
~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;3H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;3H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~[m[33;2H[K[33;1H[1m~[4;1H[m[47;1H[K[47;1H:wq! test.out"test.out" [47;12H[K[47;12H[New File] 4 lines, 128 characters written[?1l>
rm -rf X* test.ok viminfo
rm -rf test3.failed test.ok test.out X* viminfo
cp test3.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test3.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test3.in" 1320 lines, 13734 characters[1;1H/* vim: set cin ts=4 sw=4 : */

Test for 'cindent'

STARTTEST
:so small.vim
:set nocompatible viminfo+=nviminfo
:edit[16C" read modeline
/start of AUTO
=/end of AUTO
ENDTEST

/* start of AUTO matically checked vim: set ts=4 : */
{[15;9Hif (test)[16;17Hcmd1;[17;9Hcmd2;
}

{[21;9Hif (test)[22;17Hcmd1;[23;9Helse[24;17Hcmd2;
}

{[28;9Hif (test)[29;9H{[30;17Hcmd1;[31;17Hcmd2;[32;9H}
}

{[36;9Hif (test)[37;9H{[38;17Hcmd1;[39;17Helse[40;9H}
}

{[44;9Hwhile (this)[45;17Hif (test)[46;25Hcmd1;[1;1H[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[5;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[6;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 5 lines, 116 characters written[6;1H[47;1H[K[47;1H:set ff& cpo+=A[6;1H[47;1H/ENDTEST[47;10H[K[47;1H[11;1H
[47;1H[K[47;1H:so! Xdotest[12;1H[47;1H[K[47;1H:so small.vim[12;1H[47;1H[K[47;1H:set nocompatible viminfo+=nviminfo[12;1H[47;1H[K[47;1H:edit                " read modeline"test3.in"[47;22H[K[47;12H1320L, 13734C[15;5Hif (test)[15;14H[K[16;9Hcmd1;[16;17H[K[17;5Hcmd2;[17;10H[K[21;5Hif (test)[21;14H[K[22;9Hcmd1;[22;17H[K[23;5Helse[23;9H[K[24;9Hcmd2;[24;17H[K[28;5Hif (test)[28;14H[K[29;5H{[29;9H[K[30;9Hcmd1;[30;17H[K[31;9Hcmd2;[31;17H[K[32;5H}[32;9H[K[36;5Hif (test)[36;14H[K[37;5H{[37;9H[K[38;9Hcmd1;[38;17H[K[39;9Helse[39;17H[K[40;5H}[40;9H[K[44;5Hwhile (this)[44;17H[K[45;9Hif (test)[45;18H[K[46;13Hcmd1;[46;25H[K[12;1H[47;1H[K[47;1H/start of AUTO[13;4H[47;1H[K[47;1H/end of AUTO789 lines to indent...750065055045035025015050 lines to indent... 790 lines indented [47;20H[K[13;1H[47;1H[K[47;1H/^STARTTEST[m[H[2J[1;5H{[2;9Hcase 'c': if (cond)[3;19H{[4;19H}
    }
}

main()
{
    (void) MyFancyFuasdfadsfnction([11;13Hargument);
}

main()
{
    char    foo[] = "/*";
    /* as[18;8Hdf */
    hello
}
/* end of AUTO */

STARTTEST
:set tw=0 wm=60 columns=80 noai fo=croq
/serious/e
a about life, the universe, and the rest[1m^[[m
ENDTEST

{

/* this is
 * a real serious important big
 * comment
 */
    /* insert " about life, the universe, and the rest" after "serious" */
}

STARTTEST
:set nocin
/comments
joabout life[1m^[[m/happens
jothere[1m^[[m/below
oline[1m^[[m/this
Ohello[1m^[[m
ENDTEST[23;1H
[47;1H:set ff=unix cpo-=A[24;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H3L, 93C written[24;1H[47;1H[K[47;1H:set ff& cpo+=A[24;1H[47;1H/ENDTEST/+-1[47;13H[K[47;1H[26;1H
[47;1H[K[47;1H:so! Xdotest[27;1H[47;1H[K[47;1H:set tw=0 wm=60 columns=80 noai fo=croq[8;47;80t[m[H[2J[m[H[2J[1;5H{[2;9Hcase 'c': if (cond)[3;19H{[4;19H}
    }
}

main()
{
    (void) MyFancyFuasdfadsfnction([11;13Hargument);
}

main()
{
    char    foo[] = "/*";
    /* as[18;8Hdf */
    hello
}
/* end of AUTO */

STARTTEST
:set tw=0 wm=60 columns=80 noai fo=croq
/serious/e
a about life, the universe, and the rest[1m^[[m
ENDTEST

{

/* this is
 * a real serious important big
 * comment
 */
    /* insert " about life, the universe, and the rest" after "serious" */
}

STARTTEST
:set nocin
/comments
joabout life[1m^[[m/happens
jothere[1m^[[m/below
oline[1m^[[m/this
Ohello[1m^[[m
ENDTEST[27;1H[47;1H/serious/e[32;17H[47;1H[1m-- INSERT --[m[47;1H[K[33;46r[33;1H[3L[1;47r[32;19H[K[33;2H* about life, the
 * universe, and the
 * rest important big[35;7H[36;7H[47;1H/^STARTTEST[41;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[42;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H6L, 78C written[42;1H[47;1H[K[47;1H:set ff& cpo+=A[42;1H[47;1H/ENDTEST/+-1[47;13H[K[47;1H[1;46r[46;1H
[1;47r[46;1HOhello[1m^[[m[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1HENDTEST
:so! Xdotest[46;1H[47;1H[K[47;1H:set nocin[46;1H[47;1H[K[47;1H/comments[1;46r[1;1H[4M[1;47r[44;1H{
    /*[46;6H* Testing for comments, without 'cin' set[47;1H[K[46;20H[1;46r[46;1H
[1;47r[46;6H*/
[1m-- INSERT --[m[47;1H[K[1;46r[46;1H
[1;47r[46;1Habout life
/happens[1;46r[1;1H[3M[1;47r[45;1H/*
* what happens here?[47;1H[K[46;8H[1;46r[46;1H
[1;47r[46;1H*/
[1m-- INSERT --[m[47;1H[K[1;46r[46;1H
[1;47r[46;1Hthere
/below[1;46r[1;1H[3M[1;47r[45;5H/*[46;8Hthe end of the comment, try inserting a line below */[47;1H[K[46;53H
[1m-- INSERT --[m[47;1H[K[1;46r[46;1H
[1;47r[46;1Hline
/this[1;46r[1;1H[3M[1;47r[45;9H/* how about[46;25Hthis one */[47;1H[K[46;25H
[1m-- INSERT --[m[47;1H[K[46;1Hhello[46;25H[K[46;5H[1;46r[46;1H
[1;47r[46;25Hthis one */[46;8H
/^STARTTEST[1;46r[1;1H[3M[1;47r[44;1H}

STARTTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H:set cin
:set ff=unix cpo-=A[46;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H3L, 18C written[46;1H[47;1H[K[47;1H:set ff& cpo+=A[46;1H
/ENDTEST/+-1[47;13H[K[47;1H[1;46r[1;1H[2M[1;47r[45;1H/vec2
==[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1HENDTEST
:so! Xdotest[46;1H[47;1H[K[47;1H:set cin[46;1H[47;1H[K[47;1H/vec2[1;46r[1;1H[5M[1;47r[43;1H{
    var = this + that + vec[0] * vec[0][45;23H+ vec[1] * vec[1][46;23H+ vec2[2] * vec[2];[47;1H[K[46;25H[1;46r[46;1H
[1;47r[46;1H}
/^STARTTEST[1;46r[1;1H[2M[1;47r[46;1HSTARTTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H:set cin
:set ff=unix cpo-=A[46;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H5L, 51C written[46;1H[47;1H[K[47;1H:set ff& cpo+=A[46;1H
/ENDTEST/+-1[47;13H[K[47;1H[1;46r[1;1H[4M[1;47r[43;1H:set cino=}4
/testing1
k2==/testing2
k2==[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1HENDTEST
:so! Xdotest[46;1H[47;1H[K[47;1H:set cin[46;1H[47;1H[K[47;1H:set cino=}4[46;1H[47;1H[K[47;1H/testing1[1;46r[1;1H[8M[1;47r[40;1H{[41;9Hasdf asdflkajds f;
    if (tes & ting) {[43;9Hasdf asdf asdf ;[44;9Hasdfa sdf asdf;[45;9H}
    testing1;[47;1H[K[46;5H[45;8H 

/testing2[1;46r[1;1H[6M[1;47r[41;5Hif (tes & ting)
    {[43;9Hasdf asdf asdf ;[44;9Hasdfa sdf asdf;[45;9H}
    testing2;[47;1H[K[46;5H[45;8H [46;9H
/^STARTTEST[1;46r[1;1H[3M[1;47r[44;1H}

STARTTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H:set cin
:set ff=unix cpo-=A[46;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H4L, 36C written[46;1H[47;1H[K[47;1H:set ff& cpo+=A[46;1H
/ENDTEST/+-1[47;13H[K[47;1H[1;46r[1;1H[3M[1;47r[44;1H:set cino=(0,)20
/main
=][[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1HENDTEST
:so! Xdotest[46;1H[47;1H[K[47;1H:set cin[46;1H[47;1H[K[47;1H:set cino=(0,)20[46;1H[47;1H[K[47;1H/main[1;46r[1;1H[2M[1;47r[46;1Hmain ( int first_par, /*[47;1H[K[46;1H
19 lines to indent...20[7Cindented [47;19H[K[46;1H[1;46r[46;1H
[1;47r[46;24H* Comment for[47;1H[K[46;4H
/^STARTTEST[1;46r[1;1H[21M[1;47r[26;24H* first par[27;24H*/[28;8Hint second_par /*[29;24H* Comment for[30;24H* second par[31;24H*/[32;6H)
{
    func( first_par, /*[35;23H* Comment for[36;23H* first par[37;23H*/[38;11Hsecond_par /*[39;23H* Comment for[40;23H* second par[41;23H*/[42;9H);

}

STARTTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H:set cin
:set ff=unix cpo-=A[46;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H3L, 26C written[46;1H[47;1H[K[47;1H:set ff& cpo+=A[46;1H
/ENDTEST/+-1[47;13H[K[47;1H[1;46r[1;1H[2M[1;47r[45;1H:set cino=
]]=][[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1HENDTEST
:so! Xdotest[46;1H[47;1H[K[47;1H:set cin[46;1H[47;1H[K[47;1H:set cino=[46;1H[1;46r[1;1H[2M[1;47r[46;1H{[47;1H[K[46;1H
11 lines to indent...12[7Cindented [47;19H[K[46;1H[1;46r[46;1H
[1;47r[46;5Hdo[47;1H[K[46;4H
/^STARTTEST[1;46r[1;1H[13M[1;47r[34;5H{[35;9Hif ()[36;9H{[37;13Hif ()[38;17Hasdf;[39;13Helse[40;17Hasdf;[41;9H}
    } while ();
    cmd;[8C/* this should go under the } */
}

STARTTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H]]=][
:set ff=unix cpo-=A[46;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H1L, 6C written[46;1H[47;1H[K[47;1H:set ff& cpo+=A[46;1H
/ENDTEST/+-1[47;13H[K[47;1H[46;1H[1;46r[46;1H
[1;47r[46;1HENDTEST[47;1H[K[46;1H
:so! Xdotest[46;1H[1;46r[1;1H[3M[1;47r[45;1Hvoid f()
{[47;1H[K[46;1H
8 lines to indent...9[7Cindented [47;18H[K[46;1H[1;46r[46;1H
[1;47r[46;5Hif ( k() ) {[47;1H[K[46;4H
/^STARTTEST[1;46r[1;1H[10M[1;47r[37;9Hl();[39;5H} else { /* Start (two words) end */[40;9Hm();
    }[43;5Hn();
}

STARTTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H:set cino={s,e-s
:set ff=unix cpo-=A[46;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H2L, 23C written[46;1H[47;1H[K[47;1H:set ff& cpo+=A[46;1H
/ENDTEST/+-1[47;13H[K[47;1H[1;46r[46;1H
[1;47r[46;1H]]=][[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1HENDTEST
:so! Xdotest[46;1H[47;1H[K[47;1H:set cino={s,e-s[46;1H[1;46r[1;1H[3M[1;47r[45;1Hvoid f()
{[47;1H[K[46;1H
7 lines to indent...8[7Cindented [47;18H[K[46;1H    {[1;46r[46;1H
[1;47r[46;5Hif ( k() )[47;1H[K[46;5H
/^STARTTEST[1;46r[1;1H[9M[1;47r[38;9H{[39;9Hl();[40;9H} else { /* Start (two words) end */[41;9Hm();[42;9H}
    n();    /* should be under the if () */
}

STARTTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H:set cino={s,fs
:set ff=unix cpo-=A[46;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H2L, 25C written[46;1H[47;1H[K[47;1H:set ff& cpo+=A[46;1H
/ENDTEST/+-1[47;13H[K[47;1H[1;46r[46;1H
[1;47r[46;1H]]=/ foo[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1HENDTEST
:so! Xdotest[46;1H[47;1H[K[47;1H:set cino={s,fs[46;1H[1;46r[1;1H[3M[1;47r[45;1Hvoid bar(void)
{[47;1H[K[46;1H
/ foo30 lines to indent...31[7Cindented [47;19H[K[46;1H    {[47;1H[K[47;1H/^STARTTEST[m[H[2J[1;9H}[3;9H{[4;9Hint a;[5;13H{[6;13Ha = a + 1;[7;13H}[8;9H}
    b = a;
    }

void func(void)
    {
    a = 1;[15;9H{[16;9Hb = 2;[17;9H}
    c = 3;
    d = 4;
    }
/* foo */

STARTTEST
:set cino=
/while
ohere[1m^[[m
ENDTEST

a()
{
  do {
    a = a +[33;7Ha;
  } while ( a );[8C/* add text under this line */
    if ( a )[36;7Ha;
}

STARTTEST
:set cino= com=
/comment
olabel2: b();[1m^M[mlabel3 /* post */:[1m^M[m/* pre */ label4:[1m^M[mf(/*com*/);[1m^M[mif (/*com*/)[1m^^[43;1HM[mcmd();[1m^[[m
ENDTEST

a()[23;1H
[47;1H:set ff=unix cpo-=A[24;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H3L, 25C written[24;1H[47;1H[K[47;1H:set ff& cpo+=A[24;1H[47;1H/ENDTEST/+-1[47;13H[K[47;1H[26;1H
[47;1H[K[47;1H:so! Xdotest[27;1H[47;1H[K[47;1H:set cino=[27;1H[47;1H[K[47;1H/while[34;5H[47;1H[1m-- INSERT --[m[47;1H[K[35;46r[35;1H[L[1;47r[35;3Hhere[36;6H[47;1H/^STARTTEST[40;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[41;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H3L, 109C written[41;1H[47;1H[K[47;1H:set ff& cpo+=A[41;1H[47;1H/ENDTEST/+-1[47;13H[K[47;1H[43;1H

[47;1H[K[47;1H:so! Xdotest[45;1H[47;1H[K[47;1H:set cino= com=[45;1H[47;1H[K[47;1H/comment[1;46r[1;1H[5M[1;47r[42;1Ha()
{
label1:[45;13H/* hmm */[46;13H// comment[47;1H[K[46;16H
[1m-- INSERT --[m[47;1H[K[1;46r[1;1H[6M[1;47r[41;1Hlabel2: b();
label3 /* post */:
/* pre */ label4:[44;9Hf(/*com*/);[45;9Hif (/*com*/)[46;13Hcmd();[1;46r[46;1H
[1;47r[46;1H}
/^STARTTEST[1;46r[1;1H[2M[1;47r[46;1HSTARTTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H:set comments& comments^=s:/*,m:**,ex:*/
:set ff=unix cpo-=A[46;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H3L, 53C written[46;1H[47;1H[K[47;1H:set ff& cpo+=A[46;1H
/ENDTEST/+-1[47;13H[K[47;1H[1;46r[1;1H[2M[1;47r[45;1H/simple
=5j[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1HENDTEST
:so! Xdotest[46;1H[47;1H[K[47;1H:set comments& comments^=s:/*,m:**,ex:*/[46;1H[47;1H[K[47;1H/simple[1;46r[1;1H[3M[1;47r[45;1H/*
  * A simple comment[47;1H[K[46;7H
5 lines to indent...6[7Cindented [47;18H[K[46;2H* A simple comment[46;20H[K[46;2H[1;46r[46;1H
[1;47r[46;2H*/[47;1H[K[46;2H
/^STARTTEST[1;46r[1;1H[6M[1;47r[42;1H/*
** A different comment
*/

STARTTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H:set cino=c0
:set ff=unix cpo-=A[46;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H3L, 70C written[46;1H[47;1H[K[47;1H:set ff& cpo+=A[46;1H
/ENDTEST/+-1[47;13H[K[47;1H[1;46r[1;1H[2M[1;47r[45;1H:set comments& comments-=s1:/* comments^=s0:/*
2kdd]]=][[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1HENDTEST
:so! Xdotest[46;1H[47;1H[K[47;1H:set cino=c0[46;1H[47;1H[K[47;1H:set comments& comments-=s1:/* comments^=s0:/*[46;1H[44;1H2kdd]]=][[44;10H[K[45;1HENDTEST[45;8H[K[46;1H[K[44;1H[1;46r[1;1H[2M[1;47r[45;1Hvoid f()
{[47;1H[K[46;1H
4 lines to indent...5[7Cindented [47;18H[K[46;1H[1;46r[46;1H
[1;47r[47;1H[K[46;1H
/^STARTTEST[1;46r[1;1H[6M[1;47r[41;5H/*********[42;7HA comment.
    *********/
}

STARTTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H:set cino=c0,C1
:set ff=unix cpo-=A[46;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H3L, 73C written[46;1H[47;1H[K[47;1H:set ff& cpo+=A[46;1H
/ENDTEST/+-1[47;13H[K[47;1H[1;46r[1;1H[2M[1;47r[45;1H:set comments& comments-=s1:/* comments^=s0:/*
2kdd]]=][[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1HENDTEST
:so! Xdotest[46;1H[47;1H[K[47;1H:set cino=c0,C1[46;1H[47;1H[K[47;1H:set comments& comments-=s1:/* comments^=s0:/*[46;1H[44;1H2kdd]]=][[44;10H[K[45;1HENDTEST[45;8H[K[46;1H[K[44;1H[1;46r[1;1H[2M[1;47r[45;1Hvoid f()
{[47;1H[K[46;1H
4 lines to indent...5[7Cindented [47;18H[K[46;1H[1;46r[46;1H
[1;47r[47;1H[K[46;1H
/^STARTTEST[1;46r[1;1H[6M[1;47r[41;5H/*********
    A comment.
    *********/
}

STARTTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H:set cino=
:set ff=unix cpo-=A[46;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H2L, 17C written[46;1H[47;1H[K[47;1H:set ff& cpo+=A[46;1H
/ENDTEST/+-1[47;13H[K[47;1H[1;46r[46;1H
[1;47r[46;1H]]=][[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1HENDTEST
:so! Xdotest[46;1H[47;1H[K[47;1H:set cino=[46;1H[1;46r[1;1H[3M[1;47r[45;1Hvoid f()
{[47;1H[K[46;1H
5 lines to indent...6[7Cindented [47;18H[K[46;1H[1;46r[46;1H
[1;47r[46;5Hc = c1 &&[47;1H[K[46;4H
/^STARTTEST[1;46r[1;1H[7M[1;47r[40;9H([41;10Hc2 ||[42;10Hc3[43;9H) && c4;
}

STARTTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H:set cino=(s
:set ff=unix cpo-=A[46;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H2L, 23C written[46;1H[47;1H[K[47;1H:set ff& cpo+=A[46;1H
/ENDTEST/+-1[47;13H[K[47;1H[1;46r[46;1H
[1;47r[46;1H2kdd]]=][[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1HENDTEST
:so! Xdotest[46;1H[47;1H[K[47;1H:set cino=(s[46;1H[44;1H2kdd]]=][[44;10H[K[45;1HENDTEST[45;8H[K[46;1H[K[44;1H[1;46r[1;1H[2M[1;47r[45;1Hvoid f()
{[47;1H[K[46;1H
5 lines to indent...6[7Cindented [47;18H[K[46;1H[1;46r[46;1H
[1;47r[46;5Hc = c1 &&[47;1H[K[46;4H
/^STARTTEST[1;46r[1;1H[7M[1;47r[40;9H([41;10Hc2 ||[42;10Hc3[43;9H) && c4;
}

STARTTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H:set cino=(s,U1
:set ff=unix cpo-=A[46;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H2L, 28C written[46;1H[47;1H[K[47;1H:set ff& cpo+=A[46;1H
/ENDTEST/+-1[47;13H[K[47;1H[1;46r[46;1H
[1;47r[46;1H2kdd]]=][[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1HENDTEST
:so! Xdotest[46;1H[47;1H[K[47;1H:set cino=(s,U1  [46;1H[44;1H2kdd]]=][[44;10H[K[45;1HENDTEST[45;8H[K[46;1H[K[44;1H[1;46r[1;1H[2M[1;47r[45;1Hvoid f()
{[47;1H[K[46;1H
5 lines to indent...6[7Cindented [47;18H[K[46;1H[1;46r[46;1H
[1;47r[46;5Hc = c1 &&[47;1H[K[46;4H
/^STARTTEST[1;46r[1;1H[7M[1;47r[40;9H([41;13Hc2 ||[42;13Hc3[43;9H) && c4;
}

STARTTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H:set cino=(0
:set ff=unix cpo-=A[46;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H2L, 23C written[46;1H[47;1H[K[47;1H:set ff& cpo+=A[46;1H
/ENDTEST/+-1[47;13H[K[47;1H[1;46r[46;1H
[1;47r[46;1H2kdd]]=][[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1HENDTEST
:so! Xdotest[46;1H[47;1H[K[47;1H:set cino=(0[46;1H[44;1H2kdd]]=][[44;10H[K[45;1HENDTEST[45;8H[K[46;1H[K[44;1H[1;46r[1;1H[2M[1;47r[45;1Hvoid f()
{[47;1H[K[46;1H
4 lines to indent...5[7Cindented [47;18H[K[46;1H[1;46r[46;1H
[1;47r[46;5Hif (   c1[47;1H[K[46;4H
/^STARTTEST[1;46r[1;1H[6M[1;47r[41;12H&& (   c2[42;19H|| c3))[43;9Hfoo;
}

STARTTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H:set cino=(0,w1
:set ff=unix cpo-=A[46;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H2L, 28C written[46;1H[47;1H[K[47;1H:set ff& cpo+=A[46;1H
/ENDTEST/+-1[47;13H[K[47;1H[1;46r[46;1H
[1;47r[46;1H2kdd]]=][[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1HENDTEST
:so! Xdotest[46;1H[47;1H[K[47;1H:set cino=(0,w1  [46;1H[44;1H2kdd]]=][[44;10H[K[45;1HENDTEST[45;8H[K[46;1H[K[44;1H[1;46r[1;1H[2M[1;47r[45;1Hvoid f()
{[47;1H[K[46;1H
4 lines to indent...5[7Cindented [47;18H[K[46;1H[1;46r[46;1H
[1;47r[46;5Hif (   c1[47;1H[K[46;4H
/^STARTTEST[1;46r[1;1H[6M[1;47r[41;9H&& (   c2[42;13H|| c3))[43;9Hfoo;
}

STARTTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H:set cino=(s
:set ff=unix cpo-=A[46;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H2L, 23C written[46;1H[47;1H[K[47;1H:set ff& cpo+=A[46;1H
/ENDTEST/+-1[47;13H[K[47;1H[1;46r[46;1H
[1;47r[46;1H2kdd]]=][[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1HENDTEST
:so! Xdotest[46;1H[47;1H[K[47;1H:set cino=(s[46;1H[44;1H2kdd]]=][[44;10H[K[45;1HENDTEST[45;8H[K[46;1H[K[44;1H[1;46r[1;1H[2M[1;47r[45;1Hvoid f()
{[47;1H[K[46;1H
8 lines to indent...9[7Cindented [47;18H[K[46;1H[1;46r[46;1H
[1;47r[46;5Hc = c1 && ([47;1H[K[46;4H
/^STARTTEST[1;46r[1;1H[10M[1;47r[37;9Hc2 ||[38;9Hc3[39;9H) && c4;
    if ([41;9Hc1 && c2[42;8H)[43;9Hfoo;
}

STARTTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H:set cino=(s,m1
:set ff=unix cpo-=A[46;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H2L, 28C written[46;1H[47;1H[K[47;1H:set ff& cpo+=A[46;1H
/ENDTEST/+-1[47;13H[K[47;1H[1;46r[46;1H
[1;47r[46;1H2kdd]]=][[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1HENDTEST
:so! Xdotest[46;1H[47;1H[K[47;1H:set cino=(s,m1  [46;1H[44;1H2kdd]]=][[44;10H[K[45;1HENDTEST[45;8H[K[46;1H[K[44;1H[1;46r[1;1H[2M[1;47r[45;1Hvoid f()
{[47;1H[K[46;1H
8 lines to indent...9[7Cindented [47;18H[K[46;1H[1;46r[46;1H
[1;47r[46;5Hc = c1 && ([47;1H[K[46;4H
/^STARTTEST[1;46r[1;1H[10M[1;47r[37;9Hc2 ||[38;9Hc3
    ) && c4;
    if ([41;9Hc1 && c2
    )[43;9Hfoo;
}

STARTTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H:set cino=b1
:set ff=unix cpo-=A[46;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H2L, 23C written[46;1H[47;1H[K[47;1H:set ff& cpo+=A[46;1H
/ENDTEST/+-1[47;13H[K[47;1H[1;46r[46;1H
[1;47r[46;1H2kdd]]=][[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1HENDTEST
:so! Xdotest[46;1H[47;1H[K[47;1H:set cino=b1[46;1H[44;1H2kdd]]=][[44;10H[K[45;1HENDTEST[45;8H[K[46;1H[K[44;1H[1;46r[1;1H[2M[1;47r[45;1Hvoid f()
{[47;1H[K[46;1H
9 lines to indent...10 lines indented [47;19H[K[46;1H[1;46r[46;1H
[1;47r[46;5Hswitch (x)[47;1H[K[46;4H
/^STARTTEST[1;46r[1;1H[11M[1;47r[36;5H{[37;9Hcase 1:[38;13Ha = b;[39;9Hbreak;[40;9Hdefault:[41;13Ha = 0;[42;9Hbreak;
    }
}

STARTTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H:set cino=(0,W5
:set ff=unix cpo-=A[46;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H2L, 26C written[46;1H[47;1H[K[47;1H:set ff& cpo+=A[46;1H
/ENDTEST/+-1[47;13H[K[47;1H[1;46r[46;1H
[1;47r[46;1H2kdd]]=][[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1HENDTEST
:so! Xdotest[46;1H[47;1H[K[47;1H:set cino=(0,W5[46;1H[44;1H2kdd]]=][[44;10H[K[45;1HENDTEST[45;8H[K[46;1H[K[44;1H[1;46r[1;1H[2M[1;47r[45;1Hvoid f()
{[47;1H[K[46;1H
10 lines to indent...11[7Cindented [47;19H[K[46;1H[1;46r[46;1H
[1;47r[46;5Hinvokeme([47;1H[K[46;4H
/^STARTTEST[1;46r[1;1H[12M[1;47r[35;10Hargu,[36;10Hment);
    invokeme([38;10Hargu,[39;10Hment[40;10H);
    invokeme(argu,[42;14Hment[43;13H);
}

STARTTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H:set cino=/6
:set ff=unix cpo-=A[46;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H2L, 23C written[46;1H[47;1H[K[47;1H:set ff& cpo+=A[46;1H
/ENDTEST/+-1[47;13H[K[47;1H[1;46r[46;1H
[1;47r[46;1H2kdd]]=][[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1HENDTEST
:so! Xdotest[46;1H[47;1H[K[47;1H:set cino=/6[46;1H[44;1H2kdd]]=][[44;10H[K[45;1HENDTEST[45;8H[K[46;1H[K[44;1H[1;46r[1;1H[2M[1;47r[45;1Hvoid f()
{[47;1H[K[46;1H
3 lines to indent...4[7Cindented [47;18H[K[46;1H[1;46r[46;1H
[1;47r[46;5Hstatement;[47;1H[K[46;4H
/^STARTTEST[1;46r[1;1H[5M[1;47r[42;11H// comment 1[43;11H// comment 2
}

STARTTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H:set cino=
:set ff=unix cpo-=A[46;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H3L, 34C written[46;1H[47;1H[K[47;1H:set ff& cpo+=A[46;1H
/ENDTEST/+-1[47;13H[K[47;1H[1;46r[1;1H[2M[1;47r[45;1H2kdd]]/comment 1/+1
==[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1HENDTEST
:so! Xdotest[46;1H[47;1H[K[47;1H:set cino=[46;1H[44;1H==[44;3H[K[45;1HENDTEST[46;1H[K[44;1H[1;46r[1;1H[2M[1;47r[45;1Hvoid f()
{[47;1H[K[46;1H
/comment 1/+1[1;46r[1;1H[3M[1;47r[44;5Hstatement;[45;8H// comment 1
    // comment 2[47;1H[K[46;4H    // comment 2[46;8H[1;46r[46;1H
[1;47r[46;1H}
/^STARTTEST[1;46r[1;1H[2M[1;47r[46;1HSTARTTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H:set cino=g0
:set ff=unix cpo-=A[46;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H2L, 23C written[46;1H[47;1H[K[47;1H:set ff& cpo+=A[46;1H
/ENDTEST/+-1[47;13H[K[47;1H[1;46r[46;1H
[1;47r[46;1H2kdd]]=][[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1HENDTEST
:so! Xdotest[46;1H[47;1H[K[47;1H:set cino=g0[46;1H[44;1H2kdd]]=][[44;10H[K[45;1HENDTEST[45;8H[K[46;1H[K[44;1H[1;46r[1;1H[2M[1;47r[45;1Hclass CAbc
{[47;1H[K[46;1H
6 lines to indent...7[7Cindented [47;18H[K[46;1H[1;46r[46;1H
[1;47r[46;5Hint Test() { return FALSE; }[47;1H[K[46;4H
/^STARTTEST[1;46r[1;1H[8M[1;47r[40;1Hpublic: // comment
    void testfall();
protected:
    void testfall();
};

STARTTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H:set cino=+20
:set ff=unix cpo-=A[46;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H2L, 24C written[46;1H[47;1H[K[47;1H:set ff& cpo+=A[46;1H
/ENDTEST/+-1[47;13H[K[47;1H[1;46r[46;1H
[1;47r[46;1H2kdd]]=][[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1HENDTEST
:so! Xdotest[46;1H[47;1H[K[47;1H:set cino=+20[46;1H[44;1H2kdd]]=][[44;10H[K[45;1HENDTEST[45;8H[K[46;1H[K[44;1H[1;46r[1;1H[3M[1;47r[44;5Hvoid
foo()
{[47;1H[K[46;1H
4 lines to indent...5[7Cindented [47;18H[K[46;1H[1;46r[46;1H
[1;47r[46;5Hif (a)[47;1H[K[46;4H
/^STARTTEST[1;46r[1;1H[6M[1;47r[41;5H{
    } else[43;9Hasdf;
}

STARTTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H:set cino=(0,W2s
:set ff=unix cpo-=A[46;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H2L, 27C written[46;1H[47;1H[K[47;1H:set ff& cpo+=A[46;1H
/ENDTEST/+-1[47;13H[K[47;1H[1;46r[46;1H
[1;47r[46;1H2kdd]]=][[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1HENDTEST
:so! Xdotest[46;1H[47;1H[K[47;1H:set cino=(0,W2s[46;1H[44;1H2kdd]]=][[44;10H[K[45;1HENDTEST[45;8H[K[46;1H[K[44;1H[1;46r[46;1H
[1;47r[46;1H{[47;1H[K[46;1H
34 lines to indent...35[7Cindented [47;19H[K[46;1H[1;46r[46;1H
[1;47r[46;5Haverylongfunctionnamelongfunctionnameaverylongfunctionname()->asd([47;1H[K[46;4H
/^STARTTEST[m[H[2J[1;5H/* those are ugly, but consequent */[3;5Hfunc()->asd(asdasdf,[4;17Haverylongfunctionname([5;25Habc,[6;25Hdec)->averylongfunctionname([7;33Hasdfadsf,[8;33Hasdfasdf,[9;33Hasdfasdf,[10;33H),[11;17Hfunc(asdfadf,[12;22Hasdfasdf[13;21H),[14;17Hasdasdf[15;16H);[17;5Haverylongfunctionnameaverylongfunctionnameavery()->asd(fasdf([18;21Habc,[19;21Hdec)->asdfasdfasdf([20;29Hasdfadsf,[21;29Hasdfasdf,[22;29Hasdfasdf,[23;29H),[24;13Hfunc(asdfadf,[25;18Hasdfasdf),[26;13Hasdasdf[27;13H);
}

STARTTEST
:set cino=M1
2kdd]]=][
ENDTEST

int main ()
{
    if (cond1 &&[38;13Hcond2[39;13H)[40;9Hfoo;
}

STARTTEST
:g/^STARTTEST/.,/^ENDTEST/d
:1;/start of AUTO/,$wq! test.out
ENDTEST[30;1H
[47;1H:set ff=unix cpo-=A[31;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H2L, 23C written[31;1H[47;1H[K[47;1H:set ff& cpo+=A[31;1H[47;1H/ENDTEST/+-1[47;13H[K[47;1H[32;1H
[47;1H[K[47;1H:so! Xdotest[33;1H[47;1H[K[47;1H:set cino=M1[33;1H[31;1H[31;46r[46;1H
[1;47r[46;1H[1m~[m[47;1H[K[31;1H[35;1H[47;1H4 lines to indent...5[7Cindented [47;18H[K[35;1H
   [47;1H[K[47;1H/^STARTTEST[42;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[43;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H2L, 61C written[43;1H[47;1H[K[47;1H:set ff& cpo+=A[43;1H[47;1H/ENDTEST/+-1[47;13H[K[47;1H[42;1H
[47;1H[K[47;1H:so! Xdotest[43;1H[47;1H[K[47;1H:g/^STARTTEST/.,/^ENDTEST/d128 fewer lines[47;16H[K[1;1H{[1;5H[K[2;5Haverylongfunctionnamelongfunctionnameaverylongfunctionname()->asd(
            asdasdf,[3;21H[K[4;13Hfunc(asdf,[4;23H[K[5;18Hasdfadsf),[5;28H[K[6;13Hasdfasdf[6;25H[K[7;13H);[7;33H[K[8;33H[K[9;5H/* those are ugly, but consequent */[9;41H[K[10;33H[K[11;5Hfunc()->asd(asdasdf,[11;25H[K[12;17Haverylongfunctionname([13;21H    abc,[14;17H        dec)->averylongfunctionname([15;16H  [15Casdfadsf,[16;33Hasdfasdf,
                                asdfasdf,[17;42H[K[18;21H    [8C),[19;17Hfunc(asdfadf,[19;30H[K[20;22Hasdfasdf[20;30H[K[21;21H),[21;29H[K[22;17Hasdasdf[22;29H[K[23;16H);[23;29H[K[24;13H[K[25;5Haverylongfunctionnameaverylongfunctionnameavery()->asd(fasdf([26;13H        abc,[27;13H        dec)->asdfasdfasdf(
 [27Casdfadsf,[29;29Hasdfasdf,
         [19Casdfasdf,
         [19C),
            func(asdfadf,[33;18Hasdfasdf),
            asdasdf
 [11C);
}[36;5H[K[37;13H[K[38;13H[K[39;1Hint main ()[39;12H[K[40;1H{
    if (cond1 &&
            cond2
            )[43;14H[K[44;1H        foo;[44;14H[K[45;1H}[45;2H[K[46;1H[K[46;1H[47;1H[K[47;1H:1;/start of AUTO/,$wq! test.out"test.out" [47;12H[K[47;12H[New] 1185L, 11362C written[?1l>
rm -rf X* test.ok viminfo
rm -rf test4.failed test.ok test.out X* viminfo
cp test4.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test4.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test4.in" 31 lines, 839 characters[1;1HTest for autocommand that changes current buffer on BufEnter event.
Check if modelines are interpreted for the correct buffer.

STARTTEST
:so small.vim
:set nocompatible viminfo+=nviminfo
:au BufEnter Xxx brew
/start of
:.,/end of/w! Xxx   " write test file Xxx
:set ai modeline modelines=3
:sp Xxx[13C" split to Xxx, autocmd will do :brew
G?this is a
othis should be auto-indented[1m^[[m
:[19C" Append text with autoindent to this file
:au! BufEnter Xxx
:buf Xxx[12C" go to Xxx, no autocmd anymore
G?this is a
othis should be in column 1[1m^[[m:wq " append text without autoindent to Xxx
G:r Xxx[13C" include Xxx in the current file
:?startstart?,$w! test.out
:qa!
ENDTEST

startstart
start of test file Xxx
vim: set noai :[27;9Hthis is a test[28;9Hthis is a test[29;9Hthis is a test[30;9Hthis is a test
end of test file Xxx
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[4;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[5;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 17 lines, 557 characters written[5;1H[47;1H[K[47;1H:set ff& cpo+=A[5;1H[47;1H/ENDTEST[47;10H[K[47;1H[22;1H
[47;1H[K[47;1H:so! Xdotest[23;1H[47;1H[K[47;1H:so small.vim[23;1H[47;1H[K[47;1H:set nocompatible viminfo+=nviminfo[23;1H[47;1H[K[47;1H:au BufEnter Xxx brew[23;1H[47;1H[K[47;1H/start of[25;1H[47;1H[K[47;1H:.,/end of/w! Xxx   " write test file Xxx"Xxx" [47;7H[K[47;7H[New] 7L, 124C written[25;1H[47;1H[K[47;1H:set ai modeline modelines=3[25;1H[47;1H[K[47;1H:sp Xxx             " split to Xxx, autocmd will do :brew"Xxx" [47;7H[K[47;7H7L, 124C[1;1H:set ai modeline modelines=3[1;29H[K[2;1H:sp Xxx             " split to Xxx, autocmd will do :brew[2;58H[K[3;1HG?this is a
othis should be auto-indented[1m^[[m
:            [7C" Append text with autoindent to this file
:au! BufEnter Xxx[6;19H[K[7;2Hbuf Xxx            " go to Xxx, no autocmd anymore
G?this is a
othis should be in column 1[1m^[[m:wq " append text without autoindent to Xxx
G:r Xxx             " include Xxx in the current file
:?startstart?,$w! test.out[11;27H[K[12;1H:qa![12;5H[K[13;1HENDTEST[13;8H[K[14;1H[K[15;1Hstartstart[15;11H[K[16;1Hstart of test file Xxx[16;23H[K[17;1Hvim: set noai :
        this is a test[18;23H[K[19;1H        this is a test[19;23H[K[20;1H        this is a[20;23H[K[21;1H        this is a test
end of test file Xxx
[1m[7mtest4.in                                                                                                                       [m[24;1H:set ai modeline modelines=3
:sp Xxx             " split to Xxx, autocmd will do :brew
G?this is a[26;12H[K[27;1Hothis should be auto-indented[1m^[[m
:[7C            " Append text with autoindent to this file
:au! BufEnter Xxx[29;19H[K[30;1H:buf Xxx            " go to Xxx, no autocmd anymore
G?this is a[31;13H[K[32;1Hothis should be in column 1[1m^[[m:wq " append text without autoindent to Xxx
G:r Xxx[13C" include Xxx in the current file
:?startstart?,$w! test.out
:qa!
ENDTEST[37;1H[K[38;1Hstartstart
start of test file Xxx
vim: set noai :
        this is a test
        this is a test
        this is a test
        this is a test
end of test file Xxx
[7mtest4.in                                                                                                                       [m[47;2Htest4.in" line 25 of 31 --80%-- col 1[16;1H[22;1H[47;1H[K[47;1H?this is a[21;9H[47;1H[1m-- INSERT --[m[47;1H[K[22;1H        this should be auto-indented[23;10H[1m[7m[+][m[45;1H        this should be auto-indented[46;10H[7m[+][22;36H[1;22r[m[22;1H
[1;47r[22;1Hend of test file Xxx[47;1H:                   " Append text with autoindent to this file[22;20H[47;1H[K[47;1H:au! BufEnter Xxx[22;20H[47;1H[K[47;1H:buf Xxx            " go to Xxx, no autocmd anymore"Xxx" [47;7H[K[47;7H7L, 124C[1;1Hstart of test file Xxx[1;23H[K[2;1Hvim: set noai :
        this is a test[3;23H[K[4;1H [7Cthis is a test[4;23H[K[5;1H        this is a test
        this is a test[6;23H[K[7;1Hend of test file Xxx[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~
~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;9H[K[17;1H[1m~[m[18;9H[K[18;1H[1m~[m[19;9H[K[19;1H[1m~[m[20;9H[K[20;1H[1m~[m[21;9H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m
[1m[7mXxx          [1;1H[7;1H[m[47;1H[K[47;1H?this is a[6;9H[47;1H[1m-- INSERT --[m[47;1H[K[7;22r[7;1H[L[1;47r[7;1Hthis should be in column 1[23;5H[1m[7m[+][7;26H[47;1H[m:wq " append text without autoindent to Xxx"Xxx[47;7H[K[47;7H8L, 151C written[1;1HTest for autocommand that changes current buffer on BufEnter event.
Check if modelines are interpreted for the correct buffer.[3;9H[K[4;1HSTARTTEST[4;10H[K[5;1H:so small.vim[5;14H[K[6;1H:set nocompatible viminfo+=nviminfo
:au BufEnter Xxx brew[7;22H[K[8;1H/start of[8;10H[K[9;1H:.,/end of/w! Xxx   " write test file Xxx
:set ai modeline modelines=3
:sp Xxx[13C" split to Xxx, autocmd will do :brew
G?this is a
othis should be auto-indented[1m^[[m
: [18C" Append text with autoindent to this file
:au! BufEnter Xxx
:buf Xxx[12C" go to Xxx, no autocmd anymore
G?this is a
othis should be in column 1[1m^[[m:wq " append text without autoindent to Xxx
G:r Xxx[13C" include Xxx in the current file
:?startstart?,$w! test.out
:qa!
ENDTEST[23;1H[K[24;1Hstartstart[24;11H[K[25;1Hstart of test file Xxx[25;23H[K[26;1Hvim: set noai :
        this is a test[27;23H[K[28;1H [7Cthis is a test[28;23H[K[29;1H        this is a test
        this is a test[30;23H[K[31;1H        this should be auto-indented
end of test file Xxx[32;21H[K[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~
~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~[m[41;9H[K[41;1H[1m~[m[42;9H[K[42;1H[1m~[m[43;9H[K[43;1H[1m~[m[44;9H[K[44;1H[1m~[m[45;9H[K[45;1H[1m~[m[46;2H[K[46;1H[1m~[25;1H[32;1H[m[47;1H[K[47;1H:r Xxx             " include Xxx in the current file"Xxx" [47;20H[K[47;7H8L, 151C[33;1Hstart of test file Xxx
vim: set noai :
        this is a test
        this is a test
        this is a test
        this is a test
this should be in column 1
end of test file Xxx[33;1H[47;1H[K[47;1H:?startstart?,$w! test.out"test.out" [47;12H[K[47;12H[New] 17L, 316C written[33;1H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test5.failed test.ok test.out X* viminfo
cp test5.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test5.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test5.in" 29 lines, 949 characters[1;1HTest for autocommand that deletes the current buffer on BufLeave event.
Also test deleting the last buffer, should give a new, empty buffer.

STARTTEST
:so small.vim
:au BufLeave Xxx bwipe
/start of
:.,/end of/w! Xxx[15C" write test file Xxx
:sp Xxx[25C" split to Xxx
:bwipe[26C" delete buffer Xxx, now we're back here
G?this is a
othis is some more text[1m^[[m
:[31C" Append some text to this file
:?start?,$w! test.out[11C" Write current file contents
:bwipe test.out[17C" delete alternate buffer
:au bufleave test5.in bwipe
:bwipe![25C" delete current buffer, get an empty one
ithis is another test line[1m^[[m:w >>test.out
:[31C" append an extra line to the output file
:qa!
ENDTEST

start of test file Xxx
vim: set noai :[25;9Hthis is a test[26;9Hthis is a test[27;9Hthis is a test[28;9Hthis is a test
end of test file Xxx
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[4;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[5;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 16 lines, 664 characters written[5;1H[47;1H[K[47;1H:set ff& cpo+=A[5;1H[47;1H/ENDTEST[47;10H[K[47;1H[21;1H
[47;1H[K[47;1H:so! Xdotest[22;1H[47;1H[K[47;1H:so small.vim[22;1H[47;1H[K[47;1H:au BufLeave Xxx bwipe[22;1H[47;1H[K[47;1H/start of[23;1H[47;1H[K[47;1H:.,/end of/w! Xxx               " write test file Xxx"Xxx" [47;7H[K[47;7H[New File] 7 lines, 124 characters written[23;1H[47;1H[K[47;1H:sp Xxx                         " split to Xxx"Xxx" [47;7H[K[47;7H7 lines, 124 characters[1;1Hstart of test file Xxx[1;23H[K[2;1Hvim: set noai :[2;16H[K[3;9Hthis is a test
        this is a test
        this is a test
        this is a test
end of test file Xxx[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;33H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;33H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~
~[m
[1m[7mXxx                                                                                                                            [m[24;1H:.,/end of/w! Xxx[15C" write test file Xxx
:sp Xxx               [10C" split to Xxx
:bwipe                [10C" delete buffer Xxx, now we're back here
G?this is a[27;12H[K[28;1Hothis is some more text[1m^[[m
:                   [12C" Append some text to this file
:?start?,$w! test.out[11C" Write current file contents
:bwipe test.out[17C" delete alternate buffer
:au bufleave test5.in bwipe
:bwipe![25C" delete current buffer, get an empty one
ithis is another test line[1m^[[m:w >>test.out
: [30C" append an extra line to the output file
:qa!
ENDTEST[38;1H[K[39;1Hstart of test file Xxx
vim: set noai :
        this is a test
        this is a test
        this is a test
        this is a test
end of test file Xxx
[7mtest5.in                                                                                                                       [1;1H[m[47;1H[K[47;1H:bwipe                          " delete buffer Xxx, now we're back here[1;1HTest for autocommand that deletes the current buffer on BufLeave event.
Also test deleting the last buffer, should give a new, empty buffer.[3;9H[K[4;1HSTARTTEST[4;10H[K[5;1H:so small.vim[5;14H[K[6;1H:au BufLeave Xxx bwipe
/start of[7;10H[K[8;1H:.,/end of/w! Xxx[15C" write test file Xxx
:sp Xxx[25C" split to Xxx
:bwipe[26C" delete buffer Xxx, now we're back here
G?this is a
othis is some more text[1m^[[m
: [30C" Append some text to this file
:?start?,$w! test.out[11C" Write current file contents
:bwipe test.out[17C" delete alternate buffer
:au bufleave test5.in bwipe
:bwipe![25C" delete current buffer, get an empty one
ithis is another test line[1m^[[m:w >>test.out
: [30C" append an extra line to the output file
:qa!
ENDTEST[22;1H[K[23;1Hstart of test file Xxx[23;23H[K[24;1Hvim: set noai :[24;16H[K[25;1H        this is a test[25;33H[K[26;1H        this is a test[26;33H[K[27;1H        this is a test
        this is a test[28;23H[K[29;1Hend of test file Xxx[29;33H[K[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;33H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;2H[K[37;1H[1m~
~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~[m[41;9H[K[41;1H[1m~[m[42;9H[K[42;1H[1m~[m[43;9H[K[43;1H[1m~[m[44;9H[K[44;1H[1m~[m[45;2H[K[45;1H[1m~[m[46;2H[K[46;1H[1m~[23;1H[29;1H[m[47;1H[K[47;1H?this is a[28;9H[29;46r[29;1H[L[1;47r[29;1Hthis is some more text[47;1H[K[29;22H[30;20H[47;1H:                               " Append some text to this file[30;20H[47;1H[K[47;1H:?start?,$w! test.out           " Write current file contents"test.out" [47;12H[K[47;12H[New File] 8 lines, 147 characters written[30;20H[47;1H[K[47;1H:bwipe test.out                 " delete alternate buffer[30;20H[47;1H[K[47;1H:au bufleave test5.in bwipe[30;20H[47;1H[K[47;1H:bwipe!                         " delete current buffer, get an empty one[7mError detected while processing BufLeave Auto commands for "test5.in":[m[47;71H[K[47;1H
[7mE89: No write since last change for buffer 1 (add ! to override)[m
[7mPress ENTER or type command to continue[m[1;1H[2L[2;1H[1m~
~[m[4;2H[K[4;1H[1m~[m[5;2H[K[5;1H[1m~[m[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;33H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;33H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~
~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;9H[K[25;1H[1m~[m[26;9H[K[26;1H[1m~[m[27;9H[K[27;1H[1m~[m[28;9H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[47;1H[K[1;1Hthis is another test line[47;1H:w >>test.out"test.out" [47;12H[K[47;12H1 line, 26 characters appended[1;25H[47;1H[K[47;1H:                               " append an extra line to the output file[1;25H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test6.failed test.ok test.out X* viminfo
cp test6.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test6.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test6.in" 24 lines, 739 characters[1;1HTest for autocommand that redefines the argument list, when doing ":all".

STARTTEST
:so small.vim
:au BufReadPost Xxx2 next Xxx2 Xxx1
/^start of
A1[1m^[[m:.,/end of/w! Xxx1    " write test file Xxx1
$r2:.,/end of/w! Xxx2     " write test file Xxx2
$r3:.,/end of/w! Xxx3     " write test file Xxx3
:next! Xxx1 Xxx2 Xxx3     " redefine arglist; go to Xxx1
:all[22C" open window for all args
:w! test.out[14C" Write contents of Xxx1
[1m^W^W^W^W[m:w >>test.out     " Append contents of last window (Xxx1)
:rew[22C" should now be in Xxx2
:w >>test.out[13C" Append contents of Xxx2
:qa!
ENDTEST

start of test file Xxx[20;9Hthis is a test[21;9Hthis is a test[22;9Hthis is a test[23;9Hthis is a test
end of test file Xxx
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 13 lines, 537 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[17;1H
[47;1H[K[47;1H:so! Xdotest[18;1H[47;1H[K[47;1H:so small.vim[18;1H[47;1H[K[47;1H:au BufReadPost Xxx2 next Xxx2 Xxx1[18;1H[47;1H[K[47;1H/^start of[19;1H[22C1[47;1H[K[47;1H:.,/end of/w! Xxx1    " write test file Xxx1"Xxx1" [47;9H[K[47;8H[New File] 6 lines, 109 characters written[19;23H2[47;1H[K[47;1H:.,/end of/w! Xxx2     " write test file Xxx2"Xxx2" [47;9H[K[47;8H[New File] 6 lines, 109 characters written[19;23H3[47;1H[K[47;1H:.,/end of/w! Xxx3     " write test file Xxx3"Xxx3" [47;9H[K[47;8H[New File] 6 lines, 109 characters written[19;23H[47;1H[K[47;1H:next! Xxx1 Xxx2 Xxx3     " redefine arglist; go to Xxx1"Xxx1"[47;8H[K[47;8H6 lines, 109 characters[1;1Hstart of test file Xxx1[1;24H[K[2;9Hthis is a test
        this is a test
        this is a test
        this is a test[5;23H[K[6;1Hend of test file Xxx[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~
~[m[19;2H[K[19;1H[1m~[m[20;9H[K[20;1H[1m~[m[21;9H[K[21;1H[1m~[m[22;9H[K[22;1H[1m~[m[23;9H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[1;1H[m[47;1H[K[47;1H:all                      " open window for all args"Xxx2"[47;27H[K[47;8H6 lines, 109 characters
"Xxx2" 6 lines, 109 characters
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:w! test.out              " Write contents of Xxx1"test.out" [47;12H[K[47;12H[New File] 6 lines, 109 characters written
[7mPress ENTER or type command to continue[m[1;1H[3L[1;1Hstart of test file Xxx1[2;9Hthis is a test[3;9Hthis is a test[23;1H[1m[7mXxx1                                                                                                                           [m[24;1Hstart of test file Xxx2
        this is a test
        this is a test
        this is a test
        this is a test
end of test file Xxx[46;1H[7mXxx2                                                                                                                           [m[47;1H[K[1;1H[23;1H[7mXxx1                                                                                                                           [m[46;1H[1m[7mXxx2                                                                                                                           [24;1H[23;1HXxx1                                                                                                                           [m[46;1H[7mXxx2                                                                                                                           [1;1H[47;1H[m:w >>test.out     " Append contents of last window (Xxx1)"test.out" [47;12H[K[47;12H6 lines, 109 characters appended[1;1H[47;1H[K[47;1H:rew                      " should now be in Xxx2"Xxx2" line 1 of 6 --16%-- col 1 (file 1 of 2)[47;47H[K[1;23H2[23;4H[1m[7m2[1;1H[m[47;1H[K[47;1H:w >>test.out             " Append contents of Xxx2"test.out" [47;12H[K[47;12H6 lines, 109 characters appended[1;1H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test7.failed test.ok test.out X* viminfo
cp test7.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test7.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test7.in" 26 lines, 675 characters[1;1HTest for autocommand that changes the buffer list, when doing ":ball".

STARTTEST
:so small.vim
/^start of
A1[1m^[[m:.,/end of/w! Xxx1   " write test file Xxx1
:sp Xxx1
:close
$r2:.,/end of/w! Xxx2    " write test file Xxx2
:sp Xxx2
:close
$r3:.,/end of/w! Xxx3    " write test file Xxx3
:sp Xxx3
:close
:au BufReadPost Xxx2 bwipe
$r4:ball[17C" open window for all args, close Xxx2
:.,$w! test.out[10C" Write contents of this file
[1m^W^W[m:w >>test.out[8C" Append contents of second window (Xxx1)
[1m^W^W[m:/^start of/,$w >>test.out   " Append contents of last window (this file)
:qa!
ENDTEST

start of test file Xxx[24;9Hthis is a test[25;9Hthis is a test
end of test file Xxx
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 17 lines, 508 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[21;1H
[47;1H[K[47;1H:so! Xdotest[22;1H[47;1H[K[47;1H:so small.vim[22;1H[47;1H[K[47;1H/^start of[23;1H[22C1[47;1H[K[47;1H:.,/end of/w! Xxx1   " write test file Xxx1"Xxx1" [47;9H[K[47;8H[New File] 4 lines, 77 characters written[23;23H[47;1H[K[47;1H:sp Xxx1"Xxx1" [47;8H[K[47;8H4 lines, 77 characters[1;1Hstart of test file Xxx1[1;24H[K[2;9Hthis is a test
        this is a test
end of test file Xxx[5;2H[K[5;1H[1m~[m[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~
~[m
[1m[7mXxx1                                                                                                                           [m[24;1H/^start of[24;11H[K[25;1HA1[1m^[[m:.,/end of/w! Xxx1   " write test file Xxx1
:sp Xxx1[26;9H[K[27;1H:close
$r2:.,/end of/w! Xxx2    " write test file Xxx2
:sp Xxx2
:close
$r3:.,/end of/w! Xxx3    " write test file Xxx3
:sp Xxx3
:close
:au BufReadPost Xxx2 bwipe
$r4:ball[17C" open window for all args, close Xxx2
:.,$w! test.out[10C" Write contents of this file
[1m^W^W[m:w >>test.out[8C" Append contents of second window (Xxx1)
[1m^W^W[m:/^start of/,$w >>test.out   " Append contents of last window (this file)
:qa!
ENDTEST[41;1H[K[42;1Hstart of test file Xxx1
        this is a test
        this is a test
end of test file Xxx
[7mtest7.in [+]                                                                                                                   [1;1H[m[47;1H[K[47;1H:close[1;1HTest for autocommand that changes the buffer list, when doing ":ball".[2;9H[K[3;1HSTARTTEST[3;10H[K[4;1H:so small.vim[4;14H[K[5;1H/^start of
A1[1m^[[m:.,/end of/w! Xxx1   " write test file Xxx1
:sp Xxx1
:close
$r2:.,/end of/w! Xxx2    " write test file Xxx2
:sp Xxx2
:close
$r3:.,/end of/w! Xxx3    " write test file Xxx3
:sp Xxx3
:close
:au BufReadPost Xxx2 bwipe
$r4:ball[17C" open window for all args, close Xxx2
:.,$w! test.out[10C" Write contents of this file
[1m^W^W[m:w >>test.out[8C" Append contents of second window (Xxx1)
[1m^W^W[m:/^start of/,$w >>test.out   " Append contents of last window (this file)
:qa!
ENDTEST[22;1H[K[23;1Hstart of test file Xxx1[23;24H[K[24;1H        this is a test
        this is a test[25;26H[K[26;1Hend of test file Xxx[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;2H[K[37;1H[1m~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~
~[m[42;2H[K[42;1H[1m~[m[43;9H[K[43;1H[1m~[m[44;9H[K[44;1H[1m~[m[45;2H[K[45;1H[1m~[m[46;2H[K[46;1H[1m~[23;23H[m2[47;1H[K[47;1H:.,/end of/w! Xxx2    " write test file Xxx2"Xxx2" [47;9H[K[47;8H[New File] 4 lines, 77 characters written[23;23H[47;1H[K[47;1H:sp Xxx2"Xxx2" [47;8H[K[47;8H4 lines, 77 characters[1;1Hstart of test file Xxx2[1;24H[K[2;9Hthis is a test
        this is a test
end of test file Xxx[5;2H[K[5;1H[1m~[m[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~
~[m
[1m[7mXxx2                                                                                                                           [m[24;1H/^start of[24;11H[K[25;1HA1[1m^[[m:.,/end of/w! Xxx1   " write test file Xxx1
:sp Xxx1[26;9H[K[27;1H:close
$r2:.,/end of/w! Xxx2    " write test file Xxx2
:sp Xxx2
:close
$r3:.,/end of/w! Xxx3    " write test file Xxx3
:sp Xxx3
:close
:au BufReadPost Xxx2 bwipe
$r4:ball[17C" open window for all args, close Xxx2
:.,$w! test.out[10C" Write contents of this file
[1m^W^W[m:w >>test.out[8C" Append contents of second window (Xxx1)
[1m^W^W[m:/^start of/,$w >>test.out   " Append contents of last window (this file)
:qa!
ENDTEST[41;1H[K[42;1Hstart of test file Xxx2
        this is a test
        this is a test
end of test file Xxx
[7mtest7.in [+]                                                                                                                   [1;1H[m[47;1H[K[47;1H:close[1;1HTest for autocommand that changes the buffer list, when doing ":ball".[2;9H[K[3;1HSTARTTEST[3;10H[K[4;1H:so small.vim[4;14H[K[5;1H/^start of
A1[1m^[[m:.,/end of/w! Xxx1   " write test file Xxx1
:sp Xxx1
:close
$r2:.,/end of/w! Xxx2    " write test file Xxx2
:sp Xxx2
:close
$r3:.,/end of/w! Xxx3    " write test file Xxx3
:sp Xxx3
:close
:au BufReadPost Xxx2 bwipe
$r4:ball[17C" open window for all args, close Xxx2
:.,$w! test.out[10C" Write contents of this file
[1m^W^W[m:w >>test.out[8C" Append contents of second window (Xxx1)
[1m^W^W[m:/^start of/,$w >>test.out   " Append contents of last window (this file)
:qa!
ENDTEST[22;1H[K[23;1Hstart of test file Xxx2[23;24H[K[24;1H        this is a test
        this is a test[25;26H[K[26;1Hend of test file Xxx[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;2H[K[37;1H[1m~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~
~[m[42;2H[K[42;1H[1m~[m[43;9H[K[43;1H[1m~[m[44;9H[K[44;1H[1m~[m[45;2H[K[45;1H[1m~[m[46;2H[K[46;1H[1m~[23;23H[m3[47;1H[K[47;1H:.,/end of/w! Xxx3    " write test file Xxx3"Xxx3" [47;9H[K[47;8H[New File] 4 lines, 77 characters written[23;23H[47;1H[K[47;1H:sp Xxx3"Xxx3" [47;8H[K[47;8H4 lines, 77 characters[1;1Hstart of test file Xxx3[1;24H[K[2;9Hthis is a test
        this is a test
end of test file Xxx[5;2H[K[5;1H[1m~[m[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~
~[m
[1m[7mXxx3                                                                                                                           [m[24;1H/^start of[24;11H[K[25;1HA1[1m^[[m:.,/end of/w! Xxx1   " write test file Xxx1
:sp Xxx1[26;9H[K[27;1H:close
$r2:.,/end of/w! Xxx2    " write test file Xxx2
:sp Xxx2
:close
$r3:.,/end of/w! Xxx3    " write test file Xxx3
:sp Xxx3
:close
:au BufReadPost Xxx2 bwipe
$r4:ball[17C" open window for all args, close Xxx2
:.,$w! test.out[10C" Write contents of this file
[1m^W^W[m:w >>test.out[8C" Append contents of second window (Xxx1)
[1m^W^W[m:/^start of/,$w >>test.out   " Append contents of last window (this file)
:qa!
ENDTEST[41;1H[K[42;1Hstart of test file Xxx3
        this is a test
        this is a test
end of test file Xxx
[7mtest7.in [+]                                                                                                                   [1;1H[m[47;1H[K[47;1H:close[1;1HTest for autocommand that changes the buffer list, when doing ":ball".[2;9H[K[3;1HSTARTTEST[3;10H[K[4;1H:so small.vim[4;14H[K[5;1H/^start of
A1[1m^[[m:.,/end of/w! Xxx1   " write test file Xxx1
:sp Xxx1
:close
$r2:.,/end of/w! Xxx2    " write test file Xxx2
:sp Xxx2
:close
$r3:.,/end of/w! Xxx3    " write test file Xxx3
:sp Xxx3
:close
:au BufReadPost Xxx2 bwipe
$r4:ball[17C" open window for all args, close Xxx2
:.,$w! test.out[10C" Write contents of this file
[1m^W^W[m:w >>test.out[8C" Append contents of second window (Xxx1)
[1m^W^W[m:/^start of/,$w >>test.out   " Append contents of last window (this file)
:qa!
ENDTEST[22;1H[K[23;1Hstart of test file Xxx3[23;24H[K[24;1H        this is a test
        this is a test[25;26H[K[26;1Hend of test file Xxx[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;2H[K[37;1H[1m~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~
~[m[42;2H[K[42;1H[1m~[m[43;9H[K[43;1H[1m~[m[44;9H[K[44;1H[1m~[m[45;2H[K[45;1H[1m~[m[46;2H[K[46;1H[1m~[23;23H[m[47;1H[K[47;1H:au BufReadPost Xxx2 bwipe[23;23H4[47;1H[K[47;1H:ball                 " open window for all args, close Xxx2"Xxx1"[47;23H[K[47;8H4 lines, 77 characters
"Xxx2" 4 lines, 77 characters
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:.,$w! test.out          " Write contents of this file"test.out" [47;12H[K[47;12H[New File] 4 lines, 77 characters written
[7mPress ENTER or type command to continue[m[H[2J[1;1H/^start of
A1[1m^[[m:.,/end of/w! Xxx1   " write test file Xxx1
:sp Xxx1
:close
$r2:.,/end of/w! Xxx2    " write test file Xxx2
:sp Xxx2
:close
$r3:.,/end of/w! Xxx3    " write test file Xxx3
:sp Xxx3
:close
:au BufReadPost Xxx2 bwipe
$r4:ball[17C" open window for all args, close Xxx2
:.,$w! test.out[10C" Write contents of this file
[1m^W^W[m:w >>test.out[8C" Append contents of second window (Xxx1)
[1m^W^W[m:/^start of/,$w >>test.out   " Append contents of last window (this file)
:qa!
ENDTEST

start of test file Xxx4[20;9Hthis is a test[21;9Hthis is a test
end of test file Xxx
[1m[7mtest7.in [+]                                                                                                                   [m[24;1Hstart of test file Xxx1[25;9Hthis is a test[26;9Hthis is a test
end of test file Xxx
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[m
[7mXxx1                                                                                                                           [19;23H[23;1Htest7.in [+]                                                                                                                   [m[46;1H[1m[7mXxx1                                                                                                                           [24;1H[47;1H[m:w >>test.out        " Append contents of second window (Xxx1)"test.out" [47;12H[K[47;12H4 lines, 77 characters appended[24;1H[23;1H[1m[7mtest7.in [+]                                                                                                                   [m[46;1H[7mXxx1                                                                                                                           [19;23H[m[47;1H[K[47;1H:/^start of/,$w >>test.out   " Append contents of last window (this file)[7msearch hit BOTTOM, continuing at TOP[m[47;37H[K[47;1H"test.out" [47;12H[K[47;12H4 lines, 77 characters appended[19;23H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test8.failed test.ok test.out X* viminfo
cp test8.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test8.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test8.in" 24 lines, 797 characters[1;1HTest for BufWritePre autocommand that deletes or unloads the buffer.

STARTTEST
:so small.vim
:au BufWritePre Xxx1 bunload
:au BufWritePre Xxx2 bwipe
/^start of
A1[1m^[[m:.,/end of/w! Xxx1  " write test file Xxx1
$r2:.,/end of/w! Xxx2   " write test file Xxx2
:e! Xxx2[16C" edit Xxx2
:bdel test8.in[10C" delete this file from the buffer list
:e Xxx1[17C" edit Xxx1
:w[22C" write it, will unload it and give an error msg
:w! test.out[12C" Write contents of this file
:e! Xxx2[16C" start editing Xxx2
:bwipe test.out[9C" remove test.out from the buffer list
:w[22C" write it, will delete the buffer and give an error msg
:w >>test.out[11C" Append contents of this file
:qa!
ENDTEST

start of Xxx[23;9Htest
end of Xxx
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 16 lines, 678 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[20;1H
[47;1H[K[47;1H:so! Xdotest[21;1H[47;1H[K[47;1H:so small.vim[21;1H[47;1H[K[47;1H:au BufWritePre Xxx1 bunload[21;1H[47;1H[K[47;1H:au BufWritePre Xxx2 bwipe[21;1H[47;1H[K[47;1H/^start of[22;1H[12C1[47;1H[K[47;1H:.,/end of/w! Xxx1  " write test file Xxx1"Xxx1" [47;9H[K[47;8H[New File] 3 lines, 31 characters written[22;13H2[47;1H[K[47;1H:.,/end of/w! Xxx2   " write test file Xxx2"Xxx2" [47;9H[K[47;8H[New File] 3 lines, 31 characters written[22;13H[47;1H[K[47;1H:e! Xxx2                " edit Xxx2"Xxx2" [47;8H[K[47;8H3 lines, 31 characters[1;1Hstart of Xxx2[1;14H[K[2;9Htest
end of Xxx[4;2H[K[4;1H[1m~[m[5;2H[K[5;1H[1m~[m[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~
~[m[22;2H[K[22;1H[1m~[m[23;9H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[1;1H[m[47;1H[K[47;1H:bdel test8.in[1m^I^I[m" delete this file from the buffer list[1;1H[47;1H[K[47;1H:e Xxx1                 " edit Xxx1"Xxx1" [47;25H[K[47;8H3 lines, 31 characters[1;13H1[47;1H[K[47;1H:w                      " write it, will unload it and give an error msg"Xxx2"[47;25H[K[47;8H3 lines, 31 characters
[7mE203: Autocommands deleted or unloaded buffer to be written[m
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:w! test.out            " Write contents of this file"test.out" [47;12H[K[47;12H[New File] 3 lines, 31 characters written
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:e! Xxx2                " start editing Xxx2"Xxx2" [47;8H[K[47;8H3 lines, 31 characters[1;1H[3L[1;1Hstart of Xxx2[2;9Htest
end of Xxx[47;1H[K[47;1H"Xxx2" 3 lines, 31 characters[1;1H[47;1H[K[47;1H:bwipe test.out         " remove test.out from the buffer list[1;1H[47;1H[K[47;1H:w                      " write it, will delete the buffer and give an error msg"Xxx1"[47;25H[K[47;8H3 lines, 31 characters
[7mE203: Autocommands deleted or unloaded buffer to be written[m
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:w >>test.out           " Append contents of this file"test.out" [47;12H[K[47;12H3 lines, 31 characters appended
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test9.failed test.ok test.out X* viminfo
cp test9.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test9.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test9.in" 12 lines, 255 characters[1;1HTest for Bufleave autocommand that deletes the buffer we are about to edit.

STARTTEST
:so small.vim
:au BufLeave test9.in bwipe yy
:e yy
:/^start of/,$w! test.out      " Write contents of this file
:qa!
ENDTEST

start of test file xx
end of test file xx
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 5 lines, 117 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[9;1H
[47;1H[K[47;1H:so! Xdotest[10;1H[47;1H[K[47;1H:so small.vim[10;1H[47;1H[K[47;1H:au BufLeave test9.in bwipe yy[10;1H[47;1H[K[47;1H:e yy[7mE143: Autocommands unexpectedly deleted new buffer yy[10;1H[m[47;1H[K[47;1H:/^start of/,$w! test.out      " Write contents of this file"test.out" [47;12H[K[47;12H[New File] 2 lines, 42 characters written[10;1H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test10.failed test.ok test.out X* viminfo
cp test10.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test10.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test10.in" 57 lines, 1624 characters[1;1HTest for 'errorformat'.  This will fail if the quickfix feature was disabled.

STARTTEST
:so small.vim
:/start of errorfile/,/end of errorfile/w! Xerrorfile
:/start of testfile/,/end of testfile/w! Xtestfile
:cf Xerrorfile
rA
:cn
rB
:cn
rC
:cn
rD
:cn
rE
:w! test.out[13C" Write contents of this file
:qa!
ENDTEST

start of errorfile
"Xtestfile", line 4.12: 1506-045 (S) Undeclared identifier fd_set.
"Xtestfile", line 7 col 19; this is an error
gcc -c -DHAVE_CONFIsing-prototypes -I/usr/X11R6/include  version.c
Xtestfile:13: parse error before `asd'
make: *** [vim] Error 1
in file "Xtestfile" linenr 16: there is an error

2 returned
"Xtestfile", linenr 19: yet another problem

Does anyone know what is the problem and how to correction it?
end of errorfile

start of testfile
line 2  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 4  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 6  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 7  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 8  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 9  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 10 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 11 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 12 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[1;1H[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 15 lines, 225 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[19;1H
[47;1H[K[47;1H:so! Xdotest[20;1H[47;1H[K[47;1H:so small.vim[20;1H[47;1H[K[47;1H:/start of errorfile/,/end of errorfile/w! Xerrorfile"Xerrorfile" [47;14H[K[47;14H[New File] 13 lines, 447 characters written[20;1H[47;1H[K[47;1H:/start of testfile/,/end of testfile/w! Xtestfile"Xtestfile" [47;13H[K[47;13H[New File] 23 lines, 853 characters written[20;1H[47;1H[K[47;1H:cf Xerrorfile"Xtestfile" [47;13H[K[47;13H23 lines, 853 characters
(2 of 13): 1506-045 (S) Undeclared identifier fd_set.
[7mPress ENTER or type command to continue[m[1;1H[2L[1;1Hstart of testfile
line 2  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 4  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[5;39H[K[6;1Hline 6  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[6;39H[K[7;1Hline 7  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 8  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 9  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 10 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 11 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 12 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 13 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 14 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 15 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 16 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 17 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[17;39H[K[18;1Hline 18 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 19 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 20 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 21 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 22 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[22;39H[K[23;1Hend of testfile[23;16H[K[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;2H[K[27;1H[1m~
~[m[29;3H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~
~[m[32;2H[K[32;1H[1m~[m[33;2H[K[33;1H[1m~
~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;2H[K[37;1H[1m~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~[m[41;2H[K[41;1H[1m~[m[42;2H[K[42;1H[1m~[m[43;2H[K[43;1H[1m~[m[44;2H[K[44;1H[1m~[m[45;2H[K[45;1H[1m~[m[46;2H[K[46;1H[1m~[m[47;1H[K[4;12HA[5;12H[47;1H:cn(3 of 13): this is an error[7;19HB[8;19H[47;1H[K[47;1H:cn(5 of 13): parse error before `asd'[13;1HC
[47;1H[K[47;1H:cn(7 of 13): there is an error[16;1HD
[47;1H[K[47;1H:cn(10 of 13): yet another problem[19;1HE
[47;1H[K[47;1H:w! test.out             " Write contents of this file"test.out" [47;12H[K[47;12H[New File] 23 lines, 853 characters written[20;1H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test11.failed test.ok test.out X* viminfo
cp test11.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test11.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test11.in" 78 lines, 3040 characters[1;1HTests for autocommands:
- FileWritePre[10Cwriting a compressed file
- FileReadPost[10Creading a compressed file
- BufNewFile[12Creading a file template
- BufReadPre[12Cdecompressing the file to be read
- FilterReadPre[9Csubstituting characters in the temp file
- FilterReadPost[8Csubstituting characters after filtering
- FileReadPre[11Cset options for decompression
- FileReadPost[10Cdecompress the file

Note: This test will fail if "gzip" is not available.
$GZIP is made empty, "-v" would cause trouble.
Use a FileChangedShell autocommand to avoid a prompt for "Xtestfile.gz" being
modified outside of Vim (noticed on Solaris).

STARTTEST
:so small.vim
:let $GZIP = ""
:au FileChangedShell * echo "caught FileChangedShell"
:set bin
:au FileWritePre    *.gz   '[,']!gzip
:au FileWritePost   *.gz   undo
:/^start of testfile/,/^end of testfile/w! Xtestfile.gz
:au FileReadPost    *.gz   '[,']!gzip -d
:$r Xtestfile.gz[16C" Read and decompress the testfile
:?startstart?,$w! test.out      " Write contents of this file
:au BufNewFile      *.c    read Xtest.c
:/^start of test.c/+1,/^end of test.c/-1w! Xtest.c
:e! foo.c[23C" Will load Xtest.c
:au FileAppendPre   *.out  '[,']s/new/NEW/
:au FileAppendPost  *.out  !cat Xtest.c >>test.out
:w>>test.out[20C" Append it to the output file
:au! FileAppendPre
:" setup autocommands to decompress before reading and re-compress afterwards
:au BufReadPre      *.gz   !gzip -d <afile>
:au BufReadPre      *.gz   call rename(expand("<afile>:r"), expand("<afile>"))
:au BufReadPost     *.gz   call rename(expand("<afile>"), expand("<afile>:r"))
:au BufReadPost     *.gz   !gzip <afile>:r
:e! Xtestfile.gz[16C" Edit compressed file
:w>>test.out[20C" Append it to the output file
:set shelltemp[18C" need temp files here
:au FilterReadPre   *.out  call rename(expand("<afile>"), expand("<afile>").".t")
:au FilterReadPre   *.out  !sed s/e/E/ <afile>.t ><afile>
:au FilterReadPre   *.out  !rm <afile>.t
:au FilterReadPost  *.out  '[,']s/x/X/g
:e! test.out[20C" Edit the output file[1;1H[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[16;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[17;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 42 lines, 1973 characters written[17;1H[47;1H[K[47;1H:set ff& cpo+=A[17;1H[47;1H/ENDTEST[47;10H[K[47;1H[1;46r[1;1H[13M[1;47r[34;1H:23,$!cat
:23,$s/\r$//[17C" remove CR for when sed adds them
:au! FileReadPre    *.gz   !gzip -d <afile>
:au  FileReadPre    *.gz   call rename(expand("<afile>:r"), expand("<afile>"))
:au! FileReadPost   *.gz   '[,']s/l/L/
:$r Xtestfile.gz[13C" Read compressed file
:w[27C" write it, after filtering
:au![13C" remove all autocommands
:e[15C" Edit test.out again
:set nobin ff&   " use the default fileformat for writing
:w
:qa!
ENDTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H
:so! Xdotest[46;1H[47;1H[K[47;1H:so small.vim[46;1H[47;1H[K[47;1H:let $GZIP = ""[46;1H[47;1H[K[47;1H:au FileChangedShell * echo "caught FileChangedShell"[46;1H[47;1H[K[47;1H:set bin[46;1H[47;1H[K[47;1H:au FileWritePre    *.gz   '[,']!gzip[46;1H[47;1H[K[47;1H:au FileWritePost   *.gz   undo[46;1H[47;1H[K[47;1H:/^start of testfile/,/^end of testfile/w! Xtestfile.gz11 lines filtered[47;18H[K[47;1H
"Xtestfile.gz" [New File][Incomplete last line] 1 line, 111 characters written
10 more lines; before #1  0 seconds ago
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:au FileReadPost    *.gz   '[,']!gzip -d[1;1H[3L[1;1H:au BufNewFile      *.c    read Xtest.c
:/^start of test.c/+1,/^end of test.c/-1w! Xtest.c
:e! foo.c[23C" Will load Xtest.c
:au FileAppendPre   *.out  '[,']s/new/NEW/[5;9HAppendPost  *.out  !cat Xtest.c >>test.out[5;51H[K[6;2Hw>>test.out[20C" Append it to the output file
:au! FileAppendPre[7;21H[K[8;2H" setup autocommands to decompress before reading and re-compress afterwards
:au BufReadPre      *.gz   !gzip -d <afile>[9;44H[K[10;5HBufReadPre  [11Ccall rename(expand("<afile>:r"), expand("<afile>"))
:au BufReadPost     *.gz   call rename(expand("<afile>"), expand("<afile>:r"))
:au BufReadPost     *.gz   !gzip <afile>:r[12;43H[K[13;2He! Xtestfile.gz                " Edit compressed file
:w>>test.out                    " Append it to the output file
:set shelltemp[20Cneed temp files here[16;8HterRea[14Ccall rename(expand("<afile>"), expand("<afile>").".t")[17;8HterReadPre [10Csed s/e/E/ <afile>.t ><afile>
:au FilterReadPre   *.out  !rm <afile>.t[18;42H[K[19;4H FilterReadPost  *.out  '[,']s/x/X/g
:e! test.out                    " Edit the output file[20;56H[K[21;2H23,$!cat[21;10H[K[22;2H23,$s/\r$//                 " remove CR for when sed adds them[22;64H[K[23;4H! FileReadPre[11C!gzip -d <afile>[23;44H[K[24;5H FileReadPre[11Ccall rename(expand("<afile>:r"), expand("<afile>"))
:au! FileReadPost   *.gz   '[,']s/l/L/[25;40H[K[26;2H$r Xtestfile.gz[13C" Read compressed file[26;52H[K[27;2Hw            [15C" write it, after filtering
:au!             " remove all autocommands[28;43H[K[29;2He               " Edit test.out again[29;40H[K[30;2Hset nobin ff&   " use the default fileformat for writing
:w[31;3H[K[32;2Hqa![32;5H[K[33;1HENDTEST[33;8H[K[34;1H[K[35;1Hstartstart[35;11H[K[36;1Hstart of testfile[36;21H[K[37;1Hline 2  Abcdefghijklmnopqrstuvwxyz[37;35H[K[38;1Hline 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[38;39H[K[39;1Hline 4  Abcdefghijklmnopqrstuvwxyz[39;35H[K[40;1Hline 5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[40;39H[K[41;1Hline 6  Abcdefghijklmnopqrstuvwxyz[41;35H[K[42;1Hline 7  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[42;39H[K[43;1Hline 8  Abcdefghijklmnopqrstuvwxyz
line 9  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 10 Abcdefghijklmnopqrstuvwxyz
end of testfile[47;1H[K[46;1H
:$r Xtestfile.gz                " Read and decompress the testfile"Xtestfile.gz" [47;16H[K[47;16H[Incomplete last line] 1 line, 111 characters[60C[1;46r[1;1H[7M[1;47r[41;1Hstart of test.c
/*
 * Here is a new .c file
 */
end of test.c
start of testfile[47;1H[K[46;1H
:?startstart?,$w! test.out      " Write contents of this file"test.out" [47;12H[K[47;12H[New File] 29 lines, 788 characters written[46;1H[47;1H[K[47;1H:au BufNewFile      *.c    read Xtest.c[46;1H[47;1H[K[47;1H:/^start of test.c/+1,/^end of test.c/-1w! Xtest.c[7msearch hit BOTTOM, continuing at TOP[m[47;37H[K[47;1H"Xtest.c" [47;11H[K[47;11H[New File] 3 lines, 32 characters written[46;1H[47;1H[K[47;1H:e! foo.c                       " Will load Xtest.c"foo.c" [New File][47;33H[K[47;1H
"Xtest.c" 3 lines, 32 characters
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:au FileAppendPre   *.out  '[,']s/new/NEW/[1;1H[2L[2;1H/*
 * Here is a new .c file[3;28H[K[4;1H */[4;5H[K[5;2H[K[5;1H[1m~[m[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~
~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;2H[K[37;1H[1m~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~
~[m[41;2H[K[41;1H[1m~[m[42;2H[K[42;1H[1m~[m[43;2H[K[43;1H[1m~[m[44;2H[K[44;1H[1m~[m[45;2H[K[45;1H[1m~[m[46;2H[K[46;1H[1m~[m[47;1H[K[2;1H[47;1H:au FileAppendPost  *.out  !cat Xtest.c >>test.out[2;1H[47;1H[K[47;1H:w>>test.out                    " Append it to the output file"test.out" [47;12H[K[47;12H4 lines, 33 characters appended
:!cat Xtest.c >>test.out
[m
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:au! FileAppendPre[m[H[2J[2;1H/*
 * Here is a NEW .c file
 */
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[3;2H[47;1H[m:" setup autocommands to decompress before reading and re-compress afterwards[3;2H[47;1H[K[47;1H:au BufReadPre      *.gz   !gzip -d <afile>[3;2H[47;1H[K[47;1H:au BufReadPre      *.gz   call rename(expand("<afile>:r"), expand("<afile>"))[3;2H[47;1H[K[47;1H:au BufReadPost     *.gz   call rename(expand("<afile>"), expand("<afile>:r"))[3;2H[47;1H[K[47;1H:au BufReadPost     *.gz   !gzip <afile>:r[3;2H[47;1H[K[47;1H:e! Xtestfile.gz                " Edit compressed file:!gzip -d Xtestfile.gz[47;33H[K[47;23H
[m"Xtestfile.gz"[46;1H"Xtestfile.gz" 11 lines, 357 characters[47;1H[K[47;1H:!gzip Xtestfile
[m
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:w>>test.out                    " Append it to the output file"test.out" [47;12H[K[47;12H11 lines, 357 characters appended
:!cat Xtest.c >>test.out
[m
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:set shelltemp                  " need temp files here[m[H[2J[1;1Hstart of testfile
line 2  Abcdefghijklmnopqrstuvwxyz
line 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 4  Abcdefghijklmnopqrstuvwxyz
line 5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 6  Abcdefghijklmnopqrstuvwxyz
line 7  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 8  Abcdefghijklmnopqrstuvwxyz
line 9  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 10 Abcdefghijklmnopqrstuvwxyz
end of testfile
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[47;1H[m:au FilterReadPre   *.out  call rename(expand("<afile>"), expand("<afile>").".t")[1;1H[47;1H[K[47;1H:au FilterReadPre   *.out  !sed s/e/E/ <afile>.t ><afile>[1;1H[47;1H[K[47;1H:au FilterReadPre   *.out  !rm <afile>.t[1;1H[47;1H[K[47;1H:au FilterReadPost  *.out  '[,']s/x/X/g[1;1H[47;1H[K[47;1H:e! test.out                    " Edit the output file"test.out" [47;12H[K[47;12H50 lines, 1242 characters[1;6Hstar[1;11H[K[2;1Hstart of testfile[2;18H[K[3;6H2  Abcdefghijklmnopqrstuvwxyz[3;35H[K[4;6H3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[5;6H4  Abcdefghijklmnopqrstuvwxyz[5;35H[K[6;6H5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[7;6H6  Abcdefghijklmnopqrstuvwxyz[7;35H[K[8;6H7  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[9;6H8  Abcdefghijklmnopqrstuvwxyz[9;35H[K[10;6H9  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 10 Abcdefghijklmnopqrstuvwxyz
end of testfile[13;1H[K[14;1Hstart of test.c
/*
 * Here is a new .c file
 */
end of test.c
start of testfile
line 2  Abcdefghijklmnopqrstuvwxyz
line 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 4  Abcdefghijklmnopqrstuvwxyz
line 5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 6  Abcdefghijklmnopqrstuvwxyz
line 7  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 8  Abcdefghijklmnopqrstuvwxyz
line 9  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 10 Abcdefghijklmnopqrstuvwxyz
end of testfile[30;1H[K[31;1H/*
 * Here is a NEW .c file
 */
/*
 * Here is a new .c file
 */
start of testfile
line 2  Abcdefghijklmnopqrstuvwxyz
line 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 4  Abcdefghijklmnopqrstuvwxyz
line 5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 6  Abcdefghijklmnopqrstuvwxyz
line 7  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 8  Abcdefghijklmnopqrstuvwxyz
line 9  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 10 Abcdefghijklmnopqrstuvwxyz[1;1H[47;1H[K[47;1H:23,$!cat:!sed s/e/E/ /tmp/v466049/1.t >/tmp/v466049/1
[m:!rm /tmp/v466049/1.t
[m218 substitutions on 15 lines
28 lines filtered
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:23,$s/\r$//                 " remove CR for when sed adds them[7mE486: Pattern not found: \r$[m[47;30H[K[47;1H
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:au! FileReadPre    *.gz   !gzip -d <afile>[m[H[2J[1;1Hstartstart
start of testfile
line 2  Abcdefghijklmnopqrstuvwxyz
line 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 4  Abcdefghijklmnopqrstuvwxyz
line 5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 6  Abcdefghijklmnopqrstuvwxyz
line 7  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 8  Abcdefghijklmnopqrstuvwxyz
line 9  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 10 Abcdefghijklmnopqrstuvwxyz
end of testfile

start of test.c
/*
 * Here is a new .c file
 */
end of test.c
start of testfile
line 2  Abcdefghijklmnopqrstuvwxyz
line 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 4  Abcdefghijklmnopqrstuvwxyz
linE 5  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
linE 6  AbcdefghijklmnopqrstuvwXyz
linE 7  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
linE 8  AbcdefghijklmnopqrstuvwXyz
linE 9  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
linE 10 AbcdefghijklmnopqrstuvwXyz
End of testfile

/*
 * HEre is a NEW .c file
 */
/*
 * HEre is a new .c file
 */
start of tEstfile
linE 2  AbcdefghijklmnopqrstuvwXyz
linE 3  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
linE 4  AbcdefghijklmnopqrstuvwXyz
linE 5  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
linE 6  AbcdefghijklmnopqrstuvwXyz
linE 7  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
linE 8  AbcdefghijklmnopqrstuvwXyz
linE 9  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
linE 10 AbcdefghijklmnopqrstuvwXyz[23;1H[47;1H:au  FileReadPre    *.gz   call rename(expand("<afile>:r"), expand("<afile>"))[23;1H[47;1H[K[47;1H:au! FileReadPost   *.gz   '[,']s/l/L/[23;1H[47;1H[K[47;1H:$r Xtestfile.gz             " Read compressed file:!gzip -d Xtestfile.gz[47;30H[K[47;23H
[m"Xtestfile.gz"[46;1H"Xtestfile.gz" 11 lines, 357 characters[47;1H[K[47;1H11 substitutions on 11 lines
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:w                           " write it, after filtering"test.out"[47;30H[K[47;12H61 lines, 1599 characters written
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:au!             " remove all autocommands[7mE216: No such group or event: " remove all autocommands[m
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:e               " Edit test.out again"test.out"[47;18H[K[47;12H61 lines, 1599 characters[m[H[2J[1;1Hstartstart
start of testfile
line 2  Abcdefghijklmnopqrstuvwxyz
line 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 4  Abcdefghijklmnopqrstuvwxyz
line 5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 6  Abcdefghijklmnopqrstuvwxyz
line 7  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 8  Abcdefghijklmnopqrstuvwxyz
line 9  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 10 Abcdefghijklmnopqrstuvwxyz
end of testfile

start of test.c
/*
 * Here is a new .c file
 */
end of test.c
start of testfile
line 2  Abcdefghijklmnopqrstuvwxyz
line 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 4  Abcdefghijklmnopqrstuvwxyz
linE 5  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
linE 6  AbcdefghijklmnopqrstuvwXyz
linE 7  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
linE 8  AbcdefghijklmnopqrstuvwXyz
linE 9  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
linE 10 AbcdefghijklmnopqrstuvwXyz
End of testfile

/*
 * HEre is a NEW .c file
 */
/*
 * HEre is a new .c file
 */
start of tEstfile
linE 2  AbcdefghijklmnopqrstuvwXyz
linE 3  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
linE 4  AbcdefghijklmnopqrstuvwXyz
linE 5  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
linE 6  AbcdefghijklmnopqrstuvwXyz
linE 7  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
linE 8  AbcdefghijklmnopqrstuvwXyz
linE 9  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
linE 10 AbcdefghijklmnopqrstuvwXyz
"test.out" 61 lines, 1599 characters[1;1H[47;1H[K[47;1H:set nobin ff&   " use the default fileformat for writing[1;1H[47;1H[K[47;1H:w"test.out" 61 lines, 1599 characters written[1;1H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test12.failed test.ok test.out X* viminfo
cp test12.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test12.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test12.in" 52 lines, 1199 characters[1;1HTests for 'directory' option.
- ".", in same dir as file
- "./dir", in directory relative to file
- "dir", in directory relative to current dir

STARTTEST
:so small.vim
:set nocompatible viminfo+=nviminfo
:set dir=.,~
:/start of testfile/,/end of testfile/w! Xtest1
:" do an ls of the current dir to find the swap file (should not be there)
:if has("unix")
:  !ls .X*.swp >test.out
:else
:  r !ls X*.swp >test.out
:endif
:!echo first line >>test.out
:e Xtest1
:if has("unix")
:" Do an ls of the current dir to find the swap file, remove the leading dot
:" to make the result the same for all systems.
:  r!ls .X*.swp
:  s/\.*X/X/
:  .w >>test.out
:  undo
:else
:  !ls X*.swp >>test.out
:endif
:!echo under Xtest1.swp >>test.out
:!mkdir Xtest2
:set dir=./Xtest2,.,~
:e Xtest1
:!ls X*.swp >>test.out
:!echo under under >>test.out
:!ls Xtest2 >>test.out
:!echo under Xtest1.swp >>test.out
:!mkdir Xtest.je
:/start of testfile/,/end of testfile/w! Xtest2/Xtest3
:set dir=Xtest.je,~
:e Xtest2/Xtest3
:swap
:!ls Xtest2 >>test.out
:!echo under Xtest3 >>test.out
:!ls Xtest.je >>test.out
:!echo under Xtest3.swp >>test.out
:qa![1;1H[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[6;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[7;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 40 lines, 965 characters written[7;1H[47;1H[K[47;1H:set ff& cpo+=A[7;1H[47;1H/ENDTEST[47;10H[K[47;1H[1;46r[46;1H
[1;47r[46;1HENDTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H
:so! Xdotest[46;1H[47;1H[K[47;1H:so small.vim[46;1H[47;1H[K[47;1H:set nocompatible viminfo+=nviminfo[46;1H[47;1H[K[47;1H:set dir=.,~[46;1H[47;1H[K[47;1H:/start of testfile/,/end of testfile/w! Xtest1"Xtest1" [47;10H[K[47;10H[New] 4L, 70C written[46;1H[47;1H[K[47;1H:" do an ls of the current dir to find the swap file (should not be there)[46;1H[47;1H[K[47;1H:if has("unix")
:  :  !ls .X*.swp >test.out
:!ls .X*.swp >test.out[?1l>[47;1H
ls: .X*.swp: No such file or directory

shell returned 2
[?1h=[47;1H:  :else
:  :  r !ls X*.swp >test.out
:  :endif[m[H[2J[1;1H- "./dir", in directory relative to file
- "dir", in directory relative to current dir

STARTTEST
:so small.vim
:set nocompatible viminfo+=nviminfo
:set dir=.,~
:/start of testfile/,/end of testfile/w! Xtest1
:" do an ls of the current dir to find the swap file (should not be there)
:if has("unix")
:  !ls .X*.swp >test.out
:else
:  r !ls X*.swp >test.out
:endif
:!echo first line >>test.out
:e Xtest1
:if has("unix")
:" Do an ls of the current dir to find the swap file, remove the leading dot
:" to make the result the same for all systems.
:  r!ls .X*.swp
:  s/\.*X/X/
:  .w >>test.out
:  undo
:else
:  !ls X*.swp >>test.out
:endif
:!echo under Xtest1.swp >>test.out
:!mkdir Xtest2
:set dir=./Xtest2,.,~
:e Xtest1
:!ls X*.swp >>test.out
:!echo under under >>test.out
:!ls Xtest2 >>test.out
:!echo under Xtest1.swp >>test.out
:!mkdir Xtest.je
:/start of testfile/,/end of testfile/w! Xtest2/Xtest3
:set dir=Xtest.je,~
:e Xtest2/Xtest3
:swap
:!ls Xtest2 >>test.out
:!echo under Xtest3 >>test.out
:!ls Xtest.je >>test.out
:!echo under Xtest3.swp >>test.out
:qa!
ENDTEST

:!echo first line >>test.out[28C[?1l>[47;1H
[?1h=[47;1H
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:e Xtest1"Xtest1" 4L, 70C[m[H[2J[1;1Hstart of testfile
line 2 Abcdefghij
line 3 Abcdefghij
end of testfile
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[m
"Xtest1" 4L, 70C[1;1H[47;1H[K[47;1H:if has("unix")
:  :" Do an ls of the current dir to find the swap file, remove the leading dot
:  :" to make the result the same for all systems.
:  :  r!ls .X*.swp[m
:  :  s/\.*X/X/
:  :  .w >>test.out"test.out" [47;12H[K[47;12H1L, 11C appended
:  :  undo
1 line less; before #1  0 seconds ago
:  :else
:  :  !ls X*.swp >>test.out
:  :endif[m[H[2J[1;1Hstart of testfile
line 2 Abcdefghij
line 3 Abcdefghij
end of testfile
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[47;1H[m:!echo under Xtest1.swp >>test.out[34C[?1l>[47;1H
[?1h=[47;1H
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:!mkdir Xtest2[14C[?1l>[47;1H
[?1h=[47;1H
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:set dir=./Xtest2,.,~[m[H[2J[1;1Hstart of testfile
line 2 Abcdefghij
line 3 Abcdefghij
end of testfile
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[47;1H[m:e Xtest1"Xtest1" 4L, 70C[1;1H[47;1H[K[47;1H:!ls X*.swp >>test.out[22C[?1l>[47;1H
ls: X*.swp: No such file or directory

shell returned 2
[?1h=[47;1H
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:!echo under under >>test.out[29C[?1l>[47;1H
[?1h=[47;1H
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:!ls Xtest2 >>test.out[22C[?1l>[47;1H
[?1h=[47;1H
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:!echo under Xtest1.swp >>test.out[34C[?1l>[47;1H
[?1h=[47;1H
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:!mkdir Xtest.je[16C[?1l>[47;1H
[?1h=[47;1H
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:/start of testfile/,/end of testfile/w! Xtest2/Xtest3[7msearch hit BOTTOM, continuing at TOP[m[47;37H[K[47;1H"Xtest2/Xtest3" [47;17H[K[47;17H[New] 4L, 70C written
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:set dir=Xtest.je,~[m[H[2J[1;1Hstart of testfile
line 2 Abcdefghij
line 3 Abcdefghij
end of testfile
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[47;1H[m:e Xtest2/Xtest3"Xtest2/Xtest3" 4L, 70C[1;1H[47;1H[K[47;1H:swapXtest.je/Xtest3.swp[1;1H[47;1H[K[47;1H:!ls Xtest2 >>test.out[22C[?1l>[47;1H
[?1h=[47;1H
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:!echo under Xtest3 >>test.out[30C[?1l>[47;1H
[?1h=[47;1H
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:!ls Xtest.je >>test.out[24C[?1l>[47;1H
[?1h=[47;1H
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:!echo under Xtest3.swp >>test.out[34C[?1l>[47;1H
[?1h=[47;1H
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test13.failed test.ok test.out X* viminfo
cp test13.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test13.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test13.in" 58 lines, 1133 characters[1;1HTests for autocommands on :close command

Write three files and open them, each in a window.
Then go to next window, with autocommand that deletes the previous one.
Do this twice, writing the file.

Also test deleting the buffer on a Unload event.  If this goes wrong there
will be the ATTENTION prompt.

Also test changing buffers in a BufDel autocommand.  If this goes wrong there
are ml_line errors and/or a Crash.

STARTTEST
:so small.vim
:/^start of testfile/,/^end of testfile/w! Xtestje1
:/^start of testfile/,/^end of testfile/w! Xtestje2
:/^start of testfile/,/^end of testfile/w! Xtestje3
:e Xtestje1
otestje1[1m^[[m
:w
:sp Xtestje2
otestje2[1m^[[m
:w
:sp Xtestje3
otestje3[1m^[[m
:w
[1m^W^W[m
:au WinLeave Xtestje2 bwipe
[1m^W^W[m
:w! test.out
:au WinLeave Xtestje1 bwipe Xtestje3
:close
:w >>test.out
:e Xtestje1
:bwipe Xtestje2 Xtestje3 test.out
:au!
:au! BufUnload Xtestje1 bwipe
:e Xtestje3
:w >>test.out
:e Xtestje2
:sp Xtestje1
:e
:w >>test.out
:au!
:only
:e Xtestje1[1;1H[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[13;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[14;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 38 lines, 631 characters written[14;1H[47;1H[K[47;1H:set ff& cpo+=A[14;1H[47;1H/ENDTEST[47;10H[K[47;1H[1;46r[1;1H[6M[1;47r[41;1H:bwipe Xtestje2 Xtestje3 test.out test13.in
:au BufWipeout Xtestje1 buf Xtestje1
:bwipe
:w >>test.out
:qa!
ENDTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H
:so! Xdotest[46;1H[47;1H[K[47;1H:so small.vim[46;1H[47;1H[K[47;1H:/^start of testfile/,/^end of testfile/w! Xtestje1"Xtestje1" [47;13H[K[47;12H[New File] 5 lines, 64 characters written[46;1H[47;1H[K[47;1H:/^start of testfile/,/^end of testfile/w! Xtestje2"Xtestje2" [47;13H[K[47;12H[New File] 5 lines, 64 characters written[46;1H[47;1H[K[47;1H:/^start of testfile/,/^end of testfile/w! Xtestje3"Xtestje3" [47;13H[K[47;12H[New File] 5 lines, 64 characters written[46;1H[47;1H[K[47;1H:e Xtestje1"Xtestje1" 5 lines, 64 characters[1;1Hstart of testfile[1;18H[K[2;9Hcontents
        contents[3;17H[K[4;1H        contents[4;17H[K[5;1Hend of testfile[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;2H[K[37;1H[1m~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~[m[41;2H[K[41;1H[1m~[m[42;2H[K[42;1H[1m~[m[43;2H[K[43;1H[1m~[m[44;2H[K[44;1H[1m~[m[45;2H[K[45;1H[1m~
~[1;1H[2;46r[m[2;1H[L[1;47r[2;1Htestje1[47;1H[K[2;7H[3;8H[47;1H:w"Xtestje1" 6 lines, 72 characters written[3;8H[47;1H[K[47;1H:sp Xtestje2"Xtestje2" [47;12H[K[47;12H5 lines, 64 characters[2;1H        contents


end of testfile[5;16H[K[6;2H[K[6;1H[1m~[m[23;1H[1m[7mXtestje2                                                                                                                       [m[24;1Hstart of testfile
testje1
        contents
        contents
        contents
end of testfile[46;1H[7mXtestje1                                                                                                                       [1;1H[2;22r[m[2;1H[L[1;47r[2;1Htestje2[23;10H[1m[7m[+][m[47;1H[K[2;7H[3;8H[47;1H:w"Xtestje2" 6 lines, 72 characters written[23;10H[1m[7m    [3;8H[m[47;1H[K[47;1H:sp Xtestje3"Xtestje3" [47;12H[K[47;12H5 lines, 64 characters[m[H[2J[1;1Hstart of testfile[2;9Hcontents[3;9Hcontents[4;9Hcontents
end of testfile
[1m~
~
~
~
~
~
~
~
~
~[m
[1m[7mXtestje3                                                                                                                       [m[17;1Hstart of testfile
testje2[19;9Hcontents[20;9Hcontents[21;9Hcontents
end of testfile
[1m~
~
~
~
~
~
~
~[m
[7mXtestje2                                                                                                                       [m[32;1Hstart of testfile
testje1[34;9Hcontents[35;9Hcontents[36;9Hcontents
end of testfile
[1m~
~
~
~
~
~
~
~[m
[7mXtestje1                                                                                                                       [1;1H[2;15r[m[2;1H[L[1;47r[2;1Htestje3[16;10H[1m[7m[+][2;7H[3;8H[47;1H[m:w"Xtestje3" 6 lines, 72 characters written[16;10H[1m[7m    [3;8H[m[16;1H[7mXtestje3                                                                                                                       [m[31;1H[1m[7mXtestje2                                                                                                                       [19;8H[20;8H[m[47;1H[K[47;1H:au WinLeave Xtestje2 bwipe[20;8H[m[H[2J[1;1Hstart of testfile
testje3[3;9Hcontents[4;9Hcontents[5;9Hcontents
end of testfile
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[m
[7mXtestje3                                                                                                                       [m[24;1Hstart of testfile
testje1[26;9Hcontents[27;9Hcontents[28;9Hcontents
end of testfile
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[m
[1m[7mXtestje1                                                                                                                       [26;8H[27;8H[47;1H[m:w! test.out"test.out" [47;12H[K[47;12H[New File] 6 lines, 72 characters written[27;8H[47;1H[K[47;1H:au WinLeave Xtestje1 bwipe Xtestje3[27;8H[47;1H[K[47;1H:close[2;7H1[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;9H[K[26;1H[1m~[m[27;9H[K[27;1H[1m~[m[28;9H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[46;2H[K[46;1H[1m~[4;8H[m[47;1H[K[47;1H:w >>test.out"test.out" [47;12H[K[47;12H6 lines, 72 characters appended[4;8H[47;1H[K[47;1H:e Xtestje1"Xtestje1" 6 lines, 72 characters[4;9H[47;1H[K[47;1H:bwipe Xtestje2 Xtestje3 test.out[7mE94: No matching buffer for Xtestje2 Xtestje3 test.out[4;9H[m[47;1H[K[47;1H:au![4;9H[47;1H[K[47;1H:au! BufUnload Xtestje1 bwipe[4;9H[47;1H[K[47;1H:e Xtestje3"Xtestje3" 6 lines, 72 characters[2;7H3[1;1H[47;1H[K[47;1H:w >>test.out"test.out" [47;12H[K[47;12H6 lines, 72 characters appended[1;1H[47;1H[K[47;1H:e Xtestje2"Xtestje2" 6 lines, 72 characters[2;7H2[1;1H[47;1H[K[47;1H:sp Xtestje1"Xtestje1" [47;12H[K[47;12H6 lines, 72 characters[2;7H1[23;1H[1m[7mXtestje1                                                                                                                       [m[24;1Hstart of testfile
testje2
        contents
        contents
        contents
end of testfile[46;1H[7mXtestje2                                                                                                                       [1;1H[m[47;1H[K[47;1H:e[7mE143: Autocommands unexpectedly deleted new buffer Xtestje1[m[2;7H2[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;9H[K[26;1H[1m~[m[27;9H[K[27;1H[1m~[m[28;9H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[46;2H[K[46;1H[1m~[1;1H[m[47;1H[K[47;1H:w >>test.out"test.out" [47;12H[K[47;12H6 lines, 72 characters appended[1;1H[47;1H[K[47;1H:au![1;1H[47;1H[K[47;1H:onlyAlready only one window[1;1H[47;1H[K[47;1H:e Xtestje1"Xtestje1" 6 lines, 72 characters[2;7H1[1;1H[47;1H[K[47;1H:bwipe Xtestje2 Xtestje3 test.out test13.in4 buffers wiped out[47;20H[K[1;1H[47;1H[K[47;1H:au BufWipeout Xtestje1 buf Xtestje1[1;1H[47;1H[K[47;1H:bwipe"Xtestje1" 6 lines, 72 characters[1;1H[47;1H[K[47;1H:w >>test.out"test.out" [47;12H[K[47;12H6 lines, 72 characters appended[1;1H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test14.failed test.ok test.out X* viminfo
cp test14.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test14.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test14.in" 65 lines, 1012 characters[1;1HTests for "vaBiB", end could be wrong.
Also test ":s/pat/sub/" with different ~s in sub.
Also test for ^Vxff and ^Vo123 in Insert mode.
Also test "[m", "]m", "[M" and "]M"

STARTTEST
:so small.vim
/Start cursor here
vaBiBD:?Bug?,/Piece/-2w! test.out
/^- Bug
:s/u/~u~/
:s/i/~u~/
:s/o/~~~/
:.w >>test.out
:if has("ebcdic")
: let tt = "o\<C-V>193\<C-V>xc2\<C-V>o303 \<C-V>90a\<C-V>xfg\<C-V>o578\<Esc>"
:else
: let tt = "o\<C-V>65\<C-V>x42\<C-V>o103 \<C-V>33a\<C-V>xfg\<C-V>o78\<Esc>"
:endif
:exe "normal " . tt
:.w >>test.out
:set vb
/^Piece
2]maA[1m^[[m:.w >>test.out
j]maB[1m^[[m:.w >>test.out
]maC[1m^[[m:.w >>test.out
[maD[1m^[[m:.w >>test.out
k2[maE[1m^[[m:.w >>test.out
3[maF[1m^[[m:.w >>test.out
]MaG[1m^[[m:.w >>test.out
j2]MaH[1m^[[m:.w >>test.out
]M]MaI[1m^[[m:.w >>test.out
2[MaJ[1m^[[m:.w >>test.out
k[MaK[1m^[[m:.w >>test.out
3[MaL[1m^[[m:.w >>test.out
:qa!
ENDTEST

- Bug in "vPPPP" on this text (Webb):[40;9H{[41;17Hcmd;[42;17H{[43;25Hcmd;    /* <-- Start cursor here */[44;25H{[45;25H}[46;17H}[1;1H[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[6;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[7;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 30 lines, 613 characters written[7;1H[47;1H[K[47;1H:set ff& cpo+=A[7;1H[47;1H/ENDTEST[47;10H[K[47;1H[37;1H
[47;1H[K[47;1H:so! Xdotest[38;1H[47;1H[K[47;1H:so small.vim[38;1H[47;1H[K[47;1H/Start cursor here[43;40H[42;17H[7m{ 
                        cmd;    /* <-- Start cursor here */ 
                        { 
                        } 
                [41;1H                cmd; 
                [46;17H}[m
6 fewer lines[47;15H[K[41;1H        }[41;10H[K[42;1H[K[43;1HPiece of Java[43;14H[K[44;1H{[44;2H[K[45;1H        tt m1 {[45;16H[K[46;1H                t1;[41;9H[47;1H[K[47;1H:?Bug?,/Piece/-2w! test.out"test.out" [47;12H[K[47;12H[New File] 3 lines, 44 characters written[41;9H[47;1H[K[47;1H/^- Bug[7msearch hit BOTTOM, continuing at TOP[39;1H[m[47;1H[K[47;1H:s/u/~u~/[39;1H[47;1H[K[47;1H:s/i/~u~/[39;7Huuun "vPPPP" on this text (Webb):[47;1H[K[47;1H:s/o/~~~/[39;20Huuuuuuuuun this text (Webb):[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 48 characters appended[39;1H[47;1H[K[47;1H:if has("ebcdic")
:  : let tt = "o\<C-V>193\<C-V>xc2\<C-V>o303 \<C-V>90a\<C-V>xfg\<C-V>o578\<Esc>"
:  :else
:  : let tt = "o\<C-V>65\<C-V>x42\<C-V>o103 \<C-V>33a\<C-V>xfg\<C-V>o78\<Esc>"
:  :endif[1;1H[4L[1;1HTests for "vaBiB", end could be wrong.
Also test ":s/pat/sub/" with different ~s in sub.
Also test for ^Vxff and ^Vo123 in Insert mode.
Also test "[m", "]m", "[M" and "]M"[47;1H[K[39;1H[47;1H:exe "normal " . tt[40;46r[40;1H[L[1;47r[40;1HABC !a[1m^O[mg[1m^G[m8[47;1H[K[40;12H[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 11 characters appended[40;12H[47;1H[K[47;1H:set vb[40;12H[47;1H[K[47;1H/^Piece[44;1H[46;15H{A[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 10 characters appended[46;16H[1;46r[46;1H
[1;47r[46;17Ht1;[47;1H[K[46;16H[1;46r[1;1H[3M[1;47r[44;9H} e1[46;9Htt m2 {{B
:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 10 characters appended[46;16H[1;46r[1;1H[4M[1;47r[43;17Ht2;[44;9H} e2[46;9Htt m3 {[47;1H[K[46;15H{C
:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 10 characters appended[46;16H{DC[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 11 characters appended[46;16H[45;1H[38;15H{EA[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 11 characters appended[38;16H[37;1H{F[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 3 characters appended[37;2H[40;9H}G e1[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 7 characters appended[40;10H
[1;46r[1;1H[5M[1;47r[42;17Hif (x)[43;17H{[44;25Ht3;[45;17H}[46;9H} e3[47;1H[K[46;9H}H e3
:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 7 characters appended[46;10H[1;46r[46;1H
[1;47r[46;1H}[47;1H[K[46;1H}I
:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 3 characters appended[46;2H[45;9H}JH e3[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 8 characters appended[45;10H[44;16H[38;9H}K e2[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 7 characters appended[38;10H[31;1H{LF[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 4 characters appended[31;2H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test15.failed test.ok test.out X* viminfo
cp test15.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test15.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test15.in" 136 lines, 2246 characters[1;1HTests for :right on text with embedded TAB.
Also test formatting a paragraph.
Also test undo after ":%s" and formatting.

STARTTEST
:so small.vim
:set tw=65

:/^\s*test for :left/,/^\s*test for :center/ left
:/^\s*test for :center/,/^\s*test for :right/ center
:/^\s*test for :right/,/^xxx/-1 right
:set fo+=tcroql tw=72
/xxxxxxxx$
0gq6kk
:set nocp viminfo+=nviminfo
:" undo/redo here to make the next undo only work on the following changes
u[1m^R[m
:map gg :.,.+2s/^/x/<CR>kk:set tw=3<CR>gqq
/^aa
ggu
:?test for :left?,$w! test.out
:qa!
ENDTEST[25;9Htest for :left[26;11Ha[13Ca[27;13Hfa[10Ca[28;11Hdfa[11Ca[29;17Hsdfa[12Ca[30;11Hasdfa[9Ca[31;17Hxasdfa[10Ca
asxxdfa[9Ca[34;9Htest for :center[35;11Ha[13Ca[36;13Hfa[10Cafd asdf[37;11Hdfa[11Ca[38;17Hsdfa[12Cafd asdf[39;11Hasdfa[9Ca[40;17Hxasdfa[10Casdfasdfasdfasdfasdf
asxxdfa[9Ca[43;9Htest for :right[44;9Ha[15Ca[45;9Hfa[14Ca[46;9Hdfa[13Ca[1;1H[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[5;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[6;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 17 lines, 401 characters written[6;1H[47;1H[K[47;1H:set ff& cpo+=A[6;1H[47;1H/ENDTEST[47;10H[K[47;1H[23;1H
[47;1H[K[47;1H:so! Xdotest[24;1H[47;1H[K[47;1H:so small.vim[24;1H[47;1H[K[47;1H:set tw=65[24;1H[25;8H[47;1H[K[47;1H:/^\s*test for :left/,/^\s*test for :center/ left[7msearch hit BOTTOM, continuing at TOP[m[47;37H[K[25;1Htest for :left[25;15H[K[26;1Ha[9C      a[26;25H[K[27;1Hfa[10C    a[27;25H[K[28;1Hdfa[7C      a[28;25H[K[29;1Hsdfa[12Ca[29;18H[K[30;1Hasdfa           a[30;25H[K[31;1Hxasdfa[10Ca[31;18H[K[34;1Htest for :cente[34;18H[K[25;1H[47;1H[K[47;1H:/^\s*test for :center/,/^\s*test for :right/ center[34;1H                [8Ctest for :center[35;11H [13C a[14Ca[36;13H  [8Cfa        [8Cafd asdf[37;11H   [11C dfa[12Ca[38;17H    sdfa[8C        afd asdf[39;11H     [9C asdfa[10Ca[40;15Hxasdfa  
       [9C [7Casxxdfa[9Ca[43;9H                 test for :right[25;1H[47;1H[K[47;1H:/^\s*test for :right/,/^xxx/-1 right[43;26H               [10Ctest for :right[44;9H [15C [29Ca[9Ca[45;9H  [14C [28Cfa[9Ca[46;9H   [13C [27Cdfa[9Ca[25;1H[47;1H[K[47;1H:set fo+=tcroql tw=72[25;1H[47;1H[K[47;1H/xxxxxxxx$[m[H[2J[1;45Hdfa[9Caxxxoi[2;44Hsdfa[9Caxxxoi[3;43Hasdfa[9Caxxxoi[4;42Hxasdfa[9Caxxxoi[5;41Hasxxdfa[9Caxxxoi[6;40Hasxa;ofa[9Caxxxoi[7;39Hasdfaqwer[9Caxxxoi[8;47Ha[9Caxxxoik[9;46Hfa[9Caxxxoik[10;45Hdfa[9Caxxxoik[11;44Hsdfa[9Caxxxoik[12;43Hasdfa[9Caxxxoik[13;42Hxasdfa[9Caxxxoik[14;41Hasxxdfa[9Caxxxoik[15;40Hasxa;ofa[9Caxxxoik[16;39Hasdfaqwer[9Caxxxoik[17;47Ha[9Caxxxoike[18;46Hfa[9Caxxxoike[19;45Hdfa[9Caxxxoike[20;44Hsdfa[9Caxxxoike[21;43Hasdfa[9Caxxxoike[22;42Hxasdfa[9Caxxxoike[23;41Hasxxdfa[9Caxxxoike[24;40Hasxa;ofa[9Caxxxoike[25;39Hasdfaqwer[9Caxxxoike[26;47Ha[9Caxxxoikey[27;46Hfa[9Caxxxoikey[28;45Hdfa[9Caxxxoikey[29;44Hsdfa[9Caxxxoikey[30;43Hasdfa[9Caxxxoikey[31;42Hxasdfa[9Caxxxoikey[32;41Hasxxdfa[9Caxxxoikey[33;40Hasxa;ofa[9Caxxxoikey[34;39Hasdfaqwer[9Caxxxoikey

xxxxx xx xxxxxx
xxxxxxx xxxxxxxxx xxx xxxx xxxxx xxxxx xxx xx
xxxxxxxxxxxxxxxxxx xxxxx xxxx, xxxx xxxx xxxx xxxx xxx xx xx
xx xxxxxxx. xxxx xxxx.

> xx xx, xxxx xxxx xxx xxxx xxx xxxxx xxx xxx xxxxxxx xxx xxxxx
> xxxxxx xxxxxxx: xxxx xxxxxxx, xx xxxxxx xxxx xxxxxxxxxx

aa aa aa aa
bb bb bb bb
cc cc cc cc[42;50H[36;46r[46;1H
[1;47r[36;6H xx xxxxxx xxxxxxx xxxxxxxxx xxx xxxx xxxxx xxxxx xxx xx[37;62Hxx xxxxxxx.
xxxx xxxx.[38;11H[K[40;65Hxxxxxx[41;9Hx: xxxx xxxxxxx, xx xxxx[7C xxxxxxx[41;51H[K[46;1H[1m~[41;1H[40;1H
[47;1H[m:set nocp viminfo+=nviminfo[41;1H[47;1H[K[47;1H:" undo/redo here to make the next undo only work on the following changes[41;1H[47;1H1 more line; before #1  0 seconds ago[47;38H[K[m[H[2J[1;1HAlso test undo after ":%s" and formatting.

STARTTEST
:so small.vim
:set tw=65

:/^\s*test for :left/,/^\s*test for :center/ left
:/^\s*test for :center/,/^\s*test for :right/ center
:/^\s*test for :right/,/^xxx/-1 right
:set fo+=tcroql tw=72
/xxxxxxxx$
0gq6kk
:set nocp viminfo+=nviminfo
:" undo/redo here to make the next undo only work on the following changes
u[1m^R[m
:map gg :.,.+2s/^/x/<CR>kk:set tw=3<CR>gqq
/^aa
ggu
:?test for :left?,$w! test.out
:qa!
ENDTEST[23;9Htest for :left[24;11Ha[13Ca[25;13Hfa[10Ca[26;11Hdfa[11Ca[27;17Hsdfa[12Ca[28;11Hasdfa[9Ca[29;17Hxasdfa[10Ca
asxxdfa[9Ca[32;9Htest for :center[33;11Ha[13Ca[34;13Hfa[10Cafd asdf[35;11Hdfa[11Ca[36;17Hsdfa[12Cafd asdf[37;11Hasdfa[9Ca[38;17Hxasdfa[10Casdfasdfasdfasdfasdf
asxxdfa[9Ca[41;9Htest for :right[42;9Ha[15Ca[43;9Hfa[14Ca[44;9Hdfa[13Ca[45;9Hsdfa[12Ca[46;9Hasdfa[11Ca[23;8H[47;1H1 line less; after #1  0 seconds ago[23;1Htest for :left[23;15H[K[24;1Ha[9C      a[24;25H[K[25;1Hfa[10C    a[25;25H[K[26;1Hdfa[7C      a[26;25H[K[27;1Hsdfa[12Ca[27;18H[K[28;1Hasdfa           a[28;25H[K[29;1Hxasdfa[10Ca[29;18H[K[32;9H                test for :center[33;11H [13C a[14Ca[34;13H  [8Cfa        [8Cafd asdf[35;11H   [11C dfa[12Ca[36;17H    sdfa[8C        afd asdf[37;11H     [9C asdfa[10Ca[38;15Hxasdfa  
       [9C [7Casxxdfa[9Ca[41;9H               [27Ctest for :right[42;9H [15C [29Ca[9Ca[43;9H  [14C [28Cfa[9Ca[44;9H   [13C [27Cdfa[9Ca[45;9H    [12C [26Csdfa[9Ca[46;9H     [11C [25Casdfa[9Ca[23;1H
[47;1H[K[47;1H:map gg :.,.+2s/^/x/<CR>kk:set tw=3<CR>gqq[24;1H[47;1H[K[47;1H/^aa[m[H[2J[1;46Hfa[9Caxxxoi[2;45Hdfa[9Caxxxoi[3;44Hsdfa[9Caxxxoi[4;43Hasdfa[9Caxxxoi[5;42Hxasdfa[9Caxxxoi[6;41Hasxxdfa[9Caxxxoi[7;40Hasxa;ofa[9Caxxxoi[8;39Hasdfaqwer[9Caxxxoi[9;47Ha[9Caxxxoik[10;46Hfa[9Caxxxoik[11;45Hdfa[9Caxxxoik[12;44Hsdfa[9Caxxxoik[13;43Hasdfa[9Caxxxoik[14;42Hxasdfa[9Caxxxoik[15;41Hasxxdfa[9Caxxxoik[16;40Hasxa;ofa[9Caxxxoik[17;39Hasdfaqwer[9Caxxxoik[18;47Ha[9Caxxxoike[19;46Hfa[9Caxxxoike[20;45Hdfa[9Caxxxoike[21;44Hsdfa[9Caxxxoike[22;43Hasdfa[9Caxxxoike[23;42Hxasdfa[9Caxxxoike[24;41Hasxxdfa[9Caxxxoike[25;40Hasxa;ofa[9Caxxxoike[26;39Hasdfaqwer[9Caxxxoike[27;47Ha[9Caxxxoikey[28;46Hfa[9Caxxxoikey[29;45Hdfa[9Caxxxoikey[30;44Hsdfa[9Caxxxoikey[31;43Hasdfa[9Caxxxoikey[32;42Hxasdfa[9Caxxxoikey[33;41Hasxxdfa[9Caxxxoikey[34;40Hasxa;ofa[9Caxxxoikey[35;39Hasdfaqwer[9Caxxxoikey

xxxxx xx xxxxxx xxxxxxx xxxxxxxxx xxx xxxx xxxxx xxxxx xxx xx
xxxxxxxxxxxxxxxxxx xxxxx xxxx, xxxx xxxx xxxx xxxx xxx xx xx xx xxxxxxx.
xxxx xxxx.

> xx xx, xxxx xxxx xxx xxxx xxx xxxxx xxx xxx xxxxxxx xxx xxxxx xxxxxx
> xxxxxxx: xxxx xxxxxxx, xx xxxxxx xxxx xxxxxxxxxx

aa aa aa aa
bb bb bb bb
cc cc cc cc[44;1H


:.,.+2s/^/x/3 substitutions on 3 lines[44;1Hxaa aa aa aa
xbb bb bb bb
xcc cc cc cc[45;1H[44;1H[47;1H[K[47;1H:set tw=3[44;1H


3 more lines[1;46r[46;1H
[1;47r[43;5H[K[44;1Haa[44;3H[K[45;1Haa[45;3H[K[46;1Haa[47;1H[K[47;1H3 more lines[46;1H
3 fewer lines; before #2  0 seconds ago[43;1Haa aa aa aa
bb bb bb bb
cc cc cc cc[46;2H[K[46;1H[1m~[43;1H
[m[47;1H[K[47;1H:?test for :left?,$w! test.out"test.out"[47;12H[K[47;12H[New] 111L, 2304C written[44;1H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test17.failed test.ok test.out X* viminfo
cp test17.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test17.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test17.in" 27 lines, 368 characters[1;1HTests for "gf" on ${VAR}

STARTTEST
:so small.vim
:if has("ebcdic")
: set isfname=@,240-249,/,.,-,_,+,,,$,:,~,{,}
:else
: set isfname=@,48-57,/,.,-,_,+,,,$,:,~,{,}
:endif
:if has("unix")
:let $CDIR = "."
/CDIR
:else
:if has("amiga")
:let $TDIR = "/testdir"
:else
:let $TDIR = "."
:endif
/TDIR
:endif
gf
:w! test.out
:qa!
ENDTEST[26;9H${CDIR}/test17a.in[27;9H$TDIR/test17a.in
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 20 lines, 285 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[24;1H
[47;1H[K[47;1H:so! Xdotest[25;1H[47;1H[K[47;1H:so small.vim[25;1H[47;1H[K[47;1H:if has("ebcdic")
:  : set isfname=@,240-249,/,.,-,_,+,,,$,:,~,{,}
:  :else
:  : set isfname=@,48-57,/,.,-,_,+,,,$,:,~,{,}
:  :endif[1;1H[4L[1;1HTests for "gf" on ${VAR}

STARTTEST
:so small.vim[47;1H[K[25;1H[47;1H:if has("unix")
:  :let $CDIR = "."
:  /CDIR
:  :else
:  :if has("amiga")
:    :let $TDIR = "/testdir"
:    :else
:    :let $TDIR = "."
:    :endif
:  /TDIR
:  :endif[1;1H[10L[1;1HTests for "gf" on ${VAR}

STARTTEST
:so small.vim
:if has("ebcdic")
: set isfname=@,240-249,/,.,-,_,+,,,$,:,~,{,}
:else
: set isfname=@,48-57,/,.,-,_,+,,,$,:,~,{,}
:endif
:if has("unix")[47;1H[K[26;9H[47;1H"/sources/vim70/src/testdir/./test17a.in" 3 lines, 88 characters[1;2Hhis file is just to test "gf" in test 17.
The contents is not importent.
Just testing![4;2H[K[4;1H[1m~[m[5;2H[K[5;1H[1m~[m[6;3H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;3H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~
~[m[26;9H[K[26;1H[1m~[m[27;9H[K[27;1H[1m~[1;1H
[m[47;1H[K[47;1H:w! test.out"test.out" [47;12H[K[47;12H[New File] 3 lines, 88 characters written[2;1H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test18.failed test.ok test.out X* viminfo
cp test18.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test18.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test18.in" 16 lines, 213 characters[1;1HTests for not doing smart indenting when it isn't set.

STARTTEST
:so small.vim
:set nocin nosi ai
/some
2cc#test[1m^[[m
:?start?,$w! test.out
:qa!
ENDTEST

start text[13;17Hsome test text[14;17Htest text
test text[16;17Htest text
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 6 lines, 76 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[10;1H
[47;1H[K[47;1H:so! Xdotest[11;1H[47;1H[K[47;1H:so small.vim[11;1H[47;1H[K[47;1H:set nocin nosi ai[11;1H[47;1H[K[47;1H/some[13;17H[13;46r[46;1H
[1;47r[13;17H#test[13;22H[K[46;1H[1m~[m[47;1H[K[13;21H[14;9H[47;1H:?start?,$w! test.out"test.out" [47;12H[K[47;12H[New File] 4 lines, 41 characters written[14;9H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test19.failed test.ok test.out X* viminfo
cp test19.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test19.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test19.in" 23 lines, 374 characters[1;1HTests for "r<Tab>" with 'smarttab' and 'expandtab' set/not set.

STARTTEST
:set smarttab expandtab ts=8 sw=4
/some
r[7C:set noexpandtab
/other
r
:" Test replacing with Tabs and then backspacing to undo it
0wR[21C[1m^H^H^H^[[m
:" Test replacing with Tabs
0wR[21C[1m^[[m
:?^start?,$w! test.out
:qa!
ENDTEST

start text[18;17Hsome test text
test text[20;17Hother test text
    a cde
    f ghi
test text
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 11 lines, 204 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[15;1H
[47;1H[K[47;1H:so! Xdotest[16;1H[47;1H[K[47;1H:set smarttab expandtab ts=8 sw=4[16;1H[47;1H[K[47;1H/some[18;17H    ome test text[18;20H[47;1H[K[47;1H:set noexpandtab[18;20H[47;1H[K[47;1H/other[20;17H    ther test text[20;20H[21;9H[47;1H[K[47;1H:" Test replacing with Tabs and then backspacing to undo it[21;9H    
   [47;1H[K[47;1H:" Test replacing with Tabs[22;4H         [7Chi[23;9H[47;1H[K[47;1H:?^start?,$w! test.out"test.out" [47;12H[K[47;12H[New File] 7 lines, 91 characters written[23;9H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test20.failed test.ok test.out X* viminfo
cp test20.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test20.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test20.in" 22 lines, 361 characters[1;1HTests Blockwise Visual when there are TABs before the text.
First test for undo working properly when executing commands from a register.
Also test this in an empty buffer.

STARTTEST
:so tiny.vim
G0"ay$k@au
:new
@auY:quit!
GP
/start here$
[1m^V[mjjlld
:/here$/,$-1w! test.out
:qa!
ENDTEST

test text test tex start here[18;17Hsome text[19;17Htest text
test text

Ox[1m^[[mjAy[1m^[[mkdd
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[5;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[6;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 9 lines, 92 characters written[6;1H[47;1H[K[47;1H:set ff& cpo+=A[6;1H[47;1H/ENDTEST[47;10H[K[47;1H[15;1H
[47;1H[K[47;1H:so! Xdotest[16;1H[47;1H[K[47;1H:so tiny.vim[16;1H[22;1H[21;1H[21;46r[21;1H[L[1;47r[21;1Hx[47;1H[K[21;1H
y[21;1H[21;46r[46;1H
[1;47r[46;1H[1m~[21;1H[m[47;1H2 changes; before #1  0 seconds ago[21;1H[K[21;1H
[47;1H[K[47;1H:new[1;1H[K[2;2H[K[2;1H[1m~[m[3;2H[K[3;1H[1m~
~[m[5;2H[K[5;1H[1m~[m[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~
~[m[17;2H[K[17;1H[1m~[m[18;17H[K[18;1H[1m~[m[19;17H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~
~[m[22;2H[K[22;1H[1m~[m
[1m[7m[No Name]                                                                                                                      [m[24;1HTests Blockwise Visual when there are TABs before the text.
First test for undo working properly when executing commands from a register.
Also test this in an empty buffer.[27;1H[K[28;1HSTARTTEST
:so tiny.vim
G0"ay$k@au
:new
@auY:quit!
GP
/start here$
[1m^V[mjjlld
:/here$/,$-1w! test.out
:qa!
ENDTEST[39;1H[K[40;1Htest text test tex start here
  [14Csome text
  [14Ctest text
test text[44;1H[K[45;1HOx[1m^[[mjAy[1m^[[mkdd
[7mtest20.in                                                                                                                      [1;1H[1;22r[m[1;1H[L[1;47r[1;1Hx[23;11H[1m[7m[+][m[47;1H[K[1;1H
y[1;1H[1;22r[22;1H
[1;47r[22;1H[1m~[1;1H[m[47;1H1 line less; before #1  0 seconds ago[1;1H[K[23;11H[1m[7m    [1;1H[m[47;1H[K[47;1H:quit![1;1HTests Blockwise Visual when there are TABs before the text.
First test for undo working properly when executing commands from a register.
Also test this in an empty buffer.[4;1H[K[5;1HSTARTTEST
:so tiny.vim
G0"ay$k@au
:new
@auY:quit!
GP
/start here$
[1m^V[mjjlld
:/here$/,$-1w! test.out
:qa!
ENDTEST[16;1H[K[17;1Htest text test tex start here
  [14Csome text
  [14Ctest text
test text[21;1H[K[22;1HOx[1m^[[mjAy[1m^[[mkdd[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~
~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;2H[K[37;1H[1m~[m[38;2H[K[38;1H[1m~
~[m[40;2H[K[40;1H[1m~[m[41;17H[K[41;1H[1m~[m[42;17H[K[42;1H[1m~[m[43;2H[K[43;1H[1m~
~[m[45;2H[K[45;1H[1m~[m[46;2H[K[46;1H[1m~[22;1H[22;46r[m[22;1H[L[1;47r[47;1H[K[22;1H
[47;1H/start here$[7msearch hit BOTTOM, continuing at TOP[17;20H[m[7ms[18;20He[19;20H[17;21Ht[18;21H [19;20Ht[17;22Ha[18;22Ht[19;21H [m[17;20Hrt here[17;27H[K[18;20Hext[18;23H[K[19;20Hex[19;23H[K[17;20H[18;20H[47;1H[K[47;1H:/here$/,$-1w! test.out[7msearch hit BOTTOM, continuing at TOP[m"test.out" [47;12H[K[47;12H[New File] 6 lines, 57 characters written[18;20H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test21.failed test.ok test.out X* viminfo
cp test21.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test21.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test21.in" 19 lines, 297 characters[1;1HTests for [ CTRL-I with a count and CTRL-W CTRL-I with a count

STARTTEST
:so small.vim
/start
6[      :.w! test.out
?start here
6[1m^W[m     :.w >>test.out
:qa!
ENDTEST

#include test21.in

/* test text test tex start here[15;17Hsome text[16;17Htest text[17;17Hstart OK if found this line[18;9Hstart found wrong line
test text
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 6 lines, 73 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[10;1H
[47;1H[K[47;1H:so! Xdotest[11;1H[47;1H[K[47;1H:so small.vim[11;1H[47;1H[K[47;1H/start[14;23H[17;17H[47;1H[K[47;1H:.w! test.out"test.out" [47;12H[K[47;12H[New File] 1 line, 30 characters written[17;17H[47;1H[K[47;1H?start here[14;23H[23;1H[1m[7mtest21.in                                                                                                                      [m[24;1HTests for [ CTRL-I with a count and CTRL-W CTRL-I with a count[25;1H[K[26;1HSTARTTEST
:so small.vim
/start
6[      :.w! test.out
?start here
6[1m^W[m     :.w >>test.out
:qa!
ENDTEST[34;1H[K[35;1H#include test21.in[36;1H[K[37;1H/* test text test tex start here
  [14Csome text
  [14Ctest text
  [14Cstart OK if found this line
        start found wrong line
test text[46;1H[7mtest21.in                                                                                                                      [17;17H[m[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 30 characters appended[17;17H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test22.failed test.ok test.out X* viminfo
cp test22.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test22.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test22.in" 13 lines, 197 characters[1;1HTests for file with some lines ending in CTRL-M, some not[1m^M
^M[m
STARTTEST
:set ta tx
:e!
:$-3,$w! test.out
:qa!
ENDTEST

this lines ends in a[1m^M[m
this one doesn't
this one does[1m^M[m
and the last one doesn't
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 4 lines, 38 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[8;1H
[47;1H[K[47;1H:so! Xdotest[9;1H[47;1H[K[47;1H:set ta tx[9;1H[47;1H[K[47;1H:e!"test22.in" 13 lines, 197 characters[1;1H[47;1H[K[47;1H:$-3,$w! test.out"test.out" [47;12H[K[47;12H[New File] 4 lines, 79 characters written[1;1H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test23.failed test.ok test.out X* viminfo
cp test23.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test23.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test23.in" 15 lines, 282 characters[1;1HTests for complicated + argument to :edit command

STARTTEST
:$-1w! Xfile1
:$w! Xfile2
:edit +1|s/|/PIPE/|w Xfile1| e Xfile2|1 | s/\//SLASH/|w
:w! test.out
:e Xfile1
:w >> test.out
:qa!
ENDTEST

The result should be in Xfile1: "fooPIPEbar", in Xfile2: "fooSLASHbar"
foo|bar
foo/bar
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 7 lines, 125 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[11;1H
[47;1H[K[47;1H:so! Xdotest[12;1H[47;1H[K[47;1H:$-1w! Xfile1"Xfile1" [47;10H[K[47;10H[New File] 1 line, 8 characters written[12;1H[47;1H[K[47;1H:$w! Xfile2"Xfile2" [47;10H[K[47;10H[New File] 1 line, 8 characters written[12;1H[47;1H[K[47;1H:edit +1|s/|/PIPE/|w Xfile1| e Xfile2|1 | s/\//SLASH/|w"Xfile1" [47;10H[K[47;10H1 line, 8 characters
foo|bar
"Xfile1" 1 line, 11 characters written
"Xfile2" 1 line, 8 characters
foo/bar
"Xfile2" 1 line, 12 characters written
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:w! test.out"test.out" [47;12H[K[47;12H[New File] 1 line, 12 characters written
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:e Xfile1"Xfile1" 1 line, 11 characters[1;1H[7L[1;1HfooPIPEbar
[1m~
~
~
~
~
~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~
~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[47;1H[K[47;1H"Xfile1" 1 line, 11 characters[1;1H[47;1H[K[47;1H:w >> test.out"test.out" [47;12H[K[47;12H1 line, 11 characters appended[1;1H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test24.failed test.ok test.out X* viminfo
cp test24.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test24.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test24.in" 79 lines, 1240 characters[1;1HTests for regexp with backslash and other special characters inside []
Also test backslash for hex/octal numbered character.

STARTTEST
:set nocompatible viminfo+=nviminfo
/[\x]
x/[\t\]]
x/[]y]
x/[\]]
x/[y^]
x/[$y]
x/[\x61]
x/[\x60-\x64]
xj0/[\x785]
x/[\o143]
x/[\o140-\o144]
x/[\o417]
x/\%x42
x/\%o103
x/[\x00]
x
:s/[\x00-\x10]//g

:s/[\x-z]\+//

:s/[\u-z]\{2,}//

:s/\(a\)\+//

:s/\(a*\)\+//

:s/\(a*\)*//

:s/\(a\)\{2,3}/A/

:s/\(a\)\{-2,3}/A/

:s/\(a\)*\(12\)\@>/A/

:s/\(foo\)\@<!bar/A/

:s/\(an\_s\+\)\@<=file/A/

:s/^\(\h\w*\%(->\|\.\)\=\)\+=/XX/

:s/^\(\h\w*\%(->\|\.\)\=\)\+=/YY/[1;1H[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[4;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[5;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 44 lines, 480 characters written[5;1H[47;1H[K[47;1H:set ff& cpo+=A[5;1H[47;1H/ENDTEST[47;10H[K[47;1H[1;46r[1;1H[3M[1;47r[44;1H:?start?,$w! test.out
:qa!
ENDTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H
:so! Xdotest[46;1H[47;1H[K[47;1H:set nocompatible viminfo+=nviminfo[46;1H[47;1H[K[47;1H/[\x][1;46r[1;1H[2M[1;47r[45;1Hstart
test \text test text[47;1H[K[46;6Htext test text[46;20H[K[46;6H
/[\t\]][1;46r[46;1H
[1;47r[46;1Htest    text test text[47;1H[K[46;8Htext test tex[46;20H[K[46;6H
/[]y][1;46r[46;1H
[1;47r[46;1Htest text ]test text[47;1H[K[46;11Htest text[46;20H[K[46;11H
/[\]][1;46r[46;1H
[1;47r[46;1Htest ]text test text[47;1H[K[46;6Htext test text[46;20H[K[46;6H
/[y^][1;46r[46;1H
[1;47r[46;1Htest text te^st text[47;1H[K[46;13Hst text[46;20H[K[46;13H
/[$y][1;46r[46;1H
[1;47r[46;1Htest te$xt test text[47;1H[K[46;8Hxt test text[46;20H[K[46;8H
/[\x61][1;46r[46;1H
[1;47r[46;1Htest taext test text  x61[47;1H[K[46;7Hext test text  x61[46;25H[K[46;7H
/[\x60-\x64][1;46r[46;1H
[1;47r[46;1Htest tbext test text  x60-x64[47;1H[K[46;7Hext test text  x60-x64[46;29H[K[46;7H[1;46r[46;1H
[1;47r[46;1Htest 5text test text  x78 5[46;7H
/[\x785][46;6Htext test text  x78 5[46;27H[K[46;6H[47;1H[K[47;1H/[\o143][1;46r[46;1H
[1;47r[46;1Htestc text test text  o143[47;1H[K[46;5H text test text  o143[46;26H[K[46;5H
/[\o140-\o144][1;46r[46;1H
[1;47r[46;1Htesdt text test text  o140-o144[47;1H[K[46;4Ht text test text  o140-o14[46;31H[K[46;4H
/[\o417][1;46r[46;1H
[1;47r[46;1Htest7 text test text  o41 7[47;1H[K[46;5H text test text  o41 7[46;27H[K[46;5H
/\%x42[1;46r[46;1H
[1;47r[46;1Htest text tBest text  \%x42[47;1H[K[46;12Hest text  \%x42[46;27H[K[46;12H
/\%o103[1;46r[46;1H
[1;47r[46;1Htest text teCst text  \%o103[47;1H[K[46;13Hst text  \%o103[46;28H[K[46;13H
/[\x00][1;46r[46;1H
[1;47r[46;1Htest text [1m^@[mtest text  [\x00][47;1H[K[46;11Htest text  [\x00][46;28H[K[46;11H[1;46r[46;1H
[1;47r[46;1Htest te[1m^@[mxt t[1m^D[mest t[1m^P[mext  [\x00-\x10][46;11H
:s/[\x00-\x10]//g3 substitutions on 1 line[46;8Hxt test text  [\x00-\x10][46;33H[K[46;1H[1;46r[46;1H
[1;47r[46;1Htest \xyztext test text  [\x-z][47;1H[K[46;1H
:s/[\x-z]\+//[46;6Htext test text  [\x-z][46;28H[K[46;1H[1;46r[46;1H
[1;47r[46;1Htest text tev\uyst text  [\u-z][47;1H[K[46;1H
:s/[\u-z]\{2,}//[46;13Hst text  [\u-z][46;28H[K[46;1H[1;46r[46;1H
[1;47r[46;1Hxx aaaaa xx a[47;1H[K[46;1H
:s/\(a\)\+//[46;4H xx [46;10H[K[46;1H[1;46r[46;1H
[1;47r[46;1Hxx aaaaa xx a[47;1H[K[46;1H
:s/\(a*\)\+//[46;1H[1;46r[46;1H
[1;47r[46;1Hxx aaaaa xx a[47;1H[K[46;1H
:s/\(a*\)*//[46;1H[1;46r[46;1H
[1;47r[46;1Hxx aaaaa xx[47;1H[K[46;1H
:s/\(a\)\{2,3}/A/[46;4HAaa xx[46;10H[K[46;1H[1;46r[46;1H
[1;47r[46;1Hxx aaaaa xx[47;1H[K[46;1H
:s/\(a\)\{-2,3}/A/[46;4HAaaa x[46;11H[K[46;1H[1;46r[46;1H
[1;47r[46;1Hxx aaa12aa xx[47;1H[K[46;1H
:s/\(a\)*\(12\)\@>/A/[46;4HAaa xx[46;10H[K[46;1H[1;46r[46;1H
[1;47r[46;1Hxx foobar xbar xx[47;1H[K[46;1H
:s/\(foo\)\@<!bar/A/[46;12HA xx[46;16H[K[46;1H[1;46r[46;1H
[1;47r[46;1Hxx an file xx[47;1H[K[46;1H
:s/\(an\_s\+\)\@<=file/A/[46;7HA xx[46;12H[K[46;1H[1;46r[46;1H
[1;47r[46;1Hx= 9;[47;1H[K[46;1H
:s/^\(\h\w*\%(->\|\.\)\=\)\+=/XX/[46;1HXX[1;46r[46;1H
[1;47r[46;1Hhh= 77;[47;1H[K[46;1H
:s/^\(\h\w*\%(->\|\.\)\=\)\+=/YY/[46;1HYY 77;[46;7H[K[46;1H[47;1H[K[47;1H:?start?,$w! test.out"test.out" [47;12H[K[47;12H[New] 29L, 571C written[46;1H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test25.failed test.ok test.out X* viminfo
cp test25.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test25.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test25.in" 31 lines, 840 characters[1;1HTest for jumping to a tag with 'hidden' set, with symbolic link in path of tag.
This only works for Unix, because of the symbolic link.

STARTTEST
:so small.vim
:set hidden
:" Create a link from test25.dir to the current directory.
:!rm -f test25.dir
:!ln -s . test25.dir
:" Create tags.text, with the current directory name inserted.
/tags line
:r !pwd
d$/test
hP:.w! tags.test
:" Try jumping to a tag in the current file, but with a path that contains a
:" symbolic link.  When wrong, this will give the ATTENTION message.  The next
:" space will then be eaten by hit-return, instead of moving the cursor to 'd'.
:set tags=tags.test
G[1m^][m x:.w! test.out
:!rm -f test25.dir tags.test
:qa!
ENDTEST

tags line:
SECTION_OFF     /test25.dir/test25.in   /^#define  SECTION_OFF  3$/

/*tx.c*/
#define  SECTION_OFF  3
#define  NUM_SECTIONS 3

SECTION_OFF
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[4;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[5;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 17 lines, 540 characters written[5;1H[47;1H[K[47;1H:set ff& cpo+=A[5;1H[47;1H/ENDTEST[47;10H[K[47;1H[22;1H
[47;1H[K[47;1H:so! Xdotest[23;1H[47;1H[K[47;1H:so small.vim[23;1H[47;1H[K[47;1H:set hidden[23;1H[47;1H[K[47;1H:" Create a link from test25.dir to the current directory.[23;1H[47;1H[K[47;1H:!rm -f test25.dir[18C[?1l>[47;1H
[?1h=[47;1H
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:!ln -s . test25.dir[20C[?1l>[47;1H
[?1h=[47;1H
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:" Create tags.text, with the current directory name inserted.[m[H[2J[1;1HTest for jumping to a tag with 'hidden' set, with symbolic link in path of tag.
This only works for Unix, because of the symbolic link.

STARTTEST
:so small.vim
:set hidden
:" Create a link from test25.dir to the current directory.
:!rm -f test25.dir
:!ln -s . test25.dir
:" Create tags.text, with the current directory name inserted.
/tags line
:r !pwd
d$/test
hP:.w! tags.test
:" Try jumping to a tag in the current file, but with a path that contains a
:" symbolic link.  When wrong, this will give the ATTENTION message.  The next
:" space will then be eaten by hit-return, instead of moving the cursor to 'd'.
:set tags=tags.test
G[1m^][m x:.w! test.out
:!rm -f test25.dir tags.test
:qa!
ENDTEST

tags line:
SECTION_OFF     /test25.dir/test25.in   /^#define  SECTION_OFF  3$/

/*tx.c*/
#define  SECTION_OFF  3
#define  NUM_SECTIONS 3

SECTION_OFF
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[23;1H[47;1H[m/tags line[24;1H[47;1H[K[47;1H:r !pwd[m[H[2J[1;1HTest for jumping to a tag with 'hidden' set, with symbolic link in path of tag.
This only works for Unix, because of the symbolic link.

STARTTEST
:so small.vim
:set hidden
:" Create a link from test25.dir to the current directory.
:!rm -f test25.dir
:!ln -s . test25.dir
:" Create tags.text, with the current directory name inserted.
/tags line
:r !pwd
d$/test
hP:.w! tags.test
:" Try jumping to a tag in the current file, but with a path that contains a
:" symbolic link.  When wrong, this will give the ATTENTION message.  The next
:" space will then be eaten by hit-return, instead of moving the cursor to 'd'.
:set tags=tags.test
G[1m^][m x:.w! test.out
:!rm -f test25.dir tags.test
:qa!
ENDTEST

tags line:
/sources/vim70/src/testdir
SECTION_OFF     /test25.dir/test25.in   /^#define  SECTION_OFF  3$/

/*tx.c*/
#define  SECTION_OFF  3
#define  NUM_SECTIONS 3

SECTION_OFF
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~[25;1H[m[25;1H[K[25;1H[47;1H/test[26;18H/sources/vim70/src/testdir/test25.dir/test25.in /^#define  SECTION_OFF  3$/[26;42H[47;1H[K[47;1H:.w! tags.test"tags.test" [47;13H[K[47;13H[New File] 1 line, 88 characters written[26;42H[47;1H[K[47;1H:" Try jumping to a tag in the current file, but with a path that contains a[26;42H[47;1H[K[47;1H:" symbolic link.  When wrong, this will give the ATTENTION message.  The next[26;42H[47;1H[K[47;1H:" space will then be eaten by hit-return, instead of moving the cursor to 'd'.[26;42H[47;1H[K[47;1H:set tags=tags.test[26;42H[32;1H[29;1H#efine  SECTION_OFF  3[29;23H[K[29;2H[47;1H[K[47;1H:.w! test.out"test.out" [47;12H[K[47;12H[New File] 1 line, 23 characters written[29;2H[47;1H[K[47;1H:!rm -f test25.dir tags.test[28C[?1l>[47;1H
[No write since last change]
[?1h=[47;1H
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test26.failed test.ok test.out X* viminfo
cp test26.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test26.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test26.in" 43 lines, 739 characters[1;1HTest for :execute, :while and :if

STARTTEST
:so small.vim
mt:let i = 0
:while i < 12
:  let i = i + 1
:  if has("ebcdic")
:    execute "normal o" . i . "\047"
:  else
:    execute "normal o" . i . "\033"
:  endif
:  if i % 2
:    normal Ax[1m^V^[[m
:    if i == 9
:      break
:    endif
:    if i == 5
:      continue
:    else
:      let j = 9
:      while j > 0
:[8Cif has("ebcdic")
:[10Cexecute "normal" j . "a" . j . "\x27"
:[8Celse
:[10Cexecute "normal" j . "a" . j . "\x1b"
:[8Cendif
:[8Clet j = j - 1
:      endwhile
:    endif
:  endif
:  if i == 9
:    if has("ebcdic")
:      execute "normal Az\047"
:    else
:      execute "normal Az\033"
:    endif
:  endif
:endwhile
:'t,$w! test.out
:qa!
ENDTEST

[1m~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 38 lines, 685 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[42;1H
[47;1H[K[47;1H:so! Xdotest[43;1H[47;1H[K[47;1H:so small.vim[43;1H[47;1H[K[47;1H:let i = 0[43;1H[47;1H[K[47;1H:while i < 12
:  :  let i = i + 1
:  :  if has("ebcdic")
:    :    execute "normal o" . i . "\047"
:    :  else
:    :    execute "normal o" . i . "\033"
:    :  endif
:  :  if i % 2
:    :    normal Ax^[1m^[[m
:    :    if i == 9
:      :      break
:      :    endif
:    :    if i == 5
:      :      continue
:      :    else
:      :      let j = 9
:      :      while j > 0
:[8C:        if has("ebcdic")
:[10C:          execute "normal" j . "a" . j . "\x27"
:[10C:        else
:[10C:          execute "normal" j . "a" . j . "\x1b"
:[10C:        endif
:[8C:        let j = j - 1
:[8C:      endwhile
:      :    endif
:    :  endif
:  :  if i == 9
:    :    if has("ebcdic")
:      :      execute "normal Az\047"
:      :    else
:      :      execute "normal Az\033"
:      :    endif
:    :  endif
:  :endwhile[1;1H[33L[1;1H:  let i = i + 1
:  if has("ebcdic")
:    execute "normal o" . i . "\047"
:  else
:    execute "normal o" . i . "\033"
:  endif
:  if i % 2
:    normal Ax[1m^V^[[m
:    if i == 9
:      break
:    endif
:    if i == 5
:      continue
:    else
:      let j = 9
:      while j > 0
:[8Cif has("ebcdic")
:[10Cexecute "normal" j . "a" . j . "\x27"
:[8Celse
:[10Cexecute "normal" j . "a" . j . "\x1b"
:[8Cendif
:[8Clet j = j - 1
:      endwhile
:    endif
:  endif
:  if i == 9
:    if has("ebcdic")
:      execute "normal Az\047"
:    else
:      execute "normal Az\033"
:    endif
:  endif
:endwhile
:'t,$w! test.out[34;17H[K[35;2Hqa![35;6H[K[36;1HENDTEST[36;8H[K[37;1H[K[38;1H1x999999999888888887777777666666555554444333221
2[39;2H[K[40;1H3x999999999888888887777777666666555554444333221
4[41;2H[K[42;1H5x[42;3H[K[43;1H6
7x999999999888888887777777666666555554444333221
8
9x[47;1H[K[46;2H
:'t,$w! test.out"test.out" [47;12H[K[47;12H[New File] 10 lines, 159 characters written[46;2H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test27.failed test.ok test.out X* viminfo
cp test27.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test27.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test27.in" 20 lines, 270 characters[1;1HTest for expanding file names

STARTTEST
:!mkdir Xdir1
:!mkdir Xdir2
:!mkdir Xdir3
:cd Xdir3
:!mkdir Xdir4
:cd ..
:w Xdir1/file
:w Xdir3/Xdir4/file
:n Xdir?/*/file
Go[1m^R[m%[1m^[[m:.w! test.out
:n! Xdir?/*/nofile
Go[1m^R[m%[1m^[[m:.w >>test.out
:e! xx
:!rm -rf Xdir1 Xdir2 Xdir3
:qa!
ENDTEST

[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 15 lines, 220 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[19;1H
[47;1H[K[47;1H:so! Xdotest[20;1H[47;1H[K[47;1H:!mkdir Xdir1[13C[?1l>[47;1H
[?1h=[47;1H
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:!mkdir Xdir2[13C[?1l>[47;1H
[?1h=[47;1H
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:!mkdir Xdir3[13C[?1l>[47;1H
[?1h=[47;1H
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:cd Xdir3/sources/vim70/src/testdir/Xdir3
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:!mkdir Xdir4[13C[?1l>[47;1H
[?1h=[47;1H
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:cd ../sources/vim70/src/testdir
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:w Xdir1/file"Xdir1/file" [New File] 20 lines, 270 characters written
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:w Xdir3/Xdir4/file"Xdir3/Xdir4/file" [New File] 20 lines, 270 characters written
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:n Xdir?/*/file"Xdir3/Xdir4/file" 20 lines, 270 characters[m[H[2J[1;1HTest for expanding file names

STARTTEST
:!mkdir Xdir1
:!mkdir Xdir2
:!mkdir Xdir3
:cd Xdir3
:!mkdir Xdir4
:cd ..
:w Xdir1/file
:w Xdir3/Xdir4/file
:n Xdir?/*/file
Go[1m^R[m%[1m^[[m:.w! test.out
:n! Xdir?/*/nofile
Go[1m^R[m%[1m^[[m:.w >>test.out
:e! xx
:!rm -rf Xdir1 Xdir2 Xdir3
:qa!
ENDTEST

[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[m
"Xdir3/Xdir4/file" 20 lines, 270 characters[1;1H[20;1H
Xdir3/Xdir4/file[47;1H[K[47;1H:.w! test.out"test.out" [47;12H[K[47;12H[New File] 1 line, 17 characters written[21;16H[47;1H[K[47;1H:n! Xdir?/*/nofile"Xdir?/*/nofile" [New DIRECTORY][1;1H[K[2;1H[1m~[m[3;2H[K[3;1H[1m~[m[4;2H[K[4;1H[1m~[m[5;2H[K[5;1H[1m~[m[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~
~[m[21;2H[K[21;1H[1m~[1;1H[m
Xdir?/*/nofile[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 15 characters appended[2;14H[47;1H[K[47;1H:e! xx"xx" [New File][2;2H[K[2;1H[1m~[1;1H[m[47;1H[K[47;1H:!rm -rf Xdir1 Xdir2 Xdir3[26C[?1l>[47;1H
[?1h=[47;1H
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test28.failed test.ok test.out X* viminfo
cp test28.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test28.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test28.in" 23 lines, 364 characters[1;1HTest for sourcing a file with CTRL-V's at the end of the line

STARTTEST
:/firstline/+1,/lastline/-1w! Xtestfile
:so Xtestfile
Gmm__1[1m^[^[[m__2[1m^[[m__3[1m^[^[[m__4[1m^[[m__5[1m^[[m:'m,$s/[1m^@[m/0/g
:'m,$w! test.out
:qa!
ENDTEST

firstline
map __1 afirst
map __2 asecond
map __3 athird
map __4 afourth
map __5 afifth
map __1 asd[1m^V[m
map __2 asd[1m^V^V[m
map __3 asd[1m^V^V[m
map __4 asd[1m^V^V^V[m
map __5 asd[1m^V^V^V[m
lastline

[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 5 lines, 114 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[9;1H
[47;1H[K[47;1H:so! Xdotest[10;1H[47;1H[K[47;1H:/firstline/+1,/lastline/-1w! Xtestfile"Xtestfile" [47;13H[K[47;13H[New File] 10 lines, 148 characters written[10;1H[47;1H[K[47;1H:so Xtestfile[10;1H[23;1H[24;12H[23;1Hsd
map __2 asd[1m^[[m[2Csecondd  sd[1m^[^[[m  [13C[24;24Hsd[1m^@[mmap __5 asd[1m^@[m[2Cfifth[47;1H[K[47;1H:'m,$s/[1m^@[m/0/g[24;26H0map __5 asd0fifth[24;44H[K[24;1H[47;1H[K[47;1H:'m,$w! test.out"test.out" [47;12H[K[47;12H[New File] 2 lines, 45 characters written[24;1H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test29.failed test.ok test.out X* viminfo
cp test29.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test29.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test29.in" 67 lines, 663 characters[1;1HTest for joining lines with 'joinspaces' set or not

STARTTEST
:set nojoinspaces
/firstline/
jJjJjJjJjJjJjJjJjJjJjJjJjJjJ:set joinspaces
jJjJjJjJjJjJjJjJjJjJjJjJjJjJ:?firstline?+1,$w! test.out
:qa!
ENDTEST

firstline
asdfasdf.
asdf
asdfasdf.
asdf
asdfasdf.
asdf
asdfasdf.
asdf
asdfasdf.
asdf
asdfasdf.
asdf
asdfasdf.
asdf
asdfasdf
asdf
asdfasdf
asdf
asdfasdf
asdf
asdfasdf
asdf
asdfasdf
asdf
asdfasdf
asdf
asdfasdf
asdf
asdfasdf.
asdf
asdfasdf.
asdf
asdfasdf.
asdf
asdfasdf.[1;1H[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 5 lines, 135 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[9;1H
[47;1H[K[47;1H:so! Xdotest[10;1H[47;1H[K[47;1H:set nojoinspaces[10;1H[47;1H[K[47;1H/firstline/[47;11H[K[47;1H[11;1H
[12;46r[46;1H
[1;47r[12;5Hasdf. asdf[46;1Hasdf[47;1H[K[12;10H[13;10H[13;46r[46;1H
[1;47r[13;5Hasdf. asdf[46;1Hasdfasdf.[13;11H[14;11H[14;46r[46;1H
[1;47r[14;5Hasdf.  asdf[46;1Hasdf[14;12H[15;16H[15;46r[46;1H
[1;47r[15;5Hasdf.[7Casdf[46;1Hasdfasdf.[15;17H[16;16H[16;46r[46;1H
[1;47r[16;5Hasdf.[7Casdf[46;1Hasdf[16;17H[17;17H[17;46r[46;1H
[1;47r[17;5Hasdf.[8Casdf[46;1Hasdfasdf.[17;18H[18;24H[18;46r[46;1H
[1;47r[18;5Hasdf.[15Casdf[46;1Hasdf[18;25H[19;8H[19;46r[46;1H
[1;47r[19;5Hasdf asdf[46;1Hasdfasdf[19;9H[20;9H[20;46r[46;1H
[1;47r[20;5Hasdf asdf[46;1Hasdf[20;10H[21;10H[21;46r[46;1H
[1;47r[21;5Hasdf  asdf[46;1Hasdfasdf[21;11H[22;16H[22;46r[46;1H
[1;47r[22;5Hasdf[8Casdf[46;1Hasdf[22;17H[23;17H[23;46r[46;1H
[1;47r[23;5Hasdf[9Casdf[46;1Hasdfasdf[23;18H[24;16H[24;46r[46;1H
[1;47r[24;5Hasdf[8Casdf[46;1Hasdf[24;17H[25;24H[25;46r[46;1H
[1;47r[25;5Hasdf[16Casdf[46;1Hasdfasdf[25;25H[47;1H:set joinspaces[25;25H[26;9H[26;46r[46;1H
[1;47r[26;5Hasdf.  asdf[46;1Hasdf[47;1H[K[26;10H[27;10H[27;46r[46;1H
[1;47r[27;5Hasdf.  asdf[46;1Hasdfasdf[27;11H[28;11H[28;46r[46;1H
[1;47r[28;5Hasdf.  asdf[46;1Hasdf[28;12H[29;16H[29;46r[46;1H
[1;47r[29;5Hasdf.[7Casdf[46;1Hasdfasdf[29;17H[30;16H[30;46r[46;1H
[1;47r[30;5Hasdf.[7Casdf[46;1Hasdf[30;17H[31;17H[31;46r[46;1H
[1;47r[31;5Hasdf.[8Casdf[46;1Hasdfasdf[31;18H[32;24H[32;46r[46;1H
[1;47r[32;5Hasdf.[15Casdf[46;1Hasdf[32;25H[33;8H[33;46r[46;1H
[1;47r[33;5Hasdf asdf[46;1H[1m~[33;9H[34;9H[34;46r[m[46;1H
[1;47r[34;5Hasdf asdf[46;1H[1m~[34;10H[35;10H[35;46r[m[46;1H
[1;47r[35;5Hasdf  asdf[46;1H[1m~[35;11H[36;16H[36;46r[m[46;1H
[1;47r[36;5Hasdf[8Casdf[46;1H[1m~[36;17H[37;17H[37;46r[m[46;1H
[1;47r[37;5Hasdf[9Casdf[46;1H[1m~[37;18H[38;16H[38;46r[m[46;1H
[1;47r[38;5Hasdf[8Casdf[46;1H[1m~[38;17H[39;24H[m asdf[40;2H[K[40;1H[1m~[39;25H[47;1H[m:?firstline?+1,$w! test.out"test.out" [47;12H[K[47;12H[New File] 28 lines, 424 characters written[39;25H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test30.failed test.ok test.out X* viminfo
cp test30.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test30.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test30.in" 208 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option

STARTTEST
:so small.vim
:" first write three test files, one in each format
:set fileformat=unix
:set fileformats=
:/^1/w! XX1
:/^2/w! XX2
:/^3/w! XX3
:/^4/w! XX4
:/^5/w! XX5
:/^6/w! XX6
:/^7/w! XX7
:/^8/w! XX8
:/^9/w! XX9
:/^10/w! XX10
:/^unix/;/eof/-1w! XXUnix
:/^dos/;/eof/-1w! XXDos
:set bin noeol
:$w! XXMac
:set nobin eol
:bwipe XXUnix XXDos XXMac
:" create mixed format files
:!cat XXUnix XXDos >XXUxDs
:!cat XXUnix XXMac >XXUxMac
:!cat XXDos XXMac >XXDosMac
:!cat XXUnix XXDos XXMac >XXUxDsMc
:"
:" try reading and writing with 'fileformats' empty
:set fileformat=unix
:e! XXUnix
:w! test.out
:e! XXDos
:w! XXtt01
:e! XXMac
:w! XXtt02
:bwipe XXUnix XXDos XXMac
:set fileformat=dos
:e! XXUnix
:w! XXtt11
:e! XXDos
:w! XXtt12
:e! XXMac
:w! XXtt13
:bwipe XXUnix XXDos XXMac[1;1H[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 183 lines, 2957 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[m[H[2J[1;1HGo2[1m^[[m:$r XXtt21
:$r XXtt22
:$r XXtt23
Go3[1m^[[m:$r XXtt31
:$r XXtt32
:$r XXtt33
Go4[1m^[[m:$r XXtt41
:$r XXtt42
:$r XXtt43
Go5[1m^[[m:$r XXtt51
:$r XXtt52
:$r XXtt53
Go6[1m^[[m:$r XXtt61
:$r XXtt62
:$r XXtt63
Go7[1m^[[m:$r XXtt71
Go8[1m^[[m:$r XXtt81
Go9[1m^[[m:$r XXtt91
:$r XXtt92
:$r XXtt93
Go10[1m^[[m:$r XXUnix
:set nobinary ff&
:w
:qa!
ENDTEST

1
2
3
4
5
6
7
8
9
10

unix
unix
eof

dos[1m^M[m
dos[1m^M[m
eof

mac[1m^M[mmac[1m^M[25;1H
[47;1H[m:so! Xdotest[26;1H[47;1H[K[47;1H:so small.vim[26;1H[47;1H[K[47;1H:" first write three test files, one in each format[26;1H[47;1H[K[47;1H:set fileformat=unix[26;1H[47;1H[K[47;1H:set fileformats=[26;1H[47;1H[K[47;1H:/^1/w! XX1"XX1" [47;7H[K[47;7H[New File] 1 line, 2 characters written[26;1H[47;1H[K[47;1H:/^2/w! XX2"XX2" [47;7H[K[47;7H[New File] 1 line, 2 characters written[26;1H[47;1H[K[47;1H:/^3/w! XX3"XX3" [47;7H[K[47;7H[New File] 1 line, 2 characters written[26;1H[47;1H[K[47;1H:/^4/w! XX4"XX4" [47;7H[K[47;7H[New File] 1 line, 2 characters written[26;1H[47;1H[K[47;1H:/^5/w! XX5"XX5" [47;7H[K[47;7H[New File] 1 line, 2 characters written[26;1H[47;1H[K[47;1H:/^6/w! XX6"XX6" [47;7H[K[47;7H[New File] 1 line, 2 characters written[26;1H[47;1H[K[47;1H:/^7/w! XX7"XX7" [47;7H[K[47;7H[New File] 1 line, 2 characters written[26;1H[47;1H[K[47;1H:/^8/w! XX8"XX8" [47;7H[K[47;7H[New File] 1 line, 2 characters written[26;1H[47;1H[K[47;1H:/^9/w! XX9"XX9" [47;7H[K[47;7H[New File] 1 line, 2 characters written[26;1H[47;1H[K[47;1H:/^10/w! XX10"XX10" [47;8H[K[47;8H[New File] 1 line, 3 characters written[26;1H[47;1H[K[47;1H:/^unix/;/eof/-1w! XXUnix"XXUnix" [47;10H[K[47;10H[New File] 2 lines, 10 characters written[38;1H[47;1H[K[47;1H:/^dos/;/eof/-1w! XXDos"XXDos" [47;9H[K[47;9H[New File] 2 lines, 10 characters written[42;1H[47;1H[K[47;1H:set bin noeol[42;1H[47;1H[K[47;1H:$w! XXMac"XXMac" [47;9H[K[47;9H[New File][Incomplete last line] 1 line, 8 characters written[42;1H[47;1H[K[47;1H:set nobin eol[42;1H[47;1H[K[47;1H:bwipe XXUnix XXDos XXMac3 buffers wiped out[47;21H[K[42;1H[47;1H[K[47;1H:" create mixed format files[42;1H[47;1H[K[47;1H:!cat XXUnix XXDos >XXUxDs[26C[?1l>[47;1H
[?1h=[47;1H
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:!cat XXUnix XXMac >XXUxMac[27C[?1l>[47;1H
[?1h=[47;1H
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:!cat XXDos XXMac >XXDosMac[27C[?1l>[47;1H
[?1h=[47;1H
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:!cat XXUnix XXDos XXMac >XXUxDsMc[34C[?1l>[47;1H
[?1h=[47;1H
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:"[m[H[2J[1;1HGo2[1m^[[m:$r XXtt21
:$r XXtt22
:$r XXtt23
Go3[1m^[[m:$r XXtt31
:$r XXtt32
:$r XXtt33
Go4[1m^[[m:$r XXtt41
:$r XXtt42
:$r XXtt43
Go5[1m^[[m:$r XXtt51
:$r XXtt52
:$r XXtt53
Go6[1m^[[m:$r XXtt61
:$r XXtt62
:$r XXtt63
Go7[1m^[[m:$r XXtt71
Go8[1m^[[m:$r XXtt81
Go9[1m^[[m:$r XXtt91
:$r XXtt92
:$r XXtt93
Go10[1m^[[m:$r XXUnix
:set nobinary ff&
:w
:qa!
ENDTEST

1
2
3
4
5
6
7
8
9
10

unix
unix
eof

dos[1m^M[m
dos[1m^M[m
eof

mac[1m^M[mmac[1m^M[42;1H[47;1H[m:" try reading and writing with 'fileformats' empty[42;1H[47;1H[K[47;1H:set fileformat=unix[42;1H[47;1H[K[47;1H:e! XXUnix"XXUnix" [47;10H[K[47;10H2 lines, 10 characters[1;1Hunix[1;5H[K[2;1Hunix[2;5H[K[3;2H[K[3;1H[1m~[m[4;2H[K[4;1H[1m~[m[5;2H[K[5;1H[1m~[m[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~
~
~
~
~
~
~
~
~
~
~[m[36;2H[K[36;1H[1m~
~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~
~[m[42;2H[K[42;1H[1m~[m[43;2H[K[43;1H[1m~[m[44;2H[K[44;1H[1m~
~[m[46;2H[K[46;1H[1m~[1;1H[m[47;1H[K[47;1H:w! test.out"test.out" [47;12H[K[47;12H[New File] 2 lines, 10 characters written[1;1H[47;1H[K[47;1H:e! XXDos"XXDos" [47;9H[K[47;9H2 lines, 10 characters[1;1Hdos[1m^M[m
dos[1m^M[1;1H[m[47;1H[K[47;1H:w! XXtt01"XXtt01" [47;10H[K[47;10H[New File] 2 lines, 10 characters written[1;1H[47;1H[K[47;1H:e! XXMac"XXMac" [47;9H[K[47;9H[Incomplete last line] 1 line, 8 characters[1;1Hmac[2Cmac[1m^M[m[2;2H[K[2;1H[1m~[1;1H[m[47;1H[K[47;1H:w! XXtt02"XXtt02" [47;10H[K[47;10H[New File] 1 line, 9 characters written[1;1H[47;1H[K[47;1H:bwipe XXUnix XXDos XXMac"test30.in" [47;13H[K[47;13H208 lines, 3095 characters
3 buffers wiped out
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:set fileformat=dos[1;1H[2L[1;1HGo2[1m^[[m:$r XXtt21
:$r XXtt22
:$r XXtt23
Go3[1m^[[m:$r XXtt31
:$r XXtt32
:$r XXtt33
Go4[1m^[[m:$r XXtt41
:$r XXtt42
:$r XXtt43
Go5[1m^[[m:$r XXtt51
:$r XXtt52
:$r XXtt53
Go6[1m^[[m:$r XXtt61
:$r XXtt62
:$r XXtt63
Go7[1m^[[m:$r XXtt71
Go8[1m^[[m:$r XXtt81
Go9[1m^[[m:$r XXtt91
:$r XXtt92
:$r XXtt93
Go10[1m^[[m:$r XXUnix
:set nobinary ff&
:w
:qa!
ENDTEST[26;1H[K[27;1H1
2
3
4
5
6
7
8
9
10[37;1H[K[38;1Hunix
unix
eof[41;1H[K[42;1Hdos[1m^M[m
dos[1m^M[m
eof[45;1H[K[46;1Hmac[1m^M[mmac[1m^M[m[47;1H[K[42;1H[47;1H:e! XXUnix"XXUnix" [47;10H[K[47;10H[CR missing][dos format] 2 lines, 10 characters[1;1Hunix[1;5H[K[2;1Hunix[2;5H[K[3;2H[K[3;1H[1m~[m[4;2H[K[4;1H[1m~[m[5;2H[K[5;1H[1m~[m[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~
~
~
~
~
~
~
~
~
~
~[m[36;2H[K[36;1H[1m~
~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~
~[m[42;2H[K[42;1H[1m~[m[43;2H[K[43;1H[1m~[m[44;2H[K[44;1H[1m~
~[m[46;2H[K[46;1H[1m~[1;1H[m[47;1H[K[47;1H:w! XXtt11"XXtt11" [47;10H[K[47;10H[New File][dos format] 2 lines, 12 characters written[1;1H[47;1H[K[47;1H:e! XXDos"XXDos" [47;9H[K[47;9H[dos format] 2 lines, 10 characters[1;1Hdos[1;4H[K[2;1Hdos[2;4H[K[1;1H[47;1H[K[47;1H:w! XXtt12"XXtt12" [47;10H[K[47;10H[New File][dos format] 2 lines, 10 characters written[1;1H[47;1H[K[47;1H:e! XXMac"XXMac" [47;9H[K[47;9H[Incomplete last line][dos format] 1 line, 8 characters[1;1Hmac[1m^M[mmac[1m^M[m[2;2H[K[2;1H[1m~[1;1H[m[47;1H[K[47;1H:w! XXtt13"XXtt13" [47;10H[K[47;10H[New File][dos format] 1 line, 10 characters written[1;1H[47;1H[K[47;1H:bwipe XXUnix XXDos XXMac"test30.in" [47;13H[K[47;13H[CR missing][dos format] 208 lines, 3095 characters
3 buffers wiped out
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:set fileformat=mac[1;1H[2L[1;1HGo2[1m^[[m:$r XXtt21
:$r XXtt22
:$r XXtt23
Go3[1m^[[m:$r XXtt31
:$r XXtt32
:$r XXtt33
Go4[1m^[[m:$r XXtt41
:$r XXtt42
:$r XXtt43
Go5[1m^[[m:$r XXtt51
:$r XXtt52
:$r XXtt53
Go6[1m^[[m:$r XXtt61
:$r XXtt62
:$r XXtt63
Go7[1m^[[m:$r XXtt71
Go8[1m^[[m:$r XXtt81
Go9[1m^[[m:$r XXtt91
:$r XXtt92
:$r XXtt93
Go10[1m^[[m:$r XXUnix
:set nobinary ff&
:w
:qa!
ENDTEST[26;1H[K[27;1H1
2
3
4
5
6
7
8
9
10[37;1H[K[38;1Hunix
unix
eof[41;1H[K[42;1Hdos
dos
eof[45;1H[K[46;1Hmac[1m^J[mmac[47;1H[K[42;1H[47;1H:e! XXUnix"XXUnix" [47;10H[K[47;10H[Incomplete last line][mac format] 1 line, 10 characters[1;1Hunix[1m^J[munix[1m^J[m[1;13H[K[2;2H[K[2;1H[1m~[m[3;2H[K[3;1H[1m~[m[4;2H[K[4;1H[1m~[m[5;2H[K[5;1H[1m~[m[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~
~
~
~
~
~
~
~
~
~
~[m[36;2H[K[36;1H[1m~
~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~
~[m[42;2H[K[42;1H[1m~[m[43;2H[K[43;1H[1m~[m[44;2H[K[44;1H[1m~
~[m[46;2H[K[46;1H[1m~[1;1H[m[47;1H[K[47;1H:w! XXtt21"XXtt21" [47;10H[K[47;10H[New File][mac format] 1 line, 11 characters written[1;1H[47;1H[K[47;1H:e! XXDos"XXDos" [47;9H[K[47;9H[Incomplete last line][mac format] 3 lines, 10 characters[1;1Hdos[1;4H[K[2;1H[1m^J[mdos
[1m^J[1;1H[m[47;1H[K[47;1H:w! XXtt22"XXtt22" [47;10H[K[47;10H[New File][mac format] 3 lines, 11 characters written[1;1H[47;1H[K[47;1H:e! XXMac"XXMac" [47;9H[K[47;9H[mac format] 2 lines, 8 characters[1;1Hmac
mac[2;4H[K[3;2H[K[3;1H[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:w! XXtt23"XXtt23" [47;10H[K[47;10H[New File][mac format] 2 lines, 8 characters written[1;1H[47;1H[K[47;1H:bwipe XXUnix XXDos XXMac"test30.in" [47;13H[K[47;13H[Incomplete last line][mac format] 5 lines, 3095 characters
3 buffers wiped out
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:"[1;1H[2L[1;1HTest for a lot of variations of the 'fileformats' option[1m^J^J[mSTARTTEST[1m^J[m:so small.vim[1m^J[m:" first write three test files, one in ee[2;1Hach format[1m^J[m:set fileformat=unix[1m^J[m:set fileformats=[1m^J[m:/^1/w! XX1[1m^J[m:/^2/w! XX2[1m^J[m:/^3/w! XX3[1m^J[m:/^4/w! XX4[1m^J[m:/^5/w! XX5[1m^J[m:/^6/w! XX[3;1HX6[1m^J[m:/^7/w! XX7[1m^J[m:/^8/w! XX8[1m^J[m:/^9/w! XX9[1m^J[m:/^10/w! XX10[1m^J[m:/^unix/;/eof/-1w! XXUnix[1m^J[m:/^dos/;/eof/-1w! XXDos[1m^J[m:set bin noeol[1m^J[m::[4;1H$w! XXMac[1m^J[m:set nobin eol[1m^J[m:bwipe XXUnix XXDos XXMac[1m^J[m:" create mixed format files[1m^J[m:!cat XXUnix XXDos >XXUxDs[1m^J[m:!cat XXUnix XXX[5;1HMac >XXUxMac[1m^J[m:!cat XXDos XXMac >XXDosMac[1m^J[m:!cat XXUnix XXDos XXMac >XXUxDsMc[1m^J[m:"[1m^J[m:" try reading and writing with 'fileformatss[6;1H' empty[1m^J[m:set fileformat=unix[1m^J[m:e! XXUnix[1m^J[m:w! test.out[1m^J[m:e! XXDos[1m^J[m:w! XXtt01[1m^J[m:e! XXMac[1m^J[m:w! XXtt02[1m^J[m:bwipe XXUnix XXDos XXMaa[7;1Hc[1m^J[m:set fileformat=dos[1m^J[m:e! XXUnix[1m^J[m:w! XXtt11[1m^J[m:e! XXDos[1m^J[m:w! XXtt12[1m^J[m:e! XXMac[1m^J[m:w! XXtt13[1m^J[m:bwipe XXUnix XXDos XXMac[1m^J[m:set ff[8;1Hileformat=mac[1m^J[m:e! XXUnix[1m^J[m:w! XXtt21[1m^J[m:e! XXDos[1m^J[m:w! XXtt22[1m^J[m:e! XXMac[1m^J[m:w! XXtt23[1m^J[m:bwipe XXUnix XXDos XXMac[1m^J[m:"[1m^J[m:" try readd[9;1Hing and writing with 'fileformats' set to one format[1m^J[m:set fileformats=unix[1m^J[m:e! XXUxDsMc[1m^J[m:w! XXtt31[1m^J[m:bwipe XXUxDsMc[1m^J[m:set fii[10;1Hleformats=dos[1m^J[m:e! XXUxDsMc[1m^J[m:w! XXtt32[1m^J[m:bwipe XXUxDsMc[1m^J[m:set fileformats=mac[1m^J[m:e! XXUxDsMc[1m^J[m:w! XXtt33[1m^J[m:bwipe XXUxDsMc[1m^J[m:"[1m^JJ[m[11;1H:" try reading and writing with 'fileformats' set to two formats[1m^J[m:set fileformats=unix,dos[1m^J[m:e! XXUxDsMc[1m^J[m:w! XXtt41[1m^J[m:bwipe XX[12;1HXUxDsMc[1m^J[m:e! XXUxMac[1m^J[m:w! XXtt42[1m^J[m:bwipe XXUxMac[1m^J[m:e! XXDosMac[1m^J[m:w! XXtt43[1m^J[m:bwipe XXDosMac[1m^J[m:set fileformats=unix,mac[1m^J[m:e! XXUU[13;1HxDs[1m^J[m:w! XXtt51[1m^J[m:bwipe XXUxDs[1m^J[m:e! XXUxDsMc[1m^J[m:w! XXtt52[1m^J[m:bwipe XXUxDsMc[1m^J[m:e! XXDosMac[1m^J[m:w! XXtt53[1m^J[m:bwipe XXDosMac[1m^J[m:set filee[14;1Hformats=dos,mac[1m^J[m:e! XXUxDs[1m^J[m:w! XXtt61[1m^J[m:bwipe XXUxDs[1m^J[m:e! XXUxMac[1m^J[m:w! XXtt62[1m^J[m:bwipe XXUxMac[1m^J[m:e! XXUxDsMc[1m^J[m:w! XXtt63[1m^J[m:bwii[15;1Hpe XXUxDsMc[1m^J[m:"[1m^J[m:" try reading and writing with 'fileformats' set to three formats[1m^J[m:set fileformats=unix,dos,mac[1m^J[m:e! XXUxDsMM[16;1Hc[1m^J[m:w! XXtt71[1m^J[m:bwipe XXUxDsMc[1m^J[m:set fileformats=mac,dos,unix[1m^J[m:e! XXUxDsMc[1m^J[m:w! XXtt81[1m^J[m:bwipe XXUxDsMc[1m^J[m:" try with 'binary'  [17;1Hset[1m^J[m:set fileformats=mac,unix,dos[1m^J[m:set binary[1m^J[m:e! XXUxDsMc[1m^J[m:w! XXtt91[1m^J[m:bwipe XXUxDsMc[1m^J[m:set fileformats=mac[1m^J[m:e! XXUxDsMc[1m^^[18;1HJ[m:w! XXtt92[1m^J[m:bwipe XXUxDsMc[1m^J[m:set fileformats=dos[1m^J[m:e! XXUxDsMc[1m^J[m:w! XXtt93[1m^J[m:"[1m^J[m:" Append "END" to each file so that we can ss[19;1Hee what the last written char was.[1m^J[m:set fileformat=unix nobin[1m^J[mggdGaEND[1m^[[m:w >>XXtt01[1m^J[m:w >>XXtt02[1m^J[m:w >>XXtt11[1m^J[m:w >>XXtt12[1m^J[m::[20;1Hw >>XXtt13[1m^J[m:w >>XXtt21[1m^J[m:w >>XXtt22[1m^J[m:w >>XXtt23[1m^J[m:w >>XXtt31[1m^J[m:w >>XXtt32[1m^J[m:w >>XXtt33[1m^J[m:w >>XXtt41[1m^J[m:w >>XXtt42[1m^J[m:w >>XXtt433[21;1H[1m^J[m:w >>XXtt51[1m^J[m:w >>XXtt52[1m^J[m:w >>XXtt53[1m^J[m:w >>XXtt61[1m^J[m:w >>XXtt62[1m^J[m:w >>XXtt63[1m^J[m:w >>XXtt71[1m^J[m:w >>XXtt81[1m^J[m:w >>XXtt91[1m^J[m:w >>XXtt[22;1Ht92[1m^J[m:w >>XXtt93[1m^J[m:"[1m^J[m:" Concatenate the results.[1m^J[m:" Make fileformat of test.out the native fileformat.[1m^J[m:" Add a newline at tt[23;1Hhe end.[1m^J[m:set binary[1m^J[m:e! test.out[1m^J[m:$r XXtt01[1m^J[m:$r XXtt02[1m^J[mGo1[1m^[[m:$r XXtt11[1m^J[m:$r XXtt12[1m^J[m:$r XXtt13[1m^J[mGo2[1m^[[m:$r XXtt21[1m^J[m:$r XXtt22[24;1H2[1m^J[m:$r XXtt23[1m^J[mGo3[1m^[[m:$r XXtt31[1m^J[m:$r XXtt32[1m^J[m:$r XXtt33[1m^J[mGo4[1m^[[m:$r XXtt41[1m^J[m:$r XXtt42[1m^J[m:$r XXtt43[1m^J[mGo5[1m^[[m:$r XXtt51[1m^J[m:$r XXtt52[1m^J[m::[25;1H$r XXtt53[1m^J[mGo6[1m^[[m:$r XXtt61[1m^J[m:$r XXtt62[1m^J[m:$r XXtt63[1m^J[mGo7[1m^[[m:$r XXtt71[1m^J[mGo8[1m^[[m:$r XXtt81[1m^J[mGo9[1m^[[m:$r XXtt91[1m^J[m:$r XXtt92[1m^J[m:$r XXtt93[1m^JJ[m[26;1HGo10[1m^[[m:$r XXUnix[1m^J[m:set nobinary ff&[1m^J[m:w[1m^J[m:qa![1m^J[mENDTEST[1m^J^J[m1[1m^J[m2[1m^J[m3[1m^J[m4[1m^J[m5[1m^J[m6[1m^J[m7[1m^J[m8[1m^J[m9[1m^J[m10[1m^J^J[munix[1m^J[munix[1m^J[meof[1m^J^J[mdos
[1m^J[mdos
[1m^J[meof[1m^J^J[mmac
mac
[1m^J[m[47;1H[K[30;1H[47;1H:" try reading and writing with 'fileformats' set to one format[30;1H[47;1H[K[47;1H:set fileformats=unix[30;1H[47;1H[K[47;1H:e! XXUxDsMc"XXUxDsMc" [47;12H[K[47;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;6H[K[2;1Hunix[2;5H[K[3;1Hdos[1m^M[m[3;6H[K[4;1Hdos[1m^M[m[4;6H[K[5;1Hmac[1m^M[mmac[1m^M[m[5;11H[K[6;3H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;3H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:w! XXtt31"XXtt31" [47;10H[K[47;10H[New File] 5 lines, 29 characters written[1;1H[47;1H[K[47;1H:bwipe XXUxDsMc"test30.in" [47;13H[K[47;13H208 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HSTARTTEST
:so small.vim
:" first write three test files, one in each format
:set fileformat=unix
:set fileformats=
:/^1/w! XX1
:/^2/w! XX2
:/^3/w! XX3
:/^4/w! XX4
:/^5/w! XX5
:/^6/w! XX6
:/^7/w! XX7
:/^8/w! XX8
:/^9/w! XX9
:/^10/w! XX10
:/^unix/;/eof/-1w! XXUnix
:/^dos/;/eof/-1w! XXDos
:set bin noeol
:$w! XXMac
:set nobin eol
:bwipe XXUnix XXDos XXMac
:" create mixed format files
:!cat XXUnix XXDos >XXUxDs
:!cat XXUnix XXMac >XXUxMac
:!cat XXDos XXMac >XXDosMac
:!cat XXUnix XXDos XXMac >XXUxDsMc
:"
:" try reading and writing with 'fileformats' empty
:set fileformat=unix
:e! XXUnix
:w! test.out
:e! XXDos
:w! XXtt01
:e! XXMac
:w! XXtt02
:bwipe XXUnix XXDos XXMac
:set fileformat=dos
:e! XXUnix
:w! XXtt11
:e! XXDos
:w! XXtt12
:e! XXMac
:w! XXtt13
:bwipe XXUnix XXDos XXMac[5;1H[47;1H[K[47;1H:set fileformats=dos[5;1H[47;1H[K[47;1H:e! XXUxDsMc"XXUxDsMc" [47;12H[K[47;12H[Incomplete last line][CR missing][dos format] 5 lines, 28 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[3;4H[K[4;1Hdos[4;5H[K[5;1Hmac[1m^M[mmac[1m^M[m[5;11H[K[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;2H[K[37;1H[1m~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~[m[41;2H[K[41;1H[1m~[m[42;2H[K[42;1H[1m~[m[43;2H[K[43;1H[1m~[m[44;2H[K[44;1H[1m~[m[45;2H[K[45;1H[1m~[m[46;2H[K[46;1H[1m~[1;1H[m[47;1H[K[47;1H:w! XXtt32"XXtt32" [47;10H[K[47;10H[New File][dos format] 5 lines, 32 characters written[1;1H[47;1H[K[47;1H:bwipe XXUxDsMc"test30.in" [47;13H[K[47;13H[CR missing][dos format] 208 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HSTARTTEST
:so small.vim
:" first write three test files, one in each format
:set fileformat=unix
:set fileformats=
:/^1/w! XX1
:/^2/w! XX2
:/^3/w! XX3
:/^4/w! XX4
:/^5/w! XX5
:/^6/w! XX6
:/^7/w! XX7
:/^8/w! XX8
:/^9/w! XX9
:/^10/w! XX10
:/^unix/;/eof/-1w! XXUnix
:/^dos/;/eof/-1w! XXDos
:set bin noeol
:$w! XXMac
:set nobin eol
:bwipe XXUnix XXDos XXMac
:" create mixed format files
:!cat XXUnix XXDos >XXUxDs
:!cat XXUnix XXMac >XXUxMac
:!cat XXDos XXMac >XXDosMac
:!cat XXUnix XXDos XXMac >XXUxDsMc
:"
:" try reading and writing with 'fileformats' empty
:set fileformat=unix
:e! XXUnix
:w! test.out
:e! XXDos
:w! XXtt01
:e! XXMac
:w! XXtt02
:bwipe XXUnix XXDos XXMac
:set fileformat=dos
:e! XXUnix
:w! XXtt11
:e! XXDos
:w! XXtt12
:e! XXMac
:w! XXtt13
:bwipe XXUnix XXDos XXMac[5;1H[47;1H[K[47;1H:set fileformats=mac[5;1H[47;1H[K[47;1H:e! XXUxDsMc"XXUxDsMc" [47;12H[K[47;12H[mac format] 4 lines, 28 characters[1;1Hunix[1m^J[munix[1m^J[mdos[1;16H[K[2;1H[1m^J[mdos
[1m^J[mmac[3;6H[K[4;1Hmac[4;5H[K[5;2H[K[5;1H[1m~[m[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;2H[K[37;1H[1m~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~[m[41;2H[K[41;1H[1m~[m[42;2H[K[42;1H[1m~[m[43;2H[K[43;1H[1m~[m[44;2H[K[44;1H[1m~[m[45;2H[K[45;1H[1m~[m[46;2H[K[46;1H[1m~[1;1H[m[47;1H[K[47;1H:w! XXtt33"XXtt33" [47;10H[K[47;10H[New File][mac format] 4 lines, 28 characters written[1;1H[47;1H[K[47;1H:bwipe XXUxDsMc"test30.in" [47;13H[K[47;13H[Incomplete last line][mac format] 5 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option[1m^J^J[mSTARTTEST[1m^J[m:so small.vim[1m^J[m:" first write three test files, one in ee[2;1Hach format[1m^J[m:set fileformat=unix[1m^J[m:set fileformats=[1m^J[m:/^1/w! XX1[1m^J[m:/^2/w! XX2[1m^J[m:/^3/w! XX3[1m^J[m:/^4/w! XX4[1m^J[m:/^5/w! XX5[1m^J[m:/^6/w! XX[3;1HX6[1m^J[m:/^7/w! XX7[1m^J[m:/^8/w! XX8[1m^J[m:/^9/w! XX9[1m^J[m:/^10/w! XX10[1m^J[m:/^unix/;/eof/-1w! XXUnix[1m^J[m:/^dos/;/eof/-1w! XXDos[1m^J[m:set bin noeol[1m^J[m::[4;1H$w! XXMac[1m^J[m:set nobin eol[1m^J[m:bwipe XXUnix XXDos XXMac[1m^J[m:" create mixed format files[1m^J[m:!cat XXUnix XXDos >XXUxDs[1m^J[m:!cat XXUnix XXX[5;1HMac >XXUxMac[1m^J[m:!cat XXDos XXMac >XXDosMac[1m^J[m:!cat XXUnix XXDos XXMac >XXUxDsMc[1m^J[m:"[1m^J[m:" try reading and writing with 'fileformatss[6;1H' empty[1m^J[m:set fileformat=unix[1m^J[m:e! XXUnix[1m^J[m:w! test.out[1m^J[m:e! XXDos[1m^J[m:w! XXtt01[1m^J[m:e! XXMac[1m^J[m:w! XXtt02[1m^J[m:bwipe XXUnix XXDos XXMaa[7;1Hc[1m^J[m:set fileformat=dos[1m^J[m:e! XXUnix[1m^J[m:w! XXtt11[1m^J[m:e! XXDos[1m^J[m:w! XXtt12[1m^J[m:e! XXMac[1m^J[m:w! XXtt13[1m^J[m:bwipe XXUnix XXDos XXMac[1m^J[m:set ff[8;1Hileformat=mac[1m^J[m:e! XXUnix[1m^J[m:w! XXtt21[1m^J[m:e! XXDos[1m^J[m:w! XXtt22[1m^J[m:e! XXMac[1m^J[m:w! XXtt23[1m^J[m:bwipe XXUnix XXDos XXMac[1m^J[m:"[1m^J[m:" try readd[9;1Hing and writing with 'fileformats' set to one format[1m^J[m:set fileformats=unix[1m^J[m:e! XXUxDsMc[1m^J[m:w! XXtt31[1m^J[m:bwipe XXUxDsMc[1m^J[m:set fii[10;1Hleformats=dos[1m^J[m:e! XXUxDsMc[1m^J[m:w! XXtt32[1m^J[m:bwipe XXUxDsMc[1m^J[m:set fileformats=mac[1m^J[m:e! XXUxDsMc[1m^J[m:w! XXtt33[1m^J[m:bwipe XXUxDsMc[1m^J[m:"[1m^JJ[m[11;1H:" try reading and writing with 'fileformats' set to two formats[1m^J[m:set fileformats=unix,dos[1m^J[m:e! XXUxDsMc[1m^J[m:w! XXtt41[1m^J[m:bwipe XX[12;1HXUxDsMc[1m^J[m:e! XXUxMac[1m^J[m:w! XXtt42[1m^J[m:bwipe XXUxMac[1m^J[m:e! XXDosMac[1m^J[m:w! XXtt43[1m^J[m:bwipe XXDosMac[1m^J[m:set fileformats=unix,mac[1m^J[m:e! XXUU[13;1HxDs[1m^J[m:w! XXtt51[1m^J[m:bwipe XXUxDs[1m^J[m:e! XXUxDsMc[1m^J[m:w! XXtt52[1m^J[m:bwipe XXUxDsMc[1m^J[m:e! XXDosMac[1m^J[m:w! XXtt53[1m^J[m:bwipe XXDosMac[1m^J[m:set filee[14;1Hformats=dos,mac[1m^J[m:e! XXUxDs[1m^J[m:w! XXtt61[1m^J[m:bwipe XXUxDs[1m^J[m:e! XXUxMac[1m^J[m:w! XXtt62[1m^J[m:bwipe XXUxMac[1m^J[m:e! XXUxDsMc[1m^J[m:w! XXtt63[1m^J[m:bwii[15;1Hpe XXUxDsMc[1m^J[m:"[1m^J[m:" try reading and writing with 'fileformats' set to three formats[1m^J[m:set fileformats=unix,dos,mac[1m^J[m:e! XXUxDsMM[16;1Hc[1m^J[m:w! XXtt71[1m^J[m:bwipe XXUxDsMc[1m^J[m:set fileformats=mac,dos,unix[1m^J[m:e! XXUxDsMc[1m^J[m:w! XXtt81[1m^J[m:bwipe XXUxDsMc[1m^J[m:" try with 'binary'  [17;1Hset[1m^J[m:set fileformats=mac,unix,dos[1m^J[m:set binary[1m^J[m:e! XXUxDsMc[1m^J[m:w! XXtt91[1m^J[m:bwipe XXUxDsMc[1m^J[m:set fileformats=mac[1m^J[m:e! XXUxDsMc[1m^^[18;1HJ[m:w! XXtt92[1m^J[m:bwipe XXUxDsMc[1m^J[m:set fileformats=dos[1m^J[m:e! XXUxDsMc[1m^J[m:w! XXtt93[1m^J[m:"[1m^J[m:" Append "END" to each file so that we can ss[19;1Hee what the last written char was.[1m^J[m:set fileformat=unix nobin[1m^J[mggdGaEND[1m^[[m:w >>XXtt01[1m^J[m:w >>XXtt02[1m^J[m:w >>XXtt11[1m^J[m:w >>XXtt12[1m^J[m::[20;1Hw >>XXtt13[1m^J[m:w >>XXtt21[1m^J[m:w >>XXtt22[1m^J[m:w >>XXtt23[1m^J[m:w >>XXtt31[1m^J[m:w >>XXtt32[1m^J[m:w >>XXtt33[1m^J[m:w >>XXtt41[1m^J[m:w >>XXtt42[1m^J[m:w >>XXtt433[21;1H[1m^J[m:w >>XXtt51[1m^J[m:w >>XXtt52[1m^J[m:w >>XXtt53[1m^J[m:w >>XXtt61[1m^J[m:w >>XXtt62[1m^J[m:w >>XXtt63[1m^J[m:w >>XXtt71[1m^J[m:w >>XXtt81[1m^J[m:w >>XXtt91[1m^J[m:w >>XXtt[22;1Ht92[1m^J[m:w >>XXtt93[1m^J[m:"[1m^J[m:" Concatenate the results.[1m^J[m:" Make fileformat of test.out the native fileformat.[1m^J[m:" Add a newline at tt[23;1Hhe end.[1m^J[m:set binary[1m^J[m:e! test.out[1m^J[m:$r XXtt01[1m^J[m:$r XXtt02[1m^J[mGo1[1m^[[m:$r XXtt11[1m^J[m:$r XXtt12[1m^J[m:$r XXtt13[1m^J[mGo2[1m^[[m:$r XXtt21[1m^J[m:$r XXtt22[24;1H2[1m^J[m:$r XXtt23[1m^J[mGo3[1m^[[m:$r XXtt31[1m^J[m:$r XXtt32[1m^J[m:$r XXtt33[1m^J[mGo4[1m^[[m:$r XXtt41[1m^J[m:$r XXtt42[1m^J[m:$r XXtt43[1m^J[mGo5[1m^[[m:$r XXtt51[1m^J[m:$r XXtt52[1m^J[m::[25;1H$r XXtt53[1m^J[mGo6[1m^[[m:$r XXtt61[1m^J[m:$r XXtt62[1m^J[m:$r XXtt63[1m^J[mGo7[1m^[[m:$r XXtt71[1m^J[mGo8[1m^[[m:$r XXtt81[1m^J[mGo9[1m^[[m:$r XXtt91[1m^J[m:$r XXtt92[1m^J[m:$r XXtt93[1m^JJ[m[26;1HGo10[1m^[[m:$r XXUnix[1m^J[m:set nobinary ff&[1m^J[m:w[1m^J[m:qa![1m^J[mENDTEST[1m^J^J[m1[1m^J[m2[1m^J[m3[1m^J[m4[1m^J[m5[1m^J[m6[1m^J[m7[1m^J[m8[1m^J[m9[1m^J[m10[1m^J^J[munix[1m^J[munix[1m^J[meof[1m^J^J[mdos
[1m^J[mdos
[1m^J[meof[1m^J^J[mmac
mac
[1m^J[m[47;1H[K[47;1H:"[30;1H[47;1H[K[47;1H:" try reading and writing with 'fileformats' set to two formats[30;1H[47;1H[K[47;1H:set fileformats=unix,dos[30;1H[47;1H[K[47;1H:e! XXUxDsMc"XXUxDsMc" [47;12H[K[47;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;6H[K[2;1Hunix[2;5H[K[3;1Hdos[1m^M[m[3;6H[K[4;1Hdos[1m^M[m[4;6H[K[5;1Hmac[1m^M[mmac[1m^M[m[5;11H[K[6;3H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;3H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:w! XXtt41"XXtt41" [47;10H[K[47;10H[New File] 5 lines, 29 characters written[1;1H[47;1H[K[47;1H:bwipe XXUxDsMc"test30.in" [47;13H[K[47;13H208 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HSTARTTEST
:so small.vim
:" first write three test files, one in each format
:set fileformat=unix
:set fileformats=
:/^1/w! XX1
:/^2/w! XX2
:/^3/w! XX3
:/^4/w! XX4
:/^5/w! XX5
:/^6/w! XX6
:/^7/w! XX7
:/^8/w! XX8
:/^9/w! XX9
:/^10/w! XX10
:/^unix/;/eof/-1w! XXUnix
:/^dos/;/eof/-1w! XXDos
:set bin noeol
:$w! XXMac
:set nobin eol
:bwipe XXUnix XXDos XXMac
:" create mixed format files
:!cat XXUnix XXDos >XXUxDs
:!cat XXUnix XXMac >XXUxMac
:!cat XXDos XXMac >XXDosMac
:!cat XXUnix XXDos XXMac >XXUxDsMc
:"
:" try reading and writing with 'fileformats' empty
:set fileformat=unix
:e! XXUnix
:w! test.out
:e! XXDos
:w! XXtt01
:e! XXMac
:w! XXtt02
:bwipe XXUnix XXDos XXMac
:set fileformat=dos
:e! XXUnix
:w! XXtt11
:e! XXDos
:w! XXtt12
:e! XXMac
:w! XXtt13
:bwipe XXUnix XXDos XXMac[5;1H[47;1H[K[47;1H:e! XXUxMac"XXUxMac" [47;11H[K[47;11H[Incomplete last line] 3 lines, 18 characters[1;1Hunix[1;6H[K[2;1Hunix
mac[1m^M[mmac[1m^M[m[4;2H[K[4;1H[1m~[m[5;2H[K[5;1H[1m~[m[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;2H[K[37;1H[1m~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~[m[41;2H[K[41;1H[1m~[m[42;2H[K[42;1H[1m~[m[43;2H[K[43;1H[1m~[m[44;2H[K[44;1H[1m~[m[45;2H[K[45;1H[1m~[m[46;2H[K[46;1H[1m~[1;1H[m[47;1H[K[47;1H:w! XXtt42"XXtt42" [47;10H[K[47;10H[New File] 3 lines, 19 characters written[1;1H[47;1H[K[47;1H:bwipe XXUxMac"test30.in" [47;13H[K[47;13H208 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HSTARTTEST[3;10H[K[4;1H:so small.vim
:" first write three test files, one in each format
:set fileformat=unix
:set fileformats=
:/^1/w! XX1
:/^2/w! XX2
:/^3/w! XX3
:/^4/w! XX4
:/^5/w! XX5
:/^6/w! XX6
:/^7/w! XX7
:/^8/w! XX8
:/^9/w! XX9
:/^10/w! XX10
:/^unix/;/eof/-1w! XXUnix
:/^dos/;/eof/-1w! XXDos
:set bin noeol
:$w! XXMac
:set nobin eol
:bwipe XXUnix XXDos XXMac
:" create mixed format files
:!cat XXUnix XXDos >XXUxDs
:!cat XXUnix XXMac >XXUxMac
:!cat XXDos XXMac >XXDosMac
:!cat XXUnix XXDos XXMac >XXUxDsMc
:"
:" try reading and writing with 'fileformats' empty
:set fileformat=unix
:e! XXUnix
:w! test.out
:e! XXDos
:w! XXtt01
:e! XXMac
:w! XXtt02
:bwipe XXUnix XXDos XXMac
:set fileformat=dos
:e! XXUnix
:w! XXtt11
:e! XXDos
:w! XXtt12
:e! XXMac
:w! XXtt13
:bwipe XXUnix XXDos XXMac[5;1H[47;1H[K[47;1H:e! XXDosMac"XXDosMac" [47;12H[K[47;12H[Incomplete last line][dos format] 3 lines, 18 characters[1;1Hdo[1;4H[K[2;1Hdos
mac[1m^M[mmac[1m^M[m[4;2H[K[4;1H[1m~[m[5;2H[K[5;1H[1m~[m[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;2H[K[37;1H[1m~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~[m[41;2H[K[41;1H[1m~[m[42;2H[K[42;1H[1m~[m[43;2H[K[43;1H[1m~[m[44;2H[K[44;1H[1m~[m[45;2H[K[45;1H[1m~[m[46;2H[K[46;1H[1m~[1;1H[m[47;1H[K[47;1H:w! XXtt43"XXtt43" [47;10H[K[47;10H[New File][dos format] 3 lines, 20 characters written[1;1H[47;1H[K[47;1H:bwipe XXDosMac"test30.in" [47;13H[K[47;13H208 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HSTARTTEST[3;10H[K[4;1H:so small.vim
:" first write three test files, one in each format
:set fileformat=unix
:set fileformats=
:/^1/w! XX1
:/^2/w! XX2
:/^3/w! XX3
:/^4/w! XX4
:/^5/w! XX5
:/^6/w! XX6
:/^7/w! XX7
:/^8/w! XX8
:/^9/w! XX9
:/^10/w! XX10
:/^unix/;/eof/-1w! XXUnix
:/^dos/;/eof/-1w! XXDos
:set bin noeol
:$w! XXMac
:set nobin eol
:bwipe XXUnix XXDos XXMac
:" create mixed format files
:!cat XXUnix XXDos >XXUxDs
:!cat XXUnix XXMac >XXUxMac
:!cat XXDos XXMac >XXDosMac
:!cat XXUnix XXDos XXMac >XXUxDsMc
:"
:" try reading and writing with 'fileformats' empty
:set fileformat=unix
:e! XXUnix
:w! test.out
:e! XXDos
:w! XXtt01
:e! XXMac
:w! XXtt02
:bwipe XXUnix XXDos XXMac
:set fileformat=dos
:e! XXUnix
:w! XXtt11
:e! XXDos
:w! XXtt12
:e! XXMac
:w! XXtt13
:bwipe XXUnix XXDos XXMac[5;1H[47;1H[K[47;1H:set fileformats=unix,mac[5;1H[47;1H[K[47;1H:e! XXUxDs"XXUxDs" [47;10H[K[47;10H4 lines, 20 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[1m^M[m[3;6H[K[4;1Hdos[1m^M[m[4;6H[K[5;2H[K[5;1H[1m~[m[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;2H[K[37;1H[1m~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~[m[41;2H[K[41;1H[1m~[m[42;2H[K[42;1H[1m~[m[43;2H[K[43;1H[1m~[m[44;2H[K[44;1H[1m~[m[45;2H[K[45;1H[1m~[m[46;2H[K[46;1H[1m~[1;1H[m[47;1H[K[47;1H:w! XXtt51"XXtt51" [47;10H[K[47;10H[New File] 4 lines, 20 characters written[1;1H[47;1H[K[47;1H:bwipe XXUxDs"test30.in" [47;13H[K[47;13H208 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HSTARTTEST
:so small.vim
:" first write three test files, one in each format
:set fileformat=unix
:set fileformats=
:/^1/w! XX1
:/^2/w! XX2
:/^3/w! XX3
:/^4/w! XX4
:/^5/w! XX5
:/^6/w! XX6
:/^7/w! XX7
:/^8/w! XX8
:/^9/w! XX9
:/^10/w! XX10
:/^unix/;/eof/-1w! XXUnix
:/^dos/;/eof/-1w! XXDos
:set bin noeol
:$w! XXMac
:set nobin eol
:bwipe XXUnix XXDos XXMac
:" create mixed format files
:!cat XXUnix XXDos >XXUxDs
:!cat XXUnix XXMac >XXUxMac
:!cat XXDos XXMac >XXDosMac
:!cat XXUnix XXDos XXMac >XXUxDsMc
:"
:" try reading and writing with 'fileformats' empty
:set fileformat=unix
:e! XXUnix
:w! test.out
:e! XXDos
:w! XXtt01
:e! XXMac
:w! XXtt02
:bwipe XXUnix XXDos XXMac
:set fileformat=dos
:e! XXUnix
:w! XXtt11
:e! XXDos
:w! XXtt12
:e! XXMac
:w! XXtt13
:bwipe XXUnix XXDos XXMac[5;1H[47;1H[K[47;1H:e! XXUxDsMc"XXUxDsMc" [47;12H[K[47;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[1m^M[m[3;6H[K[4;1Hdos[1m^M[m[4;6H[K[5;1Hmac[1m^M[mmac[1m^M[m[5;11H[K[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;2H[K[37;1H[1m~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~[m[41;2H[K[41;1H[1m~[m[42;2H[K[42;1H[1m~[m[43;2H[K[43;1H[1m~[m[44;2H[K[44;1H[1m~[m[45;2H[K[45;1H[1m~[m[46;2H[K[46;1H[1m~[1;1H[m[47;1H[K[47;1H:w! XXtt52"XXtt52" [47;10H[K[47;10H[New File] 5 lines, 29 characters written[1;1H[47;1H[K[47;1H:bwipe XXUxDsMc"test30.in" [47;13H[K[47;13H208 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HSTARTTEST
:so small.vim
:" first write three test files, one in each format
:set fileformat=unix
:set fileformats=
:/^1/w! XX1
:/^2/w! XX2
:/^3/w! XX3
:/^4/w! XX4
:/^5/w! XX5
:/^6/w! XX6
:/^7/w! XX7
:/^8/w! XX8
:/^9/w! XX9
:/^10/w! XX10
:/^unix/;/eof/-1w! XXUnix
:/^dos/;/eof/-1w! XXDos
:set bin noeol
:$w! XXMac
:set nobin eol
:bwipe XXUnix XXDos XXMac
:" create mixed format files
:!cat XXUnix XXDos >XXUxDs
:!cat XXUnix XXMac >XXUxMac
:!cat XXDos XXMac >XXDosMac
:!cat XXUnix XXDos XXMac >XXUxDsMc
:"
:" try reading and writing with 'fileformats' empty
:set fileformat=unix
:e! XXUnix
:w! test.out
:e! XXDos
:w! XXtt01
:e! XXMac
:w! XXtt02
:bwipe XXUnix XXDos XXMac
:set fileformat=dos
:e! XXUnix
:w! XXtt11
:e! XXDos
:w! XXtt12
:e! XXMac
:w! XXtt13
:bwipe XXUnix XXDos XXMac[5;1H[47;1H[K[47;1H:e! XXDosMac"XXDosMac" [47;12H[K[47;12H[mac format] 4 lines, 18 characters[1;1Hdo[1;4H[K[2;1H[1m^J[mdos
[1m^J[mmac[3;6H[K[4;1Hmac[4;5H[K[5;2H[K[5;1H[1m~[m[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;2H[K[37;1H[1m~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~[m[41;2H[K[41;1H[1m~[m[42;2H[K[42;1H[1m~[m[43;2H[K[43;1H[1m~[m[44;2H[K[44;1H[1m~[m[45;2H[K[45;1H[1m~[m[46;2H[K[46;1H[1m~[1;1H[m[47;1H[K[47;1H:w! XXtt53"XXtt53" [47;10H[K[47;10H[New File][mac format] 4 lines, 18 characters written[1;1H[47;1H[K[47;1H:bwipe XXDosMac"test30.in" [47;13H[K[47;13H208 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HSTARTTEST
:so small.vim
:" first write three test files, one in each format
:set fileformat=unix
:set fileformats=
:/^1/w! XX1
:/^2/w! XX2
:/^3/w! XX3
:/^4/w! XX4
:/^5/w! XX5
:/^6/w! XX6
:/^7/w! XX7
:/^8/w! XX8
:/^9/w! XX9
:/^10/w! XX10
:/^unix/;/eof/-1w! XXUnix
:/^dos/;/eof/-1w! XXDos
:set bin noeol
:$w! XXMac
:set nobin eol
:bwipe XXUnix XXDos XXMac
:" create mixed format files
:!cat XXUnix XXDos >XXUxDs
:!cat XXUnix XXMac >XXUxMac
:!cat XXDos XXMac >XXDosMac
:!cat XXUnix XXDos XXMac >XXUxDsMc
:"
:" try reading and writing with 'fileformats' empty
:set fileformat=unix
:e! XXUnix
:w! test.out
:e! XXDos
:w! XXtt01
:e! XXMac
:w! XXtt02
:bwipe XXUnix XXDos XXMac
:set fileformat=dos
:e! XXUnix
:w! XXtt11
:e! XXDos
:w! XXtt12
:e! XXMac
:w! XXtt13
:bwipe XXUnix XXDos XXMac[5;1H[47;1H[K[47;1H:set fileformats=dos,mac[5;1H[47;1H[K[47;1H:e! XXUxDs"XXUxDs" [47;10H[K[47;10H[CR missing][dos format] 4 lines, 20 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[3;4H[K[4;1Hdos[4;5H[K[5;2H[K[5;1H[1m~[m[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;2H[K[37;1H[1m~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~[m[41;2H[K[41;1H[1m~[m[42;2H[K[42;1H[1m~[m[43;2H[K[43;1H[1m~[m[44;2H[K[44;1H[1m~[m[45;2H[K[45;1H[1m~[m[46;2H[K[46;1H[1m~[1;1H[m[47;1H[K[47;1H:w! XXtt61"XXtt61" [47;10H[K[47;10H[New File][dos format] 4 lines, 22 characters written[1;1H[47;1H[K[47;1H:bwipe XXUxDs"test30.in" [47;13H[K[47;13H[CR missing][dos format] 208 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HSTARTTEST
:so small.vim
:" first write three test files, one in each format
:set fileformat=unix
:set fileformats=
:/^1/w! XX1
:/^2/w! XX2
:/^3/w! XX3
:/^4/w! XX4
:/^5/w! XX5
:/^6/w! XX6
:/^7/w! XX7
:/^8/w! XX8
:/^9/w! XX9
:/^10/w! XX10
:/^unix/;/eof/-1w! XXUnix
:/^dos/;/eof/-1w! XXDos
:set bin noeol
:$w! XXMac
:set nobin eol
:bwipe XXUnix XXDos XXMac
:" create mixed format files
:!cat XXUnix XXDos >XXUxDs
:!cat XXUnix XXMac >XXUxMac
:!cat XXDos XXMac >XXDosMac
:!cat XXUnix XXDos XXMac >XXUxDsMc
:"
:" try reading and writing with 'fileformats' empty
:set fileformat=unix
:e! XXUnix
:w! test.out
:e! XXDos
:w! XXtt01
:e! XXMac
:w! XXtt02
:bwipe XXUnix XXDos XXMac
:set fileformat=dos
:e! XXUnix
:w! XXtt11
:e! XXDos
:w! XXtt12
:e! XXMac
:w! XXtt13
:bwipe XXUnix XXDos XXMac[5;1H[47;1H[K[47;1H:e! XXUxMac"XXUxMac" [47;11H[K[47;11H[Incomplete last line][CR missing][dos format] 3 lines, 18 characters[1;1Hunix[1;6H[K[2;1Hunix
mac[1m^M[mmac[1m^M[m[4;2H[K[4;1H[1m~[m[5;2H[K[5;1H[1m~[m[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;2H[K[37;1H[1m~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~[m[41;2H[K[41;1H[1m~[m[42;2H[K[42;1H[1m~[m[43;2H[K[43;1H[1m~[m[44;2H[K[44;1H[1m~[m[45;2H[K[45;1H[1m~[m[46;2H[K[46;1H[1m~[1;1H[m[47;1H[K[47;1H:w! XXtt62"XXtt62" [47;10H[K[47;10H[New File][dos format] 3 lines, 22 characters written[1;1H[47;1H[K[47;1H:bwipe XXUxMac"test30.in" [47;13H[K[47;13H[CR missing][dos format] 208 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HSTARTTEST[3;10H[K[4;1H:so small.vim
:" first write three test files, one in each format
:set fileformat=unix
:set fileformats=
:/^1/w! XX1
:/^2/w! XX2
:/^3/w! XX3
:/^4/w! XX4
:/^5/w! XX5
:/^6/w! XX6
:/^7/w! XX7
:/^8/w! XX8
:/^9/w! XX9
:/^10/w! XX10
:/^unix/;/eof/-1w! XXUnix
:/^dos/;/eof/-1w! XXDos
:set bin noeol
:$w! XXMac
:set nobin eol
:bwipe XXUnix XXDos XXMac
:" create mixed format files
:!cat XXUnix XXDos >XXUxDs
:!cat XXUnix XXMac >XXUxMac
:!cat XXDos XXMac >XXDosMac
:!cat XXUnix XXDos XXMac >XXUxDsMc
:"
:" try reading and writing with 'fileformats' empty
:set fileformat=unix
:e! XXUnix
:w! test.out
:e! XXDos
:w! XXtt01
:e! XXMac
:w! XXtt02
:bwipe XXUnix XXDos XXMac
:set fileformat=dos
:e! XXUnix
:w! XXtt11
:e! XXDos
:w! XXtt12
:e! XXMac
:w! XXtt13
:bwipe XXUnix XXDos XXMac[5;1H[47;1H[K[47;1H:e! XXUxDsMc"XXUxDsMc" [47;12H[K[47;12H[Incomplete last line][CR missing][dos format] 5 lines, 28 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[3;4H[K[4;1Hdos[4;5H[K[5;1Hmac[1m^M[mmac[1m^M[m[5;11H[K[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;2H[K[37;1H[1m~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~[m[41;2H[K[41;1H[1m~[m[42;2H[K[42;1H[1m~[m[43;2H[K[43;1H[1m~[m[44;2H[K[44;1H[1m~[m[45;2H[K[45;1H[1m~[m[46;2H[K[46;1H[1m~[1;1H[m[47;1H[K[47;1H:w! XXtt63"XXtt63" [47;10H[K[47;10H[New File][dos format] 5 lines, 32 characters written[1;1H[47;1H[K[47;1H:bwipe XXUxDsMc"test30.in" [47;13H[K[47;13H[CR missing][dos format] 208 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HSTARTTEST
:so small.vim
:" first write three test files, one in each format
:set fileformat=unix
:set fileformats=
:/^1/w! XX1
:/^2/w! XX2
:/^3/w! XX3
:/^4/w! XX4
:/^5/w! XX5
:/^6/w! XX6
:/^7/w! XX7
:/^8/w! XX8
:/^9/w! XX9
:/^10/w! XX10
:/^unix/;/eof/-1w! XXUnix
:/^dos/;/eof/-1w! XXDos
:set bin noeol
:$w! XXMac
:set nobin eol
:bwipe XXUnix XXDos XXMac
:" create mixed format files
:!cat XXUnix XXDos >XXUxDs
:!cat XXUnix XXMac >XXUxMac
:!cat XXDos XXMac >XXDosMac
:!cat XXUnix XXDos XXMac >XXUxDsMc
:"
:" try reading and writing with 'fileformats' empty
:set fileformat=unix
:e! XXUnix
:w! test.out
:e! XXDos
:w! XXtt01
:e! XXMac
:w! XXtt02
:bwipe XXUnix XXDos XXMac
:set fileformat=dos
:e! XXUnix
:w! XXtt11
:e! XXDos
:w! XXtt12
:e! XXMac
:w! XXtt13
:bwipe XXUnix XXDos XXMac[5;1H[47;1H[K[47;1H:"[5;1H[47;1H[K[47;1H:" try reading and writing with 'fileformats' set to three formats[5;1H[47;1H[K[47;1H:set fileformats=unix,dos,mac[5;1H[47;1H[K[47;1H:e! XXUxDsMc"XXUxDsMc" [47;12H[K[47;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[1m^M[m[3;6H[K[4;1Hdos[1m^M[m[4;6H[K[5;1Hmac[1m^M[mmac[1m^M[m[5;11H[K[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;2H[K[37;1H[1m~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~[m[41;2H[K[41;1H[1m~[m[42;2H[K[42;1H[1m~[m[43;2H[K[43;1H[1m~[m[44;2H[K[44;1H[1m~[m[45;2H[K[45;1H[1m~[m[46;2H[K[46;1H[1m~[1;1H[m[47;1H[K[47;1H:w! XXtt71"XXtt71" [47;10H[K[47;10H[New File] 5 lines, 29 characters written[1;1H[47;1H[K[47;1H:bwipe XXUxDsMc"test30.in" [47;13H[K[47;13H208 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HSTARTTEST
:so small.vim
:" first write three test files, one in each format
:set fileformat=unix
:set fileformats=
:/^1/w! XX1
:/^2/w! XX2
:/^3/w! XX3
:/^4/w! XX4
:/^5/w! XX5
:/^6/w! XX6
:/^7/w! XX7
:/^8/w! XX8
:/^9/w! XX9
:/^10/w! XX10
:/^unix/;/eof/-1w! XXUnix
:/^dos/;/eof/-1w! XXDos
:set bin noeol
:$w! XXMac
:set nobin eol
:bwipe XXUnix XXDos XXMac
:" create mixed format files
:!cat XXUnix XXDos >XXUxDs
:!cat XXUnix XXMac >XXUxMac
:!cat XXDos XXMac >XXDosMac
:!cat XXUnix XXDos XXMac >XXUxDsMc
:"
:" try reading and writing with 'fileformats' empty
:set fileformat=unix
:e! XXUnix
:w! test.out
:e! XXDos
:w! XXtt01
:e! XXMac
:w! XXtt02
:bwipe XXUnix XXDos XXMac
:set fileformat=dos
:e! XXUnix
:w! XXtt11
:e! XXDos
:w! XXtt12
:e! XXMac
:w! XXtt13
:bwipe XXUnix XXDos XXMac[5;1H[47;1H[K[47;1H:set fileformats=mac,dos,unix[5;1H[47;1H[K[47;1H:e! XXUxDsMc"XXUxDsMc" [47;12H[K[47;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[1m^M[m[3;6H[K[4;1Hdos[1m^M[m[4;6H[K[5;1Hmac[1m^M[mmac[1m^M[m[5;11H[K[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;2H[K[37;1H[1m~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~[m[41;2H[K[41;1H[1m~[m[42;2H[K[42;1H[1m~[m[43;2H[K[43;1H[1m~[m[44;2H[K[44;1H[1m~[m[45;2H[K[45;1H[1m~[m[46;2H[K[46;1H[1m~[1;1H[m[47;1H[K[47;1H:w! XXtt81"XXtt81" [47;10H[K[47;10H[New File] 5 lines, 29 characters written[1;1H[47;1H[K[47;1H:bwipe XXUxDsMc"test30.in" [47;13H[K[47;13H208 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HSTARTTEST
:so small.vim
:" first write three test files, one in each format
:set fileformat=unix
:set fileformats=
:/^1/w! XX1
:/^2/w! XX2
:/^3/w! XX3
:/^4/w! XX4
:/^5/w! XX5
:/^6/w! XX6
:/^7/w! XX7
:/^8/w! XX8
:/^9/w! XX9
:/^10/w! XX10
:/^unix/;/eof/-1w! XXUnix
:/^dos/;/eof/-1w! XXDos
:set bin noeol
:$w! XXMac
:set nobin eol
:bwipe XXUnix XXDos XXMac
:" create mixed format files
:!cat XXUnix XXDos >XXUxDs
:!cat XXUnix XXMac >XXUxMac
:!cat XXDos XXMac >XXDosMac
:!cat XXUnix XXDos XXMac >XXUxDsMc
:"
:" try reading and writing with 'fileformats' empty
:set fileformat=unix
:e! XXUnix
:w! test.out
:e! XXDos
:w! XXtt01
:e! XXMac
:w! XXtt02
:bwipe XXUnix XXDos XXMac
:set fileformat=dos
:e! XXUnix
:w! XXtt11
:e! XXDos
:w! XXtt12
:e! XXMac
:w! XXtt13
:bwipe XXUnix XXDos XXMac[5;1H[47;1H[K[47;1H:" try with 'binary' set[5;1H[47;1H[K[47;1H:set fileformats=mac,unix,dos[5;1H[47;1H[K[47;1H:set binary[5;1H[47;1H[K[47;1H:e! XXUxDsMc"XXUxDsMc" [47;12H[K[47;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[1m^M[m[3;6H[K[4;1Hdos[1m^M[m[4;6H[K[5;1Hmac[1m^M[mmac[1m^M[m[5;11H[K[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;2H[K[37;1H[1m~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~[m[41;2H[K[41;1H[1m~[m[42;2H[K[42;1H[1m~[m[43;2H[K[43;1H[1m~[m[44;2H[K[44;1H[1m~[m[45;2H[K[45;1H[1m~[m[46;2H[K[46;1H[1m~[1;1H[m[47;1H[K[47;1H:w! XXtt91"XXtt91" [47;10H[K[47;10H[New File][Incomplete last line] 5 lines, 28 characters written[1;1H[47;1H[K[47;1H:bwipe XXUxDsMc"test30.in" [47;13H[K[47;13H208 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HSTARTTEST
:so small.vim
:" first write three test files, one in each format
:set fileformat=unix
:set fileformats=
:/^1/w! XX1
:/^2/w! XX2
:/^3/w! XX3
:/^4/w! XX4
:/^5/w! XX5
:/^6/w! XX6
:/^7/w! XX7
:/^8/w! XX8
:/^9/w! XX9
:/^10/w! XX10
:/^unix/;/eof/-1w! XXUnix
:/^dos/;/eof/-1w! XXDos
:set bin noeol
:$w! XXMac
:set nobin eol
:bwipe XXUnix XXDos XXMac
:" create mixed format files
:!cat XXUnix XXDos >XXUxDs
:!cat XXUnix XXMac >XXUxMac
:!cat XXDos XXMac >XXDosMac
:!cat XXUnix XXDos XXMac >XXUxDsMc
:"
:" try reading and writing with 'fileformats' empty
:set fileformat=unix
:e! XXUnix
:w! test.out
:e! XXDos
:w! XXtt01
:e! XXMac
:w! XXtt02
:bwipe XXUnix XXDos XXMac
:set fileformat=dos
:e! XXUnix
:w! XXtt11
:e! XXDos
:w! XXtt12
:e! XXMac
:w! XXtt13
:bwipe XXUnix XXDos XXMac[5;1H[47;1H[K[47;1H:set fileformats=mac[5;1H[47;1H[K[47;1H:e! XXUxDsMc"XXUxDsMc" [47;12H[K[47;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[1m^M[m[3;6H[K[4;1Hdos[1m^M[m[4;6H[K[5;1Hmac[1m^M[mmac[1m^M[m[5;11H[K[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;2H[K[37;1H[1m~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~[m[41;2H[K[41;1H[1m~[m[42;2H[K[42;1H[1m~[m[43;2H[K[43;1H[1m~[m[44;2H[K[44;1H[1m~[m[45;2H[K[45;1H[1m~[m[46;2H[K[46;1H[1m~[1;1H[m[47;1H[K[47;1H:w! XXtt92"XXtt92" [47;10H[K[47;10H[New File][Incomplete last line] 5 lines, 28 characters written[1;1H[47;1H[K[47;1H:bwipe XXUxDsMc"test30.in" [47;13H[K[47;13H208 lines, 3095 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HSTARTTEST
:so small.vim
:" first write three test files, one in each format
:set fileformat=unix
:set fileformats=
:/^1/w! XX1
:/^2/w! XX2
:/^3/w! XX3
:/^4/w! XX4
:/^5/w! XX5
:/^6/w! XX6
:/^7/w! XX7
:/^8/w! XX8
:/^9/w! XX9
:/^10/w! XX10
:/^unix/;/eof/-1w! XXUnix
:/^dos/;/eof/-1w! XXDos
:set bin noeol
:$w! XXMac
:set nobin eol
:bwipe XXUnix XXDos XXMac
:" create mixed format files
:!cat XXUnix XXDos >XXUxDs
:!cat XXUnix XXMac >XXUxMac
:!cat XXDos XXMac >XXDosMac
:!cat XXUnix XXDos XXMac >XXUxDsMc
:"
:" try reading and writing with 'fileformats' empty
:set fileformat=unix
:e! XXUnix
:w! test.out
:e! XXDos
:w! XXtt01
:e! XXMac
:w! XXtt02
:bwipe XXUnix XXDos XXMac
:set fileformat=dos
:e! XXUnix
:w! XXtt11
:e! XXDos
:w! XXtt12
:e! XXMac
:w! XXtt13
:bwipe XXUnix XXDos XXMac[5;1H[47;1H[K[47;1H:set fileformats=dos[5;1H[47;1H[K[47;1H:e! XXUxDsMc"XXUxDsMc" [47;12H[K[47;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[1m^M[m[3;6H[K[4;1Hdos[1m^M[m[4;6H[K[5;1Hmac[1m^M[mmac[1m^M[m[5;11H[K[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;2H[K[37;1H[1m~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~[m[41;2H[K[41;1H[1m~[m[42;2H[K[42;1H[1m~[m[43;2H[K[43;1H[1m~[m[44;2H[K[44;1H[1m~[m[45;2H[K[45;1H[1m~[m[46;2H[K[46;1H[1m~[1;1H[m[47;1H[K[47;1H:w! XXtt93"XXtt93" [47;10H[K[47;10H[New File][Incomplete last line] 5 lines, 28 characters written[1;1H[47;1H[K[47;1H:"[1;1H[47;1H[K[47;1H:" Append "END" to each file so that we can see what the last written char was.[1;1H[47;1H[K[47;1H:set fileformat=unix nobin[1;1H[1;1H[K[2;2H[K[2;1H[1m~[m[3;2H[K[3;1H[1m~[m[4;2H[K[4;1H[1m~[m[5;2H[K[5;1H[1m~[m[47;1H--No lines in buffer--[47;23H[K[1;1HEND[47;1H[K[47;1H:w >>XXtt01"XXtt01" [47;10H[K[47;10H1 line, 4 characters appended[1;3H[47;1H[K[47;1H:w >>XXtt02"XXtt02" [47;10H[K[47;10H1 line, 4 characters appended[1;3H[47;1H[K[47;1H:w >>XXtt11"XXtt11" [47;10H[K[47;10H1 line, 4 characters appended[1;3H[47;1H[K[47;1H:w >>XXtt12"XXtt12" [47;10H[K[47;10H1 line, 4 characters appended[1;3H[47;1H[K[47;1H:w >>XXtt13"XXtt13" [47;10H[K[47;10H1 line, 4 characters appended[1;3H[47;1H[K[47;1H:w >>XXtt21"XXtt21" [47;10H[K[47;10H1 line, 4 characters appended[1;3H[47;1H[K[47;1H:w >>XXtt22"XXtt22" [47;10H[K[47;10H1 line, 4 characters appended[1;3H[47;1H[K[47;1H:w >>XXtt23"XXtt23" [47;10H[K[47;10H1 line, 4 characters appended[1;3H[47;1H[K[47;1H:w >>XXtt31"XXtt31" [47;10H[K[47;10H1 line, 4 characters appended[1;3H[47;1H[K[47;1H:w >>XXtt32"XXtt32" [47;10H[K[47;10H1 line, 4 characters appended[1;3H[47;1H[K[47;1H:w >>XXtt33"XXtt33" [47;10H[K[47;10H1 line, 4 characters appended[1;3H[47;1H[K[47;1H:w >>XXtt41"XXtt41" [47;10H[K[47;10H1 line, 4 characters appended[1;3H[47;1H[K[47;1H:w >>XXtt42"XXtt42" [47;10H[K[47;10H1 line, 4 characters appended[1;3H[47;1H[K[47;1H:w >>XXtt43"XXtt43" [47;10H[K[47;10H1 line, 4 characters appended[1;3H[47;1H[K[47;1H:w >>XXtt51"XXtt51" [47;10H[K[47;10H1 line, 4 characters appended[1;3H[47;1H[K[47;1H:w >>XXtt52"XXtt52" [47;10H[K[47;10H1 line, 4 characters appended[1;3H[47;1H[K[47;1H:w >>XXtt53"XXtt53" [47;10H[K[47;10H1 line, 4 characters appended[1;3H[47;1H[K[47;1H:w >>XXtt61"XXtt61" [47;10H[K[47;10H1 line, 4 characters appended[1;3H[47;1H[K[47;1H:w >>XXtt62"XXtt62" [47;10H[K[47;10H1 line, 4 characters appended[1;3H[47;1H[K[47;1H:w >>XXtt63"XXtt63" [47;10H[K[47;10H1 line, 4 characters appended[1;3H[47;1H[K[47;1H:w >>XXtt71"XXtt71" [47;10H[K[47;10H1 line, 4 characters appended[1;3H[47;1H[K[47;1H:w >>XXtt81"XXtt81" [47;10H[K[47;10H1 line, 4 characters appended[1;3H[47;1H[K[47;1H:w >>XXtt91"XXtt91" [47;10H[K[47;10H1 line, 4 characters appended[1;3H[47;1H[K[47;1H:w >>XXtt92"XXtt92" [47;10H[K[47;10H1 line, 4 characters appended[1;3H[47;1H[K[47;1H:w >>XXtt93"XXtt93" [47;10H[K[47;10H1 line, 4 characters appended[1;3H[47;1H[K[47;1H:"[1;3H[47;1H[K[47;1H:" Concatenate the results.[1;3H[47;1H[K[47;1H:" Make fileformat of test.out the native fileformat.[1;3H[47;1H[K[47;1H:" Add a newline at the end.[1;3H[47;1H[K[47;1H:set binary[1;3H[47;1H[K[47;1H:e! test.out"test.out" [47;12H[K[47;12H2 lines, 10 characters[1;1Hunix
unix[1;1H[47;1H[K[47;1H:$r XXtt01"XXtt01" [47;10H[K[47;10H3 lines, 14 characters[3;1Hdos[1m^M[m
dos[1m^M[m
END[3;1H[47;1H[K[47;1H:$r XXtt02"XXtt02" [47;10H[K[47;10H2 lines, 13 characters[6;1Hmac[1m^M[mmac[1m^M[m
END[6;1H

1[47;1H[K[47;1H:$r XXtt11"XXtt11" [47;10H[K[47;10H3 lines, 16 characters[9;1Hunix[1m^M[m
unix[1m^M[m
END[9;1H[47;1H[K[47;1H:$r XXtt12"XXtt12" [47;10H[K[47;10H3 lines, 14 characters[12;1Hdos[1m^M[m
dos[1m^M[m
END[12;1H[47;1H[K[47;1H:$r XXtt13"XXtt13" [47;10H[K[47;10H2 lines, 14 characters[15;1Hmac[1m^M[mmac[1m^M^M[m
END[15;1H

2[47;1H[K[47;1H:$r XXtt21"XXtt21" [47;10H[K[47;10H3 lines, 15 characters[18;1Hunix
unix
[1m^M[mEND[18;1H[47;1H[K[47;1H:$r XXtt22"XXtt22" [47;10H[K[47;10H3 lines, 15 characters[21;1Hdos[1m^M[m
dos[1m^M
^M[mEND[21;1H[47;1H[K[47;1H:$r XXtt23"XXtt23" [47;10H[K[47;10H1 line, 12 characters[24;1Hmac[1m^M[mmac[1m^M[mEND
3[47;1H[K[47;1H:$r XXtt31"XXtt31" [47;10H[K[47;10H6 lines, 33 characters[26;1Hunix
unix
dos[1m^M[m
dos[1m^M[m
mac[1m^M[mmac[1m^M[m
END[26;1H[47;1H[K[47;1H:$r XXtt32"XXtt32" [47;10H[K[47;10H6 lines, 36 characters[32;1Hunix[1m^M[m
unix[1m^M[m
dos[1m^M[m
dos[1m^M[m
mac[1m^M[mmac[1m^M^M[m
END[32;1H[47;1H[K[47;1H:$r XXtt33"XXtt33" [47;10H[K[47;10H5 lines, 32 characters[38;1Hunix
unix
dos[1m^M[m
dos[1m^M[m
mac[1m^M[mmac[1m^M[mEND[38;1H[42;1H
4[47;1H[K[47;1H:$r XXtt41"XXtt41" [47;10H[K[47;10H6 lines, 33 characters[44;1Hunix
unix
dos[1m^M[44;1H[m[47;1H[K[47;1H:$r XXtt42"XXtt42" [47;10H[K[47;10H4 lines, 23 characters[1;46r[1;1H[4M[1;47r[43;1Hdos[1m^M[m
mac[1m^M[mmac[1m^M[m
END
unix[47;1H[K[46;1H
:$r XXtt43"XXtt43" [47;10H[K[47;10H4 lines, 24 characters[1;46r[1;1H[4M[1;47r[43;1Hunix
mac[1m^M[mmac[1m^M[m
END
dos[1m^M[m[47;1H[K[46;1H[1;46r[1;1H[3M[1;47r[44;1Hdos[1m^M[m
mac[1m^M[mmac[1m^M^M[m
END[1;46r[46;1H
[1;47r[46;1H5
:$r XXtt51"XXtt51" [47;10H[K[47;10H5 lines, 24 characters[1;46r[46;1H
[1;47r[46;1Hunix[47;1H[K[46;1H
:$r XXtt52"XXtt52" [47;10H[K[47;10H6 lines, 33 characters[1;46r[1;1H[5M[1;47r[42;1Hunix
dos[1m^M[m
dos[1m^M[m
END
unix[47;1H[K[46;1H
:$r XXtt53"XXtt53" [47;10H[K[47;10H3 lines, 22 characters[1;46r[1;1H[6M[1;47r[41;1Hunix
dos[1m^M[m
dos[1m^M[m
mac[1m^M[mmac[1m^M[m
END
dos[1m^M[m[47;1H[K[46;1H[1;46r[1;1H[2M[1;47r[45;1Hdos[1m^M[m
mac[1m^M[mmac[1m^M[mEND[1;46r[46;1H
[1;47r[46;1H6
:$r XXtt61"XXtt61" [47;10H[K[47;10H5 lines, 26 characters[1;46r[46;1H
[1;47r[46;1Hunix[1m^M[m[47;1H[K[46;1H
:$r XXtt62"XXtt62" [47;10H[K[47;10H4 lines, 26 characters[1;46r[1;1H[5M[1;47r[42;1Hunix[1m^M[m
dos[1m^M[m
dos[1m^M[m
END
unix[1m^M[m[47;1H[K[46;1H
:$r XXtt63"XXtt63" [47;10H[K[47;10H6 lines, 36 characters[1;46r[1;1H[4M[1;47r[43;1Hunix[1m^M[m
mac[1m^M[mmac[1m^M^M[m
END
unix[1m^M[m[47;1H[K[46;1H[1;46r[1;1H[5M[1;47r[42;1Hunix[1m^M[m
dos[1m^M[m
dos[1m^M[m
mac[1m^M[mmac[1m^M^M[m
END[1;46r[46;1H
[1;47r[46;1H7
:$r XXtt71"XXtt71" [47;10H[K[47;10H6 lines, 33 characters[1;46r[46;1H
[1;47r[46;1Hunix[47;1H[K[46;1H[1;46r[1;1H[5M[1;47r[42;1Hunix
dos[1m^M[m
dos[1m^M[m
mac[1m^M[mmac[1m^M[m
END[1;46r[46;1H
[1;47r[46;1H8
:$r XXtt81"XXtt81" [47;10H[K[47;10H6 lines, 33 characters[1;46r[46;1H
[1;47r[46;1Hunix[47;1H[K[46;1H[1;46r[1;1H[5M[1;47r[42;1Hunix
dos[1m^M[m
dos[1m^M[m
mac[1m^M[mmac[1m^M[m
END[1;46r[46;1H
[1;47r[46;1H9
:$r XXtt91"XXtt91" [47;10H[K[47;10H5 lines, 32 characters[1;46r[46;1H
[1;47r[46;1Hunix[47;1H[K[46;1H
:$r XXtt92"XXtt92" [47;10H[K[47;10H5 lines, 32 characters[1;46r[1;1H[5M[1;47r[42;1Hunix
dos[1m^M[m
dos[1m^M[m
mac[1m^M[mmac[1m^M[mEND
unix[47;1H[K[46;1H
:$r XXtt93"XXtt93" [47;10H[K[47;10H5 lines, 32 characters[1;46r[1;1H[5M[1;47r[42;1Hunix
dos[1m^M[m
dos[1m^M[m
mac[1m^M[mmac[1m^M[mEND
unix[47;1H[K[46;1H[1;46r[1;1H[4M[1;47r[43;1Hunix
dos[1m^M[m
dos[1m^M[m
mac[1m^M[mmac[1m^M[mEND[1;46r[46;1H
[1;47r[46;1H10
:$r XXUnix"XXUnix" [47;10H[K[47;10H2 lines, 10 characters[1;46r[46;1H
[1;47r[46;1Hunix[47;1H[K[46;1H
:set nobinary ff&[46;1H[47;1H[K[47;1H:w"test.out" 121 lines, 664 characters written[46;1H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test31.failed test.ok test.out X* viminfo
cp test31.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test31.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test31.in" 69 lines, 1423 characters[1;1HTest for commands that close windows and/or buffers:
:quit
:close
:hide
:only
:sall
:all
:ball
:buf
:edit

STARTTEST
:so tiny.vim
GA 1[1m^[[m:$w! Xtest1
$r2:$w! Xtest2
$r3:$w! Xtest3
:n! Xtest1 Xtest2
A 1[1m^[[m:set hidden
:" test for working :n when hidden set; write "testtext 2"
:n
:w! test.out
:" test for failing :rew when hidden not set; write "testtext 2 2"
:set nohidden
A 2[1m^[[m:rew
:w >>test.out
:" test for working :rew when hidden set; write "testtext 1 1"
:set hidden
:rew
:w >>test.out
:" test for :all keeping a buffer when it's modified; write "testtext 1 1 1"
:set nohidden
A 1[1m^[[m:sp
:n Xtest2 Xtest3
:all
:1wincmd w
:w >>test.out
:" test abandoning changed buffer, should be unloaded even when 'hidden' set
:" write "testtext 2 2" twice
:set hidden
A 1[1m^[[m:q!
:w >>test.out
:unhide
:w >>test.out
:" test ":hide" hides anyway when 'hidden' not set; write "testtext 3"
:set nohidden
A 2[1m^[[m:hide[1;1H[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[12;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[13;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 54 lines, 1288 characters written[13;1H[47;1H[K[47;1H:set ff& cpo+=A[13;1H[47;1H/ENDTEST[47;10H[K[47;1H[1;46r[1;1H[21M[1;47r[26;1H:w >>test.out
:" test ":edit" failing in modified buffer when 'hidden' not set
:" write "testtext 3 3"
A 3[1m^[[m:e Xtest1
:w >>test.out
:" test ":edit" working in modified buffer when 'hidden' set; write "testtext 1"
:set hidden
:e Xtest1
:w >>test.out
:" test ":close" not hiding when 'hidden' not set in modified buffer;
:" write "testtext 3 3 3"
:sp Xtest3
:set nohidden
A 3[1m^[[m:close
:w >>test.out
:" test ":close!" does hide when 'hidden' not set in modified buffer;
:" write "testtext 1"
A 3[1m^[[m:close!
:w >>test.out
:qa!
ENDTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H
:so! Xdotest[46;1H[47;1H[K[47;1H:so tiny.vim[46;1H[1;46r[46;1H
[1;47r[46;1Htesttext[47;1H[K[46;1H[9C1
:$w! Xtest1"Xtest1" [47;10H[K[47;10H[New File] 1 line, 11 characters written[46;10H2[47;1H[K[47;1H:$w! Xtest2"Xtest2" [47;10H[K[47;10H[New File] 1 line, 11 characters written[46;10H3[47;1H[K[47;1H:$w! Xtest3"Xtest3" [47;10H[K[47;10H[New File] 1 line, 11 characters written[46;10H[47;1H[K[47;1H:n! Xtest1 Xtest2"Xtest1" [47;10H[K[47;10H1 line, 11 characters[1;1Htesttext 1[2;2H[K[2;1H[1m~[m[3;2H[K[3;1H[1m~[m[4;2H[K[4;1H[1m~[m[5;2H[K[5;1H[1m~[m[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;3H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;3H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;3H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;3H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;3H[K[37;1H[1m~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~[m[41;3H[K[41;1H[1m~[m[42;2H[K[42;1H[1m~[m[43;2H[K[43;1H[1m~[m[44;2H[K[44;1H[1m~
~[m[46;2H[K[46;1H[1m~[1;1H[m[11C1[47;1H[K[47;1H:set hidden[1;12H[47;1H[K[47;1H:" test for working :n when hidden set; write "testtext 2"[1;12H[47;1H[K[47;1H:n"Xtest2" 1 line, 11 characters[1;10H2[1;12H[K[1;1H[47;1H[K[47;1H:w! test.out"test.out" [47;12H[K[47;12H[New File] 1 line, 11 characters written[1;1H[47;1H[K[47;1H:" test for failing :rew when hidden not set; write "testtext 2 2"[1;1H[47;1H[K[47;1H:set nohidden[1;1H[11C2[47;1H[K[47;1H:rew[7mE37: No write since last change (add ! to override)[1;12H[m[47;1H[K[47;1H:w >>test.out"test.out" [47;12H[K[47;12H1 line, 13 characters appended[1;12H[47;1H[K[47;1H:" test for working :rew when hidden set; write "testtext 1 1"[1;12H[47;1H[K[47;1H:set hidden[1;12H[47;1H[K[47;1H:rew"Xtest1" [Modified] line 1 of 1 --100%-- col 1 (file 1 of 2)[1;10H1 1[47;1H[K[47;1H:w >>test.out"test.out" [47;12H[K[47;12H1 line, 13 characters appended[1;1H[47;1H[K[47;1H:" test for :all keeping a buffer when it's modified; write "testtext 1 1 1"[1;1H[47;1H[K[47;1H:set nohidden[1;1H[13C1[47;1H[K[47;1H:sp[23;1H[1m[7mXtest1 [+]                                                                                                                     [m[24;1Htesttext 1 1 1[46;1H[7mXtest1 [+]                                                                                                                     [1;14H[m[47;1H[K[47;1H:n Xtest2 Xtest3"Xtest2" [Modified] line 1 of 1 --100%-- col 1 (file 1 of 2)[1;10H2 2[1;14H[K[23;6H[1m[7m2 [1;1H[m[47;1H[K[47;1H:all"Xtest3" 1 line, 11 characters[m[H[2J[1;1Htesttext 1 1 1
[1m~
~
~
~
~
~
~
~
~
~
~
~
~[m
[7mXtest1 [+]                                                                                                                     [m[16;1Htesttext 2 2
[1m~
~
~
~
~
~
~
~
~
~
~
~
~[m
[1m[7mXtest2 [+]                                                                                                                     [m[31;1Htesttext 3
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~[m
[7mXtest3                                                                                                                         [16;1H[47;1H[m:1wincmd w[15;1H[1m[7mXtest1 [+]                                                                                                                     [m[30;1H[7mXtest2 [+]                                                                                                                     [1;14H[m[47;1H[K[47;1H:w >>test.out"test.out" [47;12H[K[47;12H1 line, 15 characters appended[1;14H[47;1H[K[47;1H:" test abandoning changed buffer, should be unloaded even when 'hidden' set[1;14H[47;1H[K[47;1H:" write "testtext 2 2" twice[1;14H[47;1H[K[47;1H:set hidden[1;14H1 1[47;1H[K[47;1H:q![m[H[2J[1;1Htesttext 2 2
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[m
[1m[7mXtest2 [+]                                                                                                                     [m[24;1Htesttext 3
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[m
[7mXtest3                                                                                                                         [1;1H[47;1H[m:w >>test.out"test.out" [47;12H[K[47;12H1 line, 13 characters appended[1;1H[47;1H[K[47;1H:unhide[1;1H[47;1H[K[47;1H:w >>test.out"test.out" [47;12H[K[47;12H1 line, 13 characters appended[1;1H[47;1H[K[47;1H:" test ":hide" hides anyway when 'hidden' not set; write "testtext 3"[1;1H[47;1H[K[47;1H:set nohidden[1;1H[13C2[47;1H[K[47;1H:hide[1;10H3[1;12H[K[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[46;2H[K[46;1H[1m~[1;1H[m[47;1H[K[47;1H:w >>test.out"test.out" [47;12H[K[47;12H1 line, 11 characters appended[1;1H[47;1H[K[47;1H:" test ":edit" failing in modified buffer when 'hidden' not set[1;1H[47;1H[K[47;1H:" write "testtext 3 3"[1;1H[11C3[47;1H[K[47;1H:e Xtest1[7mE37: No write since last change (add ! to override)[1;12H[m[47;1H[K[47;1H:w >>test.out"test.out" [47;12H[K[47;12H1 line, 13 characters appended[1;12H[47;1H[K[47;1H:" test ":edit" working in modified buffer when 'hidden' set; write "testtext 1"[1;12H[47;1H[K[47;1H:set hidden[1;12H[47;1H[K[47;1H:e Xtest1"Xtest1" 1 line, 11 characters[1;10H1[1;12H[K[1;1H[47;1H[K[47;1H:w >>test.out"test.out" [47;12H[K[47;12H1 line, 11 characters appended[1;1H[47;1H[K[47;1H:" test ":close" not hiding when 'hidden' not set in modified buffer;[1;1H[47;1H[K[47;1H:" write "testtext 3 3 3"[1;1H[47;1H[K[47;1H:sp Xtest3"Xtest3" [Modified] line 1 of 1 --100%-- col 1 (file 2 of 2)[1;10H3 3[23;1H[1m[7mXtest3 [+]                                                                                                                     [m[24;1Htesttext 1[46;1H[7mXtest1                                                                                                                         [1;1H[m[47;1H[K[47;1H:set nohidden[1;1H[13C3[47;1H[K[47;1H:close[7mE37: No write since last change (add ! to override)[1;14H[m[47;1H[K[47;1H:w >>test.out"test.out" [47;12H[K[47;12H1 line, 15 characters appended[1;14H[47;1H[K[47;1H:" test ":close!" does hide when 'hidden' not set in modified buffer;[1;14H[47;1H[K[47;1H:" write "testtext 1"[1;14H3 3[47;1H[K[47;1H:close![1;10H1[1;12H[K[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[46;2H[K[46;1H[1m~[1;1H[m[47;1H[K[47;1H:w >>test.out"test.out" [47;12H[K[47;12H1 line, 11 characters appended[1;1H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test32.failed test.ok test.out X* viminfo
cp test32.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test32.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test32.in" 57 lines, 1242 characters[1;1HTest for insert expansion

:se cpt=.,w
* add-expands (word from next line) from other window
* add-expands (current buffer first)
* Local expansion, ends in an empty line (unless it becomes a global expansion)
* starts Local and switches to global add-expansion
:se cpt=.,w,i
* i-add-expands and switches to local
* add-expands lines (it would end in an empty line if it didn't ignored it self)
:se cpt=kXtestfile
* checks k-expansion, and file expansion (use Xtest11 instead of test11,
* because TEST11.OUT may match first on DOS)
:se cpt=w
* checks make_cyclic in other window
:se cpt=u nohid
* checks unloaded buffer expansion
* checks adding mode abortion
:se cpt=t,d
* tag expansion, define add-expansion interrupted
* t-expansion

STARTTEST
:so small.vim
:se nocp viminfo+=nviminfo cpt=.,w ff=unix | $-2,$w!Xtestfile | set ff&
:se cot=
[1m^W[mnO#include "Xtestfile"
ru[1m^N^N^X^N^[^A[m
O[1m^P^X^N
^X^P^P^P^P^P
^X^P^P^X^X^N^X^N^N^[[m
:se cpt=.,w,i
kOM[1m^N^X^N^X^N^X^X^X^P
^X^L^X^L^P^P^[[m
:se cpt=kXtestfile
:w Xtest11.one
:w Xtest11.two
O[1m^N^[[mIX[1m^[[mA[1m^X^F^N^[[m
:se cpt=w
OST[1m^N^P^P^P^P^[[m
:se cpt=u nohid
[1m^W[moOEN[1m^N[m
unl[1m^N^X^X^P^[[m
:se cpt=t,d def=^\\k* tags=Xtestfile notagbsearch
O[1m^X^]^X^D^X^D^X^X^D^X^D^X^D^X^D[m
a[1m^N^[[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[23;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[24;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 24 lines, 384 characters written[24;1H[47;1H[K[47;1H:set ff& cpo+=A[24;1H[47;1H/ENDTEST[47;10H[K[47;1H[1;46r[1;1H[2M[1;47r[45;1H:wq! test.out
ENDTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H
:so! Xdotest[46;1H[47;1H[K[47;1H:so small.vim[46;1H[47;1H[K[47;1H:se nocp viminfo+=nviminfo cpt=.,w ff=unix | $-2,$w!Xtestfile | set ff&"Xtestfile" [47;13H[K[47;13H[New] 3L, 57C written[46;1H[47;1H[K[47;1H:se cot=[46;1H[1;1H[K[2;3H[K[2;1H[1m~[m[3;3H[K[3;1H[1m~[m[4;3H[K[4;1H[1m~[m[5;2H[K[5;1H[1m~[m[6;3H[K[6;1H[1m~[m[7;3H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;3H[K[9;1H[1m~[m[10;3H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;3H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;3H[K[14;1H[1m~[m[15;3H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;3H[K[17;1H[1m~[m[18;3H[K[18;1H[1m~
~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m
[1m[7m[No Name]                                                                                                                      [m[24;1Hru[1m^N^N^X^N^[^A[m[24;15H[K[25;1HO[1m^P^X^N[m[25;8H[K[26;1H[1m^X^P^P^P^P^P[27;8HX^X^N^X^N^N^[[m
:se cpt=.,w,i[28;14H[K[29;1HkOM[1m^N^X^N^X^N^X^X^X^P
^X^L^X^L^P^P^[[m[30;15H[K[31;1H:se cpt=kXtestfile
:w Xtest11.one[32;15H[K[33;12Htwo
O[1m^N^[[mIX[1m^[[mA[1m^X^F^N^[[m
:se cpt=w[35;10H[K[36;1HOST[1m^N^P^P^P^P^[[m
:se cpt=u nohid
[1m^W[moOEN[1m^N[m[38;9H[K[39;1Hunl[1m^N^X^X^P^[[m
:se cpt=t,d def=^\\k* tags=Xtestfile notagbsearch
O[1m^X^]^X^D^X^D^X^X^D^X^D^X^D^X^D[m[41;32H[K[42;1Ha[1C[1mN^[[m[42;6H[K[43;1H:wq! test.out
ENDTEST[44;8H[K[45;1H[K[46;1H[7mtest32.in                                                                                                                      [1;1H[m[47;1H[1m-- INSERT ---- Keyword completion (^N^P) -- Searching...[m[7msearch hit BOTTOM, continuing at TOP[m[47;37H[K[47;1H[7mScanning: test32.in[m[47;20H[K[47;1Hmatch in file test32.in[1m-- Keyword completion (^N^P) [m[7mmatch 1 of 4[2;3H[m[47;29H[K[47;1Hmatch in file test32.in[47;24H[K[47;1H[1m-- Keyword completion (^N^P) [m[7mmatch 2 of 4[2;5H[m[47;29H[K[47;1H[K[47;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[m[47;13H[K[47;4H[1mAdding Keyword completion (^N^P) -- Searching...[m[7msearch hit BOTTOM, continuing at TOP[m[47;37H[K[47;1H[7mScanning: test32.in[m[47;20H[K[47;1Hmatch in file test32.in[1m-- Adding Keyword completion (^N^P) Word from other line[2;10H[1;22r[m[1;1H[2L[1;47r[1;1H#include "Xtestfile"
run1 run2[23;11H[1m[7m[+][2;10H[m[47;1H[K[47;1H[1m-- Adding Keyword completion (^N^P) Word from other line[m[47;1H[K[47;1H[1m-- INSERT --[m[47;1H[K[2;9H3
[47;1H[1m-- INSERT ---- Keyword completion (^N^P) -- Searching...[m[7msearch hit TOP, continuing at BOTTOM[m[47;37H[K[47;1H[7mScanning: test32.i[m[47;20H[K[47;1H[1m-- Keyword completion (^N^P) [m[7mmatch 1 of 103[3;5H[m[47;29H[K[47;1H[K[47;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[m[47;13H[K[47;4H[1mAdding Keyword completion (^N^P) -- Searching...[m[7msearch hit BOTTOM, continuing at TOP[m[47;37H[K[47;1H[7mScanning: test32.in[m[47;20H[K[47;1H[1m-- Adding Keyword completion (^N^P) Word from other line[3;10H[m[47;1H[K[47;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[m[47;13H[K[47;4H[1mKeyword Local completion (^N^P) -- Searching...[m[7msearch hit TOP, continuing at BOTTOM[m[47;37H[K[47;1H[1m-- Keyword Local completion (^N^P) [m[7mmatch 1 of 4[4;5H[m[47;35H[K[47;35H[1m [m[7mmatch 2 of 4[4;5H[m[47;35H[K[47;35H[1m [m[7mmatch 3 of 4[4;10H[m[47;35H[K[47;35H[1m [m[7mmatch 4 of 4[4;8H[m[47;35H[K[47;35H[1m [m[7mBack at original[4;1H[m[47;1H[K[47;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[m[47;13H[K[47;4H[1mKeyword Local completion (^N^P) -- Searching...[m[7msearch hit TOP, continuing at BOTTOM[m[47;37H[K[47;1H[1m-- Keyword Local completion (^N^P) [m[7mmatch 1 of 4[5;5H[m[47;35H[K[47;35H[1m [m[7mmatch 2 of 4[5;5H[m[47;35H[K[47;1H[K[47;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[m[47;13H[K[47;4H[1m^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[m[47;13H[K[47;4H[1mKeyword completion (^N^P) -- Searching...[m[7msearch hit BOTTOM, continuing at TOP[m[47;37H[K[47;1H[7mScanning: test32.in[m[47;20H[K[47;1H[1m-- Keyword completion (^N^P) The only match[5;5H[m[47;29H[K[47;1H[K[47;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[m[47;13H[K[47;4H[1mAdding Keyword completion (^N^P) -- Searching...[m[7msearch hit BOTTOM, continuing at TOP[m[47;37H[K[47;1H[7mScanning: test32.in[m[47;20H[K[47;1H[1m-- Adding Keyword completion (^N^P) [m[7mmatch 1 of 2[5;10H[m[47;36H[K[47;1Hmatch in file test32.in[47;24H[K[47;1H[1m-- Adding Keyword completion (^N^P) Word from other line[5;10H[3;22r[m[3;1H[3L[1;47r[3;1Hrun3 run3

run1 run2[47;1H[K[47;1H[1m-- Adding Keyword completion (^N^P) Word from other line[m[47;1H[K[47;1H[1m-- INSERT --[m[47;1H[K[5;9H
[47;1H:se cpt=.,w,i[6;1H[5;1H[47;1H[1m-- INSERT --[m[47;13H[K[47;4H[1mKeyword completion (^N^P) -- Searching...[m[7msearch hit BOTTOM, continuing at TOP[m[47;37H[K[47;1H[7mScanning: test32.in[m[47;20H[K[47;9H[7m included file: Xtestfile[mmatch in file test32.in[47;24H[K[47;1H[1m-- Keyword completion (^N^P) The only match[5;9H[m[47;29H[K[47;1H[K[47;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[m[47;13H[K[47;4H[1mAdding Keyword completion (^N^P) -- Searching...[m[7msearch hit BOTTOM, continuing at TOP[m[47;37H[K[47;1H[7mScanning: test32.in[m[47;20H[K[47;9H[7m included file: Xtestfile[mmatch in file test32.in[47;24H[K[47;1H[1m-- Adding Keyword completion (^N^P) The only match[5;19H[m[47;36H[K[47;1H[K[47;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[m[47;13H[K[47;4H[1mAdding Keyword completion (^N^P) -- Searching...[m[7msearch hit BOTTOM, continuing at TOP[m[47;37H[K[47;1H[7mScanning: test32.in[m[47;20H[K[47;9H[7m included file: Xtestfile[mmatch in file test32.in[47;24H[K[47;1H[1m-- Adding Keyword completion (^N^P) The only match[5;28H[m[47;36H[K[47;1H[K[47;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[m[47;13H[K[47;4H[1m^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[m[47;13H[K[47;4H[1m^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[m[47;13H[K[47;4H[1mKeyword Local completion (^N^P) -- Searching...[m[7msearch hit TOP, continuing at BOTTOM[m[47;37H[K[47;1H[1m-- Keyword Local completion (^N^P) [m[7mmatch 1 of 3[5;29H[m[47;1H[K[47;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- Whole line completion (^L^N^P) -- Searching...[m[7msearch hit TOP, continuing at BOTTOM[m[47;37H[K[47;1H[7mScanning: test32.i[m[47;20H[K[47;1H[1m-- Whole line completion (^L^N^P) [m[7mmatch 1 of 54[6;29H[m[47;4H[1mINSERT --[m[47;13H[K[47;1H[K[47;1H[1m-- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y) [m[7mmatch 1 of 54[m[47;4H[1mAdding Whole line completion (^L^N^P) -- Searching...[m[7msearch hit TOP, continuing at BOTTOM[m[47;37H[K[47;1H[7mScanning: test32.i[m[47;20H[K[47;1H[1m-- Adding Whole line completion (^L^N^P) The only match[7;29H[m[47;41H[K[47;41H[1m [m[7mBack at original[7;1H[m[47;41H[K[47;41H[1m The only match[7;29H[5;22r[m[5;1H[3L[1;47r[5;1HMakefile[8Cto      run3
Makefile[8Cto      run3
Makefile[8Cto      run3[47;1H[K[47;1H[1m-- INSERT --[m[47;1H[K[7;28H[8;9H[47;1H:se cpt=kXtestfile[8;9H[47;1H[K[47;1H:w Xtest11.one"Xtest11.one" [New] 9L, 104C written[23;1H[1m[7mXtest11.one   [8;9H[m[47;1H[K[47;1H:w Xtest11.two"Xtest11.two" [New] 9L, 104C written[8;9H[47;1H[1m-- INSERT --[m[47;13H[K[47;4H[1mKeyword completion (^N^P) -- Searching...[m[7mScanning dictionary: Xtestfile[m[47;31H[K[47;1Hmatch in file Xtestfile[47;24H[K[47;1H[1m-- Keyword completion (^N^P) [m[7mmatch 1 of 9[8;7H[8;22r[m[8;1H[L[1;47r[8;1Htest11[23;13H[1m[7m[+][8;7H[mI [47;1H[K[47;1H[1m-- Keyword completion (^N^P) [m[7mmatch 1 of 9[m[47;1H[K[47;1H[1m-- INSERT --[m[47;1H[K[8;6H[47;1H[1m-- INSERT --[m[47;1H[K[8;1HXtest11[47;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- File name completion (^F^N^P) -- Searching...[m[47;34H[7mmatch 1 of 2[m[47;46H[K[8;12H[47;33H[K[47;33H[1m [m[7mmatch 2 of 2[8;12H[m.two[47;1H[K[47;1H[1m-- INSERT --[m[47;1H[K[8;11H[9;9H[47;1H:se cpt=w[9;9H[47;1H[1m-- INSERT ---- Keyword completion (^N^P) -- Searching...[m[7mScanning: test32.in[m[47;20H[K[47;1Hmatch in file test32.in[1m-- Keyword completion (^N^P) The only match[9;10H[m[47;29H[K[47;29H[1m [m[7mBack at original[9;3H[m[47;29H[K[47;1Hmatch in file test32.in[47;24H[K[47;1H[1m-- Keyword completion (^N^P) The only match[9;10H[m[47;29H[K[47;29H[1m [m[7mBack at original[9;3H[m[47;29H[K[47;1Hmatch in file test32.in[47;24H[K[47;1H[1m-- Keyword completion (^N^P) The only match[9;10H[9;22r[m[9;1H[L[1;47r[9;1HSTARTTEST[47;1H[K[47;1H[1m-- Keyword completion (^N^P) The only match[m[47;1H[K[47;1H[1m-- INSERT --[m[47;1H[K[9;9H[10;9H[47;1H:se cpt=u nohid[10;9H[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;2H[K[37;1H[1m~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~[m[41;2H[K[41;1H[1m~[m[42;2H[K[42;1H[1m~[m[43;2H[K[43;1H[1m~[m[44;2H[K[44;1H[1m~
~[m[46;2H[K[46;1H[1m~[10;9H[47;1H-- INSERT --[m[47;13H[K[47;4H[1mKeyword completion (^N^P) -- Searching...[m[7mScanning: test32.in[m[47;20H[K[47;1Hmatch in file test32.in[1m-- Keyword completion (^N^P) The only match[10;8H[m[47;1H[K[47;1H[1m-- INSERT ---- Keyword completion (^N^P) -- Searching...[m[7mScanning: test32.in[m[47;20H[K[47;1Hmatch in file test32.in[1m-- Keyword completion (^N^P) [m[7mmatch 1 of 3[11;7H[m[47;29H[K[47;1H[K[47;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[m[47;13H[K[47;4H[1m^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[m[47;13H[K[47;4H[1mKeyword completion (^N^P) -- Searching...[m[7mScanning: test32.in[m[47;20H[K[47;1Hmatch in file test32.in[1m-- Keyword completion (^N^P) The only match[11;7H[10;46r[m[10;1H[2L[1;47r[10;1HENDTEST
unless[47;1H[K[47;1H[1m-- Keyword completion (^N^P) The only match[m[47;1H[K[47;1H[1m-- INSERT --[m[47;1H[K[11;6H[12;6H[47;1H:se cpt=t,d def=^\\k* tags=Xtestfile notagbsearch[12;6H[47;1H[1m-- INSERT --[m[47;13H[K[47;4H[1m^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- Tag completion (^]^N^P) -- Searching...[m[47;28H[7mmatch 1 of 3[m[47;40H[K[12;7H[47;4H[1mINSERT --[m[47;13H[K[47;1H[K[47;1H[1m-- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y) [m[7mmatch 1 of 3[m[47;4H[1mDefinition completion (^D^N^P) -- Searching...[m[47;50H[K[47;1H[7mScanning included file: Xtestfile[m[47;34H[K[47;1Hmatch in file Xtestfile[47;24H[K[47;1H[1m-- Definition completion (^D^N^P) The only match[12;11H[47;4HINSERT --[m[47;13H[K[47;1H[K[47;1H[1m-- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y) The only match-- Adding Definition completion (^D^N^P) -- Searching...[m[7mScanning included file: Xtestfile[m[47;34H[K[47;1Hmatch in file Xtestfile[47;24H[K[47;1H[1m-- Adding Definition completion (^D^N^P) The only match[12;20H[47;4HINSERT --[m[47;13H[K[47;1H[K[47;1H[1m-- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y) The only match-- INSERT --[m[47;13H[K[47;4H[1m^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- Definition completion (^D^N^P) -- Searching...[m[7mScanning included file: Xtestfile[m[47;34H[K[47;1Hmatch in file Xtestfile[47;24H[K[47;1H[1m-- Definition completion (^D^N^P) The only match[12;25H[47;4HINSERT --[m[47;13H[K[47;1H[K[47;1H[1m-- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y) The only match-- Adding Definition completion (^D^N^P) -- Searching...[m[7mScanning included file: Xtestfile[m[47;34H[K[47;1Hmatch in file Xtestfile[47;24H[K[47;1H[1m-- Adding Definition completion (^D^N^P) The only match[12;37H[47;4HINSERT --[m[47;13H[K[47;1H[K[47;1H[1m-- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y) The only match-- Adding Definition completion (^D^N^P) -- Searching...[m[7mScanning included file: Xtestfile[m[47;34H[K[47;1Hmatch in file Xtestfile[47;24H[K[47;1H[1m-- Adding Definition completion (^D^N^P) The only match[12;38H[47;4HINSERT --[m[47;13H[K[47;1H[K[47;1H[1m-- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y) The only match-- Adding Definition completion (^D^N^P) -- Searching...[m[7mScanning included file: Xtestfile[m[47;34H[K[47;1Hmatch in file Xtestfile[47;24H[K[47;1H[1m-- Adding Definition completion (^D^N^P) Word from other line[12;42H[47;4HINSERT --[m[47;13H[K[47;1H[K[47;1H[1m-- Keyword completion (^N^P) -- Searching...[m[7mScanning tags.[m[47;15H[K[47;10H[7mincluded file: Xtestfile[m[1m-- Keyword completion (^N^P) The only match[13;4H[12;46r[m[12;1H[2L[1;47r[12;1Htest11file      36Gepeto[8C/Tag/ asd
asd[47;1H[K[47;1H[1m-- Keyword completion (^N^P) The only match[m[47;1H[K[47;1H[1m-- INSERT --[m[47;1H[K[13;3H
ru[47;1H:wq! test.out"test.out" [47;12H[K[47;12H[New] 15L, 175C written[?1l>
rm -rf X* test.ok viminfo
rm -rf test33.failed test.ok test.out X* viminfo
cp test33.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test33.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test33.in" 34 lines, 616 characters[1;1HTest for 'lisp'
If the lisp feature is not enabled, this will fail!

STARTTEST
:so small.vim
:set lisp
/^(defun
=G:/^(defun/,$w! test.out
:q!
ENDTEST

(defun html-file (base)
(format nil "~(~A~).html" base))

(defmacro page (name title &rest body)
(let ((ti (gensym)))
`(with-open-file (*standard-output*
(html-file ,name)
:direction :output
:if-exists :supersede)
(let ((,ti ,title))
(as title ,ti)
(with center
(as h2 (string-upcase ,ti)))
(brs 3)
,@body))))

;;; Utilities for generating links

(defmacro with-link (dest &rest body)
`(progn
(format t "<a href=\"~A\">" (html-file ,dest))
,@body
(princ "</a>")))
[1m~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[4;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[5;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 5 lines, 63 characters written[5;1H[47;1H[K[47;1H:set ff& cpo+=A[5;1H[47;1H/ENDTEST[47;10H[K[47;1H[10;1H
[47;1H[K[47;1H:so! Xdotest[11;1H[47;1H[K[47;1H:so small.vim[11;1H[47;1H[K[47;1H:set lisp[11;1H[47;1H[K[47;1H/^(defun[12;1H[47;1H22 lines to indent...23[7Cindented [47;19H[K[13;1H  (format nil "~(~A~).html" base))


  (let ((ti (gensym)))
       `(with-open-file (*standard-output*
                 [8C(html-file ,name)
                  [7C:direction :output
                         :if-exists :supersede)
                        (let ((,ti ,title))
              [15C(as title ,ti)
            [17C(with center
                            [7C(as h2 (string-upcase ,ti)))
       [22C(brs 3)
          [19C,@body))))[31;1H  `(progn
    (format t "<a href=\"~A\">" (html-file ,dest))
    ,@body
    (princ "</a>")))[12;1H[47;1H[K[47;1H:/^(defun/,$w! test.out[7msearch hit BOTTOM, continuing at TOP[m"test.out" [47;12H[K[47;12H[New File] 23 lines, 544 characters written[12;1H[47;1H[K[47;1H:q![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test34.failed test.ok test.out X* viminfo
cp test34.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test34.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test34.in" 58 lines, 1014 characters[1;1HTest for user functions.
Also test an <expr> mapping calling a function.

STARTTEST
:so small.vim
:function Table(title, ...)
:  let ret = a:title
:  let idx = 1
:  while idx <= a:0
:    exe "let ret = ret . a:" . idx
:    let idx = idx + 1
:  endwhile
:  return ret
:endfunction
:function Compute(n1, n2, divname)
:  if a:n2 == 0
:    return "fail"
:  endif
:  exe "let g:" . a:divname . " = ". a:n1 / a:n2
:  return "ok"
:endfunction
:func Expr1()
:  normal! v
:  return "111"
:endfunc
:func Expr2()
:  call search('XX', 'b')
:  return "222"
:endfunc
:func ListItem()
:  let g:counter += 1
:  return g:counter . '. '
:endfunc
:func ListReset()
:  let g:counter = 0
:  return ''
:endfunc
:let counter = 0
:inoremap <expr> ( ListItem()
:inoremap <expr> [ ListReset()
:imap <expr> + Expr1()
:imap <expr> * Expr2()
:let retval = "nop"
/^here
C[1m^R[m=Table("xxx", 4, "asdf")
 [1m^R[m=Compute(45, 0, "retval")[1;1H[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[4;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[5;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 51 lines, 916 characters written[5;1H[47;1H[K[47;1H:set ff& cpo+=A[5;1H[47;1H/ENDTEST[47;10H[K[47;1H[1;46r[1;1H[10M[1;47r[37;2H[1m^R[m=retval
 [1m^R[m=Compute(45, 5, "retval")
 [1m^R[m=retval

XX+-XX
---*---
(one
(two
[(one again[1m^[[m:$-5,$wq! test.out
ENDTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H
:so! Xdotest[46;1H[47;1H[K[47;1H:so small.vim[46;1H[47;1H[K[47;1H:function Table(title, ...)
:  :  let ret = a:title
:  :  let idx = 1
:  :  while idx <= a:0
:    :    exe "let ret = ret . a:" . idx
:    :    let idx = idx + 1
:    :  endwhile
:  :  return ret
:  :endfunction[1;1H[8L[1;1H:  endwhile
:  return ret
:endfunction
:function Compute(n1, n2, divname)
:  if a:n2 == 0
:    return "fail"
:  endif
:  exe "let g:" . a:divname . " = ". a:n1 / a:n2[47;1H[K[46;1H
:function Compute(n1, n2, divname)
:  :  if a:n2 == 0
:    :    return "fail"
:    :  endif
:  :  exe "let g:" . a:divname . " = ". a:n1 / a:n2
:  :  return "ok"
:  :endfunction[1;1H[6L[1;1H:  endwhile
:  return ret
:endfunction
:function Compute(n1, n2, divname)
:  if a:n2 == 0
:    return "fail"[47;1H[K[46;1H
:func Expr1()
:  :  normal! v
:  :  return "111"
:  :endfunc[1;1H[3L[1;1H:  endwhile
:  return ret
:endfunction[47;1H[K[46;1H
:func Expr2()
:  :  call search('XX', 'b')
:  :  return "222"
:  :endfunc[1;1H[3L[1;1H:  endwhile
:  return ret
:endfunction[47;1H[K[46;1H
:func ListItem()
:  :  let g:counter += 1
:  :  return g:counter . '. '
:  :endfunc[1;1H[3L[1;1H:  endwhile
:  return ret
:endfunction[47;1H[K[46;1H
:func ListReset()
:  :  let g:counter = 0
:  :  return ''
:  :endfunc[1;1H[3L[1;1H:  endwhile
:  return ret
:endfunction[47;1H[K[46;1H
:let counter = 0[46;1H[47;1H[K[47;1H:inoremap <expr> ( ListItem()[46;1H[47;1H[K[47;1H:inoremap <expr> [ ListReset()[46;1H[47;1H[K[47;1H:imap <expr> + Expr1()[46;1H[47;1H[K[47;1H:imap <expr> * Expr2()[46;1H[47;1H[K[47;1H:let retval = "nop"[46;1H[47;1H[K[47;1H/^here[1;46r[46;1H
[1;47r[46;1Hhere[47;1H[K[46;1Hher$
=Table("xxx", 4, "asdf")[47;1H[K[47;1H=Compute(45, 0, "retval")[47;1H[K[47;1H=retval[47;1H[K[47;1H=Compute(45, 5, "retval")[47;1H[K[47;1H=retval
[7mError detected while processing function Expr1:[m
[4mline    1:[m
[7mE523: Not allowed here[m
[7mPress ENTER or type command to continue[m[1;1H[4L[1;1H:  endif
:  exe "let g:" . a:divname . " = ". a:n1 / a:n2
:  return "ok"
:endfunction
:func Expr1()[5;14H[K[6;4Hnormal! v
:  return "111[7;17H[K[8;2Hendfunc[8;9H[K[9;2Hfunc Expr2()
:  call search('XX', 'b')
:  return "222"
:endfunc[12;9H[K[13;2Hfunc ListItem()
:  let g:counter += 1
:  return g:counter . '. '
:endfunc[16;9H[K[17;2Hfunc ListReset()
:  let g:counter = 0
:  return ''[19;13H[K[20;2Hendfunc[20;9H[K[21;2Hlet counter = 0
:inoremap <expr> ( ListItem()
:inoremap <expr> [ ListReset()
:imap <expr> + Expr1()
:imap <expr> * Expr2()[26;6Hretval = "nop"
/^he[27;7H[K[28;1HC[1m^R[m=Table("xxx", 4, "asdf")[28;28H[K[29;1H [1m^R[m=Compute(45, 0, "retval")
 [1m^R[m=retval[30;11H[K[31;1H [1m^R[m=Compute(45, 5, "retval")
 [1m^R[m=retval[33;1H[K[34;1HXX+-XX[34;7H[K[35;1H---*---[35;8H[K[36;1H(one[36;5H[K[37;1H(two[37;5H[K[38;1H[(one again[1m^[[m:$-5,$wq! test.out
ENDTEST[40;1H[K[41;1Hxxx4asdf fail nop ok 9
XX111XX
---222---[43;10H[K[44;1H1. one[44;7H[K[45;1H2. two[46;1H[K[47;1H[K[46;1H1. one again
:$-5,$wq! test.out"test.out" [47;12H[K[47;12H[New File] 6 lines, 68 characters written[?1l>
rm -rf X* test.ok viminfo
rm -rf test35.failed test.ok test.out X* viminfo
cp test35.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test35.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test35.in" 21 lines, 448 characters[1;1HTest Ctrl-A and Ctrl-X, which increment and decrement decimal, hexadecimal,
and octal numbers.

STARTTEST
/^start-here
:set nrformats=octal,hex
j[1m^A[m102[1m^X^A[ml[1m^X[ml[1m^A[m64[1m^A[m128[1m^X[m$[1m^X[m
:set nrformats=octal
0[1m^A[m102[1m^X^A[ml[1m^X[m2[1m^A[mw65[1m^A[m129[1m^X[mblx6lD
:set nrformats=hex
0101[1m^X[ml257[1m^X^A[mTxldt [1m^A[m [1m^X[m [1m^X[m
:set nrformats=
0200[1m^X[ml100[1m^X[mw78[1m^X^A[mk
:$-3,$wq! test.out
ENDTEST

start-here
100     0x100     077     0
100     0x100     077
100     0x100     077     0xfF     0xFf
100     0x100     077
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[4;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[5;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 10 lines, 200 characters written[5;1H[47;1H[K[47;1H:set ff& cpo+=A[5;1H[47;1H/ENDTEST[47;10H[K[47;1H[15;1H
[47;1H[K[47;1H:so! Xdotest[16;1H[47;1H[K[47;1H/^start-here[17;1H[47;1H[K[47;1H:set nrformats=octal,hex[17;1H
101-1     0x100     077     0[18;27H[K[18;2H0     0x100     077     0[18;26H[K[18;1H0[7C0fff     0100     0[18;20H20000     -1[19;26H[47;1H[K[47;1H:set nrformats=octal[19;26H101-1     0x100     077 -0     0x100     077 0     -1x100     077[19;8H1x100     077 [19;7H[10C020037777777777[19;17H07[9C [19;18H777777[19;24H[K[19;23H[20;23H[47;1H[K[47;1H:set nrformats=hex[20;23H-1     0x100     077     0xfF     0xFf[20;39H[K[20;2H1[7Cffffffff     077     0xfF     0xFf[20;17H[20;10H00000000[20;10H0     077     0xfF     0xFf[20;40H[K[20;11H[7C88[7CFEE[7Cfe[21;26H[47;1H[K[47;1H:set nrformats=[21;26H-100     0x100     077-100     -100x100     077[21;13H[10C-001000 [20;25H[21;25H[47;1H[K[47;1H:$-3,$wq! test.out"test.out" [47;12H[K[47;12H[New File] 4 lines, 120 characters written[?1l>
rm -rf X* test.ok viminfo
rm -rf test36.failed test.ok test.out X* viminfo
cp test36.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test36.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test36.in" 40 lines, 1596 characters[1;1HTest character classes in regexp

STARTTEST
/^start-here
j:s/\d//g
j:s/\D//g
j:s/\o//g
j:s/\O//g
j:s/\x//g
j:s/\X//g
j:s/\w//g
j:s/\W//g
j:s/\h//g
j:s/\H//g
j:s/\a//g
j:s/\A//g
j:s/\l//g
j:s/\L//g
j:s/\u//g
j:s/\U//g
:/^start-here/+1,$wq! test.out
ENDTEST

start-here[25;9H[1m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[1m^?~@~B~P~[[m[26;9H[1m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[1m^?~@~B~P~[[m[27;9H[1m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[1m^?~@~B~P~[[m[28;9H[1m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[1m^?~@~B~P~[[m[29;9H[1m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[1m^?~@~B~P~[[m[30;9H[1m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[1m^?~@~B~P~[[m[31;9H[1m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[1m^?~@~B~P~[[m[32;9H[1m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[1m^?~@~B~P~[[m[33;9H[1m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[1m^?~@~B~P~[[m[34;9H[1m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[1m^?~@~B~P~[[m[35;9H[1m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[1m^?~@~B~P~[[m[36;9H[1m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[1m^?~@~B~P~[[m[37;9H[1m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[1m^?~@~B~P~[[m[38;9H[1m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[1m^?~@~B~P~[[m[39;9H[1m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[1m^?~@~B~P~[[m[40;9H[1m^L^M[m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[1m^?~@~B~P~[[m
[1m~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 18 lines, 204 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[22;1H
[47;1H[K[47;1H:so! Xdotest[23;1H[47;1H[K[47;1H/^start-here[24;1H[25;8H[47;1H[K[47;1H:s/\d//g10 substitutions on 1 line[25;29H:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[1m^?~@~B~P~[[m[25;87H[K[25;9H[26;9H[47;1H[K[47;1H:s/\D//g72 substitutions on 1 line[26;1H0123456789[26;11H[K[26;1H[27;8H[47;1H[K[47;1H:s/\o//g8 substitutions on 1 line[27;29H89:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[1m^?~@~B~P~[[m[27;89H[K[27;9H[28;9H[47;1H[K[47;1H:s/\O//g74 substitutions on 1 line[28;1H01234567[28;9H[K[28;1H[29;8H[47;1H[K[47;1H:s/\x//g22 substitutions on 1 line[29;29H:;<=>?@GHIXYZ[\]^_`ghiwxyz{|}~[1m^?~@~B~P~[[m[29;75H[K[29;9H[30;9H[47;1H[K[47;1H:s/\X//g60 substitutions on 1 line[30;1H0123456789ABCDEFabcdef[30;23H[K[30;1H[31;8H[47;1H[K[47;1H:s/\w//g36 substitutions on 1 line[31;29H:;<=>?@[\]^`{|}~[1m^?~@~B~P~[[m[31;61H[K[31;9H[32;9H[47;1H[K[47;1H:s/\W//g46 substitutions on 1 line[32;1H0123456789ABCDEFGHIXYZ_abcdefghiwxyz[32;37H[K[32;1H[33;8H[47;1H[K[47;1H:s/\h//g26 substitutions on 1 line[33;46H[\]^`{|}~[1m^?~@~B~P~[[m[33;71H[K[33;9H[34;9H[47;1H[K[47;1H:s/\H//g56 substitutions on 1 line[34;1HABCDEFGHIXYZ_abcdefghiwxyz[34;27H[K[34;1H[35;8H[47;1H[K[47;1H:s/\a//g25 substitutions on 1 line[35;46H[\]^_`{|}~[1m^?~@~B~P~[[m[35;72H[K[35;9H[36;9H[47;1H[K[47;1H:s/\A//g57 substitutions on 1 line[36;1HABCDEFGHIXYZabcdefghiwxyz[36;26H[K[36;1H[37;8H[47;1H[K[47;1H:s/\l//g13 substitutions on 1 line[37;64H{|}~[1m^?~@~B~P~[[m[37;84H[K[37;9H[38;9H[47;1H[K[47;1H:s/\L//g69 substitutions on 1 line[38;1Habcdefghiwxyz[38;14H[K[38;1H[39;8H[47;1H[K[47;1H:s/\u//g12 substitutions on 1 line[39;46H[\]^_`abcdefghiwxyz{|}~[1m^?~@~B~P~[[m[39;85H[K[39;9H[40;9H[47;1H[K[47;1H:s/\U//g70 substitutions on 1 line[40;1HABCDEFGHIXYZ[40;14H[K[40;1H[47;1H[K[47;1H:/^start-here/+1,$wq! test.out[7msearch hit BOTTOM, continuing at TOP[m"test.out" [47;12H[K[47;12H[New File] 16 lines, 672 characters written[?1l>
rm -rf X* test.ok viminfo
rm -rf test37.failed test.ok test.out X* viminfo
cp test37.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test37.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test37.in" 116 lines, 3262 characters[1;1HTest for 'scrollbind'. <eralston@computer.org>   Do not add a line below!
STARTTEST
:so small.vim
:set noscrollbind
:set scrollopt=ver,jump
:set scrolloff=2
:set nowrap
:set noequalalways
:set splitbelow
:" TEST using two windows open to one buffer, one extra empty window
:split
:new
[1m^W[mt:
:resize 8
/^start of window 1$/
zt:
:set scrollbind
[1m^W[mj:
:resize 7
/^start of window 2$/
zt:
:set scrollbind
:" -- start of tests --
:" TEST scrolling down
L5jHyy[1m^W[mbpr0[1m^W[mtHyy[1m^W[mbpr1[1m^W[mtL6jHyy[1m^W[mbpr2[1m^W[mkHyy[1m^W[mbpr3:
:" TEST scrolling up
[1m^W[mtH4k[1m^W[mjH[1m^W[mtHyy[1m^W[mbpr4[1m^W[mkHyy[1m^W[mbpr5[1m^W[mk3k[1m^W[mtH[1m^W[mjHyy[1m^W[mbpr6[1m^W[mtHyy[1m^W[mbpr7:
:" TEST horizontal scrolling
:set scrollopt+=hor
gg"zyyG"zpG[1m^W[mt015zly$[1m^W[mbp"zpG[1m^W[mky$[1m^W[mbp"zpG:
[1m^W[mk10jH7zhg0y$[1m^W[mbp"zpG[1m^W[mtHg0y$[1m^W[mbp"zpG:
:set scrollopt-=hor
:" ****** tests using two different buffers *****
[1m^W[mt[1m^W[mj:
:close
[1m^W[mt:
:set noscrollbind
:/^start of window 2$/,/^end of window 2$/y
:new
[1m^W[mt[1m^W[mj4"zpGp:
[1m^W[mt/^start of window 1$/
zt:
:set scrollbind
[1m^W[mj:
/^start of window 2$/
zt:[1;1H[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[2;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[3;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 72 lines, 1498 characters written[3;1H[47;1H[K[47;1H:set ff& cpo+=A[3;1H[47;1H/ENDTEST[47;10H[K[47;1H[m[H[2J[1;1H:" TEST horizontal scrolling
:set scrollopt+=hor
gg"zyyG"zpG[1m^W[mt015zly$[1m^W[mbp"zpG[1m^W[mky$[1m^W[mbp"zpG:
[1m^W[mk10jH7zhg0y$[1m^W[mbp"zpG[1m^W[mtHg0y$[1m^W[mbp"zpG:
:set scrollopt-=hor
:" TEST syncbind
[1m^W[mt:set noscb
ggL[1m^W[mj:set noscb
ggL:set scb
[1m^W[mt:set scb
G[1m^W[mjG:syncbind
Hk[1m^W[mtH[1m^W[mjHyy[1m^W[mbp[1m^W[mtyy[1m^W[mbp:
[1m^W[mt:set noscb
ggL[1m^W[mj:set noscb
ggL:set scb
[1m^W[mt:set scb
[1m^W[mtG[1m^W[mjG[1m^W[mt:syncbind
Hk[1m^W[mjH[1m^W[mtHyy[1m^W[mbp[1m^W[mt[1m^W[mjyy[1m^W[mbp:
[1m^W[mtH3k[1m^W[mjH[1m^W[mtHyy[1m^W[mbp[1m^W[mt[1m^W[mjyy[1m^W[mbp:
:" ***** done with tests *****
:w! test.out[13C" Write contents of this file
:qa!
ENDTEST


start of window 1
. line 01 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01
. line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02
. line 03 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 03
. line 04 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 04
. line 05 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05
. line 06 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06
. line 07 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 07
. line 08 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 08
. line 09 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 09
. line 10 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 10
. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11
. line 12 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 12
. line 13 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 13
. line 14 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 14
. line 15 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 15
end of window 1


start of window 2
. line 01 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 01[23;1H
[47;1H:so! Xdotest[24;1H[47;1H[K[47;1H:so small.vim[24;1H[47;1H[K[47;1H:set noscrollbind[24;1H[47;1H[K[47;1H:set scrollopt=ver,jump[24;1H[47;1H[K[47;1H:set scrolloff=2[24;1H[47;1H[K[47;1H:set nowrap[24;1H[47;1H[K[47;1H:set noequalalways[24;1H[47;1H[K[47;1H:set splitbelow[24;1H[47;1H[K[47;1H:" TEST using two windows open to one buffer, one extra empty window[24;1H[47;1H[K[47;1H:split[1;1H[1m^W[mt:set noscb[1;14H[K[2;1HggL[1m^W[mj:set noscb[2;17H[K[3;3HL:set scb[3;12H[K[4;3Ht:set scb[4;12H[K[5;1H[1m^W[mtG[1m^W[mjG[1m^W[mt:syncbind
Hk[1m^W[mjH[1m^W[mtHyy[1m^W[mbp[1m^W[mt[1m^W[mjyy[1m^W[mbp:[7;4HH3k[1m^W[mjH[1m^W[mtHyy[1m^W[mbp[1m^W[mt[1m^W[mjyy[1m^W[mbp:
:" ***** done with tests *****
:w! test.out[13C" Write contents of this file
:qa![10;5H[K[11;1HENDTEST[11;8H[K[12;1H[K[13;1H[K[14;1Hstart of window 1
. line 01 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01
. line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02
. line 03 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 03
. line 04 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 04
. line 05 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05
. line 06 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06
. line 07 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 07[21;51H[K[22;1H. line 08 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 08
[7mtest37.in                                                                                                                      [m[24;1H:qa!
ENDTEST[26;1H[K[27;1H[K[28;1Hstart of window 1[28;18H[K[29;9H1[39C1[30;9H2[39C2[31;9H3[39C3[32;9H4[39C4[33;9H5[39C5[34;9H6[39C6[35;9H7[39C7[36;8H08[38C08[37;8H09[38C09[38;9H0[39C0[39;9H1[39C1[40;9H2[39C2[41;9H3[39C3
. line 14 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 14
. line 15 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 15
end of window 1[45;1H[K[46;1H[1m[7mtest37.in                                                                                                                      [26;1H[m[47;1H[K[47;1H:new[34;1H[7mtest37.in                                                                                                                      [m[35;1H[K[36;3H[K[36;1H[1m~[m[37;3H[K[37;1H[1m~[m[38;3H[K[38;1H[1m~[m[39;3H[K[39;1H[1m~[m[40;3H[K[40;1H[1m~[m[41;3H[K[41;1H[1m~[m[42;3H[K[42;1H[1m~[m[43;3H[K[43;1H[1m~[m[44;2H[K[44;1H[1m~
~[m
[1m[7m[No Name][35;1H[23;1Htest37.in                                                                                                                      [m[46;1H[7m[No Name]                                                                                                                      [12;1H[m[47;1H[K[47;1H:[12;1H[47;1H[K[47;1H:resize 8[1;1H:" ***** done with tests *****
:w! test.out    [9C" Write contents of this file
:qa![3;5H[K[4;1HENDTEST[4;9H[K[5;1H[K[6;1H[K[7;1Hstart of window 1[7;18H[K[8;1H. line 01 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01
[1m[7mtest37.in                                                                                                                      [m[23;1H. line 09 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 09[23;50H[K[24;1H. line 10 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 10
. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11
. line 12 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 12
. line 13 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 13
. line 14 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 14[29;8H15[38C15
end of window 1[30;16H[K[31;1H[K[32;1H[K[33;1Hstart of window 2[33;18H[K[5;1H[47;1H[K[47;1H/^start of window 1$/[47;21H[K[47;1H[1;8r[8;1H
[1;47r[8;1H. line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[47;1H[K[6;1H[1;8r[1;1H[3M[1;47r[6;1H. line 03 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 03
. line 04 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 04
. line 05 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05[3;1H[47;1H:[3;1H[47;1H[K[47;1H:set scrollbind[3;1H[9;1H[7mtest37.in                                                                                                                      [m[34;1H[1m[7mtest37.in                                                                                                                      [12;1H[m[47;1H[K[47;1H:[12;1H[47;1H[K[47;1H:resize 7[10;2Hw! test.out[13C" Write contents of this file
:qa![11;5H[K[12;1HENDTEST[14;1H[K[15;1Hstart of window 1[15;18H[K[16;9H1[39C1
[1m[7mtest37.in                                                                                                                      [m[18;1H[K[19;3H[K[19;1H[1m~[m[20;3H[K[20;1H[1m~[m[21;3H[K[21;1H[1m~[m[22;3H[K[22;1H[1m~[m[23;3H[K[23;1H[1m~[m[24;3H[K[24;1H[1m~[m[25;3H[K[25;1H[1m~[m[26;3H[K[26;1H[1m~[m[27;3H[K[27;1H[1m~[m[28;3H[K[28;1H[1m~[m[29;3H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~
~
~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~
~[13;1H[m[47;1H[K[47;1H/^start of window 2$/[47;21H[K[47;1H[10;1Hend of window 1[10;26H[K[11;1H[K[12;1H[K[13;1Hstart of window 2
. line 01 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 01
. line 02 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 02[16;9H3 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 03[13;1H[10;16r[16;1H
[1;47r[16;1H. line 04 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 04[47;1H[K[12;1H[47;1H:[12;1H[47;1H[K[47;1H:set scrollbind[12;1H[47;1H[K[47;1H:" -- start of tests --[12;1H[47;1H[K[47;1H:" TEST scrolling down[12;1H

[1;8r[1;1H[5M[1;47r[4;1H. line 06 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06
. line 07 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 07
. line 08 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 08
. line 09 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 09
. line 10 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 10[10;16r[10;1H[5M[1;47r[12;1H. line 05 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 05
. line 06 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 06
. line 07 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 07
. line 08 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 08
. line 09 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 09[47;1H[K[14;1H[12;1H[17;1H[7mtest37.in                                                                                                                      [m[46;1H[1m[7m[No Name]                                                                                                                      [18;1H[m
. line 05 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 05[46;11H[1m[7m[+][19;1H[m0[9;1H[1m[7mtest37.in                                                                                                                      [m[46;1H[7m[No Name] [+]                                                                                                                  [3;1H[9;1Htest37.in                                                                                                                      [m[46;1H[1m[7m[No Name] [+]                                                                                                                  [19;1H[m
. line 05 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 051[9;1H[1m[7mtest37.in                                                                                                                      [m[46;1H[7m[No Name] [+]                                                                                                                  [3;1H


[1;8r[m[1;1H[6M[1;47r[3;1H. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11
. line 12 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 12
. line 13 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 13
. line 14 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 14
. line 15 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 15
end of window 1[10;16r[10;1H[6M[1;47r[11;1H. line 10 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 10
. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11
. line 12 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 12
. line 13 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 13
. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14
. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15[6;1H[3;1H[9;1H[7mtest37.in                                                                                                                      [m[46;1H[1m[7m[No Name] [+]                                                                                                                  [20;1H[m
. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 112[17;1H[1m[7mtest37.in                                                                                                                      [m[46;1H[7m[No Name] [+]                                                                                                                  [12;1H[17;1Htest37.in                                                                                                                      [m[46;1H[1m[7m[No Name] [+]                                                                                                                  [21;1H[m
. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 113[47;1H:[22;1H[47;1H[K[47;1H:" TEST scrolling up[22;1H[9;1H[1m[7mtest37.in                                                                                                                      [m[46;1H[7m[No Name] [+]                                                                                                                  [3;1H[1;8r[m[1;1H[5L[1;47r[1;1H. line 04 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 04
. line 05 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05
. line 06 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06
. line 07 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 07
. line 08 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 08[10;9H4[39C4[11;8H05[38C05[12;8H06[38C06[13;8H07[38C07[14;8H08[38C08[15;8H09[38C09[16;9H0[39C0[47;1H[K[4;1H[9;1H[7mtest37.in                                                                                                                      [m[17;1H[1m[7mtest37.in                                                                                                                      [14;1H[12;1H[9;1Htest37.in                                                                                                                      [m[17;1H[7mtest37.in                                                                                                                      [4;1H[3;1H[9;1Htest37.in                                                                                                                      [m[46;1H[1m[7m[No Name] [+]                                                                                                                  [22;1H[m
. line 06 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 064[17;1H[1m[7mtest37.in                                                                                                                      [m[46;1H[7m[No Name] [+]                                                                                                                  [12;1H[17;1Htest37.in                                                                                                                      [m[46;1H[1m[7m[No Name] [+]                                                                                                                  [23;1H[m
. line 06 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 065[17;1H[1m[7mtest37.in                                                                                                                      [m[46;1H[7m[No Name] [+]                                                                                                                  [12;1H[1;8r[m[1;1H[4L[1;47r[1;1Hstart of window 1
. line 01 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01
. line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02
. line 03 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 03[10;16r[10;1H[4L[1;47r[10;1Hstart of window 2
. line 01 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 01
. line 02 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 02
. line 03 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 03[9;1H[1m[7mtest37.in                                                                                                                      [m[17;1H[7mtest37.in                                                                                                                      [6;1H[3;1H[9;1Htest37.in                                                                                                                      [m[17;1H[1m[7mtest37.in                                                                                                                      [13;1H[12;1H[m[17;1H[7mtest37.in                                                                                                                      [m[46;1H[1m[7m[No Name] [+]                                                                                                                  [24;1H[m
. line 02 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 026[9;1H[1m[7mtest37.in                                                                                                                      [m[46;1H[7m[No Name] [+]                                                                                                                  [3;1H[9;1Htest37.in                                                                                                                      [m[46;1H[1m[7m[No Name] [+]                                                                                                                  [25;1H[m
. line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 027[47;1H:[26;1H[47;1H[K[47;1H:" TEST horizontal scrolling[26;1H[47;1H[K[47;1H:set scrollopt+=hor[26;1H[18;1H[26;1H[27;1H[K[27;1H[9;1H[1m[7mtest37.in                                                                                                                      [m[46;1H[7m[No Name] [+]                                                                                                                  [3;1H[m[1;1H 1[1;3H[K[2;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01[2;35H[K[3;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[3;35H[K[4;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 03[4;35H[K[5;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 04[5;35H[K[6;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05[6;35H[K[7;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06[7;35H[K[8;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 07[8;35H[K[10;1H 2[10;3H[K[11;1HUTSRQPONMLKJIHGREDCBA9876543210 01[11;35H[K[12;1HUTSRQPONMLKJIHGREDCBA9876543210 02[12;35H[K[13;1HUTSRQPONMLKJIHGREDCBA9876543210 03[13;35H[K[14;1HUTSRQPONMLKJIHGREDCBA9876543210 04[14;35H[K[15;1HUTSRQPONMLKJIHGREDCBA9876543210 05[15;35H[K[16;1HUTSRQPONMLKJIHGREDCBA9876543210 06[16;35H[K[3;1H[9;1H[7mtest37.in                                                                                                                      [m[46;1H[1m[7m[No Name] [+]                                                                                                                  [27;1H[m56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[28;1H[K[28;1H[17;1H[1m[7mtest37.in                                                                                                                      [m[46;1H[7m[No Name] [+]                                                                                                                  [12;1H[17;1Htest37.in                                                                                                                      [m[46;1H[1m[7m[No Name] [+]                                                                                                                  [28;1H[mUTSRQPONMLKJIHGREDCBA9876543210 02[29;1H[K[29;1H[47;1H[K[47;1H:[29;1H[17;1H[1m[7mtest37.in                                                                                                                      [m[46;1H[7m[No Name] [+]                                                                                                                  [12;1H[m[1;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 09[2;33H10[3;33H11[4;33H12[5;33H13[6;33H14[7;33H15[8;1H[K[10;1HUTSRQPONMLKJIHGREDCBA9876543210 09[11;33H10[12;33H11[13;33H12[14;33H13[15;33H14[16;33H15[13;1H[1;1H. line 09 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 09
. line 10 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 10
. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11
. line 12 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 12
. line 13 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 13
. line 14 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 14
. line 15 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 15
end of window 1

. line 09 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 09
. line 10 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 10
. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11
. line 12 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 12
. line 13 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 13
. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14
. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15[12;1H[17;1H[7mtest37.in                                                                                                                      [m[46;1H[1m[7m[No Name] [+]                                                                                                                  [29;1H[m. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11[30;1H[K[30;1H[9;1H[1m[7mtest37.in                                                                                                                      [m[46;1H[7m[No Name] [+]                                                                                                                  [3;16H[9;1Htest37.in                                                                                                                      [m[46;1H[1m[7m[No Name] [+]                                                                                                                  [30;1H[m. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11[31;1H[K[31;1H[47;1H[K[47;1H:[31;1H[47;1H[K[47;1H:set scrollopt-=hor[31;1H[47;1H[K[47;1H:" ****** tests using two different buffers *****[31;1H[9;1H[1m[7mtest37.in                                                                                                                      [m[46;1H[7m[No Name] [+]                                                                                                                  [3;1H[9;1Htest37.in                                                                                                                      [m[17;1H[1m[7mtest37.in                                                                                                                      [12;1H[m[47;1H[K[47;1H:[12;1H[47;1H[K[47;1H:close[9;1H[K[10;1H[K[11;1Hstart of window 2[11;18H[K[12;8H0[39C0[13;8H0[39C0[14;8H0[39C0[15;8H0[39C0[16;8H0[39C0[3;1H[47;1H[K[47;1H:[3;1H[47;1H[K[47;1H:set noscrollbind[3;1H[47;1H[K[47;1H:/^start of window 2$/,/^end of window 2$/y18 lines yanked[47;16H[K[3;1H[47;1H[K[47;1H:new[8;1H[7mtest37.in                                                                                                                      [m[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;3H[K[12;1H[1m~[m[13;3H[K[13;1H[1m~[m[14;3H[K[14;1H[1m~[m[15;3H[K[15;1H[1m~[m[16;3H[K[16;1H[1m~[m
[1m[7m[No Name][9;1H[8;1Htest37.in                                                                                                                      [m[17;1H[7m[No Name]                                                                                                                      [3;1H[8;1Htest37.in                                                                                                                      [m[17;1H[1m[7m[No Name]                                                                                                                      [9;1H[m[47;1H4 more lines[10;1H[K[11;1H[K[12;1H[K[13;1H[K[17;11H[1m[7m[+][10;1H


[m[47;1H18 more lines[14;1Hstart of window 2
. line 01 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 01
. line 02 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 02[14;1H[47;1H[K[47;1H:[14;1H[8;1H[1m[7mtest37.in                                                                                                                      [m[17;1H[7m[No Name] [+]                                                                                                                  [3;1H[m[47;1H[K[47;1H/^start of window 1$/[47;21H[K[47;1H[7msearch hit BOTTOM, continuing at TOP[m[1;1HENDTEST[1;8H[K[2;1H[K[3;1H[K[4;1Hstart of window 1[4;18H[K[5;8H01[38C01[6;8H02[38C02[7;8H03[38C03[4;1H[1;7r[7;1H
[1;47r[7;1H. line 04 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 04[47;1H[K[3;1H[47;1H:[3;1H[47;1H[K[47;1H:set scrollbind[3;1H[8;1H[7mtest37.in                                                                                                                      [m[17;1H[1m[7m[No Name] [+]                                                                                                                  [14;1H[m[47;1H[K[47;1H:[14;1H[47;1H[K[47;1H/^start of window 2$/[47;21H[K[47;1H[7msearch hit BOTTOM, continuing at TOP[14;1H[9;16r[m[9;1H[3M[1;47r[14;1H. line 03 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 03
. line 04 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 04
. line 05 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 05[47;1H[K[11;1H[47;1H:[11;1H[47;1H[K[47;1H:set scrollbind[11;1H[47;1H[K[47;1H:" -- start of tests --[11;1H[47;1H[K[47;1H:" TEST scrolling down[11;1H


[1;7r[1;1H[5M[1;47r[3;1H. line 05 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05
. line 06 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06
. line 07 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 07
. line 08 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 08
. line 09 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 09[9;16r[9;1H[5M[1;47r[12;1H. line 06 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 06
. line 07 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 07
. line 08 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 08
. line 09 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 09
. line 10 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 10[47;1H[K[14;1H[11;1H[17;1H[7m[No Name] [+]                                                                                                                  [m[46;1H[1m[7m[No Name] [+]                                                                                                                  [31;1H[m
. line 05 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 050[8;1H[1m[7mtest37.in                                                                                                                      [m[46;1H[7m[No Name] [+]                                                                                                                  [3;1H[8;1Htest37.in                                                                                                                      [m[46;1H[1m[7m[No Name] [+]                                                                                                                  [32;1H[m
. line 05 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 051[8;1H[1m[7mtest37.in                                                                                                                      [m[46;1H[7m[No Name] [+]                                                                                                                  [3;1H

[1;7r[m[1;1H[6M[1;47r[2;1H. line 10 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 10
. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11
. line 12 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 12
. line 13 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 13
. line 14 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 14
. line 15 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 15[9;16r[9;1H[6M[1;47r[11;1H. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11
. line 12 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 12
. line 13 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 13
. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14
. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15
. line 16 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 16[5;1H[3;1H[8;1H[7mtest37.in                                                                                                                      [m[46;1H[1m[7m[No Name] [+]                                                                                                                  [33;1H[m
. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 112[17;1H[1m[7m[No Name] [+]                                                                                                                  [m[46;1H[7m[No Name] [+]                                                                                                                  [11;1H[17;1H[No Name] [+]                                                                                                                  [m[46;1H[1m[7m[No Name] [+]                                                                                                                  [34;1H[m
. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 113[47;1H:[35;1H[47;1H[K[47;1H:" TEST scrolling up[35;1H[8;1H[1m[7mtest37.in                                                                                                                      [m[46;1H[7m[No Name] [+]                                                                                                                  [3;1H[m[1;9H4[39C4[2;8H05[38C05[3;8H06[38C06[4;8H07[38C07[5;8H08[38C08[6;8H09[38C09[7;9H0[39C0[9;16r[9;1H[5L[1;47r[9;1H. line 04 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 04
. line 05 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 05
. line 06 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 06
. line 07 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 07
. line 08 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 08[47;1H[K[4;1H[8;1H[7mtest37.in                                                                                                                      [m[17;1H[1m[7m[No Name] [+]                                                                                                                  [14;1H[11;1H[8;1Htest37.in                                                                                                                      [m[17;1H[7m[No Name] [+]                                                                                                                  [4;1H[3;1H[8;1Htest37.in                                                                                                                      [m[46;1H[1m[7m[No Name] [+]                                                                                                                  [35;1H[m
. line 06 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 064[17;1H[1m[7m[No Name] [+]                                                                                                                  [m[46;1H[7m[No Name] [+]                                                                                                                  [11;1H[17;1H[No Name] [+]                                                                                                                  [m[46;1H[1m[7m[No Name] [+]                                                                                                                  [36;1H[m
. line 06 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 065[17;1H[1m[7m[No Name] [+]                                                                                                                  [m[46;1H[7m[No Name] [+]                                                                                                                  [11;1H[1;7r[m[1;1H[4L[1;47r[1;1Hstart of window 1
. line 01 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01
. line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02
. line 03 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 03[9;16r[9;1H[4L[1;47r[9;1Hstart of window 2
. line 01 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 01
. line 02 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 02
. line 03 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 03[8;1H[1m[7mtest37.in                                                                                                                      [m[17;1H[7m[No Name] [+]                                                                                                                  [5;1H[3;1H[8;1Htest37.in                                                                                                                      [m[17;1H[1m[7m[No Name] [+]                                                                                                                  [12;1H[11;1H[m[17;1H[7m[No Name] [+]                                                                                                                  [m[46;1H[1m[7m[No Name] [+]                                                                                                                  [37;1H[m
. line 02 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 026[8;1H[1m[7mtest37.in                                                                                                                      [m[46;1H[7m[No Name] [+]                                                                                                                  [3;1H[8;1Htest37.in                                                                                                                      [m[46;1H[1m[7m[No Name] [+]                                                                                                                  [38;1H[m
. line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 027[47;1H:[39;1H[47;1H[K[47;1H:" TEST horizontal scrolling[39;1H[47;1H[K[47;1H:set scrollopt+=hor[39;1H[18;1H[39;1H[40;1H[K[40;1H[8;1H[1m[7mtest37.in                                                                                                                      [m[46;1H[7m[No Name] [+]                                                                                                                  [3;1H[m[1;1H 1[1;3H[K[2;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01[2;35H[K[3;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[3;35H[K[4;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 03[4;35H[K[5;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 04[5;35H[K[6;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05[6;35H[K[7;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06[7;35H[K[9;1H 2[9;3H[K[10;1HUTSRQPONMLKJIHGREDCBA9876543210 01[10;35H[K[11;1HUTSRQPONMLKJIHGREDCBA9876543210 02[11;35H[K[12;1HUTSRQPONMLKJIHGREDCBA9876543210 03[12;35H[K[13;1HUTSRQPONMLKJIHGREDCBA9876543210 04[13;35H[K[14;1HUTSRQPONMLKJIHGREDCBA9876543210 05[14;35H[K[15;1HUTSRQPONMLKJIHGREDCBA9876543210 06[15;35H[K[16;1HUTSRQPONMLKJIHGREDCBA9876543210 07[16;35H[K[3;1H[8;1H[7mtest37.in                                                                                                                      [m[46;1H[1m[7m[No Name] [+]                                                                                                                  [40;1H[m56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[41;1H[K[41;1H[17;1H[1m[7m[No Name] [+]                                                                                                                  [m[46;1H[7m[No Name] [+]                                                                                                                  [11;1H[17;1H[No Name] [+]                                                                                                                  [m[46;1H[1m[7m[No Name] [+]                                                                                                                  [41;1H[mUTSRQPONMLKJIHGREDCBA9876543210 02[42;1H[K[42;1H[47;1H[K[47;1H:[42;1H[17;1H[1m[7m[No Name] [+]                                                                                                                  [m[46;1H[7m[No Name] [+]                                                                                                                  [11;1H[m[1;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 09[2;33H10[3;33H11[4;33H12[5;33H13[6;33H14[7;33H15

UTSRQPONMLKJIHGREDCBA9876543210 09[10;33H10[11;33H11[12;33H12[13;33H13[14;33H14[15;33H15[16;33H16[12;1H[1;1H. line 09 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 09
. line 10 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 10
. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11
. line 12 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 12
. line 13 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 13
. line 14 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 14
. line 15 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 15

. line 09 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 09
. line 10 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 10
. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11
. line 12 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 12
. line 13 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 13
. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14
. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15
. line 16 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 16[11;1H[17;1H[7m[No Name] [+]                                                                                                                  [m[46;1H[1m[7m[No Name] [+]                                                                                                                  [42;1H[m. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11[43;1H[K[43;1H[8;1H[1m[7mtest37.in                                                                                                                      [m[46;1H[7m[No Name] [+]                                                                                                                  [3;16H[8;1Htest37.in                                                                                                                      [m[46;1H[1m[7m[No Name] [+]                                                                                                                  [43;1H[m. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11[44;1H[K[44;1H[47;1H[K[47;1H:[44;1H[47;1H[K[47;1H:set scrollopt-=hor[44;1H[47;1H[K[47;1H:" TEST syncbind[44;1H[8;1H[1m[7mtest37.in                                                                                                                      [m[46;1H[7m[No Name] [+]                                                                                                                  [3;1H[m[47;1H[K[47;1H:set noscb[3;1H[1;1HTest for 'scrollbind'. <eralston@computer.org>   Do not add a line below!
STARTTEST[2;11H[K[3;1H:so small.vim[3;14H[K[4;1H:set noscrollbind[4;18H[K[5;1H:set scrollopt=ver,jump[5;24H[K[6;1H:set scrolloff=2[6;17H[K[7;1H:set nowrap[7;12H[K[1;1H[5;1H


[7mtest37.in                                                                                                                      [m[17;1H[1m[7m[No Name] [+]                                                                                                                  [11;1H[m[47;1H[K[47;1H:set noscb[11;1H[9;1H[K[10;1H[K[11;1H[K[12;1H[K[13;1H[K[14;1Hstart of window 2[14;18H[K[15;8H01[38C01[16;8H02[38C02[9;1H[14;1H[47;1H[K[47;1H:set scb[14;1H[8;1H[1m[7mtest37.in                                                                                                                      [m[17;1H[7m[No Name] [+]                                                                                                                  [5;1H[m[47;1H[K[47;1H:set scb[5;1H[1;1H. line 13 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 13[1;50H[K[2;1H. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14
. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15
. line 16 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 16
end of window 2[5;16H[K[6;1H[K[7;1Hend of test37.in (please don't delete this line)

end of window 2
[1m~
~
~
~[m[14;2H[K[14;1H[1m~[m[15;3H[K[15;1H[1m~[m[16;3H[K[16;1H[1m~[7;1H[m[1;1Hzt:[1;4H[K[2;1H:set scrollbind[2;16H[K[3;1H:" -- start of tests --[3;24H[K[4;1H:" TEST scrolling down[4;23H[K[5;1HL5jHyy[1m^W[mbpr0[1m^W[mtHyy[1m^W[mbpr1[1m^W[mtL6jHyy[1m^W[mbpr2[1m^W[mkHyy[1m^W[mbpr3:
:" TEST scrolling up
[1m^W[mtH4k[1m^W[mjH[1m^W[mtHyy[1m^W[mbpr4[1m^W[mkHyy[1m^W[mbpr5[1m^W[mk3k[1m^W[mtH[1m^W[mjHyy[1m^W[mbpr6[1m^W[mtHyy[1m^W[mbpr7:
[7mtest37.in                                                                                                                      [9;16r[m[9;1H[2L[1;47r[9;1H. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15
. line 16 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 16[17;1H[1m[7m[No Name] [+]                                                                                                                  [m[47;1H[K[11;1H[47;1H:syncbind[11;1H[1;7r[1;1H[L[1;47r[1;1H/^start of window 2$/[9;16r[9;1H[L[1;47r[9;1H. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14[47;1H[K[11;1H[8;1H[1m[7mtest37.in                                                                                                                      [m[17;1H[7m[No Name] [+]                                                                                                                  [5;1H[3;1H[8;1Htest37.in                                                                                                                      [m[17;1H[1m[7m[No Name] [+]                                                                                                                  [11;1H[m[17;1H[7m[No Name] [+]                                                                                                                  [m[46;1H[1m[7m[No Name] [+]                                                                                                                  [44;1H[m
. line 16 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 16[8;1H[1m[7mtest37.in                                                                                                                      [m[46;1H[7m[No Name] [+]                                                                                                                  [3;1H[8;1Htest37.in                                                                                                                      [m[46;1H[1m[7m[No Name] [+]                                                                                                                  [45;1H[18;45r[m[45;1H
[1;47r[45;1H:set scrollbind

:[45;1H[8;1H[1m[7mtest37.in                                                                                                                      [m[46;1H[7m[No Name] [+]                                                                                                                  [3;1H[m[47;1H[K[47;1H:set noscb[3;1H[1;1HTest for 'scrollbind'. <eralston@computer.org>   Do not add a line below!
STARTTEST
:so small.vim[3;14H[K[4;2Hset noscrollbind[4;18H[K[5;2Hset scrollopt=ver,jump
:set scrolloff=2[6;17H[K[7;2Hset nowrap[7;12H[K[1;1H[5;1H


[7mtest37.in                                                                                                                      [m[17;1H[1m[7m[No Name] [+]                                                                                                                  [11;1H[m[47;1H[K[47;1H:set noscb[11;1H[9;1H[K[10;1H[K[11;1H[K[12;1H[K[13;1H[K[14;1Hstart of window 2
. line 01 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 01
. line 02 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 02[9;1H[14;1H[47;1H[K[47;1H:set scb[14;1H[8;1H[1m[7mtest37.in                                                                                                                      [m[17;1H[7m[No Name] [+]                                                                                                                  [5;1H[m[47;1H[K[47;1H:set scb[5;1H[1;1H. line 13 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 13[1;50H[K[2;1H. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14
. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15
. line 16 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 16
end of window 2[5;16H[K[6;1H[K[7;1Hend of test37.in (please don't delete this line)

end of window 2
[1m~
~
~
~[m[14;2H[K[14;1H[1m~[m[15;3H[K[15;1H[1m~[m[16;3H[K[16;1H[1m~[7;1H[m[1;1Hzt:[1;4H[K[2;1H:set scrollbind[2;16H[K[3;1H:" -- start of tests --[3;24H[K[4;1H:" TEST scrolling down[4;23H[K[5;1HL5jHyy[1m^W[mbpr0[1m^W[mtHyy[1m^W[mbpr1[1m^W[mtL6jHyy[1m^W[mbpr2[1m^W[mkHyy[1m^W[mbpr3:
:" TEST scrolling up
[1m^W[mtH4k[1m^W[mjH[1m^W[mtHyy[1m^W[mbpr4[1m^W[mkHyy[1m^W[mbpr5[1m^W[mk3k[1m^W[mtH[1m^W[mjHyy[1m^W[mbpr6[1m^W[mtHyy[1m^W[mbpr7:
[7mtest37.in                                                                                                                      [9;16r[m[9;1H[2L[1;47r[9;1H. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15
. line 16 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 16[17;1H[1m[7m[No Name] [+]                                                                                                                  [m[47;1H[K[11;1H[8;1H[1m[7mtest37.in                                                                                                                      [m[17;1H[7m[No Name] [+]                                                                                                                  [5;1H[47;1H[m:syncbind[5;1H[3;1H[1;7r[1;1H[L[1;47r[1;1H/^start of window 2$/[9;16r[9;1H[2L[1;47r[9;1H. line 13 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 13
. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14[47;1H[K[3;1H[1;7r[1;1H[L[1;47r[1;1H:resize 7[8;1H[7mtest37.in                                                                                                                      [m[17;1H[1m[7m[No Name] [+]                                                                                                                  [12;1H[11;1H[8;1Htest37.in                                                                                                                      [m[17;1H[7m[No Name] [+]                                                                                                                  [4;1H[3;1H[8;1Htest37.in                                                                                                                      [m[46;1H[1m[7m[No Name] [+]                                                                                                                  [45;1H[18;45r[m[45;1H
[1;47r[45;1Hzt:[8;1H[1m[7mtest37.in                                                                                                                      [m[46;1H[7m[No Name] [+]                                                                                                                  [3;1H[8;1Htest37.in                                                                                                                      [m[17;1H[1m[7m[No Name] [+]                                                                                                                  [11;1H[m[17;1H[7m[No Name] [+]                                                                                                                  [m[46;1H[1m[7m[No Name] [+]                                                                                                                  [45;1H[18;45r[m[45;1H
[1;47r[45;1H. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15

:[45;1H[8;1H[1m[7mtest37.in                                                                                                                      [m[46;1H[7m[No Name] [+]                                                                                                                  [3;1H[1;7r[m[1;1H[4L[1;47r[1;1H/^start of window 1$/
zt:
:set scrollbind
[1m^W[mj:[9;16r[9;1H[4L[1;47r[9;1H. line 09 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 09
. line 10 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 10
. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11
. line 12 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 12[47;1H[K[4;1H[8;1H[7mtest37.in                                                                                                                      [m[17;1H[1m[7m[No Name] [+]                                                                                                                  [14;1H[11;1H[8;1Htest37.in                                                                                                                      [m[17;1H[7m[No Name] [+]                                                                                                                  [4;1H[3;1H[8;1Htest37.in                                                                                                                      [m[46;1H[1m[7m[No Name] [+]                                                                                                                  [45;1H[18;45r[m[45;1H
[1;47r[45;1H:set scrollbind[8;1H[1m[7mtest37.in                                                                                                                      [m[46;1H[7m[No Name] [+]                                                                                                                  [3;1H[8;1Htest37.in                                                                                                                      [m[17;1H[1m[7m[No Name] [+]                                                                                                                  [11;1H[m[17;1H[7m[No Name] [+]                                                                                                                  [m[46;1H[1m[7m[No Name] [+]                                                                                                                  [45;1H[18;45r[m[45;1H
[1;47r[45;1H. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11

:[45;1H[47;1H[K[47;1H:" ***** done with tests *****[45;1H[47;1H[K[47;1H:w! test.out             " Write contents of this file"test.out" [47;12H[K[47;12H[New File] 33 lines, 1329 characters written[46;1H[1m[7mtest.out      [45;1H[m[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test38.failed test.ok test.out X* viminfo
cp test38.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test38.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test38.in" 33 lines, 364 characters[2;1HTest Virtual replace mode.

STARTTEST
:so small.vim
ggdGa
abcdefghi
jk      lmn
    opq rst
[1m^D[muvwxyz
[1m^[[mgg:set ai
:set bs=2
gR0[1m^D[m 1
A
BCDEFGHIJ[16;9HKL
MNO
PQR[1m^[[mG:ka
o0[1m^D[m
abcdefghi
jk      lmn
    opq rst
[1m^D[muvwxyz
[1m^[[m'ajgR0[1m^D[m 1
A
BCDEFGHIJ[27;9HKL
MNO
PQR[1m^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^[[m:$
iab     cdefghi jkl[1m^[[m0gRAB......CDEFGHI.J[1m^[[mo[1m^[[m:
iabcdefghijklmnopqrst[1m^[[m0gRAB    IJKLMNO QR[1m^[[m:wq! test.out
ENDTEST

[1m~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[4;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[5;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 27 lines, 316 characters written[5;1H[47;1H[K[47;1H:set ff& cpo+=A[5;1H[47;1H/ENDTEST[47;10H[K[47;1H[32;1H
[47;1H[K[47;1H:so! Xdotest[33;1H[47;1H[K[47;1H:so small.vim[33;1H[1;1H[2;2H[K[2;1H[1m~
~[m[4;2H[K[4;1H[1m~[m[5;2H[K[5;1H[1m~[m[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;5H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~
~[m[15;2H[K[15;1H[1m~[m[16;9H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;5H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~
~[m[26;2H[K[26;1H[1m~[m[27;9H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~
~[m[47;1H--No lines in buffer--[1;1H
abcdefghi
jk      lmn
    opq rst
uvwxyz[6;1H[K[6;1H[1;1H[47;1H[K[47;1H:set ai[1;1H[47;1H[K[47;1H:set bs=2[1;1H 1
 A[2;3H[K[3;1H BCDEFGHIJ[3;11H[K[4;5H    KL[4;11H[K[5;1H        MNO[6;9HPQR[47;1H[K[47;1H:ka[6;9H[7;1H[K[8;1Habcdefghi
jk      lmn
    opq rst
uvwxyz[12;1H[K[12;1H[6;9H
 1[47;1H[K[47;1H:$[12;1Hab      cdefghi jklAB......CDEFGHI.J[13;1H[K[13;1H[47;1H[K[47;1H:[13;1HabcdefghijklmnopqrstAB      IJKLMNO QR[47;1H[K[47;1H:wq! test.out"test.out" [47;12H[K[47;12H[New File] 13 lines, 107 characters written[?1l>
rm -rf X* test.ok viminfo
rm -rf test39.failed test.ok test.out X* viminfo
cp test39.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test39.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test39.in" 24 lines, 364 characters[2;1HTest Visual block mode commands

STARTTEST
:so small.vim
/^abcde
:" Test shift-right of a block
jllll[1m^V[mjj>wll[1m^V[mjlll>
:" Test shift-left of a block
G$hhhh[1m^V[mkk<
:" Test block-insert
Gkl[1m^V[mkkkIxyz[1m^[[m
:" Test block-replace
Gllll[1m^V[mkkklllrq
:" Test block-change
G$khhh[1m^V[mhhkkcmno[1m^[[m
:$-4,$wq! test.out
ENDTEST

abcdefghijklm
abcdefghijklm
abcdefghijklm
abcdefghijklm
abcdefghijklm
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[4;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[5;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 13 lines, 241 characters written[5;1H[47;1H[K[47;1H:set ff& cpo+=A[5;1H[47;1H/ENDTEST[47;10H[K[47;1H[18;1H
[47;1H[K[47;1H:so! Xdotest[19;1H[47;1H[K[47;1H:so small.vim[19;1H[47;1H[K[47;1H/^abcde[20;1H[47;1H[K[47;1H:" Test shift-right of a block[20;1H
abcd[7me
[mabcd[7me
[mabcd[47;1H3 lines >ed 1 time[47;19H[K[21;5H        efghijklm
abcd        efghijklm
abcd        efghijklm[21;8H     ef[7mg[22;15H[21;16Hh[22;15Hg[21;17Hi[22;16Hh[21;18Hj[22;17Hi[m[21;15H        ghijklm[22;15H        ghijklm[21;16H[22;16H[47;1H[K[47;1H:" Test shift-left of a block[22;16H

[12C[7mi[23;9H [22;9H[m[47;1H3 lines <ed 1 time[47;20H[K[22;9Hef    [23;9Hefghijklm[23;18H[K[24;9Hi[22;9H[23;9H[47;1H[K[47;1H:" Test block-insert[23;9H
[23;1Ha[7mb[22;2Hb[21;2Hb[20;2H[mxyzbcdefghijklm
axyzbcd
axyzbcd
axyzbcd[20;2H
a[47;1H[K[47;1H:" Test block-replace[21;2H


abcd[7me[23;5Hb[22;5Hb[21;5Hb[22;6Hc[23;6Hc[24;6Hf[21;6Hc[22;7Hd[23;7Hd[24;7Hg[21;7Hd[22;8H [23;8H [24;8Hh[21;8H[mqqqq
axyzqqqq
axyzqqqq
abcdqqqq[21;5H
axyz[47;1H[K[47;1H:" Test block-change[22;5H

[12C[23;17H[7mji[22;12H     [23;11Hghijkl[22;11H[21;13Hef[m[22;15H  [23;11Hg[3Ckl[21;12Hmno[22;12Hmno[23;12Hmno[21;14H[22;14H[47;1H[K[47;1H:$-4,$wq! test.out"test.out" [47;12H[K[47;12H[New File] 5 lines, 108 characters written[?1l>
rm -rf X* test.ok viminfo
rm -rf test40.failed test.ok test.out X* viminfo
cp test40.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test40.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test40.in" 63 lines, 1521 characters[1;1HTest for "*Cmd" autocommands

STARTTEST
:so small.vim
:/^start/,$w! Xxx[15C" write lines below to Xxx
:au BufReadCmd testA 0r Xxx|$del
:e testA[24C" will read text of Xxd instead
:au BufWriteCmd testA call append(line("$"), "write")
:w[30C" will append a line to the file
:r testA[24C" should not read anything
:[31C" now we have:
:[31C" 1     start of Xxx
:[31C" 2[13Ctest40
:[31C" 3     end of Xxx
:[31C" 4     write
:au FileReadCmd testB '[r Xxx
:2r testB[23C" will read Xxx below line 2 instead
:[31C" 1     start of Xxx
:[31C" 2[13Ctest40
:[31C" 3     start of Xxx
:[31C" 4[13Ctest40
:[31C" 5     end of Xxx
:[31C" 6     end of Xxx
:[31C" 7     write
:au FileWriteCmd testC '[,']copy $
4GA1[1m^[[m
:4,5w testC[21C" will copy lines 4 and 5 to the end
:r testC[24C" should not read anything
:[31C" 1     start of Xxx
:[31C" 2[13Ctest40
:[31C" 3     start of Xxx
:[31C" 4[13Ctest401
:[31C" 5     end of Xxx
:[31C" 6     end of Xxx
:[31C" 7     write
:[31C" 8[13Ctest401
:[31C" 9     end of Xxx
:au FILEAppendCmd testD '[,']w! test.out
:w >>testD[22C" will write all lines to test.out
:$r testD[23C" should not read anything
:$w >>test.out[18C" append "end of Xxx" to test.out
:au BufReadCmd testE 0r test.out|$del
:sp testE[23C" split window with test.out
5Goasdf[1m^[^W^W[m:"
:au BufWriteCmd testE w! test.out
:wall[27C" will write other window to test.out[1;1H[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 55 lines, 1440 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[1;46r[1;1H[13M[1;47r[34;1H:[31C" 1     start of Xxx
:[31C" 2[13Ctest40
:[31C" 3     start of Xxx
:[31C" 4[13Ctest401
:[31C" 5     end of Xxx
:[31C" 6     asdf
:[31C" 7     end of Xxx
:[31C" 8     write
:[31C" 9[13Ctest401
:[31C" 10    end of Xxx
:[31C" 11    end of Xxx
:qa!
ENDTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H
:so! Xdotest[46;1H[47;1H[K[47;1H:so small.vim[46;1H[47;1H[K[47;1H:/^start/,$w! Xxx[1m^I^I[m" write lines below to Xxx"Xxx" [47;7H[K[47;7H[New File] 3 lines, 32 characters written[46;1H[47;1H[K[47;1H:au BufReadCmd testA 0r Xxx|$del[46;1H[47;1H[K[47;1H:e testA[1m^I^I^I[m" will read text of Xxd instead"Xxx" [47;7H[K[47;7H3 lines, 32 characters[1;1Hstart of Xxx[1;33H[K[2;1H        test40[2;15H[K[3;1Hend of Xxx[3;33H[K[4;33H[K[4;1H[1m~[m[5;33H[K[5;1H[1m~[m[6;33H[K[6;1H[1m~[m[7;33H[K[7;1H[1m~[m[8;33H[K[8;1H[1m~[m[9;33H[K[9;1H[1m~[m[10;33H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;33H[K[15;1H[1m~[m[16;33H[K[16;1H[1m~[m[17;33H[K[17;1H[1m~[m[18;33H[K[18;1H[1m~[m[19;33H[K[19;1H[1m~[m[20;33H[K[20;1H[1m~[m[21;33H[K[21;1H[1m~[m[22;33H[K[22;1H[1m~[m[23;33H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~[m[33;33H[K[33;1H[1m~[m[34;33H[K[34;1H[1m~[m[35;33H[K[35;1H[1m~[m[36;33H[K[36;1H[1m~[m[37;33H[K[37;1H[1m~[m[38;33H[K[38;1H[1m~[m[39;33H[K[39;1H[1m~[m[40;33H[K[40;1H[1m~[m[41;33H[K[41;1H[1m~[m[42;33H[K[42;1H[1m~[m[43;33H[K[43;1H[1m~[m[44;2H[K[44;1H[1m~[m[45;2H[K[45;1H[1m~
~[3;1H[m[47;1H[K[47;1H:au BufWriteCmd testA call append(line("$"), "write")[3;1H[47;1H[K[47;1H:w[1m^I^I^I^I[m" will append a line to the file[4;1Hwrite[3;1H[47;1H[K[47;1H:r testA[1m^I^I^I[m" should not read anything[7mE484: Can't open file testA[m[47;28H[K[3;1H[47;1H[K[47;1H:[1m^I^I^I^I[m" now we have:[3;1H[47;1H[K[47;1H:[1m^I^I^I^I[m" 1[1m^I[mstart of Xxx[3;1H[47;1H[K[47;1H:[1m^I^I^I^I[m" 2[1m^I^I[mtest40[3;1H[47;1H[K[47;1H:[1m^I^I^I^I[m" 3[1m^I[mend of Xxx[3;1H[47;1H[K[47;1H:[1m^I^I^I^I[m" 4[1m^I[mwrite[3;1H[47;1H[K[47;1H:au FileReadCmd testB '[r Xxx[3;1H[47;1H[K[47;1H:2r testB[1m^I^I^I[m" will read Xxx below line 2 instead"Xxx" [47;7H[K[47;7H3 lines, 32 characters[3;46r[3;1H[3L[1;47r[3;1Hstart of Xxx[4;9Htest40
end of Xxx[47;1H[K[3;1H[47;1H:[1m^I^I^I^I[m" 1[1m^I[mstart of Xxx[3;1H[47;1H[K[47;1H:[1m^I^I^I^I[m" 2[1m^I^I[mtest40[3;1H[47;1H[K[47;1H:[1m^I^I^I^I[m" 3[1m^I[mstart of Xxx[3;1H[47;1H[K[47;1H:[1m^I^I^I^I[m" 4[1m^I^I[mtest40[3;1H[47;1H[K[47;1H:[1m^I^I^I^I[m" 5[1m^I[mend of Xxx[3;1H[47;1H[K[47;1H:[1m^I^I^I^I[m" 6[1m^I[mend of Xxx[3;1H[47;1H[K[47;1H:[1m^I^I^I^I[m" 7[1m^I[mwrite[3;1H[47;1H[K[47;1H:au FileWriteCmd testC '[,']copy $[3;1H[4;9Htest401[5;10H[47;1H[K[47;1H:4,5w testC[1m^I^I^I[m" will copy lines 4 and 5 to the end[8;1H        test401
end of Xxx[47;1H[K[47;1H:r testC[1m^I^I^I[m" should not read anything[7mE484: Can't open file testC[m[47;28H[K[9;1H[47;1H[K[47;1H:[1m^I^I^I^I[m" 1[1m^I[mstart of Xxx[9;1H[47;1H[K[47;1H:[1m^I^I^I^I[m" 2[1m^I^I[mtest40[9;1H[47;1H[K[47;1H:[1m^I^I^I^I[m" 3[1m^I[mstart of Xxx[9;1H[47;1H[K[47;1H:[1m^I^I^I^I[m" 4[1m^I^I[mtest401[9;1H[47;1H[K[47;1H:[1m^I^I^I^I[m" 5[1m^I[mend of Xxx[9;1H[47;1H[K[47;1H:[1m^I^I^I^I[m" 6[1m^I[mend of Xxx[9;1H[47;1H[K[47;1H:[1m^I^I^I^I[m" 7[1m^I[mwrite[9;1H[47;1H[K[47;1H:[1m^I^I^I^I[m" 8[1m^I^I[mtest401[9;1H[47;1H[K[47;1H:[1m^I^I^I^I[m" 9[1m^I[mend of Xxx[9;1H[47;1H[K[47;1H:au FILEAppendCmd testD '[,']w! test.out[9;1H[47;1H[K[47;1H:w >>testD[1m^I^I^I[m" will write all lines to test.out"test.out" [47;12H[K[47;12H[New File] 9 lines, 91 characters written[9;1H[47;1H[K[47;1H:$r testD[1m^I^I^I[m" should not read anything[7mE484: Can't open file testD[m[47;29H[K[9;1H[47;1H[K[47;1H:$w >>test.out[1m^I^I^I[m" append "end of Xxx" to test.out"test.out" [47;12H[K[47;12H1 line, 11 characters appended[9;1H[47;1H[K[47;1H:au BufReadCmd testE 0r test.out|$del[9;1H[47;1H[K[47;1H:sp testE[1m^I^I^I[m" split window with test.out"test.out" [47;12H[K[47;12H10 lines, 102 characters[10;1Hend of Xxx[23;1H[1m[7mtestE                                                                                                                          [m[24;1Hstart of Xxx
        test40
start of Xxx
        test401
end of Xxx
end of Xxx
write
        test401
end of Xxx[46;1H[7mtestA                                                                                                                          [10;1H[5;1H[6;22r[m[6;1H[L[1;47r[6;1Hasdf[23;7H[1m[7m[+][m[47;1H[K[6;4H[23;1H[7mtestE [+]                                                                                                                      [m[46;1H[1m[7mtestA                                                                                                                          [32;1H[47;1H[m:"[32;1H[47;1H[K[47;1H:au BufWriteCmd testE w! test.out[32;1H[47;1H[K[47;1H:wall[1m^I^I^I^I[m" will write other window to test.out"test.out" [47;12H[K[47;12H11 lines, 107 characters written[23;7H[7m   [32;1H[m[47;1H[K[47;1H:[1m^I^I^I^I[m" 1[1m^I[mstart of Xxx[32;1H[47;1H[K[47;1H:[1m^I^I^I^I[m" 2[1m^I^I[mtest40[32;1H[47;1H[K[47;1H:[1m^I^I^I^I[m" 3[1m^I[mstart of Xxx[32;1H[47;1H[K[47;1H:[1m^I^I^I^I[m" 4[1m^I^I[mtest401[32;1H[47;1H[K[47;1H:[1m^I^I^I^I[m" 5[1m^I[mend of Xxx[32;1H[47;1H[K[47;1H:[1m^I^I^I^I[m" 6[1m^I[masdf[32;1H[47;1H[K[47;1H:[1m^I^I^I^I[m" 7[1m^I[mend of Xxx[32;1H[47;1H[K[47;1H:[1m^I^I^I^I[m" 8[1m^I[mwrite[32;1H[47;1H[K[47;1H:[1m^I^I^I^I[m" 9[1m^I^I[mtest401[32;1H[47;1H[K[47;1H:[1m^I^I^I^I[m" 10[1m^I[mend of Xxx[32;1H[47;1H[K[47;1H:[1m^I^I^I^I[m" 11[1m^I[mend of Xxx[32;1H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test41.failed test.ok test.out X* viminfo
cp test41.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test41.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test41.in" 24 lines, 421 characters[1;1HTest for writing and reading a file of over 100 Kbyte

1 line: "This is the start"
3001 lines: "This is the leader"
1 line: "This is the middle"
3001 lines: "This is the trailer"
1 line: "This is the end"

STARTTEST
:%d
aThis is the start
This is the leader
This is the middle
This is the trailer
This is the end[1m^[[mkY3000p2GY3000p
:w! Xtest
:%d
:e! Xtest
:.w! test.out
3003G:.w >>test.out
6005G:.w >>test.out
:qa!
ENDTEST

[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[9;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[10;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 13 lines, 196 characters written[10;1H[47;1H[K[47;1H:set ff& cpo+=A[10;1H[47;1H/ENDTEST[47;10H[K[47;1H[23;1H
[47;1H[K[47;1H:so! Xdotest[24;1H[47;1H[K[47;1H:%d[1;1H[K[2;1H[1m~[m[3;3H[K[3;1H[1m~[m[4;2H[K[4;1H[1m~[m[5;3H[K[5;1H[1m~[m[6;2H[K[6;1H[1m~[m[7;3H[K[7;1H[1m~
~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~
~[m[47;1H--No lines in buffer--[1;1HThis is the start
This is the leader
This is the middle
This is the trailer
This is the end[4;15H[47;1H3000 more lines[47;16H[K[5;13Htrailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer[5;1H[2;1H[3;13Hleader[4;13Hleader[4;19H[K[5;13Hleader[5;19H[K[6;13Hleader[6;19H[K[7;13Hleader[7;19H[K[8;13Hleader[8;19H[K[9;13Hleader[9;19H[K[10;13Hleader[10;19H[K[11;13Hleader[11;19H[K[12;13Hleader[12;19H[K[13;13Hleader[13;19H[K[14;13Hleader[14;19H[K[15;13Hleader[15;19H[K[16;13Hleader[16;19H[K[17;13Hleader[17;19H[K[18;13Hleader[18;19H[K[19;13Hleader[19;19H[K[20;13Hleader[20;19H[K[21;13Hleader[21;19H[K[22;13Hleader[22;19H[K[23;13Hleader[23;19H[K[24;13Hleader[24;19H[K[25;13Hleader[25;19H[K[26;13Hleader[26;19H[K[27;13Hleader[27;19H[K[28;13Hleader[28;19H[K[29;13Hleader[29;19H[K[30;13Hleader[30;19H[K[31;13Hleader[31;19H[K[32;13Hleader[32;19H[K[33;13Hleader[33;19H[K[34;13Hleader[34;19H[K[35;13Hleader[35;19H[K[36;13Hleader[36;19H[K[37;13Hleader[37;19H[K[38;13Hleader[38;19H[K[39;13Hleader[39;19H[K[40;13Hleader[40;19H[K[41;13Hleader[41;19H[K[42;13Hleader[42;19H[K[43;13Hleader[43;19H[K[44;13Hleader[44;19H[K[45;13Hleader[45;19H[K[46;13Hleader[46;19H[K[3;1H
[47;1H[K[47;1H:w! Xtest"Xtest" [47;9H[K[47;9H[New File] 6005 lines, 117092 characters written[4;1H[47;1H[K[47;1H:%d[1;1H[K[2;2H[K[2;1H[1m~[m[3;2H[K[3;1H[1m~[m[4;2H[K[4;1H[1m~[m[5;2H[K[5;1H[1m~[m[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;2H[K[37;1H[1m~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~[m[41;2H[K[41;1H[1m~[m[42;2H[K[42;1H[1m~[m[43;2H[K[43;1H[1m~[m[44;2H[K[44;1H[1m~[m[45;2H[K[45;1H[1m~[m[46;2H[K[46;1H[1m~[m
--No lines in buffer--[1;1H[47;1H[K[47;1H:e! Xtest"Xtest" [47;9H[K[47;9H6005 lines, 117092 characters[1;1HThis is the start
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader[1;1H[47;1H[K[47;1H:.w! test.out"test.out" [47;12H[K[47;12H[New File] 1 line, 18 characters written[1;1H[m[H[2J[1;1HThis is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the middle
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer[23;1H[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 19 characters appended[23;1H[m[H[2J[1;1HThis is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the end
:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 16 characters appended[46;1H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test42.failed test.ok test.out X* viminfo
cp test42.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test42.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test42.in" 130 lines, 2368 characters[1;1HTest for writing and reading a file starting with a BOM

STARTTEST
:so mbyte.vim
:set encoding=utf-8
:set fileencodings=ucs-bom,latin-1
:set ff=unix ffs=unix[11C" This changes the file for DOS and MAC
:" --- Write the test files
:/^latin-1$/+1w! Xtest0
:/^utf-8$/+1w! Xtest1
:/^utf-8-err$/+1w! Xtest2
:/^ucs-2$/+1w! Xtest3
:/^ucs-2le$/+1w! Xtest4
:" Need to add a NUL byte after the NL byte
:set bin
:e! Xtest4[22C" Ignore change from setting 'ff'
o[1m^V^@^[[m:set noeol
:w
:set ffs& nobinary[14C" Allow default test42.in format
:e #
:set ff=unix[20C" Format for files to write
:/^ucs-4$/+1w! Xtest5
:/^ucs-4le$/+1w! Xtest6
:" Need to add three NUL bytes after the NL byte
:set bin
:e! Xtest6[22C" ! for when setting 'ff' is a change
o[1m^V^@^V^@^V^@^[[m:set noeol
:w
:set nobin
:e #
:"
:" --- Check that editing a latin-1 file doesn't see a BOM
:e! Xtest0
:redir! >test.out
:set fileencoding bomb?
:redir END
:set fenc=latin-1
:w >>test.out
:set bomb fenc=latin-1
:w! Xtest0x
:"
:" --- Check utf-8
:e! Xtest1
:redir >>test.out
:set fileencoding bomb?
:redir END[1;1H[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 111 lines, 2116 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[m[H[2J[1;1H:set fileencoding bomb?
:redir END
:set fenc=latin-1
:w >>test.out
:set fenc=ucs-4
:w! Xtest5x
:"
:" --- Check ucs-4le
:e! Xtest6
:redir >>test.out
:set fileencoding bomb?
:redir END
:set fenc=latin-1
:w >>test.out
:set fenc=ucs-4le
:w! Xtest6x
:"
:" --- Check the files written with BOM
:set bin
:e! test.out
:$r Xtest0x
:$r Xtest1x
:$r Xtest2x
:$r Xtest3x
:$r Xtest4x
:$r Xtest5x
:$r Xtest6x
:set nobin ff&[15C" Write the file in default format
:w! test.out
:qa!
ENDTEST

latin-1
latin-1
utf-8
﻿utf-8
utf-8-err
﻿utf-8[1m~@[merr
ucs-2
[1m^@[mu[1m^@[mc[1m^@[ms[1m^@[m-[1m^@[m2[1m^@[m
ucs-2le
u[1m^@[mc[1m^@[ms[1m^@[m-[1m^@[m2[1m^@[ml[1m^@[me[1m^@[m
ucs-4
[1m^@^@[m[1m^@^@^@[mu[1m^@^@^@[mc[1m^@^@^@[ms[1m^@^@^@[m-[1m^@^@^@[m4[1m^@^@^@[m
ucs-4le
[1m^@^@[mu[1m^@^@^@[mc[1m^@^@^@[ms[1m^@^@^@[m-[1m^@^@^@[m4[1m^@^@^@[ml[1m^@^@^@[me[1m^@^@^@[31;1H
[47;1H[m:so! Xdotest[32;1H[47;1H[K[47;1H:so mbyte.vim[32;1H[47;1H[K[47;1H:set encoding=utf-8[m[H[2J[1;1H:set fileencoding bomb?
:redir END
:set fenc=latin-1
:w >>test.out
:set fenc=ucs-4
:w! Xtest5x
:"
:" --- Check ucs-4le
:e! Xtest6
:redir >>test.out
:set fileencoding bomb?
:redir END
:set fenc=latin-1
:w >>test.out
:set fenc=ucs-4le
:w! Xtest6x
:"
:" --- Check the files written with BOM
:set bin
:e! test.out
:$r Xtest0x
:$r Xtest1x
:$r Xtest2x
:$r Xtest3x
:$r Xtest4x
:$r Xtest5x
:$r Xtest6x
:set nobin ff&[15C" Write the file in default format
:w! test.out
:qa!
ENDTEST

latin-1
[1m<fe><fe>[mlatin-1
utf-8
[1m<feff>[mutf-8
utf-8-err
[1m<feff>[mutf-8[1m<80>[merr
ucs-2
[1m<fe><ff>^@[mu[1m^@[mc[1m^@[ms[1m^@[m-[1m^@[m2[1m^@[m
ucs-2le
[1m<ff><fe>[mu[1m^@[mc[1m^@[ms[1m^@[m-[1m^@[m2[1m^@[ml[1m^@[me[1m^@[m
ucs-4
[1m^@^@<fe><ff>^@^@^@[mu[1m^@^@^@[mc[1m^@^@^@[ms[1m^@^@^@[m-[1m^@^@^@[m4[1m^@^@^@[m
ucs-4le
[1m<ff><fe>^@^@[mu[1m^@^@^@[mc[1m^@^@^@[ms[1m^@^@^@[m-[1m^@^@^@[m4[1m^@^@^@[ml[1m^@^@^@[me[1m^@^@^@[32;1H[47;1H[m:set fileencodings=ucs-bom,latin-1[32;1H[47;1H[K[47;1H:set ff=unix ffs=unix           " This changes the file for DOS and MAC[32;1H[47;1H[K[47;1H:" --- Write the test files[32;1H[47;1H[K[47;1H:/^latin-1$/+1w! Xtest0"Xtest0" [47;10H[K[47;1H"Xtest0" [New File] 1 line, 10 characters written"Xtest0" [New File] 1 line, 10 characters written[32;1H[47;1H[K[47;1H:/^utf-8$/+1w! Xtest1"Xtest1" [47;10H[K[47;1H"Xtest1" [New File] 1 line, 9 characters written"Xtest1" [New File] 1 line, 9 characters written[32;1H[47;1H[K[47;1H:/^utf-8-err$/+1w! Xtest2"Xtest2" [47;10H[K[47;1H"Xtest2" [New File] 1 line, 13 characters written"Xtest2" [New File] 1 line, 13 characters written[32;1H[47;1H[K[47;1H:/^ucs-2$/+1w! Xtest3"Xtest3" [47;10H[K[47;1H"Xtest3" [New File] 1 line, 14 characters written"Xtest3" [New File] 1 line, 14 characters written[32;1H[47;1H[K[47;1H:/^ucs-2le$/+1w! Xtest4"Xtest4" [47;10H[K[47;1H"Xtest4" [New File] 1 line, 17 characters written"Xtest4" [New File] 1 line, 17 characters written[32;1H[47;1H[K[47;1H:" Need to add a NUL byte after the NL byte[32;1H[47;1H[K[47;1H:set bin[32;1H[47;1H[K[47;1H:e! Xtest4                      " Ignore change from setting 'ff'"Xtest4" [47;10H[K[47;1H"Xtest4" 1 line, 17 characters[1;1H[1m<ff><fe>[mu[1m^@[mc[1m^@[ms[1m^@[m-[1m^@[m2[1m^@[ml[1m^@[me[1m^@[m[2;2H[K[2;1H[1m~[m[3;2H[K[3;1H[1m~[m[4;2H[K[4;1H[1m~[m[5;2H[K[5;1H[1m~[m[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~
~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;2H[K[37;1H[1m~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~[m[41;2H[K[41;1H[1m~[m[42;2H[K[42;1H[1m~[m[43;2H[K[43;1H[1m~[m[44;2H[K[44;1H[1m~[m[45;2H[K[45;1H[1m~[m[46;2H[K[46;1H[1m~[1;1H
^@[m[47;1H[K[47;1H:set noeol[2;1H[47;1H[K[47;1H:w"Xtest4" "Xtest4" [Incomplete last line] 2 lines, 18 characters written"Xtest4" [Incomplete last line] 2 lines, 18 characters written[2;1H[47;1H[K[47;1H:set ffs& nobinary              " Allow default test42.in format[2;1H[47;1H[K[47;1H:e #"test42.in" "test42.in" [converted] 130 lines, 2385 characters[1;1H:set fileencoding bomb?[1;24H[K[2;1H:redir END
:set fenc=latin-1
:w >>test.out
:set fenc=ucs-4
:w! Xtest5x
:"
:" --- Check ucs-4le
:e! Xtest6
:redir >>test.out
:set fileencoding bomb?
:redir END
:set fenc=latin-1
:w >>test.out
:set fenc=ucs-4le
:w! Xtest6x
:"
:" --- Check the files written with BOM
:set bin
:e! test.out
:$r Xtest0x
:$r Xtest1x
:$r Xtest2x
:$r Xtest3x
:$r Xtest4x
:$r Xtest5x
:$r Xtest6x
:set nobin ff&[15C" Write the file in default format
:w! test.out
:qa!
ENDTEST[32;1H[K[33;1Hlatin-1
þþlatin-1
utf-8
ï»¿utf-8
utf-8-err
ï»¿utf-8[1m<80>[merr
ucs-2
þÿ[1m^@[mu[1m^@[mc[1m^@[ms[1m^@[m-[1m^@[m2[1m^@[m
ucs-2le
ÿþu[1m^@[mc[1m^@[ms[1m^@[m-[1m^@[m2[1m^@[ml[1m^@[me[1m^@[m
ucs-4
[1m^@^@[mþÿ[1m^@^@^@[mu[1m^@^@^@[mc[1m^@^@^@[ms[1m^@^@^@[m-[1m^@^@^@[m4[1m^@^@^@[m
ucs-4le
ÿþ[1m^@^@[mu[1m^@^@^@[mc[1m^@^@^@[ms[1m^@^@^@[m-[1m^@^@^@[m4[1m^@^@^@[ml[1m^@^@^@[me[1m^@^@^@[32;1H[m[47;1H[K[47;1H:set ff=unix                    " Format for files to write[32;1H[47;1H[K[47;1H:/^ucs-4$/+1w! Xtest5"Xtest5" [47;10H[K[47;1H"Xtest5" [converted][New File] 1 line, 30 characters written"Xtest5" [converted][New File] 1 line, 30 characters written[32;1H[47;1H[K[47;1H:/^ucs-4le$/+1w! Xtest6"Xtest6" [47;10H[K[47;1H"Xtest6" [converted][New File] 1 line, 35 characters written"Xtest6" [converted][New File] 1 line, 35 characters written[32;1H[47;1H[K[47;1H:" Need to add three NUL bytes after the NL byte[32;1H[47;1H[K[47;1H:set bin[32;1H[47;1H[K[47;1H:e! Xtest6                      " ! for when setting 'ff' is a change"Xtest6" [47;10H[K[47;1H"Xtest6" 1 line, 33 characters[1;1H[1m<ff><fe>^@^@[mu[1m^@^@^@[mc[1m^@^@^@[ms[1m^@^@^@[m-[1m^@^@^@[m4[1m^@^@^@[ml[1m^@^@^@[me[1m^@^@^@[m[2;2H[K[2;1H[1m~[m[3;2H[K[3;1H[1m~[m[4;2H[K[4;1H[1m~[m[5;2H[K[5;1H[1m~[m[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~
~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;2H[K[37;1H[1m~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~[m[41;2H[K[41;1H[1m~[m[42;2H[K[42;1H[1m~[m[43;2H[K[43;1H[1m~[m[44;2H[K[44;1H[1m~[m[45;2H[K[45;1H[1m~[m[46;2H[K[46;1H[1m~[1;1H
~[m   [1m^@^@^@[m[47;1H[K[47;1H:set noeol[2;5H[47;1H[K[47;1H:w"Xtest6" "Xtest6" [Incomplete last line] 2 lines, 36 characters written"Xtest6" [Incomplete last line] 2 lines, 36 characters written[2;5H[47;1H[K[47;1H:set nobin[2;5H[47;1H[K[47;1H:e #"test42.in" "test42.in" [converted] 130 lines, 2385 characters[1;1H:set fileencoding bomb?[1;24H[K[2;1H:redir END
:set fenc=latin-1
:w >>test.out
:set fenc=ucs-4
:w! Xtest5x
:"
:" --- Check ucs-4le
:e! Xtest6
:redir >>test.out
:set fileencoding bomb?
:redir END
:set fenc=latin-1
:w >>test.out
:set fenc=ucs-4le
:w! Xtest6x
:"
:" --- Check the files written with BOM
:set bin
:e! test.out
:$r Xtest0x
:$r Xtest1x
:$r Xtest2x
:$r Xtest3x
:$r Xtest4x
:$r Xtest5x
:$r Xtest6x
:set nobin ff&[15C" Write the file in default format
:w! test.out
:qa!
ENDTEST[32;1H[K[33;1Hlatin-1
þþlatin-1
utf-8
ï»¿utf-8
utf-8-err
ï»¿utf-8[1m<80>[merr
ucs-2
þÿ[1m^@[mu[1m^@[mc[1m^@[ms[1m^@[m-[1m^@[m2[1m^@[m
ucs-2le
ÿþu[1m^@[mc[1m^@[ms[1m^@[m-[1m^@[m2[1m^@[ml[1m^@[me[1m^@[m
ucs-4
[1m^@^@[mþÿ[1m^@^@^@[mu[1m^@^@^@[mc[1m^@^@^@[ms[1m^@^@^@[m-[1m^@^@^@[m4[1m^@^@^@[m
ucs-4le
ÿþ[1m^@^@[mu[1m^@^@^@[mc[1m^@^@^@[ms[1m^@^@^@[m-[1m^@^@^@[m4[1m^@^@^@[ml[1m^@^@^@[me[1m^@^@^@[32;1H[m[47;1H[K[47;1H:"[32;1H[47;1H[K[47;1H:" --- Check that editing a latin-1 file doesn't see a BOM[32;1H[47;1H[K[47;1H:e! Xtest0"Xtest0" [47;10H[K[47;1H"Xtest0" [converted] 1 line, 12 characters[1;1Hþþlatin-1[1;10H[K[2;2H[K[2;1H[1m~[m[3;2H[K[3;1H[1m~[m[4;2H[K[4;1H[1m~[m[5;2H[K[5;1H[1m~[m[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~
~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;2H[K[37;1H[1m~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~[m[41;2H[K[41;1H[1m~[m[42;2H[K[42;1H[1m~[m[43;2H[K[43;1H[1m~[m[44;2H[K[44;1H[1m~[m[45;2H[K[45;1H[1m~[m[46;2H[K[46;1H[1m~[1;1H[m[47;1H[K[47;1H:redir! >test.out[1;1H[47;1H[K[47;1H:set fileencoding bomb?[47;1H[K[47;1H  fileencoding=latin1
nobomb
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:redir END[1;1H[2L[1;1Hþþlatin-1
[1m~[m[47;3H[K[1;1H[47;1H:set fenc=latin-1[1;1H[47;1H[K[47;1H:w >>test.out"test.out" [47;12H[K[47;1H"test.out" [converted] 1 line, 12 characters appended"test.out" [converted] 1 line, 12 characters appended[1;1H[47;1H[K[47;1H:set bomb fenc=latin-1[1;1H[47;1H[K[47;1H:w! Xtest0x"Xtest0x" [47;11H[K[47;1H"Xtest0x" [converted][New File] 1 line, 12 characters written"Xtest0x" [converted][New File] 1 line, 12 characters written[1;1H[47;1H[K[47;1H:"[1;1H[47;1H[K[47;1H:" --- Check utf-8[1;1H[47;1H[K[47;1H:e! Xtest1"Xtest1" [47;10H[K[47;1H"Xtest1" 1 line, 9 characters[1;1Hutf-8[1;6H[K[1;1H[47;1H[K[47;1H:redir >>test.out[1;1H[47;1H[K[47;1H:set fileencoding bomb?[47;1H[K[47;1H  fileencoding=utf-8
  bomb
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:redir END[1;1H[2L[1;1Hutf-8
[1m~[m[47;3H[K[1;1H[47;1H:set fenc=latin-1[1;1H[47;1H[K[47;1H:w >>test.out"test.out" [47;12H[K[47;1H"test.out" [converted] 1 line, 6 characters appended"test.out" [converted] 1 line, 6 characters appended[1;1H[47;1H[K[47;1H:set fenc=utf-8[1;1H[47;1H[K[47;1H:w! Xtest1x"Xtest1x" [47;11H[K[47;1H"Xtest1x" [New File] 1 line, 9 characters written"Xtest1x" [New File] 1 line, 9 characters written[1;1H[47;1H[K[47;1H:"[1;1H[47;1H[K[47;1H:" --- Check utf-8 with an error (will fall back to latin-1)[1;1H[47;1H[K[47;1H:e! Xtest2"Xtest2" [47;10H[K[47;1H"Xtest2" [converted] 1 line, 17 characters[1;1Hï»¿utf-8[1m<80>[merr[47;1H[K[47;1H:redir >>test.out[1;1H[47;1H[K[47;1H:set fileencoding bomb?[47;1H[K[47;1H  fileencoding=latin1
nobomb
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:redir END[1;1H[2L[1;1Hï»¿utf-8[1m<80>[merr
[1m~[m[47;3H[K[1;1H[47;1H:set fenc=latin-1[1;1H[47;1H[K[47;1H:w >>test.out"test.out" [47;12H[K[47;1H"test.out" [converted] 1 line, 17 characters appended"test.out" [converted] 1 line, 17 characters appended[1;1H[47;1H[K[47;1H:set fenc=utf-8[1;1H[47;1H[K[47;1H:w! Xtest2x"Xtest2x" [47;11H[K[47;1H"Xtest2x" [New File] 1 line, 17 characters written"Xtest2x" [New File] 1 line, 17 characters written[1;1H[47;1H[K[47;1H:"[1;1H[47;1H[K[47;1H:" --- Check ucs-2[1;1H[47;1H[K[47;1H:e! Xtest3"Xtest3" [47;10H[K[47;1H"Xtest3" [converted] 1 line, 8 characters[1;1Hucs-2[1;6H[K[1;1H[47;1H[K[47;1H:redir >>test.out[1;1H[47;1H[K[47;1H:set fileencoding bomb?[47;1H[K[47;1H  fileencoding=ucs-2
  bomb
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:redir END[1;1H[2L[1;1Hucs-2
[1m~[m[47;3H[K[1;1H[47;1H:set fenc=latin-1[1;1H[47;1H[K[47;1H:w >>test.out"test.out" [47;12H[K[47;1H"test.out" [converted] 1 line, 6 characters appended"test.out" [converted] 1 line, 6 characters appended[1;1H[47;1H[K[47;1H:set fenc=ucs-2[1;1H[47;1H[K[47;1H:w! Xtest3x"Xtest3x" [47;11H[K[47;1H"Xtest3x" [converted][New File] 1 line, 8 characters written"Xtest3x" [converted][New File] 1 line, 8 characters written[1;1H[47;1H[K[47;1H:"[1;1H[47;1H[K[47;1H:" --- Check ucs-2le[1;1H[47;1H[K[47;1H:e! Xtest4"Xtest4" [47;10H[K[47;1H"Xtest4" [converted] 1 line, 10 characters[1;6Hle[47;1H[K[47;1H:redir >>test.out[1;1H[47;1H[K[47;1H:set fileencoding bomb?[47;1H[K[47;1H  fileencoding=ucs-2le
  bomb
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:redir END[1;1H[2L[1;1Hucs-2le
[1m~[m[47;3H[K[1;1H[47;1H:set fenc=latin-1[1;1H[47;1H[K[47;1H:w >>test.out"test.out" [47;12H[K[47;1H"test.out" [converted] 1 line, 8 characters appended"test.out" [converted] 1 line, 8 characters appended[1;1H[47;1H[K[47;1H:set fenc=ucs-2le[1;1H[47;1H[K[47;1H:w! Xtest4x"Xtest4x" [47;11H[K[47;1H"Xtest4x" [converted][New File] 1 line, 10 characters written"Xtest4x" [converted][New File] 1 line, 10 characters written[1;1H[47;1H[K[47;1H:"[1;1H[47;1H[K[47;1H:" --- Check ucs-4[1;1H[47;1H[K[47;1H:e! Xtest5"Xtest5" [47;10H[K[47;1H"Xtest5" [converted] 1 line, 10 characters[1;5H4[1;6H[K[1;1H[47;1H[K[47;1H:redir >>test.out[1;1H[47;1H[K[47;1H:set fileencoding bomb?[47;1H[K[47;1H  fileencoding=ucs-4
  bomb
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:redir END[1;1H[2L[1;1Hucs-4
[1m~[m[47;3H[K[1;1H[47;1H:set fenc=latin-1[1;1H[47;1H[K[47;1H:w >>test.out"test.out" [47;12H[K[47;1H"test.out" [converted] 1 line, 6 characters appended"test.out" [converted] 1 line, 6 characters appended[1;1H[47;1H[K[47;1H:set fenc=ucs-4[1;1H[47;1H[K[47;1H:w! Xtest5x"Xtest5x" [47;11H[K[47;1H"Xtest5x" [converted][New File] 1 line, 10 characters written"Xtest5x" [converted][New File] 1 line, 10 characters written[1;1H[47;1H[K[47;1H:"[1;1H[47;1H[K[47;1H:" --- Check ucs-4le[1;1H[47;1H[K[47;1H:e! Xtest6"Xtest6" [47;10H[K[47;1H"Xtest6" [converted] 1 line, 12 characters[1;6Hle[47;1H[K[47;1H:redir >>test.out[1;1H[47;1H[K[47;1H:set fileencoding bomb?[47;1H[K[47;1H  fileencoding=ucs-4le
  bomb
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:redir END[1;1H[2L[1;1Hucs-4le
[1m~[m[47;3H[K[1;1H[47;1H:set fenc=latin-1[1;1H[47;1H[K[47;1H:w >>test.out"test.out" [47;12H[K[47;1H"test.out" [converted] 1 line, 8 characters appended"test.out" [converted] 1 line, 8 characters appended[1;1H[47;1H[K[47;1H:set fenc=ucs-4le[1;1H[47;1H[K[47;1H:w! Xtest6x"Xtest6x" [47;11H[K[47;1H"Xtest6x" [converted][New File] 1 line, 12 characters written"Xtest6x" [converted][New File] 1 line, 12 characters written[1;1H[47;1H[K[47;1H:"[1;1H[47;1H[K[47;1H:" --- Check the files written with BOM[1;1H[47;1H[K[47;1H:set bin[1;1H[47;1H[K[47;1H:e! test.out"test.out" [47;12H[K[47;1H"test.out" 35 lines, 273 characters[1;1H[K[2;1H[K[3;1H  fileencoding=latin1
nobomb
[1m<fe><fe>[mlatin-1[6;1H[K[7;1H[K[8;1H  fileencoding=utf-8
  bomb
utf-8[11;1H[K[12;1H[K[13;1H  fileencoding=latin1
nobomb
[1m<feff>[mutf-8[1m<80>[merr[16;1H[K[17;1H[K[18;1H  fileencoding=ucs-2
  bomb
ucs-2[21;1H[K[22;1H[K[23;1H  fileencoding=ucs-2le
  bomb
ucs-2le[26;1H[K[27;1H[K[28;1H  fileencoding=ucs-4
  bomb
ucs-4[31;1H[K[32;1H[K[33;1H  fileencoding=ucs-4le
  bomb
ucs-4le[1;1H[47;1H[K[47;1H:$r Xtest0x"Xtest0x" [47;11H[K[47;1H"Xtest0x" 1 line, 10 characters[36;1H[1m<fe><fe>[mlatin-1[47;1H[K[47;1H:$r Xtest1x"Xtest1x" [47;11H[K[47;1H"Xtest1x" 1 line, 9 characters[37;1H[1m<feff>[mutf-8[47;1H[K[47;1H:$r Xtest2x"Xtest2x" [47;11H[K[47;1H"Xtest2x" 1 line, 17 characters[38;1Hï»¿utf-8[1m<80>[merr[47;1H[K[47;1H:$r Xtest3x"Xtest3x" [47;11H[K[47;1H"Xtest3x" 1 line, 14 characters[39;1H[1m<fe><ff>^@[mu[1m^@[mc[1m^@[ms[1m^@[m-[1m^@[m2[1m^@[m[47;1H[K[47;1H:$r Xtest4x"Xtest4x" [47;11H[K[47;1H"Xtest4x" [Incomplete last line] 2 lines, 18 characters[40;1H[1m<ff><fe>[mu[1m^@[mc[1m^@[ms[1m^@[m-[1m^@[m2[1m^@[ml[1m^@[me[1m^@
^@[40;1H[m[47;1H[K[47;1H:$r Xtest5x"Xtest5x" [47;11H[K[47;1H"Xtest5x" 1 line, 28 characters[42;1H[1m^@^@<fe><ff>^@^@^@[mu[1m^@^@^@[mc[1m^@^@^@[ms[1m^@^@^@[m-[1m^@^@^@[m4[1m^@^@^@[m[47;1H[K[47;1H:$r Xtest6x"Xtest6x" [47;11H[K[47;1H"Xtest6x" [Incomplete last line] 2 lines, 36 characters[43;1H[1m<ff><fe>^@^@[mu[1m^@^@^@[mc[1m^@^@^@[ms[1m^@^@^@[m-[1m^@^@^@[m4[1m^@^@^@[ml[1m^@^@^@[me[1m^@^@^@
^@^@^@[43;1H[m[47;1H[K[47;1H:set nobin ff&               " Write the file in default format[43;1H[47;1H[K[47;1H:w! test.out"test.out" [47;12H[K[47;1H"test.out" 44 lines, 407 characters written"test.out" 44 lines, 407 characters written[43;1H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test43.failed test.ok test.out X* viminfo
cp test43.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test43.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test43.in" 27 lines, 412 characters[1;1HTests for regexp with various magic settings.

STARTTEST
:set nocompatible viminfo+=nviminfo
/^1
/a*b\{2}c\+/e
x/\Md\*e\{2}f\+/e
x:set nomagic
/g\*h\{2}i\+/e
x/\mj*k\{2}l\+/e
x/\vm*n{2}o+/e
x/\V^aa$
x:set magic
/\v(a)(b)\2\1\1/e
x/\V[ab]\(\[xy]\)\1
x:?^1?,$w! test.out
:qa!
ENDTEST

1 a aa abb abbccc
2 d dd dee deefff
3 g gg ghh ghhiii
4 j jj jkk jkklll
5 m mm mnn mnnooo
6 x ^aa$ x
7 (a)(b) abbaa
8 axx [ab]xx
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 14 lines, 217 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[18;1H
[47;1H[K[47;1H:so! Xdotest[19;1H[47;1H[K[47;1H:set nocompatible viminfo+=nviminfo[19;1H[47;1H[K[47;1H/^1[20;1H[47;1H[K[47;1H/a*b\{2}c\+/e[20;17H[20;17H[K[20;16H[47;1H[K[47;1H/\Md\*e\{2}f\+/e[21;17H[21;17H[K[21;16H[47;1H[K[47;1H:set nomagic[21;16H[47;1H[K[47;1H/g\*h\{2}i\+/e[22;17H[22;17H[K[22;16H[47;1H[K[47;1H/\mj*k\{2}l\+/e[23;17H[23;17H[K[23;16H[47;1H[K[47;1H/\vm*n{2}o+/e[24;17H[24;17H[K[24;16H[47;1H[K[47;1H/\V^aa$[25;5Haa$ x[25;10H[K[25;5H[47;1H[K[47;1H:set magic[25;5H[47;1H[K[47;1H/\v(a)(b)\2\1\1/e[26;14H[26;14H[K[26;13H[47;1H[K[47;1H/\V[ab]\(\[xy]\)\1[27;7Hab]x[27;12H[K[27;7H[47;1H[K[47;1H:?^1?,$w! test.out"test.out" [47;12H[K[47;12H[New] 8L, 121C written[27;7H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test44.failed test.ok test.out X* viminfo
cp test44.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test44.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test44.in" 55 lines, 1137 characters[1;1HTests for regexp with multi-byte encoding and various magic settings.
Test matchstr() with a count and multi-byte chars.

STARTTEST
:so mbyte.vim
:set nocompatible encoding=utf-8 termencoding=latin1 viminfo+=nviminfo
/^1
/a*b\{2}c\+/e
x/\Md\*e\{2}f\+/e
x:set nomagic
/g\*h\{2}i\+/e
x/\mj*k\{2}l\+/e
x/\vm*n{2}o+/e
x/\V^aa$
x:set magic
/\v(a)(b)\2\1\1/e
x/\V[ab]\(\[xy]\)\1
x:" Now search for multi-byte without composing char
/ม
x:" Now search for multi-byte with composing char
/ม[1m~H[m
x:" find word by change of word class
/[1m~A[m\<[1m~B[m[1m~C[m\>[1m~A[m
x:" Test \%u, [\u] and friends
/\%u20ac
x/[\u4f7f\u5929]\+
x/\%U12345678
x/[\U1234abcd\u1234\uabcd]
x/\%d21879b
x:?^1?,$w! test.out
:e! test.out
G:put =matchstr(\"[1m~P[m[1m~Q[m[1m~R[m[1m~S[m\", \".\", 0, 2) " [1m~Q[m
:put =matchstr(\"[1m~P[m[1m~Q[m[1m~R[m[1m~S[m\", \"..\", 0, 2) " [1m~Q[m[1m~R[m
:put =matchstr(\"[1m~P[m[1m~Q[m[1m~R[m[1m~S[m\", \".\", 0, 0) " [1m~P[m
:put =matchstr(\"[1m~P[m[1m~Q[m[1m~R[m[1m~S[m\", \".\", 4, -1) " [1m~R[m
:w!
:qa!
ENDTEST

1 a aa abb abbccc
2 d dd dee deefff
3 g gg ghh ghhiii
4 j jj jkk jkklll
5 m mm mnn mnnooo
6 x ^aa$ x
7 (a)(b) abbaa[1;1H[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[4;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[5;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 33 lines, 760 characters written[5;1H[47;1H[K[47;1H:set ff& cpo+=A[5;1H[47;1H/ENDTEST[47;10H[K[47;1H[38;1H
[47;1H[K[47;1H:so! Xdotest[39;1H[47;1H[K[47;1H:so mbyte.vim[39;1H[47;1H[K[47;1H:set nocompatible encoding=utf-8 termencoding=latin1 viminfo+=nviminfo[m[H[2J[1;1HTests for regexp with multi-byte encoding and various magic settings.
Test matchstr() with a count and multi-byte chars.

STARTTEST
:so mbyte.vim
:set nocompatible encoding=utf-8 termencoding=latin1 viminfo+=nviminfo
/^1
/a*b\{2}c\+/e
x/\Md\*e\{2}f\+/e
x:set nomagic
/g\*h\{2}i\+/e
x/\mj*k\{2}l\+/e
x/\vm*n{2}o+/e
x/\V^aa$
x:set magic
/\v(a)(b)\2\1\1/e
x/\V[ab]\(\[xy]\)\1
x:" Now search for multi-byte without composing char
/
x:" Now search for multi-byte with composing char
/
x:" find word by change of word class
/?\<??\>?
x:" Test \%u, [\u] and friends
/\%u20ac
x/[\u4f7f\u5929]\+
x/\%U12345678
x/[\U1234abcd\u1234\uabcd]
x/\%d21879b
x:?^1?,$w! test.out
:e! test.out
G:put =matchstr(\"\", \".\", 0, 2) " 
:put =matchstr(\"\", \"..\", 0, 2) " 
:put =matchstr(\"\", \".\", 0, 0) " 
:put =matchstr(\"\", \".\", 4, -1) " 
:w!
:qa!
ENDTEST

1 a aa abb abbccc
2 d dd dee deefff
3 g gg ghh ghhiii
4 j jj jkk jkklll
5 m mm mnn mnnooo
6 x ^aa$ x
7 (a)(b) abbaa[39;1H[47;1H/^1/^1[40;1H[47;1H[K[47;1H/a*b\{2}c\+/e/a*b\{2}c\+/e[40;17H[40;17H[K[40;16H[47;1H[K[47;1H/\Md\*e\{2}f\+/e/\Md\*e\{2}f\+/e[41;17H[41;17H[K[41;16H[47;1H[K[47;1H:set nomagic[41;16H[47;1H[K[47;1H/g\*h\{2}i\+/e/g\*h\{2}i\+/e[42;17H[42;17H[K[42;16H[47;1H[K[47;1H/\mj*k\{2}l\+/e/\mj*k\{2}l\+/e[43;17H[43;17H[K[43;16H[47;1H[K[47;1H/\vm*n{2}o+/e/\vm*n{2}o+/e[44;17H[44;17H[K[44;16H[47;1H[K[47;1H/\V^aa$/\V^aa$[45;5Haa$ x[45;10H[K[45;5H[47;1H[K[47;1H:set magic[45;5H[47;1H[K[47;1H/\v(a)(b)\2\1\1/e/\v(a)(b)\2\1\1/e[46;14H[46;14H[K[46;13H[47;1H[K[47;1H/\V[ab]\(\[xy]\)\1/\V[ab]\(\[xy]\)\1[1;46r[46;1H
[1;47r[46;1H8 axx [ab]xx[47;1H[K[46;7Hab]x[46;12H[K[46;7H
:" Now search for multi-byte without composing char[46;7H[47;1H[K[47;1H//[1;46r[46;1H
[1;47r[46;1H9 x x[47;1H[K[46;8Hx[46;9H[K[46;8H
:" Now search for multi-byte with composing char[46;8H[47;1H[K[47;1H//[1;46r[46;1H
[1;47r[46;1Ha x x[47;1H[K[46;8Hx[46;9H[K[46;8H
:" find word by change of word class[46;8H[47;1H[K[47;1H/?\<??\>?/[2C\<[4C\>[1;46r[46;1H
[1;47r[46;1Hb ????[47;1H[K[46;3H???[46;9H[K[46;3H
:" Test \%u, [\u] and friends[46;3H[47;1H[K[47;1H/\%u20ac/\%u20ac[1;46r[46;1H
[1;47r[46;1Hc x x[47;1H[K[46;6Hx[46;7H[K[46;6H
/[\u4f7f\u5929]\+/[\u4f7f\u5929]\+[1;46r[46;1H
[1;47r[46;1Hd ??x[47;1H[K[46;3H?x [46;7H[K[46;3H
/\%U12345678/\%U12345678[1;46r[46;1H
[1;47r[46;1He [1m?[my[47;1H[K[46;3Hy[46;4H[K[46;3H
/[\U1234abcd\u1234\uabcd]/[\U1234abcd\u1234\uabcd][1;46r[46;1H
[1;47r[46;1Hf [1m?[mz[47;1H[K[46;3Hz[46;4H[K[46;3H
/\%d21879b/\%d21879b[1;46r[46;1H
[1;47r[46;1Hg a?bb[47;1H[K[46;4Hbb[46;6H[K[46;4H
:?^1?,$w! test.out"test.out" [47;12H[K[47;1H"test.out" [New] 16L, 195C written"test.out" [New] 16L, 195C written[46;4H[47;1H[K[47;1H:e! test.out"test.out" [47;12H[K[47;1H"test.out" 16L, 195C[1;1H1 a aa abb abbcc
2 d dd dee deeff
3 g gg ghh ghhii
4 j jj jkk jkkll
5 m mm mnn mnnoo
6 x aa$ x[6;10H[K[7;1H7 (a)(b) abba[7;14H[K[8;1H8 axx ab]xx[8;12H[K[9;1H9 x x[9;9H[K[10;1Ha x x
b ???[11;9H[K[12;1Hc x x
d ?x[13;6H[K[14;1He y[14;4H[K[15;1Hf z[15;5H[K[16;1Hg abb[16;6H[K[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~
~[m[31;3H[K[31;1H[1m~[m[32;3H[K[32;1H[1m~[m[33;3H[K[33;1H[1m~[m[34;3H[K[34;1H[1m~[m[35;3H[K[35;1H[1m~[m[36;3H[K[36;1H[1m~[m[37;3H[K[37;1H[1m~[m[38;3H[K[38;1H[1m~[m[39;3H[K[39;1H[1m~[m[40;3H[K[40;1H[1m~[m[41;3H[K[41;1H[1m~[m[42;3H[K[42;1H[1m~[m[43;3H[K[43;1H[1m~[m[44;3H[K[44;1H[1m~[m[45;3H[K[45;1H[1m~[m[46;3H[K[46;1H[1m~[1;1H[16;1H[m[47;1H[K[47;1H:put =matchstr(\"\", \".\", 0, 2) " [17;1H[47;1H[K[47;1H:put =matchstr(\"\", \"..\", 0, 2) " [18;1H[47;1H[K[47;1H:put =matchstr(\"\", \".\", 0, 0) " [19;1H[47;1H[K[47;1H:put =matchstr(\"\", \".\", 4, -1) " [20;1H[47;1H[K[47;1H:w!"test.out" "test.out" 20L, 209C written"test.out" 20L, 209C written[20;1H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test45.failed test.ok test.out X* viminfo
cp test45.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test45.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test45.in" 72 lines, 1498 characters[1;1HTests for folding. vim: set ft=vim :

STARTTEST
:so small.vim
:" We also need the +syntax feature here.
:if !has("syntax")
   e! test.ok
   w! test.out
   qa!
:endif
:" basic test if a fold can be created, opened, moving to the end and closed
/^1
zf2j:call append("$", "manual " . getline(foldclosed(".")))
zo:call append("$", foldclosed("."))
]z:call append("$", getline("."))
zc:call append("$", getline(foldclosed(".")))
:" test folding with markers.
:set fdm=marker fdl=1 fdc=3
/^5
:call append("$", "marker " . foldlevel("."))
[z:call append("$", foldlevel("."))
jo{{ [1m^[[mr{jj:call append("$", foldlevel("."))
kYpj:call append("$", foldlevel("."))
:" test folding with indent
:set fdm=indent sw=2
/^2 b
i  [1m^[[mjI    [1m^[[m:call append("$", "indent " . foldlevel("."))
k:call append("$", foldlevel("."))
:" test syntax folding
:set fdm=syntax fdl=0
:syn region Hup start="dd" end="hh" fold
Gzk:call append("$", "folding " . getline("."))
k:call append("$", getline("."))
:" test expression folding
:fun Flvl()
  let l = getline(v:lnum)
  if l =~ "bb$"
    return 2
  elseif l =~ "gg$"
    return "s1"
  elseif l =~ "ii$"
    return ">2"
  elseif l =~ "kk$"
    return "0"
  endif
  return "="[1;1H[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 55 lines, 1365 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[1;46r[1;1H[13M[1;47r[34;1Hendfun
:set fdm=expr fde=Flvl()
/bb$
:call append("$", "expr " . foldlevel("."))
/hh$
:call append("$", foldlevel("."))
/ii$
:call append("$", foldlevel("."))
/kk$
:call append("$", foldlevel("."))
:/^last/+1,$w! test.out
:qa!
ENDTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H
:so! Xdotest[46;1H[47;1H[K[47;1H:so small.vim[46;1H[47;1H[K[47;1H:" We also need the +syntax feature here.[46;1H[47;1H[K[47;1H:if !has("syntax")
:     e! test.ok
:     w! test.out
:     qa!
:  :endif[1;1H[4L[1;1H]z:call append("$", getline("."))
zc:call append("$", getline(foldclosed(".")))
:" test folding with markers.
:set fdm=marker fdl=1 fdc=3[47;1H[K[46;1H
:" basic test if a fold can be created, opened, moving to the end and closed[46;1H[47;1H[K[47;1H/^1[1;46r[46;1H
[1;47r[46;1H1 aa[47;1H[K[46;1H[7m+--  3 lines: 1 aa-------------------------------------------------------------------------------------------------------------[46;1H
[m:call append("$", "manual " . getline(foldclosed(".")))[46;1H1 aa[46;5H[K[46;1H[47;1H[K[47;1H:call append("$", foldclosed("."))[46;1H[1;46r[1;1H[2M[1;47r[45;1H2 bb
3 cc[47;1H[K[46;1H
:call append("$", getline("."))[46;1H[44;1H[7m+--  3 lines: 1 aa-------------------------------------------------------------------------------------------------------------[m[45;1H4 dd {{{
5 ee {{{ }}}[44;1H[47;1H[K[47;1H:call append("$", getline(foldclosed(".")))[44;1H[47;1H[K[47;1H:" test folding with markers.[44;1H[47;1H[K[47;1H:set fdm=marker fdl=1 fdc=3[1;1H[7m   [m:set fdm=marker fdl=1 fdc=3
[7m   [m/^5
[7m   [m:call append("$", "marker " . foldlevel("."))
[7m   [m[z:call append("$", foldlevel("."))
[7m   [mjo{{ [1m^[[mr{jj:call append("$", foldlevel("."))
[7m   [mkYpj:call append("$", foldlevel("."))
[7m   [m:" test folding with indent
[7m   [m:set fdm=indent sw=2
[7m   [m/^2 b
[7m   [mi  [1m^[[mjI    [1m^[[m:call append("$", "indent " . foldlevel("."))
[7m   [mk:call append("$", foldlevel("."))
[7m   [m:" test syntax folding
[7m   [m:set fdm=syntax fdl=0
[7m   [m:syn region Hup start="dd" end="hh" fold
[7m   [mGzk:call append("$", "folding " . getline("."))
[7m   [mk:call append("$", getline("."))
[7m   [m:" test expression folding
[7m   [m:fun Flvl()
[7m   [m  let l = getline(v:lnum)
[7m   [m  if l =~ "bb$"
[7m   [m    return 2
[7m   [m  elseif l =~ "gg$"
[7m   [m    return "s1"
[7m   [m  elseif l =~ "ii$"
[7m   [m    return ">2"
[7m   [m  elseif l =~ "kk$"
[7m   [m    return "0"
[7m   [m  endif
[7m   [m  return "="
[7m   [mendfun
[7m   [m:set fdm=expr fde=Flvl()
[7m   [m/bb$
[7m   [m:call append("$", "expr " . foldlevel("."))
[7m   [m/hh$
[7m   [m:call append("$", foldlevel("."))
[7m   [m/ii$
[7m   [m:call append("$", foldlevel("."))
[7m   [m/kk$
[7m   [m:call append("$", foldlevel("."))
[7m   [m:/^last/+1,$w! test.out
[7m   [m:qa!
[7m   [mENDTEST
[7m   
   [m1 aa[44;8H[K[45;1H[7m   [m2 bb[45;8H[K[46;1H[7m   [m3 cc[46;8H[K[46;4H[47;1H[K[47;1H/^5[1;5Hcall append("$", "marker " . foldlevel("."))[2;4H[z:call append("$", foldlevel("."))[3;4Hjo{{ [1m^[[mr{jj:call append("$", foldlevel(".")[3;48H[K[4;4HkYpj:call append("$", foldlevel("."))[5;4H:" test folding with indent[5;31H[K[6;4H:set fdm=indent sw=2[6;24H[K[7;4H/^2 b[7;9H[K[8;4Hi  [1m^[[mjI    [1m^[[m:call append("$", "indent " . foldlevel("."))[9;4Hk:call append("$", foldlevel("."))[10;4H:" test syntax folding[10;26H[K[11;4H:set fdm=syntax fdl=0[11;25H[K[12;5Hsyn region Hup start="dd" end="hh" fold[13;4HGzk:call append("$", "folding " . getline("."))[14;4Hk:call append("$", getline("."))[14;36H[K[15;4H:" test expression folding[15;30H[K[16;4H:fun Flvl()[16;15H[K[17;4H  let l = getline(v:lnum)[17;29H[K[18;4H  if l =~ "bb$"[19;6H  return 2[19;16H[K[20;6Helseif l =~ "gg$"[21;15H"s1"[22;19Hii[23;16H>2[24;19Hkk[25;16H0"[25;18H[K[26;7Hndif[26;11H[K[27;6Hreturn "=[27;16H[K[28;4Hendfun[28;10H[K[29;4H:set fdm=expr fde=Flvl()[30;4H/bb$[30;8H[K[31;5Hcall append("$", "expr " . foldlevel("."))[32;5Hhh[33;22Hfoldlevel("."))[33;37H[K[34;5Hii[36;5Hkk[38;4H:/^last/+1,$w! test.out[39;5Hqa![39;8H[K[40;4HENDTEST[40;11H[K[41;4H[K[42;4H1 aa[42;8H[K[43;4H2 bb[44;4H3 cc
[7m-[m[2C4 dd {{{
[7m|-[m[1C5 ee {{{ }}}[46;4H[47;1H[K[47;1H:call append("$", "marker " . foldlevel("."))[46;4H[45;4H[47;1H[K[47;1H:call append("$", foldlevel("."))[45;4H[46;4H[1;46r[46;1H
[1;47r[46;1H[7m|  [m{{[47;1H[K[46;6H[46;2H[7m-[m[3C{[1;46r[46;1H
[1;47r[46;1H[7m|| [m6 ff }}}[1;46r[46;1H
[1;47r[46;1H[7m|  [m7 gg
:call append("$", foldlevel("."))[46;6H[45;6H[46;4H6 ff }}}[46;4H[1;46r[46;1H
[1;47r[46;1H[7m   [m7 gg[47;1H[K[46;4H
:call append("$", foldlevel("."))[46;4H[47;1H[K[47;1H:" test folding with indent[46;4H[47;1H[K[47;1H:set fdm=indent sw=2[13;1H[7m-
|
|-
|
|-
|
|-
|
|-
|
|[41;1H 
  
  
  
 
   [m[47;1H[K[47;1H/^2 b[7msearch hit BOTTOM, continuing at TOP[39;4H-[m[2C  2 bb[40;5H[7m|-[m[1C    3 cc[47;1H[K[47;1H:call append("$", "indent " . foldlevel("."))[40;7H[39;7H[47;1H[K[47;1H:call append("$", foldlevel("."))[39;7H[47;1H[K[47;1H:" test syntax folding[39;7H[47;1H[K[47;1H:set fdm=syntax fdl=0[13;1H[7m 
 
  
 
  
 
  
 
  
 
 [39;1H 
  [39;7H[m[47;1H[K[47;1H:syn region Hup start="dd" end="hh" fold[41;1H[7m+  +--  7 lines: 4 dd ---------------------------------------------------------------------------------------------------------[m[42;4H9 ii[42;9H[K[43;4Ha jj[44;4Hb kk[44;9H[K[45;4Hlast[45;9H[K[46;4Hmanual 1 aa[39;7H[1;46r[1;1H[9M[1;47r[38;1H[7m   [m-1
[7m   [m3 cc
[7m   [m1 aa
[7m   [mmarker 2
[7m   [m1
[7m   [m1
[7m   [m0
[7m   [mindent 2
[7m   [m1[47;1H[K[46;4H[32;4H[47;1H:call append("$", "folding " . getline("."))[32;4H[31;4H[47;1H[K[47;1H:call append("$", getline("."))[31;4H[47;1H[K[47;1H:" test expression folding[31;4H[47;1H[K[47;1H:fun Flvl()
:    let l = getline(v:lnum)
:    if l =~ "bb$"
:        return 2
:      elseif l =~ "gg$"
:        return "s1"
:      elseif l =~ "ii$"
:        return ">2"
:      elseif l =~ "kk$"
:        return "0"
:      endif
:    return "="
:  endfun[1;1H[12L[1;1H[7m   [mk:call append("$", getline("."))
[7m   [m:" test expression folding
[7m   [m:fun Flvl()
[7m   [m  let l = getline(v:lnum)
[7m   [m  if l =~ "bb$"
[7m   [m    return 2
[7m   [m  elseif l =~ "gg$"
[7m   [m    return "s1"
[7m   [m  elseif l =~ "ii$"
[7m   [m    return ">2"
[7m   [m  elseif l =~ "kk$"
[7m   [m    return "0"[47;1H[K[31;4H[47;1H:set fdm=expr fde=Flvl()[30;1H[7m+  +-- 11 lines: 2 bb----------------------------------------------------------------------------------------------------------[m[31;4Hb kk[31;8H[K[32;1H[7m [m[2Clast[32;8H[K[33;4Hmanual 1 aa[34;4H-1[34;6H[K[35;4H3 cc[36;4H1 aa[37;6Hrker 2[37;13H[K[38;4H1[38;5H[K[39;4H1[39;6H[K[40;4H0[40;6H[K[41;4Hindent[43;4Hfolding 8 hh[44;4H    3 cc[45;5H[K[45;4H[1m~[46;4H~[30;4H[m[47;1H[K[47;1H/bb$[7msearch hit BOTTOM, continuing at TOP[30;1H--[m[1C  2 bb[30;10H[K[31;1H[7m||[m[1C    3 cc
[7m||[m[1C4 dd {{{
[7m||[m[1C5 ee {{{ }}}
[7m||[m[1C{{{
[7m||[m[1C6 ff }}}
[7m||[m[1C6 ff }}}
[7m||[m[1C7 gg[37;8H[K[38;1H[7m|[m[2C8 hh
[7m|+ +---  2 lines: 9 ii---------------------------------------------------------------------------------------------------------[m[40;4Hb kk[41;4Hlast[41;8H[K[42;4Hmanual 1 aa[43;4H-1[43;6H[K[44;4H3 cc[44;8H[K[45;4H1 aa[46;4Hmarker 2[30;8H[47;1H[K[47;1H:call append("$", "expr " . foldlevel("."))[30;8H[47;1H[K[47;1H/hh$[38;6H[47;1H[K[47;1H:call append("$", foldlevel("."))[38;6H[47;1H[K[47;1H/ii$[39;2H[7m-[m[1C9 ii[39;8H[K[40;1H[7m||[m[1Ca jj[41;4Hb kk[42;4Hlast[42;8H[K[43;4Hmanual 1 aa[44;4H-1[44;6H[K[45;4H3 cc[46;4H1 aa[46;8H[K[39;6H[47;1H[K[47;1H:call append("$", foldlevel("."))[39;6H[47;1H[K[47;1H/kk$[41;6H[47;1H[K[47;1H:call append("$", foldlevel("."))[41;6H[47;1H[K[47;1H:/^last/+1,$w! test.out"test.out" [47;12H[K[47;12H[New File] 16 lines, 86 characters written[41;6H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test46.failed test.ok test.out X* viminfo
cp test46.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test46.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test46.in" 27 lines, 431 characters[1;1HTests for multi-line regexps with ":s". vim: set ft=vim :

STARTTEST
:" test if replacing a line break works with a back reference
:/^1/,/^2/s/\n\(.\)/ \1/
:" test if inserting a line break works with a back reference
:/^3/,/^4/s/\(.\)$/\r\1/
:" test if replacing a line break with another line break works
:/^5/,/^6/s/\(\_d\{3}\)/x\1x/
:/^1/,$w! test.out
:qa!
ENDTEST

1 aa
bb
cc
2 dd
ee
3 ef
gh
4 ij
5 a8
8b c9
9d
6 e7
77f
xxxxx
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 8 lines, 292 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[12;1H
[47;1H[K[47;1H:so! Xdotest[13;1H[47;1H[K[47;1H:" test if replacing a line break works with a back reference[13;1H[47;1H[K[47;1H:/^1/,/^2/s/\n\(.\)/ \1/4 substitutions on 1 line[14;46r[14;1H[4M[1;47r[14;1H1 aa bb cc 2 dd ee[43;1H[1m~
~
~
~[m[47;1H[K[47;1H4 substitutions on 1 line[14;1H[47;1H[K[47;1H:" test if inserting a line break works with a back reference[14;1H[47;1H[K[47;1H:/^3/,/^4/s/\(.\)$/\r\1/3 substitutions on 3 lines[18;46r[18;1H[3L[1;47r[15;4H[K[16;1Hf[16;2H[K[17;1Hg[17;3H[K[18;1Hh
4 i
j[47;1H[K[47;1H3 substitutions on 3 lines[20;1H[47;1H[K[47;1H:" test if replacing a line break with another line break works[20;1H[47;1H[K[47;1H:/^5/,/^6/s/\(\_d\{3}\)/x\1x/3 substitutions on 2 lines[47;27H[K[21;4Hx8
8xb cx9
9xd
6 ex7
7x7f[47;1H[K[47;1H:/^1/,$w! test.out[7msearch hit BOTTOM, continuing at TOP[m"test.out" [47;12H[K[47;12H[New File] 13 lines, 70 characters written[25;1H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test47.failed test.ok test.out X* viminfo
cp test47.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test47.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test47.in" 44 lines, 1040 characters[1;1HTests for vertical splits and filler lines in diff mode

STARTTEST
:so small.vim
/^1
yG:new
pkdd:w! Xtest
ddGpkkrXoxxx[1m^[[m:w! Xtest2
:file Nop
ggoyyy[1m^[[mjjjozzzz[1m^[[m
:vert diffsplit Xtest
:vert diffsplit Xtest2
:" jump to second window for a moment to have filler line appear at start of
:" first window
[1m^W^W[mgg[1m^W[mpgg:let one = winline()
j:let one = one . "-" . winline()
j:let one = one . "-" . winline()
j:let one = one . "-" . winline()
j:let one = one . "-" . winline()
j:let one = one . "-" . winline()
[1m^W^W[mgg:let two = winline()
j:let two = two . "-" . winline()
j:let two = two . "-" . winline()
j:let two = two . "-" . winline()
j:let two = two . "-" . winline()
[1m^W^W[mgg:let three = winline()
j:let three = three . "-" . winline()
j:let three = three . "-" . winline()
j:let three = three . "-" . winline()
j:let three = three . "-" . winline()
j:let three = three . "-" . winline()
j:let three = three . "-" . winline()
[1m^W^W[m:call append("$", one)
:call append("$", two)
:call append("$", three)
:$-2,$w! test.out
:qa!
ENDTEST

1 aa
2 bb
3 cc
4 dd
5 ee
[1m~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 34 lines, 939 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[38;1H
[47;1H[K[47;1H:so! Xdotest[39;1H[47;1H[K[47;1H:so small.vim[39;1H[47;1H[K[47;1H/^1[40;1H[47;1H5 lines yanked[40;1H[47;1H[K[47;1H:new[1;1H[K[2;1H[1m~[m[3;2H[K[3;1H[1m~[m[4;2H[K[4;1H[1m~[m[5;2H[K[5;1H[1m~[m[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;2H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~[m[15;2H[K[15;1H[1m~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m
[1m[7m[No Name]                                                                                                                      [m[26;1Hj:let two = two . "-" . winline()[27;8Hwo = two . "-" . winline()[27;34H[K[28;1H[1m^W^W[mgg:let three = winline()[28;29H[K[33;1Hj:let three = three . "-" . winline()
j:let three = three . "-" . winline()
[1m^W^W[m:call append("$", one)
:call append("$", two)
:call append("$", three)
:$-2,$w! test.out
:qa!
ENDTEST[41;1H[K[42;1H1 aa
2 bb
3 cc
4 dd
[7mtest47.in                                                                                                                      [1;1H[m[47;1H5 more lines[2;1H1 aa
2 bb
3 cc
4 dd
5 ee[23;11H[1m[7m[+][2;1H[1;1H[1;22r[m[22;1H
[1;47r[22;1H[1m~[m[47;1H[K[1;1H[47;1H:w! Xtest"Xtest" [47;9H[K[47;9H[New File] 5 lines, 25 characters written[23;1H[1m[7mXtest         [1;1H[1;22r[m[22;1H
[1;47r[22;1H[1m~[m[23;7H[1m[7m[+][m[47;1H[K[1;1H



1 aa[4;1H[3;1HX[4;22r[4;1H[L[1;47r[4;1Hxxx[47;1H:w! Xtest2"Xtest2" [47;10H[K[47;10H[New File] 6 lines, 29 characters written[23;7H[1m[7m    [4;3H[m[47;1H[K[47;1H:file Nop"Nop" [Not edited] line 4 of 6 --66%-- col 3[23;1H[1m[7mNop   [4;3H[1;1H[2;22r[m[2;1H[L[1;47r[2;1Hyyy[23;5H[1m[7m[+][m[47;1H[K[2;3H
3 
X 
xx[6;22r[6;1H[L[1;47r[6;1Hzzzz
5 e[47;1H:vert diffsplit Xtest"Xtest" [47;9H[K[47;9H5 lines, 25 characters[1;1H[7m  [m[1m1 aa                                                         [m[7m|[m
[7m  [m2 bb[57C[7m|[m
[7m  [m[1m-------------------------------------------------------------[m[7m|[m
[7m  [m3 cc[57C[7m|[m
[7m  [m[7m4[m[1m dd                                                         [m[7m|[m
[7m  [m[1m-------------------------------------------------------------[m[7m|[m
[7m  [m[1m-------------------------------------------------------------[m[7m|[m
[7m  [m5 ee[57C[7m|[9;64H|[10;64H|[11;64H|[12;64H|[13;64H|[14;64H|[15;64H|[16;64H|[17;64H|[18;64H|[19;64H|[20;64H|[21;64H|[22;64H|[m[9;1H[7m  [m[1m-------------------------------------------------------------[m
[7m  
  
  
  
  
  
  
  
  
  
  
  
  [m[10;3H[1m~                                                            [11;3H~                                                            [12;3H~                                                            [13;3H~                                                            [14;3H~                                                            [15;3H~                                                            [16;3H~                                                            [17;3H~                                                            [18;3H~                                                            [19;3H~                                                            [20;3H~                                                            [21;3H~                                                            [22;3H~                                                            [m
[1m[7mXtest   [m[1;65H[7m  [m[1m-------------------------------------------------------------[m[2;65H[7m  [m2 bb[3;65H[7m  [m[1myyy                                                          [m[4;65H[7m  [m3 cc[5;65H[7m  [m[7mX[m[1m dd                                                         [m[6;65H[7m  [m[1mxxx                                                          [m[7;65H[7m  [m[1mzzzz                                                         [m[8;65H[7m  [m5 ee[9;65H[7m  [m[1m1 aa                                                         [m[10;65H[7m  [11;65H  [12;65H  [13;65H  [14;65H  [15;65H  [16;65H  [17;65H  [18;65H  [19;65H  [20;65H  [21;65H  [22;65H  [m[10;67H[1m~[11;67H~[12;67H~[13;67H~[14;67H~[15;67H~[16;67H~[17;67H~[18;67H~[19;67H~[20;67H~[21;67H~[22;67H~[m[23;65H[7mNop [+]                                                        [1;3H[m[47;1H[K[47;1H:vert diffsplit Xtest2"Xtest2" [47;10H[K[47;10H6 lines, 29 characters[m[H[2J[1;1H[7m  [m2 bb[36C[7m|[m
[7m  [m[1m----------------------------------------[m[7m|[m
[7m  [m3 cc[36C[7m|[m
[7m  [m[7mX[m[1m dd                                    [m[7m|[m
[7m  [m[1mxxx                                     [m[7m|[m
[7m  [m[1m----------------------------------------[m[7m|[m
[7m  [m5 ee[36C[7m|[m
[7m  [m[1m1 aa                                    [m[7m|[9;43H|[10;43H|[11;43H|[12;43H|[13;43H|[14;43H|[15;43H|[16;43H|[17;43H|[18;43H|[19;43H|[20;43H|[21;43H|[22;43H|[m[9;1H[7m  
  
  
  
  
  
  
  
  
  
  
  
  
  [m[9;3H[1m~                                       [10;3H~                                       [11;3H~                                       [12;3H~                                       [13;3H~                                       [14;3H~                                       [15;3H~                                       [16;3H~                                       [17;3H~                                       [18;3H~                                       [19;3H~                                       [20;3H~                                       [21;3H~                                       [22;3H~                                       [m
[1m[7mXtest2                                     [m[1;44H[7m  [m2 bb[36C[7m|[m[2;44H[7m  [m[1m----------------------------------------[m[7m|[m[3;44H[7m  [m3 cc[36C[7m|[m[4;44H[7m  [m[7m4[m[1m dd                                    [m[7m|[m[5;44H[7m  [m[1m----------------------------------------[m[7m|[m[6;44H[7m  [m[1m----------------------------------------[m[7m|[m[7;44H[7m  [m5 ee[36C[7m|[8;86H|[9;86H|[10;86H|[11;86H|[12;86H|[13;86H|[14;86H|[15;86H|[16;86H|[17;86H|[18;86H|[19;86H|[20;86H|[21;86H|[22;86H|[m[8;44H[7m  [m[1m----------------------------------------[m[9;44H[7m  [10;44H  [11;44H  [12;44H  [13;44H  [14;44H  [15;44H  [16;44H  [17;44H  [18;44H  [19;44H  [20;44H  [21;44H  [22;44H  [m[9;46H[1m~                                       [10;46H~                                       [11;46H~                                       [12;46H~                                       [13;46H~                                       [14;46H~                                       [15;46H~                                       [16;46H~                                       [17;46H~                                       [18;46H~                                       [19;46H~                                       [20;46H~                                       [21;46H~                                       [22;46H~                                       [m[23;44H[7mXtest                                      [m[1;87H[7m  [m2 bb[2;87H[7m  [m[1myyy                                    [m[3;87H[7m  [m3 cc[4;87H[7m  [m[7mX[m[1m dd                                   [m[5;87H[7m  [m[1mxxx                                    [m[6;87H[7m  [m[1mzzzz                                   [m[7;87H[7m  [m5 ee[8;87H[7m  [m[1m1 aa                                   [m[9;87H[7m  [10;87H  [11;87H  [12;87H  [13;87H  [14;87H  [15;87H  [16;87H  [17;87H  [18;87H  [19;87H  [20;87H  [21;87H  [22;87H  [m[9;89H[1m~[10;89H~[11;89H~[12;89H~[13;89H~[14;89H~[15;89H~[16;89H~[17;89H~[18;89H~[19;89H~[20;89H~[21;89H~[22;89H~[m[23;87H[7mNop [+]                                  [m[24;1Hj:let two = two . "-" . winline()
j:let two = two . "-" . winline()
j:let two = two . "-" . winline()
j:let two = two . "-" . winline()
[1m^W^W[mgg:let three = winline()
j:let three = three . "-" . winline()
j:let three = three . "-" . winline()
j:let three = three . "-" . winline()
j:let three = three . "-" . winline()
j:let three = three . "-" . winline()
j:let three = three . "-" . winline()
[1m^W^W[m:call append("$", one)
:call append("$", two)
:call append("$", three)
:$-2,$w! test.out
:qa!
ENDTEST

1 aa
2 bb
3 cc
4 dd
[7mtest47.in                                                                                                                      [1;3H[47;1H[m:" jump to second window for a moment to have filler line appear at start of[1;3H[47;1H[K[47;1H:" first window[1;3H[23;1H[7mXtest2                                     [m[1m[7mXtest                                      [1;46H[m[1;3H[1m----------------------------------------[m[2;3H2 bb                                    [3;3H[1m----------------------------------------[m[4;3H3 cc                                    [5;3H[7mX[m[1m dd                                    [6;3Hxxx                                     [7;3H----------------------------------------[m[8;3H5 ee                                    [9;3H[1m1 aa                                    [m[1;1H[43C                                          [2;44H[7m  [m2 bb                                    [3;44H[7m  [m[1m----------------------------------------[m[4;44H[7m  [m3 cc                                    [5;44H[7m  [m[7m4[m[1m dd                                    [m[6;44H[7m  [m[1m----------------------------------------[m[7;44H[7m  [m[1m----------------------------------------[m[8;44H[7m  [m5 ee                                    [9;44H[7m  [m[1m----------------------------------------[m[10;44H[7m  [m[1m~                                       [m[11;44H[7m  [m[1m~                                       [m[12;44H[7m  [m[1m~                                       [m[13;44H[7m  [m[1m~                                       [m[14;44H[7m  [m[1m~                                       [m[15;44H[7m  [m[1m~                                       [m[16;44H[7m  [m[1m~                                       [m[17;44H[7m  [m[1m~                                       [m[18;44H[7m  [m[1m~                                       [m[19;44H[7m  [m[1m~                                       [m[20;44H[7m  [m[1m~                                       [m[21;44H[7m  [m[1m~                                       [m[22;44H[7m  [m[1m~                                       [m[1;44H[7m  [m[1m1 aa                                    [3C---------------------------------------[m[2;89H2 bb[2;93H[K[3;89H[1myyy                                    [m[4;89H3 cc[4;93H[K[5;89H[7mX[m[1m dd                                   [6;89Hxxx                                    [7;89Hzzzz                                   [m[8;89H5 ee[8;93H[K[9;89H[1m1 aa                                   [m[47;1H[K[1;46H[23;1H[1m[7mXtest2                                     [m[7mXtest                                      [2;3H[47;1H[m:let one = winline()[2;3H[4;3H[47;1H[K[47;1H:let one = one . "-" . winline()[4;3H[5;3H[47;1H[K[47;1H:let one = one . "-" . winline()[5;3H[6;3H[47;1H[K[47;1H:let one = one . "-" . winline()[6;3H[8;3H[47;1H[K[47;1H:let one = one . "-" . winline()[8;3H[9;3H[47;1H[K[47;1H:let one = one . "-" . winline()[9;3H[23;1H[7mXtest2                                     [m[1m[7mXtest                                      [1;46H[m[47;1H[K[47;1H:let two = winline()[1;46H[2;46H[47;1H[K[47;1H:let two = two . "-" . winline()[2;46H[4;46H[47;1H[K[47;1H:let two = two . "-" . winline()[4;46H[5;46H[47;1H[K[47;1H:let two = two . "-" . winline()[5;46H[8;46H[47;1H[K[47;1H:let two = two . "-" . winline()[8;46H[23;44H[7mXtest                                      [m[1m[7mNop [+]                                  [8;92H[2;89H[m[47;1H[K[47;1H:let three = winline()[2;89H[3;89H[47;1H[K[47;1H:let three = three . "-" . winline()[3;89H[4;89H[47;1H[K[47;1H:let three = three . "-" . winline()[4;89H[5;89H[47;1H[K[47;1H:let three = three . "-" . winline()[5;89H[6;89H[47;1H[K[47;1H:let three = three . "-" . winline()[6;89H[7;89H[47;1H[K[47;1H:let three = three . "-" . winline()[7;89H[8;89H[47;1H[K[47;1H:let three = three . "-" . winline()[8;89H[23;87H[7mNop [+]                                  [m[46;1H[1m[7mtest47.in                                                                                                                      [42;1H[m[47;1H[K[47;1H:call append("$", one)[46;11H[1m[7m[+][42;1H[m[47;1H[K[47;1H:call append("$", two)[42;1H[47;1H[K[47;1H:call append("$", three)[42;1H[47;1H[K[47;1H:$-2,$w! test.out"test.out" [47;12H[K[47;12H[New File] 3 lines, 36 characters written[42;1H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test48.failed test.ok test.out X* viminfo
cp test48.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test48.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test48.in" 74 lines, 1452 characters[1;1HThis is a test of 'virtualedit'.

STARTTEST
:so small.vim
:set noswf
:set ve=all
-dgg
:"
:"   Insert "keyword keyw", ESC, C CTRL-N, shows "keyword ykeyword".
:"    Repeating CTRL-N fixes it. (Mary Ellen Foster)
2/w
C[1m^N^[[m
:"
:"   Using "C" then then <CR> moves the last remaining character to the next
:"    line.  (Mary Ellen Foster)
j^/are
C[1m^M[mare belong to vim[1m^[[m
:"
:"   When past the end of a line that ends in a single character "b" skips
:"    that word.
^$15lbC7[1m^[[m
:"
:"   Make sure 'i' works
$4li<-- should be 3 ' '[1m^[[m
:"
:"   Make sure 'C' works
$4lC<-- should be 3 ' '[1m^[[m
:"
:"   Make sure 'a' works
$4la<-- should be 4 ' '[1m^[[m
:"
:"   Make sure 'A' works
$4lA<-- should be 0 ' '[1m^[[m
:"
:"   Make sure 'D' works
$4lDi<-- 'D' should be intact[1m^[[m
:"
:"   Test for yank bug reported by Mark Waggoner.
:set ve=block
^2w[1m^V[m3jyGp
:"
:" Test "r" beyond the end of the line
:set ve=all
/^"r"
$5lrxa<-- should be 'x'[1m^[[m
:"[1;1H[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 54 lines, 1250 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[1;46r[1;1H[12M[1;47r[35;1H:"   Test to make sure 'x' can delete control characters
:set display=uhex
^xxxxxxi[This line should contain only the text between the brackets.][1m^[[m
:set display=
:"
:"   Test for ^Y/^E due to bad w_virtcol value, reported by
:"   Roy <royl@netropolis.net>.
^O[1m^[[m3li[1m^E^[[m4li[1m^E^[[m4li[1m^E[m   <-- should show the name of a noted text editor[1m^[[m
^o[1m^[[m4li[1m^Y^[[m4li[1m^Y^[[m4li[1m^Y[m   <-- and its version number[1m^[[m-dd
:"
:wq! test.out
ENDTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1Hkeyword keyw
:so! Xdotest[46;1H[47;1H[K[47;1H:so small.vim[46;1H[47;1H[K[47;1H:set noswf[46;1H[47;1H[K[47;1H:set ve=all[46;1H[45;1H

58 fewer lines[1;1Hkeyword keyw[1;13H[K[2;1Hall your base are belong to us[2;31H[K[3;1H1 2 3 4 5 6
'i'[4;4H[K[5;1H'C'
'a'[6;6H[K[7;1H'A'[7;7H[K[8;1H'D'[8;4H[K[9;1Hthis is a test
this is a test[10;16H[K[11;1Hthis is a test[11;16H[K[12;1H"r"
a[1m^V[mb[1m^M[msd[13;9H[K[14;1Habcv6efi.him0kl[14;16H[K[15;1H[K[16;1H[K[17;2H[K[17;1H[1m~[m[18;2H[K[18;1H[1m~[m[19;2H[K[19;1H[1m~[m[20;2H[K[20;1H[1m~[m[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~[m[36;2H[K[36;1H[1m~[m[37;2H[K[37;1H[1m~[m[38;2H[K[38;1H[1m~[m[39;2H[K[39;1H[1m~[m[40;2H[K[40;1H[1m~[m[41;2H[K[41;1H[1m~[m[42;2H[K[42;1H[1m~[m[43;2H[K[43;1H[1m~[m[44;2H[K[44;1H[1m~[m[45;2H[K[45;1H[1m~[m[46;2H[K[46;1H[1m~[1;1H
[m[47;1H[K[47;1H:"[2;1H[47;1H[K[47;1H:"   Insert "keyword keyw", ESC, C CTRL-N, shows "keyword ykeyword".[2;1H[47;1H[K[47;1H:"    Repeating CTRL-N fixes it. (Mary Ellen Foster)[2;1H[47;1H[K[47;1H/w[7msearch hit BOTTOM, continuing at TOP[1;12H[m$[47;1H[7mScanning tags.[m[47;15H[K[47;1HThe only match[1;16H[47;1H[K[1;12Hword[2;15H[47;1H:"[2;15H[47;1H[K[47;1H:"   Using "C" then then <CR> moves the last remaining character to the next[2;15H[47;1H[K[47;1H:"    line.  (Mary Ellen Foster)[2;15H[3;15H[47;1H[K[47;1H/are[7msearch hit BOTTOM, continuing at TOP[2;15H[m[15C$[2;15H[K[3;1Hare belong to vim
1 2 3 4 5 6
'i
'C
'a
'A
'D'[9;4H[K[12;1Hthis is a test
"r"[13;4H[K[14;2H[1m^V[mb[1m^M[msd[14;9H[K[15;1Habcv6efi.him0kl[17;1H[K[3;17H[4;17H[47;1H[K[47;1H:"[4;17H[47;1H[K[47;1H:"   When past the end of a line that ends in a single character "b" skips[4;17H[47;1H[K[47;1H:"    that word.[4;17H[10C[15C[4;11H$7[5;11H[47;1H[K[47;1H:"[5;11H[47;1H[K[47;1H:"   Make sure 'i' works[5;11H'i'   <-- should be 3 ' '[6;25H[47;1H[K[47;1H:"[6;25H[47;1H[K[47;1H:"   Make sure 'C' works[6;25H'C'   $<-- should be 3 ' '[7;25H[47;1H[K[47;1H:"[7;25H[47;1H[K[47;1H:"   Make sure 'a' works[7;25H'a'    <-- should be 4 ' '[8;26H[47;1H[K[47;1H:"[8;26H[47;1H[K[47;1H:"   Make sure 'A' works[8;26H'A'   <-- should be 0 ' '[9;22H[47;1H[K[47;1H:"[9;22H[47;1H[K[47;1H:"   Make sure 'D' works[9;22H'D'   <-- 'D' should be intact[10;30H[47;1H[K[47;1H:"[10;30H[47;1H[K[47;1H:"   Test for yank bug reported by Mark Waggoner.[10;30H[47;1H[K[47;1H:set ve=block[10;14H[8C[7ma[11;9Ha[12;9Ha[13;9H[m[10;9Ha[11;9Ha[12;9Ha[47;1Hblock of 4 lines yanked[10;9H[17;1H[47;1H3 more lines[47;13H[K[17;1Ha
a
a
 [17;1H
[47;1H[K[47;1H:"[18;1H[47;1H[K[47;1H:" Test "r" beyond the end of the line[18;1H[47;1H[K[47;1H:set ve=all[18;1H[47;1H[K[47;1H/^"r"[7msearch hit BOTTOM, continuing at TOP[13;1H[m"r"    xx<-- should be 'x'[14;25H[47;1H[K[47;1H:"[14;25H[47;1H[K[47;1H:"   Test to make sure 'x' can delete control characters[14;25H[47;1H[K[47;1H:set display=uhex[14;2H[1m<16>[mb[1m<0d>[msd[16C[1m<16>[mb[1m<0d>[msd[14;12H[K[14;1Hb[1m<0d>[msd[14;8H[K[14;1H[1m<0d>[msd[14;7H[K[14;1Hsd[14;3H[K[14;1Hd[14;2H[K[14;1H[14;1H[K[14;1H[This line should contain only the text between the brackets.][15;62H[47;1H[K[47;1H:set display=[15;62H[47;1H[K[47;1H:"[15;62H[47;1H[K[47;1H:"   Test for ^Y/^E due to bad w_virtcol value, reported by[15;62H[47;1H[K[47;1H:"   Roy <royl@netropolis.net>.[15;62H[15;46r[15;1H[L[1;47r[47;1H[K[15;1H   vv   ii   m   <-- should show the name of a noted text editor[16;62H[17;46r[17;1H[L[1;47r[17;1H    66   ..   0   <-- and its version number[16;1H[16;46r[46;1H
[1;47r[46;1H[1m~[16;5H
[m    [47;1H:"[17;5H[47;1H[K[47;1H:wq! test.out"test.out" [47;12H[K[47;12H[New File] 21 lines, 443 characters written[?1l>
rm -rf X* test.ok viminfo
rm -rf test49.failed test.ok test.out X* viminfo
cp test49.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test49.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test49.in" 13 lines, 320 characters[1;1HThis is a test of the script language.

If after adding a new test, the test output doesn't appear properly in
test49.failed, try to add one ore more "G"s at the line before ENDTEST.

STARTTEST
:so small.vim
:se nocp nomore viminfo+=nviminfo
:so test49.vim
GGGGGGGGGG"rp:.-,$wq! test.out
ENDTEST

Results of test49.vim:
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[6;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[7;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 4 lines, 94 characters written[7;1H[47;1H[K[47;1H:set ff& cpo+=A[7;1H[47;1H/ENDTEST[47;10H[K[47;1H[11;1H
[47;1H[K[47;1H:so! Xdotest[12;1H[47;1H[K[47;1H:so small.vim[12;1H[47;1H[K[47;1H:se nocp nomore viminfo+=nviminfo[12;1H[47;1H[K[47;1H:so test49.vim[7mError detected while processing function G:[m
[4mline   16:[m
[7mE171: Missing :endif:     endwhile[m
*** Test   1: OK (34695)
   function F()
1      Xpath 1[37C" X: 1
2      let first = 1
3      XloopINIT 2 8
4      while 1
5[10CXloop 1[33C" X: 2      + 0 * 16
6[10Cif first
7[14CXloop 2[29C" X: 4      + 0 * 32
8[14Clet first = 0
9[14CXloopNEXT
10[13Cbreak
11[9Celse
12[13CXloop 4[29C" X: 0      + 0 * 64
13[13Creturn
14[9Cendif
15     endwhile
   endfunction[31;1H"/tmp/v466537/0"[32;1H[K[33;1H[K[34;1H[K[35;1H[K[36;1H[K[37;1H[K[38;1H[K[39;1H[K[40;1H[K[41;1H[K[42;1H[K[43;1H[K[44;1H[K[45;1H[K[46;1H[K[47;4H[K[31;18H[noeol] 18L, 528C
15 substitutions on 15 lines
E486: Pattern not found: ^\s*$"/tmp/v466537/0" [33;19H[K[33;18H15L, 476C written"test49.in" [33;13H[K[33;13H13L, 320C
   function G()
1      Xpath 256[35C" X: 256    + 0 * 2048
2      let first = 1
3      XloopINIT 512 8
4      while 1
5[10CXloop 1[33C" X: 512    + 0 * 4096
6[10Cif first
7[14CXloop 2[29C" X: 1024   + 0 * 8192
8[14Clet first = 0
9[14CXloopNEXT
10[13Cbreak
11[9Celse
12[13CXloop 4[29C" X: 0      + 0 * 16384
13[13Creturn
14[9Cendif
15[9Cif 1    " unmatched :if
16     endwhile
   endfunction[30;1H"/tmp/v466537/1"[31;1H[K[32;1H[K[33;1H[K[34;1H[K[35;1H[K[36;1H[K[37;1H[K[38;1H[K[39;1H[K[40;1H[K[41;1H[K[42;1H[K[43;1H[K[44;1H[K[45;1H[K[46;1H[K[47;4H[K[30;18H[noeol] 19L, 588C
16 substitutions on 16 lines
E486: Pattern not found: ^\s*$"/tmp/v466537/1" [32;19H[K[32;18H16L, 534C written"test49.in" [32;13H[K[32;13H13L, 320C
[7mError detected while processing /tmp/v466537/1:[m
[4mline   16:[m
[7mE171: Missing :endif:      endwhile[m
*** Test   2: OK (34695)
*** Test   3: OK (1384648195)
*** Test   4: OK (32883)
   function F()
1      if 1
2[10CXpath 1[33C" X: 1
3[10Clet loops = 3
4[10CXloopINIT 2 16
5[10Cwhile loops > 0[25C"    3:  2:     1:
6[14CXloop 1[29C" X: 2 + 2*16 + 0*16*16
7[14Cif (loops == 2)
8[18CXloop 2[25C" X:     4*16
9[18Creturn
10[17CXloop 4[25C" X:     0
11[13Cendif
12[13CXloop 8[29C" X: 16
13[13Clet loops = loops - 1
14[13CXloopNEXT
15[9Cendwhile
16[9CXpath 8192[30C" X: 0
17     else
18[9CXpath 16384[29C" X: 0
19     endif
   endfunction[27;1H"/tmp/v466537/2"[28;1H[K[29;1H[K[30;1H[K[31;1H[K[32;1H[K[33;1H[K[34;1H[K[35;1H[K[36;1H[K[37;1H[K[38;1H[K[39;1H[K[40;1H[K[41;1H[K[42;1H[K[43;1H[K[44;1H[K[45;1H[K[46;1H[K[47;4H[K[27;18H[noeol] 22L, 784C
19 substitutions on 19 lines
E486: Pattern not found: ^\s*$"/tmp/v466537/2" [29;19H[K[29;18H19L, 724C written"test49.in" [29;13H[K[29;13H13L, 320C
*** Test   5: OK (32883)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"/tmp/v466537/3" [30;18H[K[30;18H[New] 53L, 1582C written[30;18H[K[30;18H14L, 358C appended[30;18H[K[30;18H26L, 824C appended[30;18H[K[30;18H34L, 986C appended
:!echo 'source /tmp/v466537/3' >/tmp/v466537/4[?1l>[32;1H[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/4" [47;18H[K[47;18H130L, 2431C appended[47;18H[K[47;18H131L, 2453C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/5[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult =
"/tmp/v466537/5"' -S /tmp/v466537/4[?1l>[47;1H
[?1h=[47;1H"/tmp/v466537/5" 21L, 130C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test   6: OK (603978947)
[7mError detected while processing /sources/vim70/src/testdir/test49.vim:[m
[4mline  976:[m
[7mE492: Not an editor command: ^Iasdf[m
[4mline  988:[m
[7mE492: Not an editor command: ^Iasdf[m
[4mline  996:[m
[7mE492: Not an editor command: asdf[m
[4mline  999:[m
[7mE492: Not an editor command: asdf | Xpath 32768^I^I^I^I" X: 0[m
*** Test   7: OK (90563)
[7mError detected while processing function F:[m
[4mline    5:[m
[7mE492: Not an editor command: ^I    asdf[m
[4mline    7:[m
[7mE492: Not an editor command: ^I    asdf | Xpath 8^I^I^I" X: 0[m
[4mline   19:[m
[7mE492: Not an editor command: ^I    asdf[m
[4mline   21:[m
[7mE492: Not an editor command: ^I    asdf | Xpath 2048^I^I^I" X: 0[m
[4mline   29:[m
[7mE121: Undefined variable: novar[m
[7mE15: Invalid expression: novar^I^I" returns (default return value 0)[m
[7mError detected while processing function G:[m
[4mline    5:[m
[7mE492: Not an editor command: ^I    asdf^I^I" returns -1[m
[7mError detected while processing function H:[m
[4mline    5:[m
[7mE492: Not an editor command: ^I    asdf^I^I" returns -1[m
*** Test   8: OK (562493431)
[7mError detected while processing function F..G..H..I:[m
[4mline    2:[m
[7mE492: Not an editor command:     asdf^I^I" error[m
*** Test   9: OK (363)
[7mError detected while processing /sources/vim70/src/testdir/test49.vim:[m
[4mline 1201:[m
[7mE15: Invalid expression: | strlen("\"") | Xpath 512^I^I" X: 0[m
[7mE15: Invalid expression: 1 ||| strlen("\"") | Xpath 512^I^I" X: 0[m
[4mline 1211:[m
[7mE15: Invalid expression: | strlen("\"") | Xpath 8192^I^I" X: 0[m
[7mE15: Invalid expression: 1 ||| strlen("\"") | Xpath 8192^I^I" X: 0[m
[4mline 1220:[m
[7mE15: Invalid expression: | strlen("\"") | Xpath 131072^I^I" X: 0[m
[7mE15: Invalid expression: 1 ||| strlen("\"") | Xpath 131072^I^I" X: 0[m
*** Test  10: OK (559615)
[4mline 1252:[m
[7mE492: Not an editor command:     asdf^I^I" error[m
*** Test  11: OK (2049)
1
[4mline 1330:[m
[7mE492: Not an editor command:     asdf^I^I" error[m
[4mline 1338:[m
[7mE492: Not an editor command:     asdf^I^I" error[m
*** Test  12: OK (352256)
[4mline 1357:[m
[7mE121: Undefined variable: asdf[m
[7mE15: Invalid expression: asdf[m
[4mline 1368:[m
[7mE121: Undefined variable: asdf[m
[7mE15: Invalid expression: asdf | Xpath 32 | endwhile | Xpath 64^I" X: 0[m
*** Test  13: OK (145)
[7mError detected while processing function F:[m
[4mline    8:[m
[7mE121: Undefined variable: g:boolvar[m
[7mE15: Invalid expression: g:boolvar^I" possibly undefined[m
*** Test  14: OK (42413)
[7mE121: Undefined variable: g:boolvar[m
[7mE15: Invalid expression: g:boolvar | Xloop 8 | else | Xloop 16 | endif    " X: 8[m
*** Test  15: OK (42413)
[4mline    5:[m
[7mE583: multiple :else:     else^I^I[m
[7mError detected while processing function G:[m
[4mline    5:[m
[7mE584: :elseif after :else:     elseif 1^I^I" aborts function[m
[7mError detected while processing function H:[m
[4mline    7:[m
[7mE583: multiple :else:     else^I^I[m
[7mError detected while processing function I:[m
[4mline    7:[m
[7mE584: :elseif after :else:     elseif 1^I^I" aborts function[m
*** Test  16: OK (8722)
[7mError detected while processing function F:[m
[4mline   18:[m
[7mE171: Missing :endif:     endwhile^I[m
[7mE171: Missing :endif:     endwhile^I[m
[4mline   34:[m
[7mE171: Missing :endif:     endwhile^I[m
[7mE171: Missing :endif:     endwhile^I[m
[7mE171: Missing :endif:     endwhile^I[m
[4mline   47:[m
[7mE580: :endif without :if: ^Iendif^I[m
[7mE580: :endif without :if: ^Iendif^I[m
[7mE580: :endif without :if: ^Iendif^I[m
[7mError detected while processing /sources/vim70/src/testdir/test49.vim:[m
[4mline 1626:[m
[7mE171: Missing :endif: endwhile [m
*** Test  17: OK (285127993)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/6[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/6" [47;18H[K[47;18H16L, 304C appended[47;18H[K[47;18H17L, 326C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/7[?1l>[47;1H
[?1h=[47;1H:!echo 'q[1m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResul
[46;127Ht[47;2H= "/tmp/v466537/7"' -c 'breakadd file 8 /tmp/v466537/6' -S /tmp/v466537/6[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/7" 3L, 6C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/8[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/8" [47;18H[K[47;18H6L, 127C appended[47;18H[K[47;18H7L, 149C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/9[?1l>[47;1H
[?1h=[47;1H:!echo 'q[1m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResul
[46;127Ht[47;2H= "/tmp/v466537/9"' -c 'breakadd file 4 /tmp/v466537/8' -S /tmp/v466537/8[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/9" 1L, 5C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/10[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/10" [47;19H[K[47;19H21L, 486C appended[47;19H[K[47;19H22L, 508C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/11[?1l>[47;1H
[?1h=[47;1H:!echo 'q[1m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResul
[46;127Ht[47;2H= "/tmp/v466537/11"' -c 'breakadd func 7 F' -S /tmp/v466537/10[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/11" 3L, 18C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/12[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/12" [47;19H[K[47;19H13L, 364C appended[47;19H[K[47;19H14L, 386C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/13[?1l>[47;1H
[?1h=[47;1H:!echo 'q[1m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResul
[46;127Ht[47;2H= "/tmp/v466537/13"' -c 'breakadd func 3 G' -S /tmp/v466537/12[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/13" 1L, 9C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  18: OK (67224583)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/14[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/14" [47;19H[K[47;19H12L, 201C appended[47;19H[K[47;19H13L, 223C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/15[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult =
"/tmp/v466537/15"' -S /tmp/v466537/14[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/15" 2L, 4C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/16[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/16" [47;19H[K[47;19H12L, 205C appended[47;19H[K[47;19H13L, 227C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/17[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult =
"/tmp/v466537/17"' -S /tmp/v466537/16[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/17" 2L, 7C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/18[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/18" [47;19H[K[47;19H6L, 122C appended[47;19H[K[47;19H7L, 144C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/19[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult =
"/tmp/v466537/19"' -S /tmp/v466537/18[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/19" 1L, 5C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/20[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/20" [47;19H[K[47;19H8L, 176C appended[47;19H[K[47;19H9L, 198C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/21[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult =
"/tmp/v466537/21"' -S /tmp/v466537/20[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/21" 1L, 6C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/22[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/22" [47;19H[K[47;19H10L, 215C appended[47;19H[K[47;19H11L, 237C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/23[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult =
"/tmp/v466537/23"' -S /tmp/v466537/22[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/23" 1L, 8C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/24[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/24" [47;19H[K[47;19H7L, 149C appended[47;19H[K[47;19H8L, 171C[47;19H[K[47;19H8L, 170C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/25[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult =
"/tmp/v466537/25"' -S /tmp/v466537/24[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/25" 1L, 9C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  19: OK (69275973)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/26[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/26" [47;19H[K[47;19H9L, 135C appended[47;19H[K[47;19H10L, 157C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/27[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult =
"/tmp/v466537/27"' -S /tmp/v466537/26[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/27" 2L, 4C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/28[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/28" [47;19H[K[47;19H10L, 155C appended[47;19H[K[47;19H11L, 177C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/29[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult =
"/tmp/v466537/29"' -S /tmp/v466537/28[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/29" 3L, 8C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/30[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/30" [47;19H[K[47;19H12L, 204C appended[47;19H[K[47;19H13L, 226C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/31[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult =
"/tmp/v466537/31"' -S /tmp/v466537/30[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/31" 4L, 18C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/32[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/32" [47;19H[K[47;19H12L, 214C appended[47;19H[K[47;19H13L, 236C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/33[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult =
"/tmp/v466537/33"' -S /tmp/v466537/32[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/33" 4L, 22C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/34[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/34" [47;19H[K[47;19H12L, 211C appended[47;19H[K[47;19H13L, 233C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/35[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult =
"/tmp/v466537/35"' -S /tmp/v466537/34[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/35" 3L, 22C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/36[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/36" [47;19H[K[47;19H14L, 263C appended[47;19H[K[47;19H15L, 285C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/37[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult =
"/tmp/v466537/37"' -S /tmp/v466537/36[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/37" 4L, 34C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/38[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/38" [47;19H[K[47;19H14L, 277C appended[47;19H[K[47;19H15L, 299C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/39[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult =
"/tmp/v466537/39"' -S /tmp/v466537/38[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/39" 4L, 40C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  20: OK (1874575085)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/40[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/40" [47;19H[K[47;19H58L, 1022C appended[47;19H[K[47;19H59L, 1044C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/41[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult =
"/tmp/v466537/41"' -S /tmp/v466537/40[?1l>[47;1H
[?1h=[47;1H"/tmp/v466537/41" 9L, 56C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  21: OK (147932225)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/42[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/42" [47;19H[K[47;19H23L, 418C appended[47;19H[K[47;19H24L, 440C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/43[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult =
"/tmp/v466537/43"' -S /tmp/v466537/42[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/43" 1L, 2C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/44[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/44" [47;19H[K[47;19H23L, 437C appended[47;19H[K[47;19H24L, 459C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/45[?1l>[47;1H
[?1h=[47;1H:!echo 'q[1m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResul
[46;127Ht[47;2H= "/tmp/v466537/45"' -c 'breakadd func 2 Interrupt' -S /tmp/v466537/44[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/45" 1L, 3C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/46[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/46" [47;19H[K[47;19H21L, 386C appended[47;19H[K[47;19H22L, 408C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/47[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult =
"/tmp/v466537/47"' -S /tmp/v466537/46[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/47" 1L, 5C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  22: OK (4161)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/48[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/48" [47;19H[K[47;19H25L, 432C appended[47;19H[K[47;19H26L, 454C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/49[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult =
"/tmp/v466537/49"' -S /tmp/v466537/48[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/49" 3L, 8C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  23: OK (49)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/50[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/50" [47;19H[K[47;19H16L, 392C appended[47;19H[K[47;19H17L, 414C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/51[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult =
"/tmp/v466537/51"' -S /tmp/v466537/50[?1l>[47;1H
[?1h=[47;1H"/tmp/v466537/51" 3L, 7C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  24: OK (41)
*** Test  25: OK (260177811)
*** Test  26: OK (1681500476)
*** Test  27: OK (1996459)
   function F()
1      try
2[10CXpath 1[33C" X: 1
3[10Ctry
4[14CXpath 2[29C" X: 2
5[14Creturn
6[14CXpath 4[29C" X: 0
7[10Cfinally
8[14CXpath 8[29C" X: 8
9[10Cendtry
10[9CXpath 16[32C" X: 0
11     finally
12[9CXpath 32[32C" X: 32
13     endtry
14     Xpath 64[36C" X: 0
   endfunction[32;1H"/tmp/v466537/52"[33;1H[K[34;1H[K[35;1H[K[36;1H[K[37;1H[K[38;1H[K[39;1H[K[40;1H[K[41;1H[K[42;1H[K[43;1H[K[44;1H[K[45;1H[K[46;1H[K[47;4H[K[32;19H[noeol] 17L, 552C
14 substitutions on 14 lines
E486: Pattern not found: ^\s*$"/tmp/v466537/52"[34;19H[K[34;19H14L, 502C written"test49.in" [34;13H[K[34;13H13L, 320C
   function G()
1      try
2[10CXpath 128[31C" X: 128
3[10Creturn
4[10CXpath 256[31C" X: 0
5      finally
6[10CXpath 512[31C" X: 512
7[10Ccall F()
8[10CXpath 1024[30C" X: 1024
9      endtry
10     Xpath 2048[34C" X: 0
   endfunction[35;1H"/tmp/v466537/53"[36;1H[K[37;1H[K[38;1H[K[39;1H[K[40;1H[K[41;1H[K[42;1H[K[43;1H[K[44;1H[K[45;1H[K[46;4H[K[35;19H[noeol] 13L, 406C
10 substitutions on 10 lines
E486: Pattern not found: ^\s*$"/tmp/v466537/53"[37;19H[K[37;19H10L, 378C written"test49.in" [37;13H[K[37;13H13L, 320C
   function H()
1      try
2[10CXpath 4096[30C" X: 4096
3[10Ccall G()
4[10CXpath 8192[30C" X: 8192
5      finally
6[10CXpath 16384[29C" X: 16384
7[10Creturn
8[10CXpath 32768[29C" X: 0
9      endtry
10     Xpath 65536[33C" X: 0
   endfunction[36;1H"/tmp/v466537/54"[37;1H[K[38;1H[K[39;1H[K[40;1H[K[41;1H[K[42;1H[K[43;1H[K[44;1H[K[45;1H[K[46;1H[K[47;4H[K[36;19H[noeol] 13L, 409C
10 substitutions on 10 lines
E486: Pattern not found: ^\s*$"/tmp/v466537/54"[38;19H[K[38;19H10L, 381C written"test49.in" [38;13H[K[38;13H13L, 320C
*** Test  28: OK (1996459)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/55[?1l>[41;1H[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/55" [47;19H[K[47;19H39L, 721C appended[47;19H[K[47;19H40L, 743C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/56[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult =
"/tmp/v466537/56"' -S /tmp/v466537/55[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/56" 6L, 21C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/57[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/57" [47;19H[K[47;19H23L, 509C appended[47;19H[K[47;19H24L, 531C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/58[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult =
"/tmp/v466537/58"' -S /tmp/v466537/57[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/58" 4L, 34C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  29: OK (170428555)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/59[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/59" [47;19H[K[47;19H60L, 1101C appended[47;19H[K[47;19H61L, 1123C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/60[?1l>[47;1H
[?1h=[47;1H:!echo 'q[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let Extr
[46;127Ha[47;1HVimResult = "/tmp/v466537/60"' -c 'breakadd func 3 F' -c 'breakadd file 19 /tmp/v466537/59' -c 'breakadd file 31 /tmp/v466537/
[46;127H5[47;1H9' -S /tmp/v466537/59[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/60" 16L, 89C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  30: OK (190905173)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/61[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/61" [47;19H[K[47;19H60L, 1122C appended[47;19H[K[47;19H61L, 1144C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/62[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult =
"/tmp/v466537/62"' -S /tmp/v466537/61[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/62" 16L, 89C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  31: OK (190905173)
*** Test  32: OK (354833067)
*** Test  33: OK (1216907538)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/63[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/63" [47;19H[K[47;19H63L, 1288C appended[47;19H[K[47;19H64L, 1310C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/64[?1l>[47;1H
[?1h=[47;1H:!echo 'q[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c
[46;127H'[47;1Hlet ExtraVimResult = "/tmp/v466537/64"' -c 'breakadd func 16 C' -S /tmp/v466537/63[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/64" 17L, 127C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  34: OK (2146584868)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/65[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/65" [47;19H[K[47;19H63L, 1285C appended[47;19H[K[47;19H64L, 1307C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/66[?1l>[47;1H
[?1h=[47;1H:!echo 'q[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c
[46;127H'[47;1Hlet ExtraVimResult = "/tmp/v466537/66"' -c 'breakadd func 16 B' -S /tmp/v466537/65[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/66" 17L, 127C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  35: OK (2146584868)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/67[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/67" [47;19H[K[47;19H66L, 1430C appended[47;19H[K[47;19H67L, 1452C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/68[?1l>[47;1H
[?1h=[47;1H:!echo 'q[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'le
[46;127Ht[47;2HExtraVimResult = "/tmp/v466537/68"' -c 'breakadd func 16 R' -S /tmp/v466537/67[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/68" 9L, 81C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  36: OK (1071644672)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/69[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/69" [47;19H[K[47;19H73L, 1488C appended[47;19H[K[47;19H74L, 1510C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/70[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult =
"/tmp/v466537/70"' -c 'breakadd func 16 F' -S /tmp/v466537/69[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/70" 9L, 81C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  37: OK (1071644672)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/71[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/71" [47;19H[K[47;19H82L, 1519C appended[47;19H[K[47;19H83L, 1541C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/72[?1l>[47;1H
[?1h=[47;1H:!echo 'q[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c
[46;127H'[47;1Hlet ExtraVimResult = "/tmp/v466537/72"' -c 'breakadd func 16 E' -S /tmp/v466537/71[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/72" 8L, 63C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  38: OK (357908480)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/73[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/73" [47;19H[K[47;19H83L, 1538C appended[47;19H[K[47;19H84L, 1560C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/74[?1l>[47;1H
[?1h=[47;1H:!echo 'q[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let E
[46;127Hx[47;1HtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/74"' -c 'breakadd func 16 I' -c 'breakadd func 22 I' -S /tmp/v466537/7
[46;127H3[47;2H[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/74" 8L, 63C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  39: OK (357908480)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/75[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/75" [47;19H[K[47;19H82L, 1519C appended[47;19H[K[47;19H83L, 1541C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/76[?1l>[47;1H
[?1h=[47;1H:!echo 'q[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c
[46;127H'[47;1Hlet ExtraVimResult = "/tmp/v466537/76"' -c 'breakadd func 16 T' -S /tmp/v466537/75[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/76" 8L, 63C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  40: OK (357908480)
*** Test  41: OK (3076095)
*** Test  42: OK (1505155949)
*** Test  43: OK (1157763329)
*** Test  44: OK (1031761407)
*** Test  45: OK (1157763329)
*** Test  46: OK (739407)
*** Test  47: OK (371213935)
*** Test  48: OK (756255461)
*** Test  49: OK (179000669)
   function C()
1      try
2[10CXpath 1[33C" X: 1
3[10Cthrow "arrgh"
4[10CXpath 2[33C" X: 0
5      catch /arrgh/
6[10CXpath 4[33C" X: 4
7      endtry
8      Xpath 8[37C" X: 8
   endfunction[38;1H"/tmp/v466537/77"[39;1H[K[40;1H[K[41;1H[K[42;1H[K[43;1H[K[44;1H[K[45;1H[K[46;1H[K[47;4H[K[38;19H[noeol] 11L, 334C
8 substitutions on 8 lines
E486: Pattern not found: ^\s*$"/tmp/v466537/77"[40;19H[K[40;19H8L, 295C written"test49.in" [40;13H[K[40;13H13L, 320C
   function T1()
1      XloopNEXT
2      try
3[10CXloop 1[33C" X: 16 + 16*16
4[10Cthrow "arrgh"
5[10CXloop 2[33C" X: 0
6      finally
7[10CXloop 4[33C" X: 64 + 64*16
8      endtry
9      Xloop 8[37C" X: 0
   endfunction[37;1H"/tmp/v466537/78"[38;1H[K[39;1H[K[40;1H[K[41;1H[K[42;1H[K[43;1H[K[44;1H[K[45;1H[K[46;1H[K[47;4H[K[37;19H[noeol] 12L, 364C
9 substitutions on 9 lines
E486: Pattern not found: ^\s*$"/tmp/v466537/78"[39;19H[K[39;19H9L, 323C written"test49.in" [39;13H[K[39;13H13L, 320C
   function T2()
1      try
2[10CXpath 4096[30C" X: 4096
3[10Ccall T1()
4[10CXpath 8192[30C" X: 0
5      finally
6[10CXpath 16384[29C" X: 16384
7      endtry
8      Xpath 32768[33C" X: 0
   endfunction[38;1H"/tmp/v466537/79"[39;1H[K[40;1H[K[41;1H[K[42;1H[K[43;1H[K[44;1H[K[45;1H[K[46;1H[K[47;4H[K[38;19H[noeol] 11L, 332C
8 substitutions on 8 lines
E486: Pattern not found: ^\s*$"/tmp/v466537/79"[40;19H[K[40;19H8L, 305C written"test49.in" [40;13H[K[40;13H13L, 320C
*** Test  50: OK (363550045)
*** Test  51: OK (40744667)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/81[?1l>[44;1H[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/81" [47;19H[K[47;19H2L, 41C appended[47;19H[K[47;19H3L, 63C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/82[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/80' -c 'debuggreedy|set viminfo+=nvi
[46;127Hm[47;1Hinfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/82"' -S /tmp/v466537/81[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/82" 1L, 2C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/80" [47;19H[K[47;19H8L, 182C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/83[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/83" [47;19H[K[47;19H7L, 115C appended[47;19H[K[47;19H8L, 137C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/84[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/80' -c 'debuggreedy|set viminfo+=nvi
[46;127Hm[47;1Hinfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/84"' -S /tmp/v466537/83[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/84" 1L, 2C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/80" [47;19H[K[47;19H8L, 181C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/85[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/85" [47;19H[K[47;19H12L, 180C appended[47;19H[K[47;19H13L, 202C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/86[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/80' -c 'debuggreedy|set viminfo+=nvi
[46;127Hm[47;1Hinfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/86"' -S /tmp/v466537/85[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/86" 2L, 8C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/80" [47;19H[K[47;19H10L, 209C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/87[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/87" [47;19H[K[47;19H8L, 139C appended[47;19H[K[47;19H9L, 161C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/88[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/80' -c 'debuggreedy|set viminfo+=nvi
[46;127Hm[47;1Hinfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/88"' -S /tmp/v466537/87[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/88" 2L, 11C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/80" [47;19H[K[47;19H10L, 217C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/89[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/89" [47;19H[K[47;19H5L, 87C appended[47;19H[K[47;19H6L, 109C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/90[?1l>[47;1H
[?1h=[47;1H:!echo 'q[1m^M[mq' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/80' -c 'debuggreedy|set viminfo+=
[46;127Hn[47;1Hviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/90"' -c 'breakadd file 4 /tmp/v466537/89' -S /tmp/v
[46;127H4[47;1H66537/89[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/90" 1L, 7C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/80" [47;19H[K[47;19H[noeol] 9L, 202C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/91[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/91" [47;19H[K[47;19H7L, 189C appended[47;19H[K[47;19H8L, 211C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/92[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/80' -c 'debuggreedy|set viminfo+=nvi
[46;127Hm[47;1Hinfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/92"' -S /tmp/v466537/91[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/92" 1L, 8C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/80" [47;19H[K[47;19H9L, 252C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/93[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/93" [47;19H[K[47;19H7L, 199C appended[47;19H[K[47;19H8L, 221C[47;19H[K[47;19H8L, 220C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/94[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/80' -c 'debuggreedy|set viminfo+=nvi
[46;127Hm[47;1Hinfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/94"' -S /tmp/v466537/93[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/94" 1L, 10C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/80" [47;19H[K[47;19H9L, 214C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  52: OK (1247112011)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/96[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/96" [47;19H[K[47;19H1L, 10C appended[47;19H[K[47;19H2L, 32C[47;19H[K[47;19H2L, 31C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/97[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/95' -c 'debuggreedy|set viminfo+=nvi
[46;127Hm[47;1Hinfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/97"' -S /tmp/v466537/96[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/97" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/95" [47;19H[K[47;19H6L, 154C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/98[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/98" [47;19H[K[47;19H3L, 39C appended[47;19H[K[47;19H4L, 61C
3 substitutions on 3 lines"/tmp/v466537/98" [47;20H[K[47;19H4L, 58C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/99[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/95' -c 'debuggreedy|set viminfo+=nvi
[46;127Hm[47;1Hinfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/99"' -S /tmp/v466537/98[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/99" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/95" [47;19H[K[47;19H6L, 158C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/100[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/100" [47;20H[K[47;20H4L, 45C appended[47;20H[K[47;20H5L, 67C
4 substitutions on 4 lines"/tmp/v466537/100"[47;20H[K[47;20H5L, 63C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/101[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/95' -c 'debuggreedy|set viminfo+=nvi
[46;127Hm[47;1Hinfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/101"' -S /tmp/v466537/100[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/101" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/95" [47;19H[K[47;19H6L, 159C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/102[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/102" [47;20H[K[47;20H3L, 33C appended[47;20H[K[47;20H4L, 55C
3 substitutions on 3 lines"/tmp/v466537/102"[47;20H[K[47;20H4L, 52C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/103[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/95' -c 'debuggreedy|set viminfo+=nvi
[46;127Hm[47;1Hinfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/103"' -S /tmp/v466537/102[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/103" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/95" [47;19H[K[47;19H6L, 159C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/104[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/104" [47;20H[K[47;20H5L, 65C appended[47;20H[K[47;20H6L, 87C
5 substitutions on 5 lines"/tmp/v466537/104"[47;20H[K[47;20H6L, 82C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/105[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/95' -c 'debuggreedy|set viminfo+=nvi
[46;127Hm[47;1Hinfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/105"' -S /tmp/v466537/104[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/105" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/95" [47;19H[K[47;19H6L, 159C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/106[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/106" [47;20H[K[47;20H1L, 9C appended[47;20H[K[47;20H2L, 31C[47;20H[K[47;20H2L, 30C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/107[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/95' -c 'debuggreedy|set viminfo+=nvi
[46;127Hm[47;1Hinfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/107"' -S /tmp/v466537/106[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/107" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/95" [47;19H[K[47;19H6L, 153C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/108[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/108" [47;20H[K[47;20H3L, 38C appended[47;20H[K[47;20H4L, 60C
3 substitutions on 3 lines"/tmp/v466537/108"[47;20H[K[47;20H4L, 57C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/109[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/95' -c 'debuggreedy|set viminfo+=nvi
[46;127Hm[47;1Hinfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/109"' -S /tmp/v466537/108[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/109" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/95" [47;19H[K[47;19H6L, 157C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/110[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/110" [47;20H[K[47;20H4L, 44C appended[47;20H[K[47;20H5L, 66C
4 substitutions on 4 lines"/tmp/v466537/110"[47;20H[K[47;20H5L, 62C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/111[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/95' -c 'debuggreedy|set viminfo+=nvi
[46;127Hm[47;1Hinfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/111"' -S /tmp/v466537/110[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/111" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/95" [47;19H[K[47;19H6L, 157C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/112[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/112" [47;20H[K[47;20H3L, 32C appended[47;20H[K[47;20H4L, 54C
3 substitutions on 3 lines"/tmp/v466537/112"[47;20H[K[47;20H4L, 51C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/113[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/95' -c 'debuggreedy|set viminfo+=nvi
[46;127Hm[47;1Hinfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/113"' -S /tmp/v466537/112[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/113" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/95" [47;19H[K[47;19H6L, 157C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/114[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/114" [47;20H[K[47;20H5L, 64C appended[47;20H[K[47;20H6L, 86C
5 substitutions on 5 lines"/tmp/v466537/114"[47;20H[K[47;20H6L, 81C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/115[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/95' -c 'debuggreedy|set viminfo+=nvi
[46;127Hm[47;1Hinfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/115"' -S /tmp/v466537/114[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/115" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/95" [47;19H[K[47;19H6L, 157C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/116[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/116" [47;20H[K[47;20H1L, 11C appended[47;20H[K[47;20H2L, 33C[47;20H[K[47;20H2L, 32C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/117[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/95' -c 'debuggreedy|set viminfo+=nvi
[46;127Hm[47;1Hinfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/117"' -S /tmp/v466537/116[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/117" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/95" [47;19H[K[47;19H6L, 157C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/118[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/118" [47;20H[K[47;20H3L, 40C appended[47;20H[K[47;20H4L, 62C
3 substitutions on 3 lines"/tmp/v466537/118"[47;20H[K[47;20H4L, 59C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/119[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/95' -c 'debuggreedy|set viminfo+=nvi
[46;127Hm[47;1Hinfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/119"' -S /tmp/v466537/118[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/119" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/95" [47;19H[K[47;19H6L, 161C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/120[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/120" [47;20H[K[47;20H4L, 46C appended[47;20H[K[47;20H5L, 68C
4 substitutions on 4 lines"/tmp/v466537/120"[47;20H[K[47;20H5L, 64C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/121[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/95' -c 'debuggreedy|set viminfo+=nvi
[46;127Hm[47;1Hinfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/121"' -S /tmp/v466537/120[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/121" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/95" [47;19H[K[47;19H6L, 161C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/122[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/122" [47;20H[K[47;20H3L, 34C appended[47;20H[K[47;20H4L, 56C
3 substitutions on 3 lines"/tmp/v466537/122"[47;20H[K[47;20H4L, 53C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/123[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/95' -c 'debuggreedy|set viminfo+=nvi
[46;127Hm[47;1Hinfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/123"' -S /tmp/v466537/122[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/123" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/95" [47;19H[K[47;19H6L, 161C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/124[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/124" [47;20H[K[47;20H5L, 66C appended[47;20H[K[47;20H6L, 88C
5 substitutions on 5 lines"/tmp/v466537/124"[47;20H[K[47;20H6L, 83C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/125[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/95' -c 'debuggreedy|set viminfo+=nvi
[46;127Hm[47;1Hinfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/125"' -S /tmp/v466537/124[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/125" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/95" [47;19H[K[47;19H6L, 161C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/126[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/126" [47;20H[K[47;20H4L, 37C appended[47;20H[K[47;20H5L, 59C
4 substitutions on 4 lines"/tmp/v466537/126"[47;20H[K[47;20H5L, 55C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/127[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/95' -c 'debuggreedy|set viminfo+=nvi
[46;127Hm[47;1Hinfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/127"' -S /tmp/v466537/126[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/127" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/95" [47;19H[K[47;19H6L, 150C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/128[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/128" [47;20H[K[47;20H4L, 41C appended[47;20H[K[47;20H5L, 63C
4 substitutions on 4 lines"/tmp/v466537/128"[47;20H[K[47;20H5L, 59C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/129[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/95' -c 'debuggreedy|set viminfo+=nvi
[46;127Hm[47;1Hinfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/129"' -S /tmp/v466537/128[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/129" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/95" [47;19H[K[47;19H6L, 159C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  53: OK (131071)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/131[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/131" [47;20H[K[47;20H1L, 13C appended[47;20H[K[47;20H2L, 35C[47;20H[K[47;20H2L, 34C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/132[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/130' -c 'debuggreedy|set viminfo+=nv
[46;127Hi[47;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/132"' -S /tmp/v466537/131[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/132" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/130" [47;20H[K[47;20H6L, 164C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/133[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/133" [47;20H[K[47;20H3L, 36C appended[47;20H[K[47;20H4L, 58C
3 substitutions on 3 lines"/tmp/v466537/133"[47;20H[K[47;20H4L, 55C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/134[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/130' -c 'debuggreedy|set viminfo+=nv
[46;127Hi[47;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/134"' -S /tmp/v466537/133[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/134" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/130" [47;20H[K[47;20H6L, 168C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/135[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/135" [47;20H[K[47;20H3L, 38C appended[47;20H[K[47;20H4L, 60C
3 substitutions on 3 lines"/tmp/v466537/135"[47;20H[K[47;20H4L, 57C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/136[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/130' -c 'debuggreedy|set viminfo+=nv
[46;127Hi[47;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/136"' -S /tmp/v466537/135[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/136" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/130" [47;20H[K[47;20H6L, 154C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/137[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/137" [47;20H[K[47;20H4L, 48C appended[47;20H[K[47;20H5L, 70C
4 substitutions on 4 lines"/tmp/v466537/137"[47;20H[K[47;20H5L, 66C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/138[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/130' -c 'debuggreedy|set viminfo+=nv
[46;127Hi[47;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/138"' -S /tmp/v466537/137[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/138" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/130" [47;20H[K[47;20H6L, 168C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/139[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/139" [47;20H[K[47;20H4L, 53C appended[47;20H[K[47;20H5L, 75C
4 substitutions on 4 lines"/tmp/v466537/139"[47;20H[K[47;20H5L, 71C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/140[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/130' -c 'debuggreedy|set viminfo+=nv
[46;127Hi[47;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/140"' -S /tmp/v466537/139[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/140" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/130" [47;20H[K[47;20H6L, 155C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/141[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/141" [47;20H[K[47;20H5L, 62C appended[47;20H[K[47;20H6L, 84C
5 substitutions on 5 lines"/tmp/v466537/141"[47;20H[K[47;20H6L, 79C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/142[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/130' -c 'debuggreedy|set viminfo+=nv
[46;127Hi[47;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/142"' -S /tmp/v466537/141[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/142" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/130" [47;20H[K[47;20H6L, 155C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/143[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/143" [47;20H[K[47;20H5L, 64C appended[47;20H[K[47;20H6L, 86C
5 substitutions on 5 lines"/tmp/v466537/143"[47;20H[K[47;20H6L, 81C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/144[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/130' -c 'debuggreedy|set viminfo+=nv
[46;127Hi[47;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/144"' -S /tmp/v466537/143[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/144" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/130" [47;20H[K[47;20H6L, 154C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/145[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/145" [47;20H[K[47;20H3L, 36C appended[47;20H[K[47;20H4L, 58C
3 substitutions on 3 lines"/tmp/v466537/145"[47;20H[K[47;20H4L, 55C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/146[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/130' -c 'debuggreedy|set viminfo+=nv
[46;127Hi[47;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/146"' -S /tmp/v466537/145[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/146" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/130" [47;20H[K[47;20H6L, 168C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/147[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/147" [47;20H[K[47;20H5L, 67C appended[47;20H[K[47;20H6L, 89C
5 substitutions on 5 lines"/tmp/v466537/147"[47;20H[K[47;20H6L, 84C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/148[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/130' -c 'debuggreedy|set viminfo+=nv
[46;127Hi[47;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/148"' -S /tmp/v466537/147[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/148" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/130" [47;20H[K[47;20H6L, 167C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/149[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/149" [47;20H[K[47;20H5L, 68C appended[47;20H[K[47;20H6L, 90C
5 substitutions on 5 lines"/tmp/v466537/149"[47;20H[K[47;20H6L, 85C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/150[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/130' -c 'debuggreedy|set viminfo+=nv
[46;127Hi[47;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/150"' -S /tmp/v466537/149[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/150" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/130" [47;20H[K[47;20H6L, 168C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/151[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/151" [47;20H[K[47;20H7L, 95C appended[47;20H[K[47;20H8L, 117C
7 substitutions on 7 lines"/tmp/v466537/151"[47;20H[K[47;20H8L, 110C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/152[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/130' -c 'debuggreedy|set viminfo+=nv
[46;127Hi[47;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/152"' -S /tmp/v466537/151[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/152" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/130" [47;20H[K[47;20H6L, 167C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  54: OK (2047)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/154[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/154" [47;20H[K[47;20H1L, 13C appended[47;20H[K[47;20H2L, 35C[47;20H[K[47;20H2L, 34C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/155[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/153' -c 'debuggreedy|set viminfo+=nv
[46;127Hi[47;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/155"' -S /tmp/v466537/154[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/155" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/153" [47;20H[K[47;20H6L, 172C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/156[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/156" [47;20H[K[47;20H3L, 36C appended[47;20H[K[47;20H4L, 58C
3 substitutions on 3 lines"/tmp/v466537/156"[47;20H[K[47;20H4L, 55C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/157[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/153' -c 'debuggreedy|set viminfo+=nv
[46;127Hi[47;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/157"' -S /tmp/v466537/156[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/157" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/153" [47;20H[K[47;20H6L, 176C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/158[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/158" [47;20H[K[47;20H4L, 48C appended[47;20H[K[47;20H5L, 70C
4 substitutions on 4 lines"/tmp/v466537/158"[47;20H[K[47;20H5L, 66C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/159[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/153' -c 'debuggreedy|set viminfo+=nv
[46;127Hi[47;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/159"' -S /tmp/v466537/158[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/159" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/153" [47;20H[K[47;20H6L, 176C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/160[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/160" [47;20H[K[47;20H3L, 36C appended[47;20H[K[47;20H4L, 58C
3 substitutions on 3 lines"/tmp/v466537/160"[47;20H[K[47;20H4L, 55C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/161[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/153' -c 'debuggreedy|set viminfo+=nv
[46;127Hi[47;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/161"' -S /tmp/v466537/160[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/161" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/153" [47;20H[K[47;20H6L, 176C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/162[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/162" [47;20H[K[47;20H5L, 68C appended[47;20H[K[47;20H6L, 90C
5 substitutions on 5 lines"/tmp/v466537/162"[47;20H[K[47;20H6L, 85C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/163[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/153' -c 'debuggreedy|set viminfo+=nv
[46;127Hi[47;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/163"' -S /tmp/v466537/162[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/163" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/153" [47;20H[K[47;20H6L, 176C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/164[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/164" [47;20H[K[47;20H1L, 10C appended[47;20H[K[47;20H2L, 32C[47;20H[K[47;20H2L, 31C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/165[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/153' -c 'debuggreedy|set viminfo+=nv
[46;127Hi[47;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/165"' -S /tmp/v466537/164[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/165" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/153" [47;20H[K[47;20H6L, 166C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/166[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/166" [47;20H[K[47;20H3L, 33C appended[47;20H[K[47;20H4L, 55C
3 substitutions on 3 lines"/tmp/v466537/166"[47;20H[K[47;20H4L, 52C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/167[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/153' -c 'debuggreedy|set viminfo+=nv
[46;127Hi[47;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/167"' -S /tmp/v466537/166[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/167" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/153" [47;20H[K[47;20H6L, 170C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/168[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/168" [47;20H[K[47;20H4L, 45C appended[47;20H[K[47;20H5L, 67C
4 substitutions on 4 lines"/tmp/v466537/168"[47;20H[K[47;20H5L, 63C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/169[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/153' -c 'debuggreedy|set viminfo+=nv
[46;127Hi[47;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/169"' -S /tmp/v466537/168[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/169" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/153" [47;20H[K[47;20H6L, 170C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/170[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/170" [47;20H[K[47;20H3L, 33C appended[47;20H[K[47;20H4L, 55C
3 substitutions on 3 lines"/tmp/v466537/170"[47;20H[K[47;20H4L, 52C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/171[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/153' -c 'debuggreedy|set viminfo+=nv
[46;127Hi[47;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/171"' -S /tmp/v466537/170[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/171" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/153" [47;20H[K[47;20H6L, 170C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/172[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/172" [47;20H[K[47;20H5L, 65C appended[47;20H[K[47;20H6L, 87C
5 substitutions on 5 lines"/tmp/v466537/172"[47;20H[K[47;20H6L, 82C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/173[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/153' -c 'debuggreedy|set viminfo+=nv
[46;127Hi[47;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/173"' -S /tmp/v466537/172[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/173" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/153" [47;20H[K[47;20H6L, 170C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  55: OK (1023)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/175[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/175" [47;20H[K[47;20H1L, 11C appended[47;20H[K[47;20H2L, 33C[47;20H[K[47;20H2L, 32C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/176[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/174' -c 'debuggreedy|set viminfo+=nv
[46;127Hi[47;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/176"' -S /tmp/v466537/175[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/176" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/174" [47;20H[K[47;20H6L, 158C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/177[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/177" [47;20H[K[47;20H3L, 34C appended[47;20H[K[47;20H4L, 56C
3 substitutions on 3 lines"/tmp/v466537/177"[47;20H[K[47;20H4L, 53C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/178[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/174' -c 'debuggreedy|set viminfo+=nv
[46;127Hi[47;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/178"' -S /tmp/v466537/177[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/178" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/174" [47;20H[K[47;20H6L, 162C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/179[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/179" [47;20H[K[47;20H3L, 40C appended[47;20H[K[47;20H4L, 62C
3 substitutions on 3 lines"/tmp/v466537/179"[47;20H[K[47;20H4L, 59C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/180[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/174' -c 'debuggreedy|set viminfo+=nv
[46;127Hi[47;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/180"' -S /tmp/v466537/179[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/180" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/174" [47;20H[K[47;20H6L, 162C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/181[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/181" [47;20H[K[47;20H3L, 32C appended[47;20H[K[47;20H4L, 54C
3 substitutions on 3 lines"/tmp/v466537/181"[47;20H[K[47;20H4L, 51C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/182[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/174' -c 'debuggreedy|set viminfo+=nv
[46;127Hi[47;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/182"' -S /tmp/v466537/181[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/182" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/174" [47;20H[K[47;20H6L, 152C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/183[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/183" [47;20H[K[47;20H3L, 35C appended[47;20H[K[47;20H4L, 57C
3 substitutions on 3 lines"/tmp/v466537/183"[47;20H[K[47;20H4L, 54C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/184[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/174' -c 'debuggreedy|set viminfo+=nv
[46;127Hi[47;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/184"' -S /tmp/v466537/183[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/184" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/174" [47;20H[K[47;20H6L, 155C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/185[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/185" [47;20H[K[47;20H4L, 44C appended[47;20H[K[47;20H5L, 66C
4 substitutions on 4 lines"/tmp/v466537/185"[47;20H[K[47;20H5L, 62C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/186[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/174' -c 'debuggreedy|set viminfo+=nv
[46;127Hi[47;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/186"' -S /tmp/v466537/185[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/186" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/174" [47;20H[K[47;20H6L, 152C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/187[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/187" [47;20H[K[47;20H4L, 47C appended[47;20H[K[47;20H5L, 69C
4 substitutions on 4 lines"/tmp/v466537/187"[47;20H[K[47;20H5L, 65C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/188[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/174' -c 'debuggreedy|set viminfo+=nv
[46;127Hi[47;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/188"' -S /tmp/v466537/187[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/188" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/174" [47;20H[K[47;20H6L, 155C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/189[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/189" [47;20H[K[47;20H5L, 64C appended[47;20H[K[47;20H6L, 86C
5 substitutions on 5 lines"/tmp/v466537/189"[47;20H[K[47;20H6L, 81C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/190[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/174' -c 'debuggreedy|set viminfo+=nv
[46;127Hi[47;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/190"' -S /tmp/v466537/189[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/190" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/174" [47;20H[K[47;20H6L, 152C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/191[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/191" [47;20H[K[47;20H5L, 67C appended[47;20H[K[47;20H6L, 89C
5 substitutions on 5 lines"/tmp/v466537/191"[47;20H[K[47;20H6L, 84C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/192[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/tmp/v466537/174' -c 'debuggreedy|set viminfo+=nv
[46;127Hi[47;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/v466537/192"' -S /tmp/v466537/191[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/192" 0L, 0C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/174" [47;20H[K[47;20H6L, 155C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  56: OK (511)
   function FuncException()
1      let g:exception = v:exception
   endfunction[45;1H"/tmp/v466537/193" [45;20H[K[46;1H[K[47;4H[K[45;20H[noeol] 4L, 80C
E486: Pattern not found: ^\s*$"/tmp/v466537/193" [46;20H[K[46;20H1L, 36C written"test49.in" [46;13H[K[46;13H13L, 320C
   function FuncThrowpoint()
1      let g:throwpoint = v:throwpoint
   endfunction[45;1H"/tmp/v466537/194" [45;20H[K[46;1H[K[47;4H[K[45;20H[noeol] 4L, 83C
E486: Pattern not found: ^\s*$"/tmp/v466537/194" [46;20H[K[46;20H1L, 38C written"test49.in" [46;13H[K[46;13H13L, 320C
   function T(arg, line)
1      if a:line == 2
2[10Cthrow a:arg[13C" in line 2
3      elseif a:line == 4
4[10Cthrow a:arg[13C" in line 4
5      elseif a:line == 6
6[10Cthrow a:arg[13C" in line 6
7      elseif a:line == 8
8[10Cthrow a:arg[13C" in line 8
9      endif
   endfunction[37;1H"/tmp/v466537/195"[37;20H[K[38;1H[K[39;1H[K[40;1H[K[41;1H[K[42;1H[K[43;1H[K[44;1H[K[45;1H[K[46;1H[K[47;4H[K[37;20H[noeol] 12L, 341C
9 substitutions on 9 lines
8 substitutions on 8 lines
E486: Pattern not found: ^\s*$"/tmp/v466537/195" [40;20H[K[40;20H9L, 292C written"test49.in" [40;13H[K[40;13H13L, 320C
   function G(arg, line)
1      call T(a:arg, a:line)
   endfunction[41;1H"/tmp/v466537/196"[41;20H[K[42;1H[K[43;4H[K[41;20H[noeol] 4L, 69C
E486: Pattern not found: ^\s*$"/tmp/v466537/196" [42;20H[K[42;20H1L, 30C written"test49.in" [42;13H[K[42;13H13L, 320C
   function F(arg, line)
1      call G(a:arg, a:line)
   endfunction[43;1H"/tmp/v466537/197"[43;20H[K[44;1H[K[45;4H[K[43;20H[noeol] 4L, 69C
E486: Pattern not found: ^\s*$"/tmp/v466537/197" [44;20H[K[44;20H1L, 30C written"test49.in" [44;13H[K[44;13H13L, 320C
*** Test  57: OK (2147450880)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/198[?1l>[47;1H[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/198" [47;20H[K[47;20H87L, 1700C appended[47;20H[K[47;20H88L, 1722C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/199[?1l>[47;1H
[?1h=[47;1H:!echo 'q[1m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResul
[46;127Ht[47;2H= "/tmp/v466537/199"' -c 'breakadd func 4 T' -S /tmp/v466537/198[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/199" 8L, 36C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  58: OK (624945)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/200[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/200" [47;20H[K[47;20H293L, 5789C appended[47;20H[K[47;20H294L, 5811C
3 substitutions on 3 lines"/tmp/v466537/200"[47;20H[K[47;20H294L, 5808C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/201[?1l>[47;1H
[?1h=[47;1H:!echo 'q[1m^M[mq[1m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimRe
[46;127Hs[47;1Hult = "/tmp/v466537/201"' -c 'breakadd file 115 /tmp/v466537/200' -c 'breakadd file 225 /tmp/v466537/200' -S /tmp/v466537/200[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/201" 28L, 162C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  59: OK (2038431743)"/n/o/n/w/r/i/t/a/b/l/e/_/f/i/l/e""/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/202[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/202" [47;20H[K[47;20H33L, 765C appended[47;20H[K[47;20H34L, 787C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/203[?1l>[47;1H
[?1h=[47;1H:!echo 'q[1m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResul
[46;127Ht[47;2H= "/tmp/v466537/203"' -c 'breakadd file 7 /tmp/v466537/202' -S /tmp/v466537/202[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/203" 3L, 27C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  60: OK (311511339)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/204[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/204" [47;20H[K[47;20H115L, 2272C appended[47;20H[K[47;20H116L, 2294C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/205[?1l>[47;1H
[?1h=[47;1H:!echo 'q[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'le
[46;127Ht[47;2HExtraVimResult = "/tmp/v466537/205"' -c 'breakadd file 8 /tmp/v466537/204' -c 'breakadd file 36 /tmp/v466537/204' -c 'breakad
[46;127Hd[47;2Hfile 40 /tmp/v466537/204' -c 'breakadd file 69 /tmp/v466537/204' -c 'breakadd file 95 /tmp/v466537/204' -c 'breakadd file 97
[46;127H/[47;1Htmp/v466537/204' -S /tmp/v466537/204[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/205" 14L, 81C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  61: OK (374889517)
   function F()
1      while 1
2      " Missing :endwhile
   endfunction[44;1H"/tmp/v466537/206"[45;1H[K[46;1H[K[47;4H[K[44;20H[noeol] 5L, 73C
E486: Pattern not found: ^\s*$"/tmp/v466537/206" [45;20H[K[45;20H2L, 40C written"test49.in" [45;13H[K[45;13H13L, 320C
*** Test  62: OK (286331153)"/i/m/p/o/s/s/i/b/l/e" [46;24H[K[47;1H[4mline 6342:[m
[7m"/i/m/p/o/s/s/i/b/l/e" E212: Can't open file for writing[m
*** Test  63: OK (236978127)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/207[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/207" [47;20H[K[47;20H149L, 2828C appended[47;20H[K[47;20H150L, 2850C
6 substitutions on 6 lines"/tmp/v466537/207"[47;20H[K[47;20H150L, 2844C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/208[?1l>[47;1H
[?1h=[47;1H:!echo 'q[1m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResul
[46;127Ht[47;2H= "/tmp/v466537/208"' -c 'breakadd file 63 /tmp/v466537/207' -S /tmp/v466537/207[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/208" 16L, 97C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  64: OK (1499645335)
*** Test  65: OK (70187)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/209[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/209" [47;20H[K[47;20H78L, 1520C appended[47;20H[K[47;20H79L, 1542C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/210[?1l>[47;1H
[?1h=[47;1H:!echo 'q[1m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResul
[46;127Ht[47;2H= "/tmp/v466537/210"' -c 'breakadd func 8 F' -S /tmp/v466537/209[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/210" 6L, 22C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  66: OK (5464)
*** Test  67: OK (212514423)
*** Test  68: OK (212514423)
*** Test  69: OK (8995471)
*** Test  70: OK (69544277)
*** Test  71: OK (34886997)
*** Test  72: OK (1789569365)
   function F0()
   endfunction
   function F1()
   endfunction
*** Test  73: OK (9032615)"/tmp/v466537/211" [New File]"test49.in" [47;13H[K[47;13H13L, 320C"/tmp/v466537/212" [New File]"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  74: OK (224907669)
*** Test  75: OK (2000403408)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/213[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/213" [47;20H[K[47;20H253L, 6369C appended[47;20H[K[47;20H254L, 6391C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/214[?1l>[47;1H
[?1h=[47;1H:!echo 'q[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq[1m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin =
[46;127H1[47;1H' -c 'let ExtraVimResult = "/tmp/v466537/214"' -c 'breakadd func 2 INT' -S /tmp/v466537/213[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/214" 28L, 167C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  76: OK (1610087935)
[7mError detected while processing function ERR:[m
[4mline    2:[m
[7mE492: Not an editor command:     asdf[m
[7mE492: Not an editor command:     asdf[m
[7mE492: Not an editor command:     asdf[m
*** Test  77: OK (1388671)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/215[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/215" [47;20H[K[47;20H161L, 4543C appended[47;20H[K[47;20H162L, 4565C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/216[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult =
"/tmp/v466537/216"' -S /tmp/v466537/215[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/216" 1L, 10C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  78: OK (134217728)
[7mError detected while processing function NEXT:[m
[4mline    1:[m
[7mE121: Undefined variable: novar[m
[7mE15: Invalid expression: novar | Xloop 1[m
[7mE121: Undefined variable: novar[m
[7mE488: Trailing characters[m
[7mE108: No such variable: "novar"[m
[7mE488: Trailing characters[m
[7mE121: Undefined variable: novar[m
[7mE15: Invalid expression: novar[m
[7mE475: Invalid argument: {novar} | Xloop 1[m
[7mE121: Undefined variable: novar[m
[7mE15: Invalid expression:  novar[m
[7mE475: Invalid argument: { novar} | Xloop 1[m
*** Test  79: OK (70288929)
[7mError detected while processing /sources/vim70/src/testdir/test49.vim:[m
[4mline 8828:[m
[7mE584: :elseif after :else: elseif 1 ||| 2[m
[4mline 8838:[m
[7mE584: :elseif after :else: elseif 1 ||| 2[m
[4mline 8846:[m
[7mE582: :elseif without :if: elseif 1 ||| 2[m
[4mline 8854:[m
[7mE582: :elseif without :if:     elseif 1 ||| 2[m
*** Test  80: OK (17895765)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/217[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/217" [47;20H[K[47;20H15L, 272C appended[47;20H[K[47;20H16L, 294C[47;20H[K[47;20H16L, 293C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/218[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult =
"/tmp/v466537/218"' -S /tmp/v466537/217[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/218" 2L, 4C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/219[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/219" [47;20H[K[47;20H12L, 227C appended[47;20H[K[47;20H13L, 249C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/220[?1l>[47;1H
[?1h=[47;1H:!echo 'q[1m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResul
[46;127Ht[47;2H= "/tmp/v466537/220"' -c 'breakadd file 8 /tmp/v466537/219' -S /tmp/v466537/219[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/220" 2L, 8C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  81: OK (387)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/221[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/221" [47;20H[K[47;20H20L, 417C appended[47;20H[K[47;20H21L, 439C[47;20H[K[47;20H21L, 438C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/222[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult =
"/tmp/v466537/222"' -S /tmp/v466537/221[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/222" 1L, 2C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/223[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/223" [47;20H[K[47;20H24L, 480C appended[47;20H[K[47;20H25L, 502C[47;20H[K[47;20H25L, 501C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/224[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult =
"/tmp/v466537/224"' -S /tmp/v466537/223[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/224" 1L, 4C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/225[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/225" [47;20H[K[47;20H17L, 390C appended[47;20H[K[47;20H18L, 412C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/226[?1l>[47;1H
[?1h=[47;1H:!echo 'q[1m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResul
[46;127Ht[47;2H= "/tmp/v466537/226"' -c 'breakadd file 7 /tmp/v466537/225' -S /tmp/v466537/225[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/226" 1L, 6C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/227[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/227" [47;20H[K[47;20H21L, 444C appended[47;20H[K[47;20H22L, 466C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/228[?1l>[47;1H
[?1h=[47;1H:!echo 'q[1m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResul
[46;127Ht[47;2H= "/tmp/v466537/228"' -c 'breakadd func 6 I' -S /tmp/v466537/227[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/228" 1L, 8C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  82: OK (8454401)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/229[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/229" [47;20H[K[47;20H17L, 307C appended[47;20H[K[47;20H18L, 329C[47;20H[K[47;20H18L, 328C written"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/230[?1l>[47;1H
[?1h=[47;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult =
"/tmp/v466537/230"' -S /tmp/v466537/229[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/230" 3L, 7C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/231[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/231" [47;20H[K[47;20H14L, 266C appended[47;20H[K[47;20H15L, 288C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/232[?1l>[47;1H
[?1h=[47;1H:!echo 'q[1m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResul
[46;127Ht[47;2H= "/tmp/v466537/232"' -c 'breakadd file 8 /tmp/v466537/231' -S /tmp/v466537/231[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/232" 3L, 13C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  83: OK (2835)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/233[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/233" [47;20H[K[47;20H154L, 3580C appended[47;20H[K[47;20H155L, 3602C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/234[?1l>[47;1H
[?1h=[47;1H:!echo 'q[1m^M[mq[1m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimRe
[46;127Hs[47;1Hult = "/tmp/v466537/234"' -c 'breakadd func 1 INT' -S /tmp/v466537/233[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/234" 18L, 118C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  84: OK (934782101)
TMP"/tmp/v466537/235" [noeol] 2L, 6C[47;1H[K[47;1H/  "test49.in" 13L, 320C"/n/o/n/e/x/i/s/t/e/n/t"
"/tmp/v466537/237" 1L, 1C"test49.in" [47;13H[K[47;13H13L, 320C
:!echo XYZ >/tmp/v466537/238[?1l>[47;1H
[?1h=[47;1H"/tmp/v466537/239" [New File]"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  85: OK (198689)"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!echo 'source /tmp/v466537/3' >/tmp/v466537/240[?1l>[47;1H
[?1h=[47;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/v466537/240" [47;20H[K[47;20H151L, 3929C appended[47;20H[K[47;20H152L, 3951C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C
:!>/tmp/v466537/241[?1l>[47;1H
[?1h=[47;1H:!echo 'q[1m^M[mq[1m^M[mq[1m^M[mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVi
[46;127Hm[47;1HResult = "/tmp/v466537/241"' -c 'breakadd func 5 ThrowOnInterrupt' -S /tmp/v466537/240[?1l>[47;1H

shell returned 1
[?1h=[47;1H"/tmp/v466537/241" 16L, 281C"/sources/vim70/src/testdir/test49.vim" [readonly] 9802L, 224141C"test49.in" [47;13H[K[47;13H13L, 320C
*** Test  86: OK (50443995)
[7mPress ENTER or type command to continue[m[H[2J[1;1HThis is a test of the script language.

If after adding a new test, the test output doesn't appear properly in
test49.failed, try to add one ore more "G"s at the line before ENDTEST.

STARTTEST
:so small.vim
:se nocp nomore viminfo+=nviminfo
:so test49.vim
GGGGGGGGGG"rp:.-,$wq! test.out
ENDTEST

Results of test49.vim:
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[12;1H
[m[47;1H91 more lines[14;1H*** Test   1: OK (34695)
*** Test   2: OK (34695)
*** Test   3: OK (1384648195)
*** Test   4: OK (32883)
*** Test   5: OK (32883)
*** Test   6: OK (603978947)
*** Test   7: OK (90563)
*** Test   8: OK (562493431)
*** Test   9: OK (363)
*** Test  10: OK (559615)
*** Test  11: OK (2049)
*** Test  12: OK (352256)
*** Test  13: OK (145)
*** Test  14: OK (42413)
*** Test  15: OK (42413)
*** Test  16: OK (8722)
*** Test  17: OK (285127993)
*** Test  18: OK (67224583)
*** Test  19: OK (69275973)
*** Test  20: OK (1874575085)
*** Test  21: OK (147932225)
*** Test  22: OK (4161)
*** Test  23: OK (49)
*** Test  24: OK (41)
*** Test  25: OK (260177811)
*** Test  26: OK (1681500476)
*** Test  27: OK (1996459)
*** Test  28: OK (1996459)
*** Test  29: OK (170428555)
*** Test  30: OK (190905173)
*** Test  31: OK (190905173)
*** Test  32: OK (354833067)
--- Test  33: sum = 178275600 (ok)[14;1H[47;1H[K[47;1H:.-,$wq! test.out"test.out" [47;12H[K[47;12H[New] 92L, 2672C written[?1l>
rm -rf X* test.ok viminfo
rm -rf test51.failed test.ok test.out X* viminfo
cp test51.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test51.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test51.in" 36 lines, 808 characters[1;1HTests for ":highlight". vim: set ft=vim :

STARTTEST
:so small.vim
:" basic test if ":highlight" doesn't crash
:highlight
:hi Search
:" test setting colors.
:" test clearing one color and all doesn't generate error or warning
:hi NewGroup term=bold cterm=italic ctermfg=DarkBlue ctermbg=Grey gui= guifg=#00ff00 guibg=Cyan
:hi Group2 term= cterm=
:hi Group3 term=underline cterm=bold
:redir! >test.out
:hi NewGroup
:hi Group2
:hi Group3
:hi clear NewGroup
:hi NewGroup
:hi Group2
:hi Group2 NONE
:hi Group2
:hi clear
:hi Group3
:hi Crash term='asdf
:redir END
:" filter ctermfg and ctermbg, the numbers depend on the terminal
:e test.out
:%s/ctermfg=\d*/ctermfg=2/
:%s/ctermbg=\d*/ctermbg=3/
:" filter out possibly translated error message
:%s/E475: [^:]*:/E475:/
:" fix the fileformat
:set ff&
:wq!
ENDTEST

[1m~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 31 lines, 746 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[35;1H
[47;1H[K[47;1H:so! Xdotest[36;1H[47;1H[K[47;1H:so small.vim[36;1H[47;1H[K[47;1H:" basic test if ":highlight" doesn't crash[36;1H[47;1H[K[47;1H:highlight
SpecialKey     [1mxxx[m [1mterm=[mbold [1mctermfg=[m1
NonText[8C[1mxxx[m [1mterm=[mbold [1mctermfg=[m9
Directory      [1mxxx[m [1mterm=[mbold [1mctermfg=[m1
ErrorMsg[7C[7mxxx[m [1mterm=[mstandout [1mctermfg=[m15 [1mctermbg=[m4
IncSearch      [7mxxx[m [1mterm=[mreverse [1mcterm=[mreverse
Search[9C[7mxxx[m [1mterm=[mreverse [1mctermfg=[m0 [1mctermbg=[m14
MoreMsg[8C[1mxxx[m [1mterm=[mbold [1mctermfg=[m2
ModeMsg[8C[1mxxx[m [1mterm=[mbold [1mcterm=[mbold
LineNr[9C[4mxxx[m [1mterm=[munderline [1mctermfg=[m6
Question[7C[7mxxx[m [1mterm=[mstandout [1mctermfg=[m2
StatusLine     [1m[7mxxx[m [1mterm=[mbold,reverse [1mcterm=[mbold,reverse
StatusLineNC   [7mxxx[m [1mterm=[mreverse [1mcterm=[mreverse
VertSplit      [7mxxx[m [1mterm=[mreverse [1mcterm=[mreverse
Title[10C[1mxxx[m [1mterm=[mbold [1mctermfg=[m5
Visual[9C[7mxxx[m [1mterm=[mreverse [1mcterm=[mreverse
VisualNOS      xxx cleared
WarningMsg     [7mxxx[m [1mterm=[mstandout [1mctermfg=[m4
WildMenu[7C[7mxxx[m [1mterm=[mstandout [1mctermfg=[m0 [1mctermbg=[m14
Folded[9C[7mxxx[m [1mterm=[mstandout [1mctermfg=[m1 [1mctermbg=[m7
FoldColumn     [7mxxx[m [1mterm=[mstandout [1mctermfg=[m1 [1mctermbg=[m7
DiffAdd[8C[1mxxx[m [1mterm=[mbold [1mctermbg=[m9
DiffChange     [1mxxx[m [1mterm=[mbold [1mctermbg=[m13
DiffDelete     [1mxxx[m [1mterm=[mbold [1mctermfg=[m9 [1mctermbg=[m11
DiffText[7C[7mxxx[m [1mterm=[mreverse [1mcterm=[mbold [1mctermbg=[m12
SignColumn     xxx cleared
SpellBad[7C[7mxxx[m [1mterm=[mreverse [1mctermbg=[m12
SpellCap[7C[7mxxx[m [1mterm=[mreverse [1mctermbg=[m9
SpellRare      [7mxxx[m [1mterm=[mreverse [1mctermbg=[m13
SpellLocal     [4mxxx[m [1mterm=[munderline [1mctermbg=[m11
Pmenu[10Cxxx [1mctermbg=[m13
PmenuSel[7Cxxx [1mctermbg=[m7
PmenuSbar      xxx [1mctermbg=[m7
PmenuThumb     xxx [1mcterm=[mreverse
TabLine[8C[4mxxx[m [1mterm=[munderline [1mcterm=[munderline [1mctermfg=[m0 [1mctermbg=[m7
TabLineSel     [1mxxx[m [1mterm=[mbold [1mcterm=[mbold
TabLineFill    [7mxxx[m [1mterm=[mreverse [1mcterm=[mreverse
CursorColumn   [7mxxx[m [1mterm=[mreverse [1mctermbg=[m7
CursorLine     [4mxxx[m [1mterm=[munderline [1mcterm=[munderline
MatchParen     [7mxxx[m [1mterm=[mreverse [1mctermbg=[m11
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:hi Search
Search[9C[7mxxx[m [1mterm=[mreverse [1mctermfg=[m0 [1mctermbg=[m14
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:" test setting colors.[1;1H[42L[1;1HTests for ":highlight". vim: set ft=vim :

STARTTEST
:so small.vim
:" basic test if ":highlight" doesn't crash
:highlight
:hi Search
:" test setting colors.
:" test clearing one color and all doesn't generate error or warning
:hi NewGroup term=bold cterm=italic ctermfg=DarkBlue ctermbg=Grey gui= guifg=#00ff00 guibg=Cyan
:hi Group2 term= cterm=
:hi Group3 term=underline cterm=bold
:redir! >test.out
:hi NewGroup
:hi Group2
:hi Group3
:hi clear NewGroup
:hi NewGroup
:hi Group2
:hi Group2 NONE
:hi Group2
:hi clear
:hi Group3
:hi Crash term='asdf
:redir END
:" filter ctermfg and ctermbg, the numbers depend on the terminal
:e test.out
:%s/ctermfg=\d*/ctermfg=2/
:%s/ctermbg=\d*/ctermbg=3/
:" filter out possibly translated error message
:%s/E475: [^:]*:/E475:/
:" fix the fileformat
:set ff&
:wq!
ENDTEST

[1m~
~
~
~
~
~[m[47;1H[K[36;1H[47;1H:" test clearing one color and all doesn't generate error or warning[36;1H[47;1H[K[47;1H:hi NewGroup term=bold cterm=italic ctermfg=DarkBlue ctermbg=Grey gui= guifg=#00ff00 guibg=Cyan[7mE418: Illegal value: guifg=#00ff00[m[47;35H[K[36;1H[47;1H[K[47;1H:hi Group2 term= cterm=[7mE418: Illegal value: cterm=[36;1H[m[47;1H[K[47;1H:hi Group3 term=underline cterm=bold[36;1H[47;1H[K[47;1H:redir! >test.out[36;1H[47;1H[K[47;1H:hi NewGroup
NewGroup[7C[1mxxx[m [1mterm=[mbold [1mcterm=[mitalic [1mctermfg=[m1 [1mctermbg=[m7
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:hi Group2
Group2[9Cxxx cleared
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:hi Group3
Group3[9C[4mxxx[m [1mterm=[munderline [1mcterm=[mbold
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:hi clear NewGroup[1;1H[6L[1;1HTests for ":highlight". vim: set ft=vim :

STARTTEST
:so small.vim
:" basic test if ":highlight" doesn't crash
:highlight[47;1H[K[36;1H[47;1H:hi NewGroup
NewGroup[7Cxxx cleared
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:hi Group2
Group2[9Cxxx cleared
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:hi Group2 NONE[1;1H[4L[1;1HTests for ":highlight". vim: set ft=vim :

STARTTEST
:so small.vim[47;1H[K[36;1H[47;1H:hi Group2
Group2[9Cxxx cleared
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:hi clear[m[H[2J[1;1HTests for ":highlight". vim: set ft=vim :

STARTTEST
:so small.vim
:" basic test if ":highlight" doesn't crash
:highlight
:hi Search
:" test setting colors.
:" test clearing one color and all doesn't generate error or warning
:hi NewGroup term=bold cterm=italic ctermfg=DarkBlue ctermbg=Grey gui= guifg=#00ff00 guibg=Cyan
:hi Group2 term= cterm=
:hi Group3 term=underline cterm=bold
:redir! >test.out
:hi NewGroup
:hi Group2
:hi Group3
:hi clear NewGroup
:hi NewGroup
:hi Group2
:hi Group2 NONE
:hi Group2
:hi clear
:hi Group3
:hi Crash term='asdf
:redir END
:" filter ctermfg and ctermbg, the numbers depend on the terminal
:e test.out
:%s/ctermfg=\d*/ctermfg=2/
:%s/ctermbg=\d*/ctermbg=3/
:" filter out possibly translated error message
:%s/E475: [^:]*:/E475:/
:" fix the fileformat
:set ff&
:wq!
ENDTEST

[1m~
~
~
~
~
~
~
~
~
~[36;1H[47;1H[m:hi Group3
Group3[9Cxxx cleared
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:hi Crash term='asdf[7mE475: Invalid argument: term='asdf[m
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:redir END[1;1H[3L[1;1HTests for ":highlight". vim: set ft=vim :

STARTTEST[47;1H[K[36;1H[47;1H:" filter ctermfg and ctermbg, the numbers depend on the terminal[36;1H[47;1H[K[47;1H:e test.out"test.out" 20 lines, 289 characters[1;1H[K[3;1HNewGroup       xxx term=bold cterm=italic ctermfg=1 ctermbg=7[4;1H[K[5;1HGroup2         xxx cleared[5;27H[K[6;1H[K[7;1HGroup3         xxx term=underline cterm=bold[8;1H[K[9;1H[K[10;1HNewGroup       xxx cleared[10;27H[K[11;1H[K[12;1HGroup2         xxx cleared[12;27H[K[13;1H[K[14;1H[K[15;1HGroup2         xxx cleared[16;1H[K[17;1H[K[18;1HGroup3         xxx cleared[19;1H[K[20;1HE475: Invalid argument: term='asdf[21;2H[K[21;1H[1m~[m[22;2H[K[22;1H[1m~[m[23;2H[K[23;1H[1m~[m[24;2H[K[24;1H[1m~[m[25;2H[K[25;1H[1m~[m[26;2H[K[26;1H[1m~[m[27;2H[K[27;1H[1m~[m[28;2H[K[28;1H[1m~[m[29;2H[K[29;1H[1m~[m[30;2H[K[30;1H[1m~[m[31;2H[K[31;1H[1m~[m[32;2H[K[32;1H[1m~[m[33;2H[K[33;1H[1m~[m[34;2H[K[34;1H[1m~[m[35;2H[K[35;1H[1m~
~[1;1H[m[47;1H[K[47;1H:%s/ctermfg=\d*/ctermfg=2/[3;51H2[47;1H[K[47;1H:%s/ctermbg=\d*/ctermbg=3/[3;61H3[47;1H[K[47;1H:" filter out possibly translated error message[3;1H[47;1H[K[47;1H:%s/E475: [^:]*:/E475:/[20;7Hterm='asdf[20;17H[K[20;1H[47;1H[K[47;1H:" fix the fileformat[20;1H[47;1H[K[47;1H:set ff&[20;1H[47;1H[K[47;1H:wq!"test.out" 20 lines, 271 characters written[?1l>
rm -rf X* test.ok viminfo
rm -rf test52.failed test.ok test.out X* viminfo
cp test52.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test52.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test52.in" 65 lines, 1645 characters[1;1HTests for reading and writing files with conversion for Win32.

STARTTEST
:so mbyte.vim
:" make this a dummy test for non-Win32 systems
:if !has("win32") | e! test.ok | wq! test.out | endif
:"
:" write tests:
:" combine three values for 'encoding' with three values for 'fileencoding'
:" also write files for read tests
/^1
:set encoding=utf-8
:.w! ++enc=utf-8 test.out
:.w ++enc=cp1251 >>test.out
:.w ++enc=cp866 >>test.out
:.w! ++enc=utf-8 Xutf8
/^2
:set encoding=cp1251
:.w ++enc=utf-8 >>test.out
:.w ++enc=cp1251 >>test.out
:.w ++enc=cp866 >>test.out
:.w! ++enc=cp1251 Xcp1251
/^3
:set encoding=cp866
:.w ++enc=utf-8 >>test.out
:.w ++enc=cp1251 >>test.out
:.w ++enc=cp866 >>test.out
:.w! ++enc=cp866 Xcp866
:"
:" read three 'fileencoding's with utf-8 'encoding'
:set encoding=utf-8 fencs=utf-8,cp1251
:e Xutf8
:.w ++enc=utf-8 >>test.out
:e Xcp1251
:.w ++enc=utf-8 >>test.out
:set fencs=utf-8,cp866
:e Xcp866
:.w ++enc=utf-8 >>test.out
:"
:" read three 'fileencoding's with cp1251 'encoding'
:set encoding=utf-8 fencs=utf-8,cp1251
:e Xutf8
:.w ++enc=cp1251 >>test.out
:e Xcp1251
:.w ++enc=cp1251 >>test.out
:set fencs=utf-8,cp866[1;1H[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 57 lines, 1333 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[1;46r[1;1H[15M[1;47r[32;1H:e Xcp866
:.w ++enc=cp1251 >>test.out
:"
:" read three 'fileencoding's with cp866 'encoding'
:set encoding=cp866 fencs=utf-8,cp1251
:e Xutf8
:.w ++enc=cp866 >>test.out
:e Xcp1251
:.w ++enc=cp866 >>test.out
:set fencs=utf-8,cp866
:e Xcp866
:.w ++enc=cp866 >>test.out
:"
:qa!
ENDTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H
:so! Xdotest[46;1H[47;1H[K[47;1H:so mbyte.vim[46;1H[47;1H[K[47;1H:" make this a dummy test for non-Win32 systems[46;1H[47;1H[K[47;1H:if !has("win32") | e! test.ok | wq! test.out | endif"test.ok" [47;11H[K[47;11H18 lines, 1374 characters
"test.out" [New File] 18 lines, 1374 characters written[?1l>
rm -rf X* test.ok viminfo
rm -rf test53.failed test.ok test.out X* viminfo
cp test53.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test53.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test53.in" 48 lines, 952 characters[1;1HTests for string and html text objects. vim: set ft=vim :

Note that the end-of-line moves the cursor to the next test line.

Also test match() and matchstr()

STARTTEST
:so small.vim
/^start:/
da"
0va'a'rx
02f`da`
0fXdi"
03f'vi'ry
:set quoteescape=+*-
di`
$F"va"oha"i"rz
:"
/^<begin
jfXdit
0fXdit
fXdat
0fXdat
:"
:put =matchstr(\"abcd\", \".\", 0, 2) " b
:put =matchstr(\"abcd\", \"..\", 0, 2) " bc
:put =matchstr(\"abcd\", \".\", 2, 0) " c (zero and negative -> first match)
:put =matchstr(\"abcd\", \".\", 0, -1) " a
:put =match(\"abcd\", \".\", 0, 5) " -1
:put =match(\"abcd\", \".\", 0, -1) " 0
:/^start:/,/^end:/wq! test.out
ENDTEST

start: "wo\"rd\\" foo
'foo' 'bar' 'piep'
bla bla `quote` blah
out " in "noXno"
"'" 'blah' rep 'buh'
bla `s*`d-`+++`l**` b`la
voo "nah" sdf " asdf" sdf " sdf" sd

<begin>
-<b>asdf<i>Xasdf</i>asdf</b>-
-<b>asdX<i>a<i />sdf</i>asdf</b>-
-<b>asdf<i>Xasdf</i>asdf</b>-
-<b>asdX<i>as<b />df</i>asdf</b>-[1;1H[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[7;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[8;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 24 lines, 461 characters written[8;1H[47;1H[K[47;1H:set ff& cpo+=A[8;1H[47;1H/ENDTEST[47;10H[K[47;1H[32;1H
[47;1H[K[47;1H:so! Xdotest[33;1H[47;1H[K[47;1H:so small.vim[33;1H[47;1H[K[47;1H/^start:/[47;9H[K[47;1H[34;1H[7Cfo[34;11H[K[34;8H[35;8H[7m'foo' 'bar'[mxxxxxxxxxxxx
[14Cblah[36;13H[K[36;9H[37;9H[12C"[37;12H[K[37;11H[38;11H[9C'[7m rep[myyyyy[39;11H[47;1H[K[47;1H:set quoteescape=+*-[39;11H` b`la[39;12H[K[39;6H[40;6H[29C[7m" sdf"[m"[5C[7m [40;27H"[40;16H asdf" sdf [40;15H[40;7Hah" sdf "[mvoo "zzzzzzzzzzzzzzzzzzzzzzzzzzzzvoo "
[47;1H[K[47;1H:"[41;1H[47;1H[K[47;1H/^<begin[42;1H
[11C</i>asdf</b>-[43;25H[K[43;12H[44;12H[7C</b>-[44;10H[K[44;5H
-<b>[7Casdf</b>-[45;18H[K[45;9H[46;9H[7C--[46;3H[K[46;2H[1;46r[46;1H
[1;47r[46;1H</begin>[47;1H[K[46;2H
:"[46;2H[47;1H[K[47;1H:put =matchstr(\"abcd\", \".\", 0, 2) " b[1;46r[46;1H
[1;47r[46;1Hb[47;1H[K[46;1H
:put =matchstr(\"abcd\", \"..\", 0, 2) " bc[1;46r[46;1H
[1;47r[46;1Hbc[47;1H[K[46;1H
:put =matchstr(\"abcd\", \".\", 2, 0) " c (zero and negative -> first match)[1;46r[46;1H
[1;47r[46;1Hc[47;1H[K[46;1H
:put =matchstr(\"abcd\", \".\", 0, -1) " a[1;46r[46;1H
[1;47r[46;1Ha[47;1H[K[46;1H
:put =match(\"abcd\", \".\", 0, 5) " -1[1;46r[46;1H
[1;47r[46;1H-1[47;1H[K[46;1H
:put =match(\"abcd\", \".\", 0, -1) " 0[1;46r[46;1H
[1;47r[46;1H0[47;1H[K[46;1H
:/^start:/,/^end:/wq! test.out[7msearch hit BOTTOM, continuing at TOP[m"test.out" [47;12H[K[47;12H[New File] 21 lines, 217 characters written[?1l>
rm -rf X* test.ok viminfo
rm -rf test54.failed test.ok test.out X* viminfo
cp test54.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test54.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test54.in" 17 lines, 527 characters[1;1HSome tests for buffer-local autocommands

STARTTEST
:so small.vim
:e xx
:!rm -f test.out
:au BufLeave <buffer> :!echo buffer-local autommand in %>> test.out
:e somefile[11C" here, autocommand for xx shall write test.out
:[21C" but autocommand shall not apply to buffer named <buffer>
:bwipe xx[13C" here, autocommand shall be auto-deleted
:e xx[17C" nothing shall be written
:e somefile[11C" nothing shall be written
:qa!
ENDTEST

start of test file xx
end of test file xx
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 10 lines, 424 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[14;1H
[47;1H[K[47;1H:so! Xdotest[15;1H[47;1H[K[47;1H:so small.vim[15;1H[47;1H[K[47;1H:e xx"xx" [New File][1;1H[K[2;1H[1m~[m[3;2H[K[3;1H[1m~[m[4;2H[K[4;1H[1m~[m[5;2H[K[5;1H[1m~[m[6;2H[K[6;1H[1m~[m[7;2H[K[7;1H[1m~[m[8;2H[K[8;1H[1m~[m[9;23H[K[9;1H[1m~[m[10;2H[K[10;1H[1m~[m[11;2H[K[11;1H[1m~[m[12;2H[K[12;1H[1m~[m[13;2H[K[13;1H[1m~[m[14;2H[K[14;1H[1m~
~[m[16;2H[K[16;1H[1m~[m[17;2H[K[17;1H[1m~[1;1H[m[47;1H[K[47;1H:!rm -f test.out[16C[?1l>[47;1H
[?1h=[47;1H
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:au BufLeave <buffer> :!echo buffer-local autommand in %>> test.out[m[H[2J[2;1H[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[47;1H[m:e somefile           " here, autocommand for xx shall write test.out :!echo buffer-local autommand in xx>> test.out[47;47H[K[47;47H
[m"somefile" [New File]
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:                     " but autocommand shall not apply to buffer named <buffer>[m[H[2J[2;1H[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[47;1H[m:bwipe xx             " here, autocommand shall be auto-deleted[1;1H[47;1H[K[47;1H:e xx                 " nothing shall be written"xx" [New File][47;23H[K[1;1H[47;1H[K[47;1H:e somefile           " nothing shall be written"somefile" [New File][47;23H[K[1;1H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test55.failed test.ok test.out X* viminfo
cp test55.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test55.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test55.in" 343 lines, 6998 characters[1;1HTests for List and Dictionary types.     vim: set ft=vim :

STARTTEST
:so small.vim
:fun Test(...)
:" Creating List directly with different types
:let l = [1, 'as''d', [1, 2, function("strlen")], {'a': 1},]
:$put =string(l)
:$put =string(l[-1])
:$put =string(l[-4])
:try
:  $put =string(l[-5])
:catch
:  $put =v:exception[:14]
:endtry
:" List slices
:$put =string(l[:])
:$put =string(l[1:])
:$put =string(l[:-2])
:$put =string(l[0:8])
:$put =string(l[8:-1])
:"
:" List identity
:let ll = l
:let lx = copy(l)
:try
:  $put =(l == ll) . (l isnot ll) . (l is ll) . (l == lx) . (l is lx) . (l isnot lx)
:catch
:  $put =v:exception
:endtry
:"
:" Creating Dictionary directly with different types
:let d = {001: 'asd', 'b': [1, 2, function('strlen')], -1: {'a': 1},}
:$put =string(d) . d.1
:$put =string(sort(keys(d)))
:$put =string (values(d))
:for [key, val] in items(d)
:  $put =key . ':' . string(val)
:  unlet key val
:endfor
:call extend  (d, {3:33, 1:99})
:call extend(d, {'b':'bbb', 'c':'ccc'}, "keep")
:try
:  call extend(d, {3:333,4:444}, "error")
:catch
:  $put =v:exception[:15] . v:exception[-1:-1][1;1H[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 337 lines, 6912 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[m[H[2J[1;1H:  let a:000[2] = [9, 10]
:catch
:  $put ='caught a:000[2]'
:endtry
:try
:  let a:000[3] = {9: 10}
:catch
:  $put ='caught a:000[3]'
:endtry
:" now the tests that should pass
:try
:  let a:000[2][1] = 9
:  call extend(a:000[2], [5, 6])
:  let a:000[3][5] = 8
:  let a:000[3]['a'] = 12
:  $put =string(a:000)
:catch
:  $put ='caught ' . v:exception
:endtry
:"
:" reverse() and sort()
:let l = ['-0', 'A11', 2, 'xaaa', 4, 'foo', 'foo6', [0, 1, 2], 'x8']
:$put =string(reverse(l))
:$put =string(reverse(reverse(l)))
:$put =string(sort(l))
:$put =string(reverse(sort(l)))
:$put =string(sort(reverse(sort(l))))
:"
:" splitting a string to a List
:$put =string(split('  aa  bb '))
:$put =string(split('  aa  bb  ', '\W\+', 0))
:$put =string(split('  aa  bb  ', '\W\+', 1))
:$put =string(split('  aa  bb  ', '\W', 1))
:$put =string(split(':aa::bb:', ':', 0))
:$put =string(split(':aa::bb:', ':', 1))
:$put =string(split('aa,,bb, cc,', ',\s*', 1))
:$put =string(split('abc', '\zs'))
:$put =string(split('abc', '\zs', 1))
:"
:endfun
:call Test(1, 2, [3, 4], {5: 6})  " This may take a while
:"
:/^start:/,$wq! test.out
ENDTEST

start:[44;1H


:so! Xdotest[45;1H[47;1H[K[47;1H:so small.vim[45;1H[47;1H[K[47;1H:fun Test(...)
:  :" Creating List directly with different types
:  :let l = [1, 'as''d', [1, 2, function("strlen")], {'a': 1},]
:  :$put =string(l)
:  :$put =string(l[-1])
:  :$put =string(l[-4])
:  :try
:    :  $put =string(l[-5])
:    :catch
:    :  $put =v:exception[:14]
:    :endtry
:  :" List slices
:  :$put =string(l[:])
:  :$put =string(l[1:])
:  :$put =string(l[:-2])
:  :$put =string(l[0:8])
:  :$put =string(l[8:-1])
:  :"
:  :" List identity
:  :let ll = l
:  :let lx = copy(l)
:  :try
:    :  $put =(l == ll) . (l isnot ll) . (l is ll) . (l == lx) . (l is lx) . (l isnot lx)
:    :catch
:    :  $put =v:exception
:    :endtry
:  :"
:  :" Creating Dictionary directly with different types
:  :let d = {001: 'asd', 'b': [1, 2, function('strlen')], -1: {'a': 1},}
:  :$put =string(d) . d.1
:  :$put =string(sort(keys(d)))
:  :$put =string (values(d))
:  :for [key, val] in items(d)
:    :  $put =key . ':' . string(val)
:    :  unlet key val
:    :endfor
:  :call extend  (d, {3:33, 1:99})
:  :call extend(d, {'b':'bbb', 'c':'ccc'}, "keep")
:  :try
:    :  call extend(d, {3:333,4:444}, "error")
:    :catch
:    :  $put =v:exception[:15] . v:exception[-1:-1]
:    :endtry
:  :$put =string(d)
:  :call filter(d, 'v:key =~ ''[ac391]''')
:  :$put =string(d)
:  :"
:  :" Dictionary identity
:  :let dd = d
:  :let dx = copy(d)
:  :try
:    :  $put =(d == dd) . (d isnot dd) . (d is dd) . (d == dx) . (d is dx) . (d isnot dx)
:    :catch
:    :  $put =v:exception
:    :endtry
:  :"
:  :" Changing var type should fail
:  :try
:    :  let d = []
:    :catch
:    :  $put =v:exception[:14] . v:exception[-1:-1]
:    :endtry
:  :try
:    :  let l = {}
:    :catch
:    :  $put =v:exception[:14] . v:exception[-1:-1]
:    :endtry
:  :"
:  :" removing items with :unlet
:  :unlet l[2]
:  :$put =string(l)
:  :let l = range(8)
:  :try
:    :unlet l[:3]
:    :unlet l[1:]
:    :catch
:    :$put =v:exception
:    :endtry
:  :$put =string(l)
:  :"
:  :unlet d.c
:  :unlet d[-1]
:  :$put =string(d)
:  :"
:  :" removing items out of range: silently skip items that don't exist
:  let l = [0, 1, 2, 3]
:  :unlet l[2:1]
:  :$put =string(l)
:  let l = [0, 1, 2, 3]
:  :unlet l[2:2]
:  :$put =string(l)
:  let l = [0, 1, 2, 3]
:  :unlet l[2:3]
:  :$put =string(l)
:  let l = [0, 1, 2, 3]
:  :unlet l[2:4]
:  :$put =string(l)
:  let l = [0, 1, 2, 3]
:  :unlet l[2:5]
:  :$put =string(l)
:  let l = [0, 1, 2, 3]
:  :unlet l[-1:2]
:  :$put =string(l)
:  let l = [0, 1, 2, 3]
:  :unlet l[-2:2]
:  :$put =string(l)
:  let l = [0, 1, 2, 3]
:  :unlet l[-3:2]
:  :$put =string(l)
:  let l = [0, 1, 2, 3]
:  :unlet l[-4:2]
:  :$put =string(l)
:  let l = [0, 1, 2, 3]
:  :unlet l[-5:2]
:  :$put =string(l)
:  let l = [0, 1, 2, 3]
:  :unlet l[-6:2]
:  :$put =string(l)
:  :"
:  :" assignment to a list
:  :let l = [0, 1, 2, 3]
:  :let [va, vb] = l[2:3]
:  :$put =va
:  :$put =vb
:  :try
:    :  let [va, vb] = l
:    :catch
:    :  $put =v:exception[:14]
:    :endtry
:  :try
:    :  let [va, vb] = l[1:1]
:    :catch
:    :  $put =v:exception[:14]
:    :endtry
:  :"
:  :" manipulating a big Dictionary (hashtable.c has a border of 1000 entries)
:  :let d = {}
:  :for i in range(1500)
:    : let d[i] = 3000 - i
:    :endfor
:  :$put =d[0] . ' ' . d[100] . ' ' . d[999] . ' ' . d[1400] . ' ' . d[1499]
:  :try
:    :  let n = d[1500]
:    :catch
:    :  $put =v:exception[:14] . v:exception[-4:-1]
:    :endtry
:  :" lookup each items
:  :for i in range(1500)
:    : if d[i] != 3000 - i
:      :  $put =d[i]
:      : endif
:    :endfor
:  : let i += 1
:  :" delete even items
:  :while i >= 2
:    : let i -= 2
:    : unlet d[i]
:    :endwhile
:  :$put =get(d, 1500 - 100, 'NONE') . ' ' . d[1]
:  :" delete odd items, checking value, one intentionally wrong
:  :let d[33] = 999
:  :let i = 1
:  :while i < 1500
:    : if d[i] != 3000 - i
:      :  $put =i . '=' . d[i]
:      : else
:      :  unlet d[i]
:      : endif
:    : let i += 2
:    :endwhile
:  :$put =string(d)  " must be almost empty now
:  :unlet d
:  :"
:  :" Dictionary function
:  :let dict = {}
:  :func dict.func(a) dict
:    :  $put =a:a . len(self.data)
:    :endfunc
:    :let dict.data = [1,2,3]
:    :call dict.func("len: ")
:    :let x = dict.func("again: ")
:    :try
:      :  let Fn = dict.func
:      :  call Fn('xxx')
:      :catch
:      :  $put =v:exception[:15]
:      :endtry
:    :" 
:    :" Function in script-local List or Dict
:    :let g:dict = {}
:    :function g:dict.func() dict
:      :  $put ='g:dict.func'.self.foo[1].self.foo[0]('asdf')
:      :endfunc
:      :let g:dict.foo = ['-', 2, 3]
:      :call insert(g:dict.foo, function('strlen'))
:      :call g:dict.func()
:      :" 
:      :" Nasty: remove func from Dict that's being called (works)
:      :let d = {1:1}
:      :func d.func(a)
:[8C:  return "a:". a:a
:[8C:endfunc
:[8C:$put =d.func(string(remove(d, 'func')))
:[8C:"
:[8C:" Nasty: deepcopy() dict that refers to itself (fails when noref used)
:[8C:let d = {1:1, 2:2}
:[8C:let l = [4, d, 6]
:[8C:let d[3] = l
:[8C:let dc = deepcopy(d)
:[8C:try
:[10C:  let dc = deepcopy(d, 1)
:[10C:catch
:[10C:  $put =v:exception[:14]
:[10C:endtry
:[8C:let l2 = [0, l, l, 3]
:[8C:let l[1] = l2
:[8C:let l3 = deepcopy(l2)
:[8C:$put ='same list: ' . (l3[1] is l3[2])
:[8C:"
:[8C:" Locked variables
:[8C:for depth in range(5)
:[10C:  $put ='depth is ' . depth
:[10C:  for u in range(3)
:[12C:    unlet l
:[12C:    let l = [0, [1, [2, 3]], {4: 5, 6: {7: 8}}]
:[12C:    exe "lockvar " . depth . " l"
:[12C:    if u == 1
:[14C:      exe "unlockvar l"
:[14C:    elseif u == 2
:[14C:      exe "unlockvar " . depth . " l"
:[14C:    endif
:[12C:    let ps = islocked("l").islocked("l[1]").islocked("l[1][1]").islocked("l[1][1][0]").'-'.islocked("l[2]").islo
[46;127Hc[47;1Hked("l[2]['6']").islocked("l[2]['6'][7]")
:[12C:    $put =ps
:[12C:    let ps = ''
:[12C:    try
:[14C:      let l[1][1][0] = 99
:[14C:      let ps .= 'p'
:[14C:    catch
:[14C:      let ps .= 'F'
:[14C:    endtry
:[12C:    try
:[14C:      let l[1][1] = [99]
:[14C:      let ps .= 'p'
:[14C:    catch
:[14C:      let ps .= 'F'
:[14C:    endtry
:[12C:    try
:[14C:      let l[1] = [99]
:[14C:      let ps .= 'p'
:[14C:    catch
:[14C:      let ps .= 'F'
:[14C:    endtry
:[12C:    try
:[14C:      let l[2]['6'][7] = 99
:[14C:      let ps .= 'p'
:[14C:    catch
:[14C:      let ps .= 'F'
:[14C:    endtry
:[12C:    try
:[14C:      let l[2][6] = {99: 99}
:[14C:      let ps .= 'p'
:[14C:    catch
:[14C:      let ps .= 'F'
:[14C:    endtry
:[12C:    try
:[14C:      let l[2] = {99: 99}
:[14C:      let ps .= 'p'
:[14C:    catch
:[14C:      let ps .= 'F'
:[14C:    endtry
:[12C:    try
:[14C:      let l = [99]
:[14C:      let ps .= 'p'
:[14C:    catch
:[14C:      let ps .= 'F'
:[14C:    endtry
:[12C:    $put =ps
:[12C:  endfor
:[10C:endfor
:[8C:"
:[8C:" a:000 function argument
:[8C:" first the tests that should fail
:[8C:try
:[10C:  let a:000 = [1, 2]
:[10C:catch
:[10C:  $put ='caught a:000'
:[10C:endtry
:[8C:try
:[10C:  let a:000[0] = 9
:[10C:catch
:[10C:  $put ='caught a:000[0]'
:[10C:endtry
:[8C:try
:[10C:  let a:000[2] = [9, 10]
:[10C:catch
:[10C:  $put ='caught a:000[2]'
:[10C:endtry
:[8C:try
:[10C:  let a:000[3] = {9: 10}
:[10C:catch
:[10C:  $put ='caught a:000[3]'
:[10C:endtry
:[8C:" now the tests that should pass
:[8C:try
:[10C:  let a:000[2][1] = 9
:[10C:  call extend(a:000[2], [5, 6])
:[10C:  let a:000[3][5] = 8
:[10C:  let a:000[3]['a'] = 12
:[10C:  $put =string(a:000)
:[10C:catch
:[10C:  $put ='caught ' . v:exception
:[10C:endtry
:[8C:"
:[8C:" reverse() and sort()
:[8C:let l = ['-0', 'A11', 2, 'xaaa', 4, 'foo', 'foo6', [0, 1, 2], 'x8']
:[8C:$put =string(reverse(l))
:[8C:$put =string(reverse(reverse(l)))
:[8C:$put =string(sort(l))
:[8C:$put =string(reverse(sort(l)))
:[8C:$put =string(sort(reverse(sort(l))))
:[8C:"
:[8C:" splitting a string to a List
:[8C:$put =string(split('  aa  bb '))
:[8C:$put =string(split('  aa  bb  ', '\W\+', 0))
:[8C:$put =string(split('  aa  bb  ', '\W\+', 1))
:[8C:$put =string(split('  aa  bb  ', '\W', 1))
:[8C:$put =string(split(':aa::bb:', ':', 0))
:[8C:$put =string(split(':aa::bb:', ':', 1))
:[8C:$put =string(split('aa,,bb, cc,', ',\s*', 1))
:[8C:$put =string(split('abc', '\zs'))
:[8C:$put =string(split('abc', '\zs', 1))
:[8C:"
:[8C:endfun[m[H[2J[1;1H:  let a:000[2] = [9, 10]
:catch
:  $put ='caught a:000[2]'
:endtry
:try
:  let a:000[3] = {9: 10}
:catch
:  $put ='caught a:000[3]'
:endtry
:" now the tests that should pass
:try
:  let a:000[2][1] = 9
:  call extend(a:000[2], [5, 6])
:  let a:000[3][5] = 8
:  let a:000[3]['a'] = 12
:  $put =string(a:000)
:catch
:  $put ='caught ' . v:exception
:endtry
:"
:" reverse() and sort()
:let l = ['-0', 'A11', 2, 'xaaa', 4, 'foo', 'foo6', [0, 1, 2], 'x8']
:$put =string(reverse(l))
:$put =string(reverse(reverse(l)))
:$put =string(sort(l))
:$put =string(reverse(sort(l)))
:$put =string(sort(reverse(sort(l))))
:"
:" splitting a string to a List
:$put =string(split('  aa  bb '))
:$put =string(split('  aa  bb  ', '\W\+', 0))
:$put =string(split('  aa  bb  ', '\W\+', 1))
:$put =string(split('  aa  bb  ', '\W', 1))
:$put =string(split(':aa::bb:', ':', 0))
:$put =string(split(':aa::bb:', ':', 1))
:$put =string(split('aa,,bb, cc,', ',\s*', 1))
:$put =string(split('abc', '\zs'))
:$put =string(split('abc', '\zs', 1))
:"
:endfun
:call Test(1, 2, [3, 4], {5: 6})  " This may take a while
:"
:/^start:/,$wq! test.out
ENDTEST

start:[45;1H

:call Test(1, 2, [3, 4], {5: 6})  " This may take a while[1;1H1000-000[1;9H[K[2;1HppppppF
0000-000[3;9H[K[4;1Hppppppp
0000-000
ppppppp[6;8H[K[7;1Hdepth is 2
1100-100[8;9H[K[9;1HppFppFF
0000-000[10;9H[K[11;1Hppppppp
0000-000[12;9H[K[13;1Hppppppp[13;9H[K[14;1Hdepth is 3[14;11H[K[15;1H1110-110[15;9H[K[16;1HpFFpFFF[16;9H[K[17;1H0010-010
pFppFpp[18;9H[K[19;1H0000-000
ppppppp
depth is 4[21;11H[K[22;1H1111-111[22;10H[K[23;1HFFFFFFF[23;8H[K[24;1H0011-011[24;9H[K[25;1HFFpFFpp[25;8H[K[26;1H0000-000[26;9H[K[27;1Hppppppp[27;8H[K[28;1Hcaught a:000
caught a:000[0][29;16H[K[30;1Hcaught a:000[2][30;16H[K[31;1Hcaught a:000[3][31;16H[K[32;1H[1, 2, [3, 9, 5, 6], {'a': 12, '5': 8}][32;40H[K[33;1H['x8', [0, 1, 2], 'foo6', 'foo', 4, 'xaaa', 2, 'A11', '-0']
['x8', [0, 1, 2], 'foo6', 'foo', 4, 'xaaa', 2, 'A11', '-0']
['-0', 'A11', 'foo', 'foo6', 'x8', 'xaaa', 2, 4, [0, 1, 2]]
[[0, 1, 2], 4, 2, 'xaaa', 'x8', 'foo6', 'foo', 'A11', '-0']
['-0', 'A11', 'foo', 'foo6', 'x8', 'xaaa', 2, 4, [0, 1, 2]]
['aa', 'bb'][38;13H[K[39;1H['aa', 'bb']
['', 'aa', 'bb', '']
['', '', 'aa', '', 'bb', '', ''][41;35H[K[42;1H['aa', '', 'bb']
['', 'aa', '', 'bb', '']
['aa', '', 'bb', 'cc', '']
['a', 'b', 'c']
['', 'a', '', 'b', '', 'c', ''][47;1H[K[47;1H:"[46;1H[47;1H[K[47;1H:/^start:/,$wq! test.out[7msearch hit BOTTOM, continuing at TOP[m"test.out" [47;12H[K[47;12H[New File] 107 lines, 1891 characters written[?1l>
rm -rf X* test.ok viminfo
rm -rf test56.failed test.ok test.out X* viminfo
cp test56.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test56.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test56.in" 21 lines, 388 characters[1;1HTest for script-local function.     vim: set ft=vim :

STARTTEST
:so small.vim
:"
:set nocp
:/^start:/+1,/^end:/-1w! Xtest.vim
:source Xtest.vim
_x
:$-1,$wq! test.out
ENDTEST

start:
fun <SID>DoLast()
  call append(line('$'), "last line")
endfun
fun s:DoNothing()
  call append(line('$'), "nothing line")
endfun
nnoremap <buffer> _x    :call <SID>DoNothing()<bar>call <SID>DoLast()<cr>
end:
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 7 lines, 102 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[11;1H
[47;1H[K[47;1H:so! Xdotest[12;1H[47;1H[K[47;1H:so small.vim[12;1H[47;1H[K[47;1H:"[12;1H[47;1H[K[47;1H:set nocp[12;1H[47;1H[K[47;1H:/^start:/+1,/^end:/-1w! Xtest.vim"Xtest.vim" [47;13H[K[47;13H[New] 7L, 200C written[12;1H[47;1H[K[47;1H:source Xtest.vim[12;1H[47;1H[K[47;1H:call <SNR>3_DoNothing()|call <SNR>3_DoLast()[22;1Hnothing line
last line[12;1H
[47;1H[K[47;1H:$-1,$wq! test.out"test.out" [47;12H[K[47;12H[New] 2L, 23C written[?1l>
rm -rf X* test.ok viminfo
rm -rf test57.failed test.ok test.out X* viminfo
cp test57.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test57.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test57.in" 496 lines, 3654 characters[1;1HTests for :sort command.     vim: set ft=vim :

STARTTEST
:so small.vim
:"
:/^t01:/+1,/^t02/-1sort
:/^t02:/+1,/^t03/-1sort n
:/^t03:/+1,/^t04/-1sort x
:/^t04:/+1,/^t05/-1sort u
:/^t05:/+1,/^t06/-1sort!
:/^t06:/+1,/^t07/-1sort! n
:/^t07:/+1,/^t08/-1sort! u
:/^t08:/+1,/^t09/-1sort o
:/^t09:/+1,/^t10/-1sort! x
:/^t10:/+1,/^t11/-1sort/./
:/^t11:/+1,/^t12/-1sort/../
:/^t12:/+1,/^t13/-1sort/../u
:/^t13:/+1,/^t14/-1sort/./n
:/^t14:/+1,/^t15/-1sort/./r
:/^t15:/+1,/^t16/-1sort/../r
:/^t16:/+1,/^t17/-1sort/./rn
:/^t17:/+1,/^t18/-1sort/\d/
:/^t18:/+1,/^t19/-1sort/\d/r
:/^t19:/+1,/^t20/-1sort/\d/n
:/^t20:/+1,/^t21/-1sort/\d/rn
:/^t21:/+1,/^t22/-1sort/\d\d/
:/^t22:/+1,/^t23/-1sort/\d\d/n
:/^t23:/+1,/^t24/-1sort/\d\d/x
:/^t24:/+1,/^t25/-1sort/\d\d/r
:/^t25:/+1,/^t26/-1sort/\d\d/rn
:/^t26:/+1,/^t27/-1sort/\d\d/rx
:/^t27:/+1,/^t28/-1sort no
:/^t01:/,$wq! test.out
ENDTEST

t01: alphebetical
abc
ab
a
a321
a123
a122
b321
b123
c123d
 123b[1;1H[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 30 lines, 842 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[34;1H
[47;1H[K[47;1H:so! Xdotest[35;1H[47;1H[K[47;1H:so small.vim[35;1H[47;1H[K[47;1H:"[35;1H[47;1H[K[47;1H:/^t01:/+1,/^t02/-1sort[37;1H[K[38;1H[K[39;1H 123b[40;2H[K[41;4H2
a123
a
ab[44;3H[K[45;1Habc[45;4H[K[46;1Hb[46;5H[K[37;1H[47;1H[K[47;1H:/^t02:/+1,/^t03/-1sort n[1;46r[1;1H[8M[1;47r[39;1Hb321
b321
b321b
b322b
c123d
c321d
t02: numeric
abc[47;1H[K[46;1H
:/^t03:/+1,/^t04/-1sort x[1;46r[1;1H[17M[1;47r[30;1Hab
a


a122
a123
b123
c123d
 123b
a321
b321
c321d
b321
b321b
b322b
t03: hexadecimal[47;1H[K[46;1H
:/^t04:/+1,/^t05/-1sort u[1;46r[1;1H[17M[1;47r[31;1Ha
ab
abc
 123b
a122
a123
a321
b123
b321
b321
b321b
b322b
c123d
c321d
t04: alpha, unique[47;1H[K[46;1H
:/^t05:/+1,/^t06/-1sort![1;46r[1;1H[15M[1;47r[32;2H123b
a
a122
a123
a321
ab
abc
b123
b321
b321b
b322b
c123d
c321d
t05: alpha, reverse
c321d[47;1H[K[46;1H
:/^t06:/+1,/^t07/-1sort! n        [1;46r[1;1H[17M[1;47r[30;1Hc123d
b322b
b321b
b321
b321
b123
abc
ab
a321
a123
a122
a
 123b


t06: numeric, reverse
b322b[47;1H[K[46;1H
:/^t07:/+1,/^t08/-1sort! u[1;46r[1;1H[17M[1;47r[30;1Hb321b
b321
c321d
b321
a321
 123b
c123d
b123
a123
a122


a
ab
abc
t07: unique, reverse
c321d[47;1H[K[46;1H
:/^t08:/+1,/^t09/-1sort o         [1;46r[1;1H[15M[1;47r[32;1Hc123d
b322b
b321b
b321
b123
abc
ab
a321
a123
a122
a
 123b

t08: octal
abc[47;1H[K[46;1H
:/^t09:/+1,/^t10/-1sort! x        [1;46r[1;1H[17M[1;47r[30;1Hab
a


a122
a123
b123
c123d
 123b
a321
b321
c321d
b321
b321b
b322b
t09: reverse, hexadecimal
c321d[47;1H[K[46;1H
:/^t10:/+1,/^t11/-1sort/./        [1;46r[1;1H[17M[1;47r[30;1Hc123d
b322b
b321b
b321
b321
b123
a321
a123
a122
 123b
abc
ab
a


t10: alpha, skip first character
a[47;1H[K[46;1H
:/^t11:/+1,/^t12/-1sort/../       [1;46r[1;1H[17M[1;47r[32;1Ha122
a123
b123
 123b
c123d
a321
b321
b321
b321b
c321d
b322b
ab
abc
t11: alpha, skip first 2 characters
ab[47;1H[K[46;1H
:/^t12:/+1,/^t13/-1sort/../u[1;46r[1;1H[17M[1;47r[30;1Ha


a321
b321
b321
b321b
c321d
a122
b322b
a123
b123
 123b
c123d
abc
t12: alpha, unique, skip first 2 characters
ab[47;1H[K[46;1H
:/^t13:/+1,/^t14/-1sort/./n[1;46r[1;1H[15M[1;47r[32;1Ha

a321
b321
b321b
c321d
a122
b322b
a123
b123
 123b
c123d
abc
t13: numeric, skip first character
abc[47;1H[K[46;1H
:/^t14:/+1,/^t15/-1sort/./r[1;46r[1;1H[17M[1;47r[30;1Hab
a


a122
a123
b123
c123d
 123b
a321
b321
c321d
b321
b321b
b322b
t14: alpha, sort on first character[47;1H[K[46;1H
:/^t15:/+1,/^t16/-1sort/../r[1;46r[1;1H[17M[1;47r[31;2H123b
abc
ab
a
a321
a123
a122
b321
b123
b322b
b321
b321b
c123d
c321d
t15: alpha, sort on first 2 characters
a[47;1H[K[46;1H
:/^t16:/+1,/^t17/-1sort/./rn[1;46r[1;1H[17M[1;47r[32;2H123b
a123
a122
a321
abc
ab
b123
b321
b322b
b321
b321b
c123d
c321d
t16: numeric, sort on first character
abc[47;1H[K[46;1H
:/^t17:/+1,/^t18/-1sort/\d/[1;46r[1;1H[17M[1;47r[30;1Hab
a
a321
a123
a122
b321
b123
c123d
 123b
c321d
b322b
b321
b321b


t17: alpha, skip past first digit
abc[47;1H[K[46;1H
:/^t18:/+1,/^t19/-1sort/\d/r[1;46r[1;1H[17M[1;47r[30;1Hab
a


a321
b321
b321
b321b
c321d
a122
b322b
a123
b123
 123b
c123d
t18: alpha, sort on first digit
abc[47;1H[K[46;1H
:/^t19:/+1,/^t20/-1sort/\d/n[1;46r[1;1H[17M[1;47r[30;1Hab
a


a123
a122
b123
c123d
 123b
a321
b321
c321d
b322b
b321
b321b
t19: numeric, skip past first digit
abc[47;1H[K[46;1H
:/^t20:/+1,/^t21/-1sort/\d/rn[1;46r[1;1H[17M[1;47r[30;1Hab
a


a321
b321
c321d
b321
b321b
a122
b322b
a123
b123
c123d
 123b
t20: numeric, sort on first digit
abc[47;1H[K[46;1H
:/^t21:/+1,/^t22/-1sort/\d\d/[1;46r[1;1H[17M[1;47r[30;1Hab
a


a123
a122
b123
c123d
 123b
a321
b321
c321d
b322b
b321
b321b
t21: alpha, skip past first 2 digits
abc[47;1H[K[46;1H
:/^t22:/+1,/^t23/-1sort/\d\d/n[1;46r[1;1H[17M[1;47r[30;1Hab
a


a321
b321
b321
b321b
c321d
a122
b322b
a123
b123
 123b
c123d
t22: numeric, skip past first 2 digits
abc[47;1H[K[46;1H
:/^t23:/+1,/^t24/-1sort/\d\d/x[1;46r[1;1H[17M[1;47r[30;1Hab
a


a321
b321
c321d
b321
b321b
a122
b322b
a123
b123
c123d
 123b
t23: hexadecimal, skip past first 2 digits
abc[47;1H[K[46;1H
:/^t24:/+1,/^t25/-1sort/\d\d/r[1;46r[1;1H[17M[1;47r[30;1Hab
a


a321
b321
b321
a122
a123
b123
b321b
c321d
b322b
 123b
c123d
t24: alpha, sort on first 2 digits
abc[47;1H[K[46;1H
:/^t25:/+1,/^t26/-1sort/\d\d/rn[1;46r[1;1H[17M[1;47r[30;1Hab
a


a123
a122
b123
c123d
 123b
a321
b321
c321d
b322b
b321
b321b
t25: numeric, sort on first 2 digits
abc[47;1H[K[46;1H
:/^t26:/+1,/^t27/-1sort/\d\d/rx[1;46r[1;1H[17M[1;47r[30;1Hab
a


a123
a122
b123
c123d
 123b
a321
b321
c321d
b322b
b321
b321b
t26: hexadecimal, sort on first 2 digits
abc[47;1H[K[46;1H
:/^t27:/+1,/^t28/-1sort no[7mE474: Invalid argument[m[47;23H[K[46;1H[47;1H[K[47;1H:/^t01:/,$wq! test.out[7msearch hit BOTTOM, continuing at TOP[m"test.out" [47;12H[K[47;12H[New File] 455 lines, 2727 characters written[?1l>
rm -rf X* test.ok viminfo
rm -rf test58.failed test.ok test.out X* viminfo
cp test58.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test58.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test58.in" 630 lines, 10705 characters[1;1HTests for spell checking.     vim: set ft=vim :

STARTTEST
:so small.vim
:"
:" Don't want to depend on the locale from the environment
:set enc=latin1
:e!
:"
:" Function to test .aff/.dic with list of good and bad words.
:func TestOne(aff, dic)
  set spellfile=
  $put =''
  $put ='test '. a:aff . '-' . a:dic
  " Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
  mkspell! Xtest Xtest
  " use that spell file
  set spl=Xtest.latin1.spl spell
  " list all valid words
  spelldump
  %yank
  quit
  $put
  $put ='-------'
  " find all bad words and suggestions for them
  exe '1;/^' . a:aff . 'good:'
  normal 0f:]s
  let prevbad = ''
  while 1
    let [bad, a] = spellbadword()
    if bad == '' || bad == prevbad || bad == 'badend'[34;7Hbreak
    endif
    let prevbad = bad
    let lst = spellsuggest(bad, 3)
    normal mm
    $put =bad
    $put =string(lst)
    normal `m]s
  endwhile
endfunc
:"
:call TestOne('1', '1')
:$put =soundfold('goobledygoook')[1;1H[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 100 lines, 2377 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[m[H[2J[1;1H:$put =str
:set spl=Xtest_ca.latin1.spl
/^test2:
]smm:let [str, a] = spellbadword()
:$put =str
`m]s:let [str, a] = spellbadword()
:$put =str
:"
:" Postponed prefixes
:call TestOne('2', '1')
:"
:" Compound words
:call TestOne('3', '3')
:call TestOne('4', '4')
:call TestOne('5', '5')
:call TestOne('6', '6')
:call TestOne('7', '7')
:"
:" NOSLITSUGS
:call TestOne('8', '8')
:"
gg:/^test output:/,$wq! test.out
ENDTEST

1affstart
SET ISO8859-1
TRY esianrtolcdugmphbyfvkwjkqxz-'ESIANRTOLCDUGMPHBYFVKWJKQXZ

FOL  
LOW  
UPP  

SOFOFROM abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ޿
SOFOTO   ebctefghejklnnepkrstevvkesebctefghejklnnepkrstevvkeseeeeeeeceeeeeeeedneeeeeeeeeeepseeeeeeeeceeeeeeeedneeeeeeeeeeep?

MIDWORD '-

KEP =
RAR ?
BAD !

PFX I N 1
PFX I 0 in .

PFX O Y 1
PFX O 0 out .[23;1H
[47;1H:so! Xdotest[24;1H[47;1H[K[47;1H:so small.vim[24;1H[47;1H[K[47;1H:"[24;1H[47;1H[K[47;1H:" Don't want to depend on the locale from the environment[24;1H[47;1H[K[47;1H:set enc=latin1[m[H[2J[1;1H:$put =str
:set spl=Xtest_ca.latin1.spl
/^test2:
]smm:let [str, a] = spellbadword()
:$put =str
`m]s:let [str, a] = spellbadword()
:$put =str
:"
:" Postponed prefixes
:call TestOne('2', '1')
:"
:" Compound words
:call TestOne('3', '3')
:call TestOne('4', '4')
:call TestOne('5', '5')
:call TestOne('6', '6')
:call TestOne('7', '7')
:"
:" NOSLITSUGS
:call TestOne('8', '8')
:"
gg:/^test output:/,$wq! test.out
ENDTEST

1affstart
SET ISO8859-1
TRY esianrtolcdugmphbyfvkwjkqxz-'ESIANRTOLCDUGMPHBYFVKWJKQXZ

FOL  
LOW  
UPP  

SOFOFROM abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ޿
SOFOTO   ebctefghejklnnepkrstevvkesebctefghejklnnepkrstevvkeseeeeeeeceeeeeeeedneeeeeeeeeeepseeeeeeeeceeeeeeeedneeeeeeeeeeep?

MIDWORD '-

KEP =
RAR ?
BAD !

PFX I N 1
PFX I 0 in .

PFX O Y 1
PFX O 0 out .[24;1H[47;1H:e!"test58.in" 630 lines, 10705 characters[1;1HTests for spell checking.     vim: set ft=vim :[2;1H[K[3;1HSTARTTEST
:so small.vim[4;14H[K[5;2H"[5;3H[K[6;1H:" Don't want to depend on the locale from the environment
:set enc=latin1
:e![9;4H[K[10;2H" Function to test .aff/.dic with list of good and bad words.
:func TestOne(aff, dic)
  set spellfile=[12;17H[K[13;1H  $put =''[13;11H[K[14;1H  $put ='test '. a:aff . '-' . a:dic
  " Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
  mkspell! Xtest Xtest
  " use that spell file
  set spl=Xtest.latin1.spl spell
  " list all valid words
  spelldump[22;12H[K[23;1H  %yank
  quit
  $pu[25;7H[K[26;1H  $put ='-------'
  " find all bad words and suggestions for them[27;48H[K[28;3Hexe '1;/^' . a:aff . 'good:'
  normal 0f:]s[29;15H[K[30;1H  let prevbad = ''[30;19H[K[31;1H  while 1[31;10H[K[32;5Hlet [bad, a] = spellbadword()
    if bad == '' || bad == prevbad || bad == 'badend'[33;54H[K[34;1H      break[34;12H[K[35;5Hendif
    let prevbad = bad
    let lst = spellsuggest(bad, 3)
    normal mm
    $put =bad
    $put =string(lst)
    normal `m]s
  endwhile
endfunc[43;9H[K[44;1H:"
:call TestOne('1', '1')
:$put =soundfold('goobledygoook')[1;1H[47;1H[K[47;1H:"[1;1H[47;1H[K[47;1H:" Function to test .aff/.dic with list of good and bad words.[1;1H[47;1H[K[47;1H:func TestOne(aff, dic)
:    set spellfile=
:    $put =''
:    $put ='test '. a:aff . '-' . a:dic
:    " Generate a .spl file from a .dic and .aff file.
:    exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
:    exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
:    mkspell! Xtest Xtest
:    " use that spell file
:    set spl=Xtest.latin1.spl spell
:    " list all valid words
:    spelldump
:    %yank
:    quit
:    $put
:    $put ='-------'
:    " find all bad words and suggestions for them
:    exe '1;/^' . a:aff . 'good:'
:    normal 0f:]s
:    let prevbad = ''
:    while 1
:        let [bad, a] = spellbadword()
:        if bad == '' || bad == prevbad || bad == 'badend'
:            break
:          endif
:        let prevbad = bad
:        let lst = spellsuggest(bad, 3)
:        normal mm
:        $put =bad
:        $put =string(lst)
:        normal `m]s
:      endwhile
:  endfunc[1;1H[32L[1;1HTests for spell checking.     vim: set ft=vim :

STARTTEST
:so small.vim
:"
:" Don't want to depend on the locale from the environment
:set enc=latin1
:e!
:"
:" Function to test .aff/.dic with list of good and bad words.
:func TestOne(aff, dic)
  set spellfile=
  $put =''
  $put ='test '. a:aff . '-' . a:dic
  " Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
  mkspell! Xtest Xtest
  " use that spell file
  set spl=Xtest.latin1.spl spell
  " list all valid words
  spelldump
  %yank
  quit
  $put
  $put ='-------'
  " find all bad words and suggestions for them
  exe '1;/^' . a:aff . 'good:'
  normal 0f:]s
  let prevbad = ''
  while 1
    let [bad, a] = spellbadword()[47;1H[K[1;1H[47;1H:"[1;1H[47;1H[K[47;1H:call TestOne('1', '1')"Xtest.aff" [47;13H[K[47;13H[New File] 46 lines, 754 characters written
"Xtest.dic" [New File] 11 lines, 71 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - testCompressing word tree...[47;26H[K[47;1H
Compressed 29 of 127 nodes; 98 (77%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 490 bytes
Reading back spell file...
Performing soundfolding...
Total number of words: 16
Number of words after soundfolding: 16
Compressing word tree...
Compressed 39 of 104 nodes; 65 (62%) remaining
Writing suggestion file Xtest.latin1.sug ...
Estimated runtime memory use: 357 bytes
17 lines yanked
17 more lines
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:$put =soundfold('goobledygoook')[1;1H[19L[2;1H8[7mgood[m: [7mfoo[m [7mbar[m [7mfaabar
bad[m: [7mfoobar[m [7mbarfoo
badend


test[m output:

[7mtest[m 1-1
# [7mfile[m: [7mXtest[m.[7mlatin1[m.[7mspl[m
Comment
deol
dr
input
OK
output
outputs
outtest
put
puts[20;5H[K[21;1Htest[21;5H[K[22;1Htesten[22;7H[K[23;1Htestn[23;6H[K[24;1Hthe end
uk[25;3H[K[26;1Hwrong[26;6H[K[27;1H-------[27;8H[K[28;1H[7mbad[m[28;4H[K[29;1H['put', 'uk', 'OK']
[7minputs[m[30;7H[K[31;1H['input', 'puts', 'outputs']
[7mcomment[m[32;9H[K[33;1H['Comment', 'outtest', 'the end'][33;34H[K[34;1H[7mok[m[34;7H[K[35;1H['OK', 'uk', 'put']
[7mOk[m[36;5H[K[37;1H['OK', 'Uk', 'Put'][37;20H[K[38;1Htest[38;5H[K[39;1H['Test', 'testn', 'testen']
[7mdl[m[40;5H[K[41;1H['deol', 'dr', 'test']
[7mend[m[42;4H[K[43;1H['put', 'uk', 'test']
[7mthe[m
['put', 'uk', 'test'][45;22H[K[46;1H[7mgebletegek[m[46;11H[K[47;1H[K[46;1H
:$put =soundfold('koprnven')[1;46r[46;1H
[1;47r[46;1H[7mkepereneven[m[47;1H[K[46;1H
:$put =soundfold('oeverloos gezwets edale')[1;46r[46;1H
[1;47r[46;1H[7meverles[m [7mgesvets[m [7metele[m[47;1H[K[46;1H
:"[46;1H[47;1H[K[47;1H:"[46;1H[47;1H[K[47;1H:" and now with SAL instead of SOFO items; test automatic reloading[46;1H[m[H[2J[1;1H[7mTests[m [7mfor[m [7mspell[m [7mchecking[m.     [7mvim[m: [7mset[m [7mft[m=[7mvim[m :

[7mSTARTTEST[m
:[7mso[m [7msmall[m.[7mvim[m
:"
:" [7mDon't[m [7mwant[m [7mto[m [7mdepend[m [7mon[m [7mthe[m [7mlocale[m [7mfrom[m [7mthe[m [7menvironment[m
:[7mset[m [7menc[m=[7mlatin1[m
:[7me[m!
:"
:" [7mFunction[m [7mto[m test .[7maff[m/.[7mdic[m [7mwith[m [7mlist[m [7mof[m [7mgood[m [7mand[m [7mbad[m [7mwords[m.
:[7mfunc[m [7mTestOne[m([7maff[m, [7mdic[m)
  [7mset[m [7mspellfile[m=
  $put =''
  $put ='test '. [7ma[m:[7maff[m . '-' . [7ma[m:[7mdic[m
  " [7mGenerate[m [7ma[m .[7mspl[m [7mfile[m [7mfrom[m [7ma[m .[7mdic[m [7mand[m .[7maff[m [7mfile[m.
  [7mexe[m '1;/^' . [7ma[m:[7maff[m . '[7maffstart[m/+1,/^' . [7ma[m:[7maff[m . '[7maffend[m/-1[7mw[m! [7mXtest[m.[7maff[m'
  [7mexe[m '1;/^' . [7ma[m:[7mdic[m . '[7mdicstart[m/+1,/^' . [7ma[m:[7mdic[m . '[7mdicend[m/-1[7mw[m! [7mXtest[m.[7mdic[m'
  [7mmkspell[m! [7mXtest[m [7mXtest[m
  " [7muse[m [7mthat[m [7mspell[m [7mfile
[m  [7mset[m [7mspl[m=[7mXtest[m.[7mlatin1[m.[7mspl[m [7mspell[m
  " [7mlist[m [7mall[m [7mvalid[m [7mwords
[m  [7mspelldump[m
  %[7myank
[m  [7mquit[m
  $put
  $put ='-------'
  " [7mfind[m [7mall[m [7mbad[m [7mwords[m [7mand[m [7msuggestions[m [7mfor[m [7mthem
[m  [7mexe[m '1;/^' . [7ma[m:[7maff[m . '[7mgood[m:'
  [7mnormal[m 0[7mf[m:][7ms
[m  [7mlet[m [7mprevbad[m = ''
  [7mwhile[m 1
    [7mlet[m [[7mbad[m, [7ma[m] = [7mspellbadword[m()
    [7mif[m [7mbad[m == '' || [7mbad[m == [7mprevbad[m || [7mbad[m == '[7mbadend[m'[34;7H[7mbreak
[m    [7mendif
[m    [7mlet[m [7mprevbad[m = [7mbad
[m    [7mlet[m [7mlst[m = [7mspellsuggest[m([7mbad[m, 3)
    [7mnormal[m [7mmm[m
    $put =[7mbad[m
    $put =[7mstring[m([7mlst[m)
    [7mnormal[m `[7mm[m][7ms
[m  [7mendwhile
endfunc[m
:"
:[7mcall[m [7mTestOne[m('1', '1')
:$put =[7msoundfold[m('[7mgoobledygoook[m')[1;1H[47;1H:/^affstart_sal/+1,/^affend_sal/-1w! Xtest.aff"Xtest.aff" [47;13H[K[47;13H151 lines, 3412 characters written[1;1H[47;1H[K[47;1H:mkspell! Xtest XtestReading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - testCompressing word tree...[47;26H[K[47;1H
Compressed 29 of 127 nodes; 98 (77%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 490 bytes
Performing soundfolding...
Total number of words: 16
Number of words after soundfolding: 15
Compressing word tree...
Compressed 33 of 75 nodes; 42 (56%) remaining
Writing suggestion file Xtest.latin1.sug ...
Estimated runtime memory use: 241 bytes
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:$put =soundfold('goobledygoook')[1;1H[14L[1;1H[7mbadend


test[m output:

[7mtest[m 1-1
# [7mfile[m: [7mXtest[m.[7mlatin1[m.[7mspl[m
Comment
deol
dr
input
OK
output
outputs
outtest[15;8H[K[16;1Hput[16;4H[K[17;1Hputs[17;5H[K[18;1Htest[18;5H[K[19;1Htesten[19;7H[K[20;1Htestn[20;7H[K[21;1Hthe end[21;8H[K[22;1Huk[22;3H[K[23;1Hwrong[23;6H[K[24;1H-------
[7mbad[m[25;4H[K[26;1H['put', 'uk', 'OK']
[7minputs[m[27;7H[K[28;1H['input', 'puts', 'outputs'][28;29H[K[29;1H[7mcomment[m[29;8H[K[30;1H['Comment', 'outtest', 'the end']
[7mok[m[31;3H[K[32;1H['OK', 'uk', 'put'][32;20H[K[33;1H[7mOk[m[33;5H[K[34;1H['OK', 'Uk', 'Put']
test[35;5H[K[36;1H['Test', 'testn', 'testen']
[7mdl[m[37;5H[K[38;1H['deol', 'dr', 'test']
[7mend[m[39;5H[K[40;1H['put', 'uk', 'test']
[7mthe[m[41;5H[K[42;1H['put', 'uk', 'test']
[7mgebletegek
kepereneven
everles[m [7mgesvets[m [7metele[m[45;22H[K[46;1H[7mkbltykk[m[46;8H[K[47;1H[K[46;1H
:$put =soundfold('koprnven')[1;46r[46;1H
[1;47r[46;1H[7mkprnfn[m[47;1H[K[46;1H
:$put =soundfold('oeverloos gezwets edale')[1;46r[46;1H
[1;47r[46;1H*[7mfls[m [7mkswts[m [7mtl[m[47;1H[K[46;1H
:"[46;1H[47;1H[K[47;1H:" also use an addition file[46;1H[m[H[2J[1;1H[7mTests[m [7mfor[m [7mspell[m [7mchecking[m.     [7mvim[m: [7mset[m [7mft[m=[7mvim[m :

[7mSTARTTEST[m
:[7mso[m [7msmall[m.[7mvim[m
:"
:" [7mDon't[m [7mwant[m [7mto[m [7mdepend[m [7mon[m [7mthe[m [7mlocale[m [7mfrom[m [7mthe[m [7menvironment[m
:[7mset[m [7menc[m=[7mlatin1[m
:[7me[m!
:"
:" [7mFunction[m [7mto[m test .[7maff[m/.[7mdic[m [7mwith[m [7mlist[m [7mof[m [7mgood[m [7mand[m [7mbad[m [7mwords[m.
:[7mfunc[m [7mTestOne[m([7maff[m, [7mdic[m)
  [7mset[m [7mspellfile[m=
  $put =''
  $put ='test '. [7ma[m:[7maff[m . '-' . [7ma[m:[7mdic[m
  " [7mGenerate[m [7ma[m .[7mspl[m [7mfile[m [7mfrom[m [7ma[m .[7mdic[m [7mand[m .[7maff[m [7mfile[m.
  [7mexe[m '1;/^' . [7ma[m:[7maff[m . '[7maffstart[m/+1,/^' . [7ma[m:[7maff[m . '[7maffend[m/-1[7mw[m! [7mXtest[m.[7maff[m'
  [7mexe[m '1;/^' . [7ma[m:[7mdic[m . '[7mdicstart[m/+1,/^' . [7ma[m:[7mdic[m . '[7mdicend[m/-1[7mw[m! [7mXtest[m.[7mdic[m'
  [7mmkspell[m! [7mXtest[m [7mXtest[m
  " [7muse[m [7mthat[m [7mspell[m [7mfile
[m  [7mset[m [7mspl[m=[7mXtest[m.[7mlatin1[m.[7mspl[m [7mspell[m
  " [7mlist[m [7mall[m [7mvalid[m [7mwords
[m  [7mspelldump[m
  %[7myank
[m  [7mquit[m
  $put
  $put ='-------'
  " [7mfind[m [7mall[m [7mbad[m [7mwords[m [7mand[m [7msuggestions[m [7mfor[m [7mthem
[m  [7mexe[m '1;/^' . [7ma[m:[7maff[m . '[7mgood[m:'
  [7mnormal[m 0[7mf[m:][7ms
[m  [7mlet[m [7mprevbad[m = ''
  [7mwhile[m 1
    [7mlet[m [[7mbad[m, [7ma[m] = [7mspellbadword[m()
    [7mif[m [7mbad[m == '' || [7mbad[m == [7mprevbad[m || [7mbad[m == '[7mbadend[m'[34;7H[7mbreak
[m    [7mendif
[m    [7mlet[m [7mprevbad[m = [7mbad
[m    [7mlet[m [7mlst[m = [7mspellsuggest[m([7mbad[m, 3)
    [7mnormal[m [7mmm[m
    $put =[7mbad[m
    $put =[7mstring[m([7mlst[m)
    [7mnormal[m `[7mm[m][7ms
[m  [7mendwhile
endfunc[m
:"
:[7mcall[m [7mTestOne[m('1', '1')
:$put =[7msoundfold[m('[7mgoobledygoook[m')[1;1H[47;1H:/^addstart/+1,/^addend/-1w! Xtest.latin1.add"Xtest.latin1.add" [47;20H[K[47;20H[New File] 3 lines, 38 characters written[1;1H[47;1H[K[47;1H:mkspell! Xtest.latin1.add.spl Xtest.latin1.addReading word file Xtest.latin1.add ...[47;39H[K[47;1H
Compressing word tree...
Compressed 0 of 29 nodes; 29 (100%) remaining
Writing spell file Xtest.latin1.add.spl ...
Done!
Estimated runtime memory use: 145 bytes
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:set spellfile=Xtest.latin1.add[1;1H[6L[1;1H[7mTests[m [7mfor[m [7mspell[m [7mchecking[m.     [7mvim[m: [7mset[m [7mft[m=[7mvim[m :

[7mSTARTTEST[m
:[7mso[m [7msmall[m.[7mvim[m
:"
:" [7mDon't[m [7mwant[m [7mto[m [7mdepend[m [7mon[m [7mthe[m [7mlocale[m [7mfrom[m [7mthe[m [7menvironment[m[47;1H[K[1;1H[47;1H/^test2:[m[H[2J[1;1H[7mMAP[m 9
[7mMAP[m [7ma
MAP[m [7me
MAP[m [7mi
MAP[m [7mo
MAP[m [7mu
MAP[m [7mn
MAP[m [7mc
MAP[m [7my
MAP[m [7ms[m
2[7maffend[m

2[7mgood[m: puts
[7mbad[m: [7minputs[m [7mcomment[m [7mok[m [7mOk[m [7mend[m [7mthe[m. [7mtest[m [7mdl
badend

addstart[m
/[7mregions[m=[7musgbnz[m
elequint/2
elekwint/3
[7maddend

test2[m:
elequint test elekwint test [7melekwent[m [7masdf[m

Test [7mrules[m [7mfor[m [7mcompounding[m.

3[7maffstart
SET[m [7mISO8859-1

COMPOUNDMIN[m 3
[7mCOMPOUNDRULE[m [7mm[m*
[7mNEEDCOMPOUND[m [7mx[m
3[7maffend[m

3[7mdicstart[m
1234
[7mfoo[m/[7mm
bar[m/[7mmx
m[m/[7mm
la[m/[7mmx[m
3[7mdicend[m

3[7mgood[m: [7mfoo[m [7mm[m [7mfoobar[m [7mfoofoobar[m [7mbarfoo[m [7mbarbarfoo
bad[m: [7mbar[m [7mla[m [7mfoom[m [7mbarm[m [7mmfoo[m [7mmbar[m [7mmm[m [7mlala[m [7mmla[m [7mlam[m [7mfoola[m [7mlabar
badend[23;1H[24;29H[47;1H[m:let [str, a] = spellbadword()[24;29H[47;1H[K[47;1H:$put =str[m[H[2J[1;1Htest output:

[7mtest[m 1-1
# [7mfile[m: [7mXtest[m.[7mlatin1[m.[7mspl[m
Comment
deol
dr
input
OK
output
outputs
outtest
put
puts
test
testen
testn
the end
uk
wrong
-------
[7mbad[m
['put', 'uk', 'OK']
[7minputs[m
['input', 'puts', 'outputs']
[7mcomment[m
['Comment', 'outtest', 'the end']
[7mok[m
['OK', 'uk', 'put']
[7mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[7mdl[m
['deol', 'dr', 'test']
[7mend[m
['put', 'uk', 'test']
[7mthe[m
['put', 'uk', 'test']
[7mgebletegek
kepereneven
everles[m [7mgesvets[m [7metele
kbltykk
kprnfn[m
*[7mfls[m [7mkswts[m [7mtl
elekwent
[m:set spl=Xtest_us.latin1.spl[46;1H[47;1H[K[47;1H/^test2:[7msearch hit BOTTOM, continuing at TOP[m[H[2J[1;1H[7mMAP[m 9
[7mMAP[m [7ma
MAP[m [7me
MAP[m [7mi
MAP[m [7mo
MAP[m [7mu
MAP[m [7mn
MAP[m [7mc
MAP[m [7my
MAP[m [7ms[m
2[7maffend[m

2[7mgood[m: puts
[7mbad[m: [7minputs[m [7mcomment[m [7mok[m [7mOk[m [7mend[m [7mthe[m. [7mtest[m [7mdl
badend

addstart[m
/[7mregions[m=[7musgbnz[m
[4melequint[m/2
[4melekwint[m/3
[7maddend

test2[m:
[4melequint[m test [4melekwint[m test [7melekwent[m [7masdf[m

Test [7mrules[m [7mfor[m [7mcompounding[m.

3[7maffstart
SET[m [7mISO8859-1

COMPOUNDMIN[m 3
[7mCOMPOUNDRULE[m [7mm[m*
[7mNEEDCOMPOUND[m [7mx[m
3[7maffend[m

3[7mdicstart[m
1234
[7mfoo[m/[7mm
bar[m/[7mmx
m[m/[7mm
la[m/[7mmx[m
3[7mdicend[m

3[7mgood[m: [7mfoo[m [7mm[m [7mfoobar[m [7mfoofoobar[m [7mbarfoo[m [7mbarbarfoo
bad[m: [7mbar[m [7mla[m [7mfoom[m [7mbarm[m [7mmfoo[m [7mmbar[m [7mmm[m [7mlala[m [7mmla[m [7mlam[m [7mfoola[m [7mlabar
badend[m
[7msearch hit BOTTOM, continuing at TOP[23;1H
[m[47;1H[K[47;1H:let [str, a] = spellbadword()[24;1H[47;1H[K[47;1H:$put =str[m[H[2J[2;1H[7mtest[m 1-1
# [7mfile[m: [7mXtest[m.[7mlatin1[m.[7mspl[m
Comment
deol
dr
input
OK
output
outputs
outtest
put
puts
test
testen
testn
the end
uk
wrong
-------
[7mbad[m
['put', 'uk', 'OK']
[7minputs[m
['input', 'puts', 'outputs']
[7mcomment[m
['Comment', 'outtest', 'the end']
[7mok[m
['OK', 'uk', 'put']
[7mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[7mdl[m
['deol', 'dr', 'test']
[7mend[m
['put', 'uk', 'test']
[7mthe[m
['put', 'uk', 'test']
[7mgebletegek
kepereneven
everles[m [7mgesvets[m [7metele
kbltykk
kprnfn[m
*[7mfls[m [7mkswts[m [7mtl
elekwent[m
[4melequint[m[H[2J[1;1H[7mMAP[m [7ma
MAP[m [7me
MAP[m [7mi
MAP[m [7mo
MAP[m [7mu
MAP[m [7mn
MAP[m [7mc
MAP[m [7my
MAP[m [7ms[m
2[7maffend[m

2[7mgood[m: puts
[7mbad[m: [7minputs[m [7mcomment[m [7mok[m [7mOk[m [7mend[m [7mthe[m. [7mtest[m [7mdl
badend

addstart[m
/[7mregions[m=[7musgbnz[m
[4melequint[m/2
[4melekwint[m/3
[7maddend

test2[m:
[4melequint[m test [4melekwint[m test [7melekwent[m [7masdf[m

Test [7mrules[m [7mfor[m [7mcompounding[m.

3[7maffstart
SET[m [7mISO8859-1

COMPOUNDMIN[m 3
[7mCOMPOUNDRULE[m [7mm[m*
[7mNEEDCOMPOUND[m [7mx[m
3[7maffend[m

3[7mdicstart[m
1234
[7mfoo[m/[7mm
bar[m/[7mmx
m[m/[7mm
la[m/[7mmx[m
3[7mdicend[m

3[7mgood[m: [7mfoo[m [7mm[m [7mfoobar[m [7mfoofoobar[m [7mbarfoo[m [7mbarbarfoo
bad[m: [7mbar[m [7mla[m [7mfoom[m [7mbarm[m [7mmfoo[m [7mmbar[m [7mmm[m [7mlala[m [7mmla[m [7mlam[m [7mfoola[m [7mlabar
badend[23;1H[14C[47;1H[m:let [str, a] = spellbadword()[23;15H[47;1H[K[47;1H:$put =str[m[H[2J[1;1Htest 1-1
# [7mfile[m: [7mXtest[m.[7mlatin1[m.[7mspl[m
Comment
deol
dr
input
OK
output
outputs
outtest
put
puts
test
testen
testn
the end
uk
wrong
-------
[7mbad[m
['put', 'uk', 'OK']
[7minputs[m
['input', 'puts', 'outputs']
[7mcomment[m
['Comment', 'outtest', 'the end']
[7mok[m
['OK', 'uk', 'put']
[7mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[7mdl[m
['deol', 'dr', 'test']
[7mend[m
['put', 'uk', 'test']
[7mthe[m
['put', 'uk', 'test']
[7mgebletegek
kepereneven
everles[m [7mgesvets[m [7metele
kbltykk
kprnfn[m
*[7mfls[m [7mkswts[m [7mtl
elekwent[m
[4melequint
elekwint
[m:set spl=Xtest_gb.latin1.spl[45;1Helequint
[47;1H[K[47;1H/^test2:[7msearch hit BOTTOM, continuing at TOP[m[H[2J[1;1H[7mMAP[m 9
[7mMAP[m [7ma
MAP[m [7me
MAP[m [7mi
MAP[m [7mo
MAP[m [7mu
MAP[m [7mn
MAP[m [7mc
MAP[m [7my
MAP[m [7ms[m
2[7maffend[m

2[7mgood[m: puts
[7mbad[m: [7minputs[m [7mcomment[m [7mok[m [7mOk[m [7mend[m [7mthe[m. [7mtest[m [7mdl
badend

addstart[m
/[7mregions[m=[7musgbnz[m
elequint/2
[4melekwint[m/3
[7maddend

test2[m:
elequint test [4melekwint[m test [7melekwent[m [7masdf[m

Test [7mrules[m [7mfor[m [7mcompounding[m.

3[7maffstart
SET[m [7mISO8859-1

COMPOUNDMIN[m 3
[7mCOMPOUNDRULE[m [7mm[m*
[7mNEEDCOMPOUND[m [7mx[m
3[7maffend[m

3[7mdicstart[m
1234
[7mfoo[m/[7mm
bar[m/[7mmx
m[m/[7mm
la[m/[7mmx[m
3[7mdicend[m

3[7mgood[m: [7mfoo[m [7mm[m [7mfoobar[m [7mfoofoobar[m [7mbarfoo[m [7mbarbarfoo
bad[m: [7mbar[m [7mla[m [7mfoom[m [7mbarm[m [7mmfoo[m [7mmbar[m [7mmm[m [7mlala[m [7mmla[m [7mlam[m [7mfoola[m [7mlabar
badend[m
[7msearch hit BOTTOM, continuing at TOP[23;1H[24;15H[m[47;1H[K[47;1H:let [str, a] = spellbadword()[24;15H[47;1H[K[47;1H:$put =str[m[H[2J[1;1H# [7mfile[m: [7mXtest[m.[7mlatin1[m.[7mspl[m
Comment
deol
dr
input
OK
output
outputs
outtest
put
puts
test
testen
testn
the end
uk
wrong
-------
[7mbad[m
['put', 'uk', 'OK']
[7minputs[m
['input', 'puts', 'outputs']
[7mcomment[m
['Comment', 'outtest', 'the end']
[7mok[m
['OK', 'uk', 'put']
[7mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[7mdl[m
['deol', 'dr', 'test']
[7mend[m
['put', 'uk', 'test']
[7mthe[m
['put', 'uk', 'test']
[7mgebletegek
kepereneven
everles[m [7mgesvets[m [7metele
kbltykk
kprnfn[m
*[7mfls[m [7mkswts[m [7mtl
elekwent[m
elequint
[4melekwint
elekwint[m[H[2J[1;1H[7mMAP[m [7ma
MAP[m [7me
MAP[m [7mi
MAP[m [7mo
MAP[m [7mu
MAP[m [7mn
MAP[m [7mc
MAP[m [7my
MAP[m [7ms[m
2[7maffend[m

2[7mgood[m: puts
[7mbad[m: [7minputs[m [7mcomment[m [7mok[m [7mOk[m [7mend[m [7mthe[m. [7mtest[m [7mdl
badend

addstart[m
/[7mregions[m=[7musgbnz[m
elequint/2
[4melekwint[m/3
[7maddend

test2[m:
elequint test [4melekwint[m test [7melekwent[m [7masdf[m

Test [7mrules[m [7mfor[m [7mcompounding[m.

3[7maffstart
SET[m [7mISO8859-1

COMPOUNDMIN[m 3
[7mCOMPOUNDRULE[m [7mm[m*
[7mNEEDCOMPOUND[m [7mx[m
3[7maffend[m

3[7mdicstart[m
1234
[7mfoo[m/[7mm
bar[m/[7mmx
m[m/[7mm
la[m/[7mmx[m
3[7mdicend[m

3[7mgood[m: [7mfoo[m [7mm[m [7mfoobar[m [7mfoofoobar[m [7mbarfoo[m [7mbarbarfoo
bad[m: [7mbar[m [7mla[m [7mfoom[m [7mbarm[m [7mmfoo[m [7mmbar[m [7mmm[m [7mlala[m [7mmla[m [7mlam[m [7mfoola[m [7mlabar
badend[23;15H[14C[47;1H[m:let [str, a] = spellbadword()[23;29H[47;1H[K[47;1H:$put =str[m[H[2J[1;1HComment
deol
dr
input
OK
output
outputs
outtest
put
puts
test
testen
testn
the end
uk
wrong
-------
[7mbad[m
['put', 'uk', 'OK']
[7minputs[m
['input', 'puts', 'outputs']
[7mcomment[m
['Comment', 'outtest', 'the end']
[7mok[m
['OK', 'uk', 'put']
[7mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[7mdl[m
['deol', 'dr', 'test']
[7mend[m
['put', 'uk', 'test']
[7mthe[m
['put', 'uk', 'test']
[7mgebletegek
kepereneven
everles[m [7mgesvets[m [7metele
kbltykk
kprnfn[m
*[7mfls[m [7mkswts[m [7mtl
elekwent[m
elequint
[4melekwint
elekwint[m
[7melekwent
[m:set spl=Xtest_nz.latin1.spl[43;1H[4melequint[m
elekwint
elekwint
[47;1H[K[47;1H/^test2:[7msearch hit BOTTOM, continuing at TOP[m[H[2J[1;1H[7mMAP[m 9
[7mMAP[m [7ma
MAP[m [7me
MAP[m [7mi
MAP[m [7mo
MAP[m [7mu
MAP[m [7mn
MAP[m [7mc
MAP[m [7my
MAP[m [7ms[m
2[7maffend[m

2[7mgood[m: puts
[7mbad[m: [7minputs[m [7mcomment[m [7mok[m [7mOk[m [7mend[m [7mthe[m. [7mtest[m [7mdl
badend

addstart[m
/[7mregions[m=[7musgbnz[m
[4melequint[m/2
elekwint/3
[7maddend

test2[m:
[4melequint[m test elekwint test [7melekwent[m [7masdf[m

Test [7mrules[m [7mfor[m [7mcompounding[m.

3[7maffstart
SET[m [7mISO8859-1

COMPOUNDMIN[m 3
[7mCOMPOUNDRULE[m [7mm[m*
[7mNEEDCOMPOUND[m [7mx[m
3[7maffend[m

3[7mdicstart[m
1234
[7mfoo[m/[7mm
bar[m/[7mmx
m[m/[7mm
la[m/[7mmx[m
3[7mdicend[m

3[7mgood[m: [7mfoo[m [7mm[m [7mfoobar[m [7mfoofoobar[m [7mbarfoo[m [7mbarbarfoo
bad[m: [7mbar[m [7mla[m [7mfoom[m [7mbarm[m [7mmfoo[m [7mmbar[m [7mmm[m [7mlala[m [7mmla[m [7mlam[m [7mfoola[m [7mlabar
badend[m
[7msearch hit BOTTOM, continuing at TOP[23;1H
[m[47;1H[K[47;1H:let [str, a] = spellbadword()[24;1H[47;1H[K[47;1H:$put =str[m[H[2J[1;1Hdeol
dr
input
OK
output
outputs
outtest
put
puts
test
testen
testn
the end
uk
wrong
-------
[7mbad[m
['put', 'uk', 'OK']
[7minputs[m
['input', 'puts', 'outputs']
[7mcomment[m
['Comment', 'outtest', 'the end']
[7mok[m
['OK', 'uk', 'put']
[7mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[7mdl[m
['deol', 'dr', 'test']
[7mend[m
['put', 'uk', 'test']
[7mthe[m
['put', 'uk', 'test']
[7mgebletegek
kepereneven
everles[m [7mgesvets[m [7metele
kbltykk
kprnfn[m
*[7mfls[m [7mkswts[m [7mtl
elekwent[m
[4melequint[m
elekwint
elekwint
[7melekwent[m
[4melequint[m[H[2J[1;1H[7mMAP[m [7ma
MAP[m [7me
MAP[m [7mi
MAP[m [7mo
MAP[m [7mu
MAP[m [7mn
MAP[m [7mc
MAP[m [7my
MAP[m [7ms[m
2[7maffend[m

2[7mgood[m: puts
[7mbad[m: [7minputs[m [7mcomment[m [7mok[m [7mOk[m [7mend[m [7mthe[m. [7mtest[m [7mdl
badend

addstart[m
/[7mregions[m=[7musgbnz[m
[4melequint[m/2
elekwint/3
[7maddend

test2[m:
[4melequint[m test elekwint test [7melekwent[m [7masdf[m

Test [7mrules[m [7mfor[m [7mcompounding[m.

3[7maffstart
SET[m [7mISO8859-1

COMPOUNDMIN[m 3
[7mCOMPOUNDRULE[m [7mm[m*
[7mNEEDCOMPOUND[m [7mx[m
3[7maffend[m

3[7mdicstart[m
1234
[7mfoo[m/[7mm
bar[m/[7mmx
m[m/[7mm
la[m/[7mmx[m
3[7mdicend[m

3[7mgood[m: [7mfoo[m [7mm[m [7mfoobar[m [7mfoofoobar[m [7mbarfoo[m [7mbarbarfoo
bad[m: [7mbar[m [7mla[m [7mfoom[m [7mbarm[m [7mmfoo[m [7mmbar[m [7mmm[m [7mlala[m [7mmla[m [7mlam[m [7mfoola[m [7mlabar
badend[23;1H[28C[47;1H[m:let [str, a] = spellbadword()[23;29H[47;1H[K[47;1H:$put =str[m[H[2J[1;1Hdr
input
OK
output
outputs
outtest
put
puts
test
testen
testn
the end
uk
wrong
-------
[7mbad[m
['put', 'uk', 'OK']
[7minputs[m
['input', 'puts', 'outputs']
[7mcomment[m
['Comment', 'outtest', 'the end']
[7mok[m
['OK', 'uk', 'put']
[7mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[7mdl[m
['deol', 'dr', 'test']
[7mend[m
['put', 'uk', 'test']
[7mthe[m
['put', 'uk', 'test']
[7mgebletegek
kepereneven
everles[m [7mgesvets[m [7metele
kbltykk
kprnfn[m
*[7mfls[m [7mkswts[m [7mtl
elekwent[m
[4melequint[m
elekwint
elekwint
[7melekwent[m
[4melequint[m
[7melekwent
[m:set spl=Xtest_ca.latin1.spl[41;1H[7melequint
elekwint
elekwint

elequint
[m[47;1H[K[47;1H/^test2:[7msearch hit BOTTOM, continuing at TOP[m[H[2J[1;1H[7mMAP[m 9
[7mMAP[m [7ma
MAP[m [7me
MAP[m [7mi
MAP[m [7mo
MAP[m [7mu
MAP[m [7mn
MAP[m [7mc
MAP[m [7my
MAP[m [7ms[m
2[7maffend[m

2[7mgood[m: puts
[7mbad[m: [7minputs[m [7mcomment[m [7mok[m [7mOk[m [7mend[m [7mthe[m. [7mtest[m [7mdl
badend

addstart[m
/[7mregions[m=[7musgbnz
elequint[m/2
[7melekwint[m/3
[7maddend

test2[m:
[7melequint[m test [7melekwint[m test [7melekwent[m [7masdf[m

Test [7mrules[m [7mfor[m [7mcompounding[m.

3[7maffstart
SET[m [7mISO8859-1

COMPOUNDMIN[m 3
[7mCOMPOUNDRULE[m [7mm[m*
[7mNEEDCOMPOUND[m [7mx[m
3[7maffend[m

3[7mdicstart[m
1234
[7mfoo[m/[7mm
bar[m/[7mmx
m[m/[7mm
la[m/[7mmx[m
3[7mdicend[m

3[7mgood[m: [7mfoo[m [7mm[m [7mfoobar[m [7mfoofoobar[m [7mbarfoo[m [7mbarbarfoo
bad[m: [7mbar[m [7mla[m [7mfoom[m [7mbarm[m [7mmfoo[m [7mmbar[m [7mmm[m [7mlala[m [7mmla[m [7mlam[m [7mfoola[m [7mlabar
badend[m
[7msearch hit BOTTOM, continuing at TOP[23;1H
[m[47;1H[K[47;1H:let [str, a] = spellbadword()[24;1H[47;1H[K[47;1H:$put =str[m[H[2J[1;1Hinput
OK
output
outputs
outtest
put
puts
test
testen
testn
the end
uk
wrong
-------
[7mbad[m
['put', 'uk', 'OK']
[7minputs[m
['input', 'puts', 'outputs']
[7mcomment[m
['Comment', 'outtest', 'the end']
[7mok[m
['OK', 'uk', 'put']
[7mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[7mdl[m
['deol', 'dr', 'test']
[7mend[m
['put', 'uk', 'test']
[7mthe[m
['put', 'uk', 'test']
[7mgebletegek
kepereneven
everles[m [7mgesvets[m [7metele
kbltykk
kprnfn[m
*[7mfls[m [7mkswts[m [7mtl
elekwent
elequint
elekwint
elekwint
elekwent
elequint
elekwent
elequint[m[H[2J[1;1H[7mMAP[m [7ma
MAP[m [7me
MAP[m [7mi
MAP[m [7mo
MAP[m [7mu
MAP[m [7mn
MAP[m [7mc
MAP[m [7my
MAP[m [7ms[m
2[7maffend[m

2[7mgood[m: puts
[7mbad[m: [7minputs[m [7mcomment[m [7mok[m [7mOk[m [7mend[m [7mthe[m. [7mtest[m [7mdl
badend

addstart[m
/[7mregions[m=[7musgbnz
elequint[m/2
[7melekwint[m/3
[7maddend

test2[m:
[7melequint[m test [7melekwint[m test [7melekwent[m [7masdf[m

Test [7mrules[m [7mfor[m [7mcompounding[m.

3[7maffstart
SET[m [7mISO8859-1

COMPOUNDMIN[m 3
[7mCOMPOUNDRULE[m [7mm[m*
[7mNEEDCOMPOUND[m [7mx[m
3[7maffend[m

3[7mdicstart[m
1234
[7mfoo[m/[7mm
bar[m/[7mmx
m[m/[7mm
la[m/[7mmx[m
3[7mdicend[m

3[7mgood[m: [7mfoo[m [7mm[m [7mfoobar[m [7mfoofoobar[m [7mbarfoo[m [7mbarbarfoo
bad[m: [7mbar[m [7mla[m [7mfoom[m [7mbarm[m [7mmfoo[m [7mmbar[m [7mmm[m [7mlala[m [7mmla[m [7mlam[m [7mfoola[m [7mlabar
badend[23;1H[14C[47;1H[m:let [str, a] = spellbadword()[23;15H[47;1H[K[47;1H:$put =str[m[H[2J[1;1HOK
output
outputs
outtest
put
puts
test
testen
testn
the end
uk
wrong
-------
[7mbad[m
['put', 'uk', 'OK']
[7minputs[m
['input', 'puts', 'outputs']
[7mcomment[m
['Comment', 'outtest', 'the end']
[7mok[m
['OK', 'uk', 'put']
[7mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[7mdl[m
['deol', 'dr', 'test']
[7mend[m
['put', 'uk', 'test']
[7mthe[m
['put', 'uk', 'test']
[7mgebletegek
kepereneven
everles[m [7mgesvets[m [7metele
kbltykk
kprnfn[m
*[7mfls[m [7mkswts[m [7mtl
elekwent
elequint
elekwint
elekwint
elekwent
elequint
elekwent
elequint
elekwint
[m:"[46;1H[47;1H[K[47;1H:" Postponed prefixes[46;1H[47;1H[K[47;1H:call TestOne('2', '1')"Xtest.aff" [47;13H[K[47;13H44 lines, 447 characters written
"Xtest.dic" 11 lines, 71 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - testCompressing word tree...[47;26H[K[47;1H
Compressed 10 of 98 nodes; 88 (89%) remaining
Compressed 0 of 13 nodes; 13 (100%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 505 bytes
17 lines yanked
17 more lines
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:"[1;1H[12L[1;1H[7mSFX[m [7mN[m 0 [7men[m [^[7mn[m]
[7mSFX[m [7mN[m 0 [7mnen[m [7mn
SFX[m [7mN[m 0 [7mn[m .

[7mREP[m 3
[7mREP[m [7mg[m [7mch
REP[m [7mch[m [7mg
REP[m [7msvp[m [7ms[m.[7mv[m.[7mp[m.

[7mMAP[m 9
[7mMAP[m [7ma
MAP[m [7me
MAP[m [7mi
MAP[m [7mo
MAP[m [7mu[m[15;10H[K[16;1H[7mMAP[m [7mn
MAP[m [7mc[m[17;7H[K[18;1H[7mMAP[m [7my
MAP[m [7ms[m[19;7H[K[20;1H2[7maffend[m[21;1H[K[22;1H2[7mgood[m: puts
[7mbad[m: [7minputs[m [7mcomment[m [7mok[m [7mOk[m [7mend[m [7mthe[m. [7mtest[m [7mdl
badend[m[25;1H[K[26;1H[7maddstart[m
/[7mregions[m=[7musgbnz[m[27;16H[K[28;2H[7mlequint[m/2
[7melekwint[m/3[29;11H[K[30;1H[7maddend[m[31;1H[K[32;1H[7mtest2[m:[32;7H[K[33;1H[7melequint[m test [7melekwint[m test [7melekwent[m [7masdf[m[34;1H[K[35;1HTest [7mrules[m [7mfor[m [7mcompounding[m.[36;1H[K[37;1H3[7maffstar[m[37;10H[K[38;1H[7mSET[m [7mISO8859-1[m[39;1H[K[40;1H[7mCOMPOUNDMIN[m 3
[7mCOMPOUNDRULE[m [7mm[m*
[7mNEEDCOMPOUND[m [7mx[m
3[7maffend[m[43;8H[K[44;1H[K[45;1H3[7mdicstart[m
1234[46;5H[K[47;1H[K[24;1H[47;1H:" Compound words[24;1H[47;1H[K[47;1H:call TestOne('3', '3')"Xtest.aff" [47;13H[K[47;13H5 lines, 60 characters written
"Xtest.dic" 5 lines, 29 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - fooCompressing word tree...[47;26H[K[47;1H
Compressed 6 of 29 nodes; 23 (79%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 115 bytes
3 lines yanked
3 more lines
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:call TestOne('4', '4')"Xtest.aff" [47;13H[K[47;13H45 lines, 559 characters written
"Xtest.dic" 8 lines, 59 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - wordCompressing word tree...[47;26H[K[47;1H
Compressed 2 of 91 nodes; 89 (97%) remaining
Compressed 0 of 15 nodes; 15 (100%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 520 bytes
12 lines yanked
12 more lines
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:call TestOne('5', '5')"Xtest.aff" [47;13H[K[47;13H25 lines, 237 characters written
"Xtest.dic" 6 lines, 57 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - fooCompressing word tree...[47;26H[K[47;1H
Compressed 19 of 105 nodes; 86 (81%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 440 bytes
10 lines yanked
10 more lines
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:call TestOne('6', '6')"Xtest.aff" [47;13H[K[47;13H23 lines, 211 characters written
"Xtest.dic" 6 lines, 53 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - meeCompressing word tree...[47;26H[K[47;1H
Compressed 19 of 87 nodes; 68 (78%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 350 bytes
9 lines yanked
9 more lines
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:call TestOne('7', '7')"Xtest.aff" [47;13H[K[47;13H22 lines, 223 characters written
"Xtest.dic" 6 lines, 67 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - meeCompressing word tree...[47;26H[K[47;1H
Compressed 19 of 89 nodes; 70 (78%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 360 bytes
9 lines yanked
9 more lines
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:"[m[H[2J[1;1H[7mSFX[m 391 [7mY[m 1
[7mSFX[m 391 0 [7ma1[m .

[7mSFX[m 111 [7mY[m 1
[7mSFX[m 111 0 [7ma[m .

[7mPFX[m 17 [7mY[m 1
[7mPFX[m 17 0 [7mpre[m/432 .
7[7maffend[m

7[7mdicstart[m
1234
[7mmee[m/391,111,9999
bar/17,61003,123
lead/2
tail/123
[7mmiddle[m/77,1
7[7mdicend[m

7[7mgood[m: meea1 meea bar prebar barmeat prebarmeat  leadprebar[21;7Hlead tail leadtail  leadmiddletail
[7mbad[m: [7mmee[m [7mmeea2[m [7mprabar[m [7mprobarmaat[m [7mmiddle[m [7mleadmiddle[m [7mmiddletail[m [7mtaillead[23;9Hleadprobar
badend

Test[m [7mNOSLITSUGS[m

8[7maffstart
SET[m [7mISO8859[m-1

[7mNOSPLITSUGS[m
8[7maffend[m

8[7mdicstart[m
1234
[7mfoo[m
bar
[7mfaabar[m
8[7mdicend[m

8[7mgood[m: [7mfoo[m bar [7mfaabar
bad[m: [7mfoobar[m [7mbarfoo
badend


test[m [7moutput[m:[24;1H[47;1H:" NOSLITSUGS[24;1H[47;1H[K[47;1H:call TestOne('8', '8')"Xtest.aff" [47;13H[K[47;13H3 lines, 27 characters written
"Xtest.dic" 4 lines, 20 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - fooCompressing word tree...[47;26H[K[47;1H
Compressed 8 of 26 nodes; 18 (69%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 90 bytes
4 lines yanked
4 more lines
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:"[1;1H[11L[1;1H7[7mgood[m: [7mmeea1[m [7mmeea[m bar [7mprebar[m [7mbarmeat[m [7mprebarmeat[m  [7mleadprebar[2;7Hlead[m [7mtail[m [7mleadtail[m  [7mleadmiddletail
bad[m: [7mmee[m [7mmeea2[m [7mprabar[m [7mprobarmaat[m [7mmiddle[m [7mleadmiddle[m [7mmiddletail[m [7mtaillead[4;9Hleadprobar
badend

Test[m [7mNOSLITSUGS[m

8[7maffstart
SET[m [7mISO8859[m-1

[7mNOSPLITSUGS[m
8[7maffend[m[13;8H[K[14;1H[K[15;1H8[7mdicstart[m
1234[16;5H[K[17;1Hfoo[17;4H[K[18;1Hbar[18;4H[K[19;1Hfaabar
8[7mdicend[m[20;8H[K[21;7H[K[22;1H8[7mgood[m: foo bar faabar[22;23H[K[23;1H[7mbad[m: [7mfoobar[m [7mbarfoo[m[26;1H[K[27;1H[7mtest[m [7moutput[m:[28;1H[K[29;1H[7mtest[m 1-1[29;9H[K[30;1H# [7mfile[m: [7mXtest[m.[7mlatin1[m.[7mspl
Comment[m[31;8H[K[32;1H[7mdeol[m[32;5H[K[33;1H[7mdr
input[m[34;6H[K[35;1H[7mOK[m[35;3H[K[36;1H[7moutput
outputs
outtest
put[m[39;4H[K[40;1H[7mputs
test[m[41;5H[K[42;1H[7mtesten[m[42;7H[K[43;1H[7mtest[m[43;6H[K[44;1H[7mthe[m [7mend
uk
wrong[m[46;6H[K[47;1H[K[24;1H[m[H[2J[1;1H[7mTests[m [7mfor[m [7mspell[m [7mchecking[m.     [7mvim[m: [7mset[m [7mft[m=[7mvim[m :

[7mSTARTTEST[m
:[7mso[m [7msmall[m.[7mvim[m
:"
:" [7mDon[m'[7mt[m [7mwant[m [7mto[m [7mdepend[m [7mon[m [7mthe[m [7mlocale[m [7mfrom[m [7mthe[m [7menvironment[m
:[7mset[m [7menc[m=[7mlatin1[m
:[7me[m!
:"
:" [7mFunction[m [7mto[m [7mtest[m .[7maff[m/.[7mdic[m [7mwith[m [7mlist[m [7mof[m [7mgood[m [7mand[m [7mbad[m [7mwords[m.
:[7mfunc[m [7mTestOne[m([7maff[m, [7mdic[m)
  [7mset[m [7mspellfile[m=
  $[7mput[m =''
  $[7mput[m ='[7mtest[m '. [7ma[m:[7maff[m . '-' . [7ma[m:[7mdic[m
  " [7mGenerate[m [7ma[m .[7mspl[m [7mfile[m [7mfrom[m [7ma[m .[7mdic[m [7mand[m .[7maff[m [7mfile[m.
  [7mexe[m '1;/^' . [7ma[m:[7maff[m . '[7maffstart[m/+1,/^' . [7ma[m:[7maff[m . '[7maffend[m/-1[7mw[m! [7mXtest[m.[7maff[m'
  [7mexe[m '1;/^' . [7ma[m:[7mdic[m . '[7mdicstart[m/+1,/^' . [7ma[m:[7mdic[m . '[7mdicend[m/-1[7mw[m! [7mXtest[m.[7mdic[m'
  [7mmkspell[m! [7mXtest[m [7mXtest[m
  " [7muse[m [7mthat[m [7mspell[m [7mfile
[m  [7mset[m [7mspl[m=[7mXtest[m.[7mlatin1[m.[7mspl[m [7mspell[m
  " [7mlist[m [7mall[m [7mvalid[m [7mwords
[m  [7mspelldump[m
  %[7myank
[m  [7mquit[m
  $[7mput[m
  $[7mput[m ='-------'
  " [7mfind[m [7mall[m [7mbad[m [7mwords[m [7mand[m [7msuggestions[m [7mfor[m [7mthem
[m  [7mexe[m '1;/^' . [7ma[m:[7maff[m . '[7mgood[m:'
  [7mnormal[m 0[7mf[m:][7ms
[m  [7mlet[m [7mprevbad[m = ''
  [7mwhile[m 1
    [7mlet[m [[7mbad[m, [7ma[m] = [7mspellbadword[m()
    [7mif[m [7mbad[m == '' || [7mbad[m == [7mprevbad[m || [7mbad[m == '[7mbadend[m'[34;7H[7mbreak
[m    [7mendif
[m    [7mlet[m [7mprevbad[m = [7mbad
[m    [7mlet[m [7mlst[m = [7mspellsuggest[m([7mbad[m, 3)
    [7mnormal[m [7mmm[m
    $[7mput[m =[7mbad[m
    $[7mput[m =[7mstring[m([7mlst[m)
    [7mnormal[m `[7mm[m][7ms
[m  [7mendwhile
endfunc[m
:"
:[7mcall[m [7mTestOne[m('1', '1')
:$[7mput[m =[7msoundfold[m('[7mgoobledygoook[m')[1;1H[47;1H:/^test output:/,$wq! test.out"test.out" [47;12H[K[47;12H[New File] 283 lines, 3793 characters written[?1l>
rm -rf X* test.ok viminfo
rm -rf test59.failed test.ok test.out X* viminfo
cp test59.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test59.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test59.in" 621 lines, 10818 characters[1;1HTests for spell checking with 'encoding' set to "utf-8".  vim: set ft=vim :

STARTTEST
:so small.vim
:so mbyte.vim
:"
:" Don't want to depend on the locale from the environment.  The .aff and .dic
:" text is in latin1, the test text is utf-8.
:set enc=latin1
:e!
:set enc=utf-8
:set fenc=
:"
:" Function to test .aff/.dic with list of good and bad words.
:func TestOne(aff, dic)
  set spellfile=
  $put =''
  $put ='test '. a:aff . '-' . a:dic
  " Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
  mkspell! Xtest Xtest
  " use that spell file
  set spl=Xtest.utf-8.spl spell
  " list all valid words
  spelldump
  %yank
  quit
  $put
  $put ='-------'
  " find all bad words and suggestions for them
  exe '1;/^' . a:aff . 'good:'
  normal 0f:]s
  let prevbad = ''
  while 1
    let [bad, a] = spellbadword()
    if bad == '' || bad == prevbad || bad == 'badend'[38;7Hbreak
    endif
    let prevbad = bad
    let lst = spellsuggest(bad, 3)
    normal mm
    $put =bad
    $put =string(lst)
    normal `m]s
  endwhile[1;1H[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 101 lines, 2441 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[m[H[2J[1;1H]smm:let [str, a] = spellbadword()
:$put =str
`m]s:let [str, a] = spellbadword()
:$put =str
:set spl=Xtest_ca.utf-8.spl
/^test2:
]smm:let [str, a] = spellbadword()
:$put =str
`m]s:let [str, a] = spellbadword()
:$put =str
:"
:" Postponed prefixes
:call TestOne('2', '1')
:"
:" Compound words
:call TestOne('3', '3')
:call TestOne('4', '4')
:call TestOne('5', '5')
:call TestOne('6', '6')
:call TestOne('7', '7')
:"
gg:/^test output:/,$wq! test.out
ENDTEST

1affstart
SET ISO8859-1
TRY esianrtolcdugmphbyfvkwjkqxz-'ESIANRTOLCDUGMPHBYFVKWJKQXZ

FOL  
LOW  
UPP  

SOFOFROM abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ޿
SOFOTO   ebctefghejklnnepkrstevvkesebctefghejklnnepkrstevvkeseeeeeeeceeeeeeeedneeeeeeeeeeepseeeeeeeeceeeeeeeedneeeeeeeeeeep?

MIDWORD '-

KEP =
RAR ?
BAD !

#NOSPLITSUGS

PFX I N 1
PFX I 0 in .[23;1H
[47;1H:so! Xdotest[24;1H[47;1H[K[47;1H:so small.vim[24;1H[47;1H[K[47;1H:so mbyte.vim[24;1H[47;1H[K[47;1H:"[24;1H[47;1H[K[47;1H:" Don't want to depend on the locale from the environment.  The .aff and .dic[24;1H[47;1H[K[47;1H:" text is in latin1, the test text is utf-8.[24;1H[47;1H[K[47;1H:set enc=latin1[m[H[2J[1;1H]smm:let [str, a] = spellbadword()
:$put =str
`m]s:let [str, a] = spellbadword()
:$put =str
:set spl=Xtest_ca.utf-8.spl
/^test2:
]smm:let [str, a] = spellbadword()
:$put =str
`m]s:let [str, a] = spellbadword()
:$put =str
:"
:" Postponed prefixes
:call TestOne('2', '1')
:"
:" Compound words
:call TestOne('3', '3')
:call TestOne('4', '4')
:call TestOne('5', '5')
:call TestOne('6', '6')
:call TestOne('7', '7')
:"
gg:/^test output:/,$wq! test.out
ENDTEST

1affstart
SET ISO8859-1
TRY esianrtolcdugmphbyfvkwjkqxz-'ESIANRTOLCDUGMPHBYFVKWJKQXZ

FOL  
LOW  
UPP  

SOFOFROM abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ޿
SOFOTO   ebctefghejklnnepkrstevvkesebctefghejklnnepkrstevvkeseeeeeeeceeeeeeeedneeeeeeeeeeepseeeeeeeeceeeeeeeedneeeeeeeeeeep?

MIDWORD '-

KEP =
RAR ?
BAD !

#NOSPLITSUGS

PFX I N 1
PFX I 0 in .[24;1H[47;1H:e!"test59.in" 621 lines, 10818 characters[1;1HTests for spell checking with 'encoding' set to "utf-8".  vim: set ft=vim :[2;1H[K[3;1HSTARTTEST[3;10H[K[4;2Hso small.vim
:so mbyte.vim[5;14H[K[6;1H:"[6;3H[K[7;1H:" Don't want to depend on the locale from the environment.  The .aff and .dic
:" text is in latin1, the test text is utf-8.
:set enc=latin1[9;16H[K[10;2He![10;4H[K[11;2Hset enc=utf-8
:set fenc=[12;11H[K[13;2H"[13;3H[K[14;4HFunction to test .aff/.dic with list of good and bad words.
:func TestOne(aff, dic)
  set spellfile=[16;17H[K[17;1H  $put =''[17;11H[K[18;1H  $put ='test '. a:aff . '-' . a:dic
  " Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
  mkspell! Xtest Xtest[22;23H[K[23;1H  " use that spell file
  set spl=Xtest.utf-8.spl spell
  " list all valid words
  spelldump[26;12H[K[27;1H  %yank[27;8H[K[28;3Hquit
  $put[29;7H[K[30;1H  $put ='-------'[30;18H[K[31;1H  " find all bad words and suggestions for them
  exe '1;/^' . a:aff . 'good:'
  normal 0f:]s[33;15H[K[34;1H  let prevbad = ''[34;19H[K[35;3Hwhile 1
    let [bad, a] = spellbadword()
    if bad == '' || bad == prevbad || bad == 'badend'
      break
    endif
    let prevbad = bad
    let lst = spellsuggest(bad, 3)
    normal mm
    $put =bad
    $put =string(lst)
    normal `m]s
  endwhile[1;1H[47;1H[K[47;1H:set enc=utf-8[m[H[2J[1;1HTests for spell checking with 'encoding' set to "utf-8".  vim: set ft=vim :

STARTTEST
:so small.vim
:so mbyte.vim
:"
:" Don't want to depend on the locale from the environment.  The .aff and .dic
:" text is in latin1, the test text is utf-8.
:set enc=latin1
:e!
:set enc=utf-8
:set fenc=
:"
:" Function to test .aff/.dic with list of good and bad words.
:func TestOne(aff, dic)
  set spellfile=
  $put =''
  $put ='test '. a:aff . '-' . a:dic
  " Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
  mkspell! Xtest Xtest
  " use that spell file
  set spl=Xtest.utf-8.spl spell
  " list all valid words
  spelldump
  %yank
  quit
  $put
  $put ='-------'
  " find all bad words and suggestions for them
  exe '1;/^' . a:aff . 'good:'
  normal 0f:]s
  let prevbad = ''
  while 1
    let [bad, a] = spellbadword()
    if bad == '' || bad == prevbad || bad == 'badend'[38;7Hbreak
    endif
    let prevbad = bad
    let lst = spellsuggest(bad, 3)
    normal mm
    $put =bad
    $put =string(lst)
    normal `m]s
  endwhile[1;1H[47;1H:set fenc=[1;1H[47;1H[K[47;1H:"[1;1H[47;1H[K[47;1H:" Function to test .aff/.dic with list of good and bad words.[1;1H[47;1H[K[47;1H:func TestOne(aff, dic)
:    set spellfile=
:    $put =''
:    $put ='test '. a:aff . '-' . a:dic
:    " Generate a .spl file from a .dic and .aff file.
:    exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
:    exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
:    mkspell! Xtest Xtest
:    " use that spell file
:    set spl=Xtest.utf-8.spl spell
:    " list all valid words
:    spelldump
:    %yank
:    quit
:    $put
:    $put ='-------'
:    " find all bad words and suggestions for them
:    exe '1;/^' . a:aff . 'good:'
:    normal 0f:]s
:    let prevbad = ''
:    while 1
:        let [bad, a] = spellbadword()
:        if bad == '' || bad == prevbad || bad == 'badend'
:            break
:          endif
:        let prevbad = bad
:        let lst = spellsuggest(bad, 3)
:        normal mm
:        $put =bad
:        $put =string(lst)
:        normal `m]s
:      endwhile
:  endfunc[1;1H[32L[1;1HTests for spell checking with 'encoding' set to "utf-8".  vim: set ft=vim :

STARTTEST
:so small.vim
:so mbyte.vim
:"
:" Don't want to depend on the locale from the environment.  The .aff and .dic
:" text is in latin1, the test text is utf-8.
:set enc=latin1
:e!
:set enc=utf-8
:set fenc=
:"
:" Function to test .aff/.dic with list of good and bad words.
:func TestOne(aff, dic)
  set spellfile=
  $put =''
  $put ='test '. a:aff . '-' . a:dic
  " Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
  mkspell! Xtest Xtest
  " use that spell file
  set spl=Xtest.utf-8.spl spell
  " list all valid words
  spelldump
  %yank
  quit
  $put
  $put ='-------'
  " find all bad words and suggestions for them
  exe '1;/^' . a:aff . 'good:'[47;1H[K[1;1H[47;1H:"[1;1H[47;1H[K[47;1H:call TestOne('1', '1')"Xtest.aff" [47;13H[K[47;1H"Xtest.aff" [New File] 48 lines, 768 characters written
"Xtest.dic" "Xtest.dic" [New File] 11 lines, 71 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - testCompressing word tree...[47;26H[K[47;1H
Compressed 29 of 131 nodes; 102 (77%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 510 bytes
Reading back spell file...
Performing soundfolding...
Total number of words: 16
Number of words after soundfolding: 16
Compressing word tree...
Compressed 39 of 104 nodes; 65 (62%) remaining
Writing suggestion file Xtest.utf-8.sug ...
Estimated runtime memory use: 357 bytes
17 lines yanked
17 more lines
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:$put =soundfold('goobledygoook')[1;1H[19L[1;1H7[7mgood[m: [7mmeea1[m [7mmeeaé[m [7mbar[m [7mprebar[m [7mbarmeat[m [7mprebarmeat[m  [7mleadprebar[2;7Hlead[m [7mtail[m [7mleadtail[m  [7mleadmiddletail
bad[m: [7mmee[m [7mmeea2[m [7mprabar[m [7mprobarmaat[m [7mmiddle[m [7mleadmiddle[m [7mmiddletail[m [7mtaillead[4;9Hleadprobar
badend

test[m output:

[7mtest[m 1-1
# [7mfile[m: [7mXtest[m.[7mutf-8[m.[7mspl[m
Comment
deol
déôr
input
OK
output
outputs
outtest
put
puts[20;5H[K[21;1Htest[21;5H[K[22;1Htesten[22;7H[K[23;1Htestn[23;6H[K[24;1Hthe end[24;8H[K[25;1Huk[25;3H[K[26;1Hwrong[26;6H[K[27;1H-------
[7mbad[m[28;4H[K[29;1H['put', 'uk', 'OK']
[7minputs[m[30;8H[K[31;1H['input', 'puts', 'outputs'][31;29H[K[32;1H[7mcomment[m[32;8H[K[33;1H['Comment', 'outtest', 'the end']
[7mok[m[34;3H[K[35;1H['OK', 'uk', 'put']
[7mOk[m[36;5H[K[37;1H['OK', 'Uk', 'Put'][37;21H[K[38;1Htest[38;7H[K[39;1H['Test', 'testn', 'testen']
[7mdéôl[m[40;5H[K[41;1H['deol', 'déôr', 'test'][41;25H[K[42;1H[7mend[m[42;5H[K[43;1H['put', 'uk', 'test']
[7mthe[m[44;5H[K[45;1H['put', 'uk', 'test']
[7mgebletegek[m[47;1H[K[46;1H
:$put =soundfold('kóopërÿnôven')[1;46r[46;1H
[1;47r[46;1H[7mkepereneven[m[47;1H[K[46;1H
:$put =soundfold('oeverloos gezwets edale')[1;46r[46;1H
[1;47r[46;1H[7meverles[m [7mgesvets[m [7metele[m[47;1H[K[46;1H
:"[46;1H[47;1H[K[47;1H:"[46;1H[47;1H[K[47;1H:" and now with SAL instead of SOFO items; test automatic reloading[46;1H[m[H[2J[1;1H[7mTests[m [7mfor[m [7mspell[m [7mchecking[m [7mwith[m '[7mencoding[m' [7mset[m [7mto[m "[7mutf-8[m".  [7mvim[m: [7mset[m [7mft[m=[7mvim[m :

[7mSTARTTEST[m
:[7mso[m [7msmall[m.[7mvim[m
:[7mso[m [7mmbyte[m.[7mvim[m
:"
:" [7mDon't[m [7mwant[m [7mto[m [7mdepend[m [7mon[m [7mthe[m [7mlocale[m [7mfrom[m [7mthe[m [7menvironment[m.  [7mThe[m .[7maff[m [7mand[m .[7mdic[m
:" [7mtext[m [7mis[m [7min[m [7mlatin1[m, [7mthe[m test [7mtext[m [7mis[m [7mutf-8[m.
:[7mset[m [7menc[m=[7mlatin1[m
:[7me[m!
:[7mset[m [7menc[m=[7mutf-8[m
:[7mset[m [7mfenc[m=
:"
:" [7mFunction[m [7mto[m test .[7maff[m/.[7mdic[m [7mwith[m [7mlist[m [7mof[m [7mgood[m [7mand[m [7mbad[m [7mwords[m.
:[7mfunc[m [7mTestOne[m([7maff[m, [7mdic[m)
  [7mset[m [7mspellfile[m=
  $put =''
  $put ='test '. [7ma[m:[7maff[m . '-' . [7ma[m:[7mdic[m
  " [7mGenerate[m [7ma[m .[7mspl[m [7mfile[m [7mfrom[m [7ma[m .[7mdic[m [7mand[m .[7maff[m [7mfile[m.
  [7mexe[m '1;/^' . [7ma[m:[7maff[m . '[7maffstart[m/+1,/^' . [7ma[m:[7maff[m . '[7maffend[m/-1[7mw[m! [7mXtest[m.[7maff[m'
  [7mexe[m '1;/^' . [7ma[m:[7mdic[m . '[7mdicstart[m/+1,/^' . [7ma[m:[7mdic[m . '[7mdicend[m/-1[7mw[m! [7mXtest[m.[7mdic[m'
  [7mmkspell[m! [7mXtest[m [7mXtest[m
  " [7muse[m [7mthat[m [7mspell[m [7mfile
[m  [7mset[m [7mspl[m=[7mXtest[m.[7mutf-8[m.[7mspl[m [7mspell[m
  " [7mlist[m [7mall[m [7mvalid[m [7mwords
[m  [7mspelldump[m
  %[7myank
[m  [7mquit[m
  $put
  $put ='-------'
  " [7mfind[m [7mall[m [7mbad[m [7mwords[m [7mand[m [7msuggestions[m [7mfor[m [7mthem
[m  [7mexe[m '1;/^' . [7ma[m:[7maff[m . '[7mgood[m:'
  [7mnormal[m 0[7mf[m:][7ms
[m  [7mlet[m [7mprevbad[m = ''
  [7mwhile[m 1
    [7mlet[m [[7mbad[m, [7ma[m] = [7mspellbadword[m()
    [7mif[m [7mbad[m == '' || [7mbad[m == [7mprevbad[m || [7mbad[m == '[7mbadend[m'[38;7H[7mbreak
[m    [7mendif
[m    [7mlet[m [7mprevbad[m = [7mbad
[m    [7mlet[m [7mlst[m = [7mspellsuggest[m([7mbad[m, 3)
    [7mnormal[m [7mmm[m
    $put =[7mbad[m
    $put =[7mstring[m([7mlst[m)
    [7mnormal[m `[7mm[m][7ms
[m  [7mendwhile[1;1H[47;1H[m:/^affstart_sal/+1,/^affend_sal/-1w! Xtest.aff"Xtest.aff" [47;13H[K[47;1H"Xtest.aff" 153 lines, 3426 characters written"Xtest.aff" 153 lines, 3426 characters written[1;1H[47;1H[K[47;1H:mkspell! Xtest XtestReading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - testCompressing word tree...[47;26H[K[47;1H
Compressed 29 of 131 nodes; 102 (77%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 510 bytes
Performing soundfolding...
Total number of words: 16
Number of words after soundfolding: 15
Compressing word tree...
Compressed 33 of 75 nodes; 42 (56%) remaining
Writing suggestion file Xtest.utf-8.sug ...
Estimated runtime memory use: 241 bytes
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:$put =soundfold('goobledygoook')[1;1H[14L[1;9H[7mleadprobar
badend

test[m output:

[7mtest[m 1-1
# [7mfile[m: [7mXtest[m.[7mutf-8[m.[7mspl[m
Comment
deol
déôr
input
OK
output
outputs
outtest[15;8H[K[16;1Hput[16;4H[K[17;1Hputs[17;5H[K[18;1Htest[18;5H[K[19;1Htesten[19;7H[K[20;1Htestn[20;7H[K[21;1Hthe end[21;8H[K[22;1Huk[22;3H[K[23;1Hwrong[23;6H[K[24;1H-------[24;8H[K[25;1H[7mbad[m[25;5H[K[26;1H['put', 'uk', 'OK']
[7minputs[m[27;7H[K[28;1H['input', 'puts', 'outputs']
[7mcomment[m
['Comment', 'outtest', 'the end']
[7mok[m[31;3H[K[32;1H['OK', 'uk', 'put'][32;20H[K[33;1H[7mOk[m[33;3H[K[34;1H['OK', 'Uk', 'Put']
test[35;5H[K[36;1H['Test', 'testn', 'testen'][36;28H[K[37;1H[7mdéôl[m[37;5H[K[38;1H['deol', 'déôr', 'test']
[7mend[m[39;5H[K[40;1H['put', 'uk', 'test']
[7mthe[m[41;5H[K[42;1H['put', 'uk', 'test']
[7mgebletegek[m[43;11H[K[44;1H[7mkepereneven[m[44;12H[K[45;1H[7meverles[m [7mgesvets[m [7metele
kbltykk[m[46;8H[K[47;1H[K[46;1H
:$put =soundfold('kóopërÿnôven')[1;46r[46;1H
[1;47r[46;1H[7mkprnfn[m[47;1H[K[46;1H
:$put =soundfold('oeverloos gezwets edale')[1;46r[46;1H
[1;47r[46;1H*[7mfls[m [7mkswts[m [7mtl[m[47;1H[K[46;1H
:"[46;1H[47;1H[K[47;1H:" also use an addition file[46;1H[m[H[2J[1;1H[7mTests[m [7mfor[m [7mspell[m [7mchecking[m [7mwith[m '[7mencoding[m' [7mset[m [7mto[m "[7mutf-8[m".  [7mvim[m: [7mset[m [7mft[m=[7mvim[m :

[7mSTARTTEST[m
:[7mso[m [7msmall[m.[7mvim[m
:[7mso[m [7mmbyte[m.[7mvim[m
:"
:" [7mDon't[m [7mwant[m [7mto[m [7mdepend[m [7mon[m [7mthe[m [7mlocale[m [7mfrom[m [7mthe[m [7menvironment[m.  [7mThe[m .[7maff[m [7mand[m .[7mdic[m
:" [7mtext[m [7mis[m [7min[m [7mlatin1[m, [7mthe[m test [7mtext[m [7mis[m [7mutf-8[m.
:[7mset[m [7menc[m=[7mlatin1[m
:[7me[m!
:[7mset[m [7menc[m=[7mutf-8[m
:[7mset[m [7mfenc[m=
:"
:" [7mFunction[m [7mto[m test .[7maff[m/.[7mdic[m [7mwith[m [7mlist[m [7mof[m [7mgood[m [7mand[m [7mbad[m [7mwords[m.
:[7mfunc[m [7mTestOne[m([7maff[m, [7mdic[m)
  [7mset[m [7mspellfile[m=
  $put =''
  $put ='test '. [7ma[m:[7maff[m . '-' . [7ma[m:[7mdic[m
  " [7mGenerate[m [7ma[m .[7mspl[m [7mfile[m [7mfrom[m [7ma[m .[7mdic[m [7mand[m .[7maff[m [7mfile[m.
  [7mexe[m '1;/^' . [7ma[m:[7maff[m . '[7maffstart[m/+1,/^' . [7ma[m:[7maff[m . '[7maffend[m/-1[7mw[m! [7mXtest[m.[7maff[m'
  [7mexe[m '1;/^' . [7ma[m:[7mdic[m . '[7mdicstart[m/+1,/^' . [7ma[m:[7mdic[m . '[7mdicend[m/-1[7mw[m! [7mXtest[m.[7mdic[m'
  [7mmkspell[m! [7mXtest[m [7mXtest[m
  " [7muse[m [7mthat[m [7mspell[m [7mfile
[m  [7mset[m [7mspl[m=[7mXtest[m.[7mutf-8[m.[7mspl[m [7mspell[m
  " [7mlist[m [7mall[m [7mvalid[m [7mwords
[m  [7mspelldump[m
  %[7myank
[m  [7mquit[m
  $put
  $put ='-------'
  " [7mfind[m [7mall[m [7mbad[m [7mwords[m [7mand[m [7msuggestions[m [7mfor[m [7mthem
[m  [7mexe[m '1;/^' . [7ma[m:[7maff[m . '[7mgood[m:'
  [7mnormal[m 0[7mf[m:][7ms
[m  [7mlet[m [7mprevbad[m = ''
  [7mwhile[m 1
    [7mlet[m [[7mbad[m, [7ma[m] = [7mspellbadword[m()
    [7mif[m [7mbad[m == '' || [7mbad[m == [7mprevbad[m || [7mbad[m == '[7mbadend[m'[38;7H[7mbreak
[m    [7mendif
[m    [7mlet[m [7mprevbad[m = [7mbad
[m    [7mlet[m [7mlst[m = [7mspellsuggest[m([7mbad[m, 3)
    [7mnormal[m [7mmm[m
    $put =[7mbad[m
    $put =[7mstring[m([7mlst[m)
    [7mnormal[m `[7mm[m][7ms
[m  [7mendwhile[1;1H[47;1H[m:/^addstart/+1,/^addend/-1w! Xtest.utf-8.add"Xtest.utf-8.add" [47;19H[K[47;1H"Xtest.utf-8.add" [New File] 3 lines, 38 characters written"Xtest.utf-8.add" [New File] 3 lines, 38 characters written[1;1H[47;1H[K[47;1H:mkspell! Xtest.utf-8.add.spl Xtest.utf-8.addReading word file Xtest.utf-8.add ...[47;38H[K[47;1H
Compressing word tree...
Compressed 0 of 29 nodes; 29 (100%) remaining
Writing spell file Xtest.utf-8.add.spl ...
Done!
Estimated runtime memory use: 145 bytes
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:set spellfile=Xtest.utf-8.add[1;1H[6L[1;1H[7mTests[m [7mfor[m [7mspell[m [7mchecking[m [7mwith[m '[7mencoding[m' [7mset[m [7mto[m "[7mutf-8[m".  [7mvim[m: [7mset[m [7mft[m=[7mvim[m :

[7mSTARTTEST[m
:[7mso[m [7msmall[m.[7mvim[m
:[7mso[m [7mmbyte[m.[7mvim[m
:"[47;1H[K[1;1H[47;1H/^test2:/^test2:[m[H[2J[1;1H[7mword[m/[7mmP
util[m/[7mam
pro[m/[7mxq
tomato[m/[7mm
bork[m/[7mmp
start[m/[7ms
end[m/[7me[m
4[7mdicend[m

4[7mgood[m: [7mword[m [7mutil[m [7mbork[m [7mprebork[m [7mstart[m [7mend[m [7mwordutil[m [7mwordutils[m [7mpro-ok[11;9Hbork[m [7mborkbork[m [7mborkborkbork[m [7mborkborkborkbork[m [7mborkborkborkborkbork[12;9Htomato[m [7mtomatotomato[m [7mstartend[m [7mstartword[m [7mstartwordword[m [7mstartwordend[13;9Hstartwordwordend[m [7mstartwordwordwordend[m [7mprebork[m [7mpreborkbork[14;9Hpreborkborkbork[15;9Hnouword
bad[m: [7mwordutilize[m [7mpro[m [7mborkborkborkborkborkbork[m [7mtomatotomatotomato[17;9Hendstart[m [7mendend[m [7mstartstart[m [7mwordend[m [7mwordstart[18;9Hpreborkprebork[m  [7mpreborkpreborkbork[19;9Hstartwordwordwordwordend[m [7mborkpreborkpreborkbork[20;9Hutilsbork[m  [7mstartnouword
badend

test2[m:
elequint test elekwint test [7melekwent[m [7masdf[m

Test [7maffix[m [7mflags[m [7mwith[m [7mtwo[m [7mcharacters[m

5[7maffstart
SET[m [7mISO8859-1

FLAG[m [7mlong

NEEDAFFIX[m !!

[7mCOMPOUNDRULE[m [7mssmm[m*[7mee

NEEDCOMPOUND[m [7mxx
COMPOUNDPERMITFLAG[m [7mpp

SFX[m 13 [7mY[m 1
[7mSFX[m 13 0 [7mbork[m .

[7mSFX[m [7ma1[m [7mY[m 1
[7mSFX[m [7ma1[m 0 [7ma1[m .

[7mSFX[m [7ma[m[1m<e9>[m [7mY[m 1[23;1H[24;29H[47;1H:let [str, a] = spellbadword()[24;29H[47;1H[K[47;1H:$put =str[m[H[2J[1;1Htest output:

[7mtest[m 1-1
# [7mfile[m: [7mXtest[m.[7mutf-8[m.[7mspl[m
Comment
deol
déôr
input
OK
output
outputs
outtest
put
puts
test
testen
testn
the end
uk
wrong
-------
[7mbad[m
['put', 'uk', 'OK']
[7minputs[m
['input', 'puts', 'outputs']
[7mcomment[m
['Comment', 'outtest', 'the end']
[7mok[m
['OK', 'uk', 'put']
[7mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[7mdéôl[m
['deol', 'déôr', 'test']
[7mend[m
['put', 'uk', 'test']
[7mthe[m
['put', 'uk', 'test']
[7mgebletegek
kepereneven
everles[m [7mgesvets[m [7metele
kbltykk
kprnfn[m
*[7mfls[m [7mkswts[m [7mtl
elekwent
[m:set spl=Xtest_us.utf-8.spl[46;1H[47;1H[K[47;1H/^test2:/^test2:[7msearch hit BOTTOM, continuing at TOP[m[H[2J[1;1H[7mword[m/[7mmP
util[m/[7mam
pro[m/[7mxq
tomato[m/[7mm
bork[m/[7mmp
start[m/[7ms
end[m/[7me[m
4[7mdicend[m

4[7mgood[m: [7mword[m [7mutil[m [7mbork[m [7mprebork[m [7mstart[m [7mend[m [7mwordutil[m [7mwordutils[m [7mpro-ok[11;9Hbork[m [7mborkbork[m [7mborkborkbork[m [7mborkborkborkbork[m [7mborkborkborkborkbork[12;9Htomato[m [7mtomatotomato[m [7mstartend[m [7mstartword[m [7mstartwordword[m [7mstartwordend[13;9Hstartwordwordend[m [7mstartwordwordwordend[m [7mprebork[m [7mpreborkbork[14;9Hpreborkborkbork[15;9Hnouword
bad[m: [7mwordutilize[m [7mpro[m [7mborkborkborkborkborkbork[m [7mtomatotomatotomato[17;9Hendstart[m [7mendend[m [7mstartstart[m [7mwordend[m [7mwordstart[18;9Hpreborkprebork[m  [7mpreborkpreborkbork[19;9Hstartwordwordwordwordend[m [7mborkpreborkpreborkbork[20;9Hutilsbork[m  [7mstartnouword
badend

test2[m:
[4melequint[m test [4melekwint[m test [7melekwent[m [7masdf[m

Test [7maffix[m [7mflags[m [7mwith[m [7mtwo[m [7mcharacters[m

5[7maffstart
SET[m [7mISO8859-1

FLAG[m [7mlong

NEEDAFFIX[m !!

[7mCOMPOUNDRULE[m [7mssmm[m*[7mee

NEEDCOMPOUND[m [7mxx
COMPOUNDPERMITFLAG[m [7mpp

SFX[m 13 [7mY[m 1
[7mSFX[m 13 0 [7mbork[m .

[7mSFX[m [7ma1[m [7mY[m 1
[7mSFX[m [7ma1[m 0 [7ma1[m .

[7mSFX[m [7ma[m[1m<e9>[m [7mY[m 1
[7msearch hit BOTTOM, continuing at TOP[23;1H
[m[47;1H[K[47;1H:let [str, a] = spellbadword()[24;1H[47;1H[K[47;1H:$put =str[m[H[2J[2;1H[7mtest[m 1-1
# [7mfile[m: [7mXtest[m.[7mutf-8[m.[7mspl[m
Comment
deol
déôr
input
OK
output
outputs
outtest
put
puts
test
testen
testn
the end
uk
wrong
-------
[7mbad[m
['put', 'uk', 'OK']
[7minputs[m
['input', 'puts', 'outputs']
[7mcomment[m
['Comment', 'outtest', 'the end']
[7mok[m
['OK', 'uk', 'put']
[7mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[7mdéôl[m
['deol', 'déôr', 'test']
[7mend[m
['put', 'uk', 'test']
[7mthe[m
['put', 'uk', 'test']
[7mgebletegek
kepereneven
everles[m [7mgesvets[m [7metele
kbltykk
kprnfn[m
*[7mfls[m [7mkswts[m [7mtl
elekwent[m
[4melequint[m[H[2J[1;1H[7mutil[m/[7mam
pro[m/[7mxq
tomato[m/[7mm
bork[m/[7mmp
start[m/[7ms
end[m/[7me[m
4[7mdicend[m

4[7mgood[m: [7mword[m [7mutil[m [7mbork[m [7mprebork[m [7mstart[m [7mend[m [7mwordutil[m [7mwordutils[m [7mpro-ok[10;9Hbork[m [7mborkbork[m [7mborkborkbork[m [7mborkborkborkbork[m [7mborkborkborkborkbork[11;9Htomato[m [7mtomatotomato[m [7mstartend[m [7mstartword[m [7mstartwordword[m [7mstartwordend[12;9Hstartwordwordend[m [7mstartwordwordwordend[m [7mprebork[m [7mpreborkbork[13;9Hpreborkborkbork[14;9Hnouword
bad[m: [7mwordutilize[m [7mpro[m [7mborkborkborkborkborkbork[m [7mtomatotomatotomato[16;9Hendstart[m [7mendend[m [7mstartstart[m [7mwordend[m [7mwordstart[17;9Hpreborkprebork[m  [7mpreborkpreborkbork[18;9Hstartwordwordwordwordend[m [7mborkpreborkpreborkbork[19;9Hutilsbork[m  [7mstartnouword
badend

test2[m:
[4melequint[m test [4melekwint[m test [7melekwent[m [7masdf[m

Test [7maffix[m [7mflags[m [7mwith[m [7mtwo[m [7mcharacters[m

5[7maffstart
SET[m [7mISO8859-1

FLAG[m [7mlong

NEEDAFFIX[m !!

[7mCOMPOUNDRULE[m [7mssmm[m*[7mee

NEEDCOMPOUND[m [7mxx
COMPOUNDPERMITFLAG[m [7mpp

SFX[m 13 [7mY[m 1
[7mSFX[m 13 0 [7mbork[m .

[7mSFX[m [7ma1[m [7mY[m 1
[7mSFX[m [7ma1[m 0 [7ma1[m .

[7mSFX[m [7ma[m[1m<e9>[m [7mY[m 1
[7mSFX[m [7ma[m[1m<e9>[m 0 [7ma[m[1m<e9>[m .[23;1H[14C[47;1H:let [str, a] = spellbadword()[23;15H[47;1H[K[47;1H:$put =str[m[H[2J[1;1Htest 1-1
# [7mfile[m: [7mXtest[m.[7mutf-8[m.[7mspl[m
Comment
deol
déôr
input
OK
output
outputs
outtest
put
puts
test
testen
testn
the end
uk
wrong
-------
[7mbad[m
['put', 'uk', 'OK']
[7minputs[m
['input', 'puts', 'outputs']
[7mcomment[m
['Comment', 'outtest', 'the end']
[7mok[m
['OK', 'uk', 'put']
[7mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[7mdéôl[m
['deol', 'déôr', 'test']
[7mend[m
['put', 'uk', 'test']
[7mthe[m
['put', 'uk', 'test']
[7mgebletegek
kepereneven
everles[m [7mgesvets[m [7metele
kbltykk
kprnfn[m
*[7mfls[m [7mkswts[m [7mtl
elekwent[m
[4melequint
elekwint
[m:set spl=Xtest_gb.utf-8.spl[45;1Helequint
[47;1H[K[47;1H/^test2:/^test2:[7msearch hit BOTTOM, continuing at TOP[m[H[2J[1;1H[7mword[m/[7mmP
util[m/[7mam
pro[m/[7mxq
tomato[m/[7mm
bork[m/[7mmp
start[m/[7ms
end[m/[7me[m
4[7mdicend[m

4[7mgood[m: [7mword[m [7mutil[m [7mbork[m [7mprebork[m [7mstart[m [7mend[m [7mwordutil[m [7mwordutils[m [7mpro-ok[11;9Hbork[m [7mborkbork[m [7mborkborkbork[m [7mborkborkborkbork[m [7mborkborkborkborkbork[12;9Htomato[m [7mtomatotomato[m [7mstartend[m [7mstartword[m [7mstartwordword[m [7mstartwordend[13;9Hstartwordwordend[m [7mstartwordwordwordend[m [7mprebork[m [7mpreborkbork[14;9Hpreborkborkbork[15;9Hnouword
bad[m: [7mwordutilize[m [7mpro[m [7mborkborkborkborkborkbork[m [7mtomatotomatotomato[17;9Hendstart[m [7mendend[m [7mstartstart[m [7mwordend[m [7mwordstart[18;9Hpreborkprebork[m  [7mpreborkpreborkbork[19;9Hstartwordwordwordwordend[m [7mborkpreborkpreborkbork[20;9Hutilsbork[m  [7mstartnouword
badend

test2[m:
elequint test [4melekwint[m test [7melekwent[m [7masdf[m

Test [7maffix[m [7mflags[m [7mwith[m [7mtwo[m [7mcharacters[m

5[7maffstart
SET[m [7mISO8859-1

FLAG[m [7mlong

NEEDAFFIX[m !!

[7mCOMPOUNDRULE[m [7mssmm[m*[7mee

NEEDCOMPOUND[m [7mxx
COMPOUNDPERMITFLAG[m [7mpp

SFX[m 13 [7mY[m 1
[7mSFX[m 13 0 [7mbork[m .

[7mSFX[m [7ma1[m [7mY[m 1
[7mSFX[m [7ma1[m 0 [7ma1[m .

[7mSFX[m [7ma[m[1m<e9>[m [7mY[m 1
[7msearch hit BOTTOM, continuing at TOP[23;1H[24;15H[m[47;1H[K[47;1H:let [str, a] = spellbadword()[24;15H[47;1H[K[47;1H:$put =str[m[H[2J[1;1H# [7mfile[m: [7mXtest[m.[7mutf-8[m.[7mspl[m
Comment
deol
déôr
input
OK
output
outputs
outtest
put
puts
test
testen
testn
the end
uk
wrong
-------
[7mbad[m
['put', 'uk', 'OK']
[7minputs[m
['input', 'puts', 'outputs']
[7mcomment[m
['Comment', 'outtest', 'the end']
[7mok[m
['OK', 'uk', 'put']
[7mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[7mdéôl[m
['deol', 'déôr', 'test']
[7mend[m
['put', 'uk', 'test']
[7mthe[m
['put', 'uk', 'test']
[7mgebletegek
kepereneven
everles[m [7mgesvets[m [7metele
kbltykk
kprnfn[m
*[7mfls[m [7mkswts[m [7mtl
elekwent[m
elequint
[4melekwint
elekwint[m[H[2J[1;1H[7mutil[m/[7mam
pro[m/[7mxq
tomato[m/[7mm
bork[m/[7mmp
start[m/[7ms
end[m/[7me[m
4[7mdicend[m

4[7mgood[m: [7mword[m [7mutil[m [7mbork[m [7mprebork[m [7mstart[m [7mend[m [7mwordutil[m [7mwordutils[m [7mpro-ok[10;9Hbork[m [7mborkbork[m [7mborkborkbork[m [7mborkborkborkbork[m [7mborkborkborkborkbork[11;9Htomato[m [7mtomatotomato[m [7mstartend[m [7mstartword[m [7mstartwordword[m [7mstartwordend[12;9Hstartwordwordend[m [7mstartwordwordwordend[m [7mprebork[m [7mpreborkbork[13;9Hpreborkborkbork[14;9Hnouword
bad[m: [7mwordutilize[m [7mpro[m [7mborkborkborkborkborkbork[m [7mtomatotomatotomato[16;9Hendstart[m [7mendend[m [7mstartstart[m [7mwordend[m [7mwordstart[17;9Hpreborkprebork[m  [7mpreborkpreborkbork[18;9Hstartwordwordwordwordend[m [7mborkpreborkpreborkbork[19;9Hutilsbork[m  [7mstartnouword
badend

test2[m:
elequint test [4melekwint[m test [7melekwent[m [7masdf[m

Test [7maffix[m [7mflags[m [7mwith[m [7mtwo[m [7mcharacters[m

5[7maffstart
SET[m [7mISO8859-1

FLAG[m [7mlong

NEEDAFFIX[m !!

[7mCOMPOUNDRULE[m [7mssmm[m*[7mee

NEEDCOMPOUND[m [7mxx
COMPOUNDPERMITFLAG[m [7mpp

SFX[m 13 [7mY[m 1
[7mSFX[m 13 0 [7mbork[m .

[7mSFX[m [7ma1[m [7mY[m 1
[7mSFX[m [7ma1[m 0 [7ma1[m .

[7mSFX[m [7ma[m[1m<e9>[m [7mY[m 1
[7mSFX[m [7ma[m[1m<e9>[m 0 [7ma[m[1m<e9>[m .[23;15H[14C[47;1H:let [str, a] = spellbadword()[23;29H[47;1H[K[47;1H:$put =str[m[H[2J[1;1HComment
deol
déôr
input
OK
output
outputs
outtest
put
puts
test
testen
testn
the end
uk
wrong
-------
[7mbad[m
['put', 'uk', 'OK']
[7minputs[m
['input', 'puts', 'outputs']
[7mcomment[m
['Comment', 'outtest', 'the end']
[7mok[m
['OK', 'uk', 'put']
[7mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[7mdéôl[m
['deol', 'déôr', 'test']
[7mend[m
['put', 'uk', 'test']
[7mthe[m
['put', 'uk', 'test']
[7mgebletegek
kepereneven
everles[m [7mgesvets[m [7metele
kbltykk
kprnfn[m
*[7mfls[m [7mkswts[m [7mtl
elekwent[m
elequint
[4melekwint
elekwint[m
[7melekwent
[m:set spl=Xtest_nz.utf-8.spl[43;1H[4melequint[m
elekwint
elekwint
[47;1H[K[47;1H/^test2:/^test2:[7msearch hit BOTTOM, continuing at TOP[m[H[2J[1;1H[7mword[m/[7mmP
util[m/[7mam
pro[m/[7mxq
tomato[m/[7mm
bork[m/[7mmp
start[m/[7ms
end[m/[7me[m
4[7mdicend[m

4[7mgood[m: [7mword[m [7mutil[m [7mbork[m [7mprebork[m [7mstart[m [7mend[m [7mwordutil[m [7mwordutils[m [7mpro-ok[11;9Hbork[m [7mborkbork[m [7mborkborkbork[m [7mborkborkborkbork[m [7mborkborkborkborkbork[12;9Htomato[m [7mtomatotomato[m [7mstartend[m [7mstartword[m [7mstartwordword[m [7mstartwordend[13;9Hstartwordwordend[m [7mstartwordwordwordend[m [7mprebork[m [7mpreborkbork[14;9Hpreborkborkbork[15;9Hnouword
bad[m: [7mwordutilize[m [7mpro[m [7mborkborkborkborkborkbork[m [7mtomatotomatotomato[17;9Hendstart[m [7mendend[m [7mstartstart[m [7mwordend[m [7mwordstart[18;9Hpreborkprebork[m  [7mpreborkpreborkbork[19;9Hstartwordwordwordwordend[m [7mborkpreborkpreborkbork[20;9Hutilsbork[m  [7mstartnouword
badend

test2[m:
[4melequint[m test elekwint test [7melekwent[m [7masdf[m

Test [7maffix[m [7mflags[m [7mwith[m [7mtwo[m [7mcharacters[m

5[7maffstart
SET[m [7mISO8859-1

FLAG[m [7mlong

NEEDAFFIX[m !!

[7mCOMPOUNDRULE[m [7mssmm[m*[7mee

NEEDCOMPOUND[m [7mxx
COMPOUNDPERMITFLAG[m [7mpp

SFX[m 13 [7mY[m 1
[7mSFX[m 13 0 [7mbork[m .

[7mSFX[m [7ma1[m [7mY[m 1
[7mSFX[m [7ma1[m 0 [7ma1[m .

[7mSFX[m [7ma[m[1m<e9>[m [7mY[m 1
[7msearch hit BOTTOM, continuing at TOP[23;1H
[m[47;1H[K[47;1H:let [str, a] = spellbadword()[24;1H[47;1H[K[47;1H:$put =str[m[H[2J[1;1Hdeol
déôr
input
OK
output
outputs
outtest
put
puts
test
testen
testn
the end
uk
wrong
-------
[7mbad[m
['put', 'uk', 'OK']
[7minputs[m
['input', 'puts', 'outputs']
[7mcomment[m
['Comment', 'outtest', 'the end']
[7mok[m
['OK', 'uk', 'put']
[7mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[7mdéôl[m
['deol', 'déôr', 'test']
[7mend[m
['put', 'uk', 'test']
[7mthe[m
['put', 'uk', 'test']
[7mgebletegek
kepereneven
everles[m [7mgesvets[m [7metele
kbltykk
kprnfn[m
*[7mfls[m [7mkswts[m [7mtl
elekwent[m
[4melequint[m
elekwint
elekwint
[7melekwent[m
[4melequint[m[H[2J[1;1H[7mutil[m/[7mam
pro[m/[7mxq
tomato[m/[7mm
bork[m/[7mmp
start[m/[7ms
end[m/[7me[m
4[7mdicend[m

4[7mgood[m: [7mword[m [7mutil[m [7mbork[m [7mprebork[m [7mstart[m [7mend[m [7mwordutil[m [7mwordutils[m [7mpro-ok[10;9Hbork[m [7mborkbork[m [7mborkborkbork[m [7mborkborkborkbork[m [7mborkborkborkborkbork[11;9Htomato[m [7mtomatotomato[m [7mstartend[m [7mstartword[m [7mstartwordword[m [7mstartwordend[12;9Hstartwordwordend[m [7mstartwordwordwordend[m [7mprebork[m [7mpreborkbork[13;9Hpreborkborkbork[14;9Hnouword
bad[m: [7mwordutilize[m [7mpro[m [7mborkborkborkborkborkbork[m [7mtomatotomatotomato[16;9Hendstart[m [7mendend[m [7mstartstart[m [7mwordend[m [7mwordstart[17;9Hpreborkprebork[m  [7mpreborkpreborkbork[18;9Hstartwordwordwordwordend[m [7mborkpreborkpreborkbork[19;9Hutilsbork[m  [7mstartnouword
badend

test2[m:
[4melequint[m test elekwint test [7melekwent[m [7masdf[m

Test [7maffix[m [7mflags[m [7mwith[m [7mtwo[m [7mcharacters[m

5[7maffstart
SET[m [7mISO8859-1

FLAG[m [7mlong

NEEDAFFIX[m !!

[7mCOMPOUNDRULE[m [7mssmm[m*[7mee

NEEDCOMPOUND[m [7mxx
COMPOUNDPERMITFLAG[m [7mpp

SFX[m 13 [7mY[m 1
[7mSFX[m 13 0 [7mbork[m .

[7mSFX[m [7ma1[m [7mY[m 1
[7mSFX[m [7ma1[m 0 [7ma1[m .

[7mSFX[m [7ma[m[1m<e9>[m [7mY[m 1
[7mSFX[m [7ma[m[1m<e9>[m 0 [7ma[m[1m<e9>[m .[23;1H[28C[47;1H:let [str, a] = spellbadword()[23;29H[47;1H[K[47;1H:$put =str[m[H[2J[1;1Hdéôr
input
OK
output
outputs
outtest
put
puts
test
testen
testn
the end
uk
wrong
-------
[7mbad[m
['put', 'uk', 'OK']
[7minputs[m
['input', 'puts', 'outputs']
[7mcomment[m
['Comment', 'outtest', 'the end']
[7mok[m
['OK', 'uk', 'put']
[7mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[7mdéôl[m
['deol', 'déôr', 'test']
[7mend[m
['put', 'uk', 'test']
[7mthe[m
['put', 'uk', 'test']
[7mgebletegek
kepereneven
everles[m [7mgesvets[m [7metele
kbltykk
kprnfn[m
*[7mfls[m [7mkswts[m [7mtl
elekwent[m
[4melequint[m
elekwint
elekwint
[7melekwent[m
[4melequint[m
[7melekwent
[m:set spl=Xtest_ca.utf-8.spl[41;1H[7melequint
elekwint
elekwint

elequint
[m[47;1H[K[47;1H/^test2:/^test2:[7msearch hit BOTTOM, continuing at TOP[m[H[2J[1;1H[7mword[m/[7mmP
util[m/[7mam
pro[m/[7mxq
tomato[m/[7mm
bork[m/[7mmp
start[m/[7ms
end[m/[7me[m
4[7mdicend[m

4[7mgood[m: [7mword[m [7mutil[m [7mbork[m [7mprebork[m [7mstart[m [7mend[m [7mwordutil[m [7mwordutils[m [7mpro-ok[11;9Hbork[m [7mborkbork[m [7mborkborkbork[m [7mborkborkborkbork[m [7mborkborkborkborkbork[12;9Htomato[m [7mtomatotomato[m [7mstartend[m [7mstartword[m [7mstartwordword[m [7mstartwordend[13;9Hstartwordwordend[m [7mstartwordwordwordend[m [7mprebork[m [7mpreborkbork[14;9Hpreborkborkbork[15;9Hnouword
bad[m: [7mwordutilize[m [7mpro[m [7mborkborkborkborkborkbork[m [7mtomatotomatotomato[17;9Hendstart[m [7mendend[m [7mstartstart[m [7mwordend[m [7mwordstart[18;9Hpreborkprebork[m  [7mpreborkpreborkbork[19;9Hstartwordwordwordwordend[m [7mborkpreborkpreborkbork[20;9Hutilsbork[m  [7mstartnouword
badend

test2[m:
[7melequint[m test [7melekwint[m test [7melekwent[m [7masdf[m

Test [7maffix[m [7mflags[m [7mwith[m [7mtwo[m [7mcharacters[m

5[7maffstart
SET[m [7mISO8859-1

FLAG[m [7mlong

NEEDAFFIX[m !!

[7mCOMPOUNDRULE[m [7mssmm[m*[7mee

NEEDCOMPOUND[m [7mxx
COMPOUNDPERMITFLAG[m [7mpp

SFX[m 13 [7mY[m 1
[7mSFX[m 13 0 [7mbork[m .

[7mSFX[m [7ma1[m [7mY[m 1
[7mSFX[m [7ma1[m 0 [7ma1[m .

[7mSFX[m [7ma[m[1m<e9>[m [7mY[m 1
[7msearch hit BOTTOM, continuing at TOP[23;1H
[m[47;1H[K[47;1H:let [str, a] = spellbadword()[24;1H[47;1H[K[47;1H:$put =str[m[H[2J[1;1Hinput
OK
output
outputs
outtest
put
puts
test
testen
testn
the end
uk
wrong
-------
[7mbad[m
['put', 'uk', 'OK']
[7minputs[m
['input', 'puts', 'outputs']
[7mcomment[m
['Comment', 'outtest', 'the end']
[7mok[m
['OK', 'uk', 'put']
[7mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[7mdéôl[m
['deol', 'déôr', 'test']
[7mend[m
['put', 'uk', 'test']
[7mthe[m
['put', 'uk', 'test']
[7mgebletegek
kepereneven
everles[m [7mgesvets[m [7metele
kbltykk
kprnfn[m
*[7mfls[m [7mkswts[m [7mtl
elekwent
elequint
elekwint
elekwint
elekwent
elequint
elekwent
elequint[m[H[2J[1;1H[7mutil[m/[7mam
pro[m/[7mxq
tomato[m/[7mm
bork[m/[7mmp
start[m/[7ms
end[m/[7me[m
4[7mdicend[m

4[7mgood[m: [7mword[m [7mutil[m [7mbork[m [7mprebork[m [7mstart[m [7mend[m [7mwordutil[m [7mwordutils[m [7mpro-ok[10;9Hbork[m [7mborkbork[m [7mborkborkbork[m [7mborkborkborkbork[m [7mborkborkborkborkbork[11;9Htomato[m [7mtomatotomato[m [7mstartend[m [7mstartword[m [7mstartwordword[m [7mstartwordend[12;9Hstartwordwordend[m [7mstartwordwordwordend[m [7mprebork[m [7mpreborkbork[13;9Hpreborkborkbork[14;9Hnouword
bad[m: [7mwordutilize[m [7mpro[m [7mborkborkborkborkborkbork[m [7mtomatotomatotomato[16;9Hendstart[m [7mendend[m [7mstartstart[m [7mwordend[m [7mwordstart[17;9Hpreborkprebork[m  [7mpreborkpreborkbork[18;9Hstartwordwordwordwordend[m [7mborkpreborkpreborkbork[19;9Hutilsbork[m  [7mstartnouword
badend

test2[m:
[7melequint[m test [7melekwint[m test [7melekwent[m [7masdf[m

Test [7maffix[m [7mflags[m [7mwith[m [7mtwo[m [7mcharacters[m

5[7maffstart
SET[m [7mISO8859-1

FLAG[m [7mlong

NEEDAFFIX[m !!

[7mCOMPOUNDRULE[m [7mssmm[m*[7mee

NEEDCOMPOUND[m [7mxx
COMPOUNDPERMITFLAG[m [7mpp

SFX[m 13 [7mY[m 1
[7mSFX[m 13 0 [7mbork[m .

[7mSFX[m [7ma1[m [7mY[m 1
[7mSFX[m [7ma1[m 0 [7ma1[m .

[7mSFX[m [7ma[m[1m<e9>[m [7mY[m 1
[7mSFX[m [7ma[m[1m<e9>[m 0 [7ma[m[1m<e9>[m .[23;1H[14C[47;1H:let [str, a] = spellbadword()[23;15H[47;1H[K[47;1H:$put =str[m[H[2J[1;1HOK
output
outputs
outtest
put
puts
test
testen
testn
the end
uk
wrong
-------
[7mbad[m
['put', 'uk', 'OK']
[7minputs[m
['input', 'puts', 'outputs']
[7mcomment[m
['Comment', 'outtest', 'the end']
[7mok[m
['OK', 'uk', 'put']
[7mOk[m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[7mdéôl[m
['deol', 'déôr', 'test']
[7mend[m
['put', 'uk', 'test']
[7mthe[m
['put', 'uk', 'test']
[7mgebletegek
kepereneven
everles[m [7mgesvets[m [7metele
kbltykk
kprnfn[m
*[7mfls[m [7mkswts[m [7mtl
elekwent
elequint
elekwint
elekwint
elekwent
elequint
elekwent
elequint
elekwint
[m:"[46;1H[47;1H[K[47;1H:" Postponed prefixes[46;1H[47;1H[K[47;1H:call TestOne('2', '1')"Xtest.aff" [47;13H[K[47;1H"Xtest.aff" 46 lines, 461 characters written
"Xtest.dic" "Xtest.dic" 11 lines, 71 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - testCompressing word tree...[47;26H[K[47;1H
Compressed 10 of 102 nodes; 92 (90%) remaining
Compressed 0 of 13 nodes; 13 (100%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 525 bytes
17 lines yanked
17 more lines
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:"[1;1H[12L[1;1H# [7mcomment[m
wrong
Comment
OK
uk
put/[7mISO[m
the end
deol
d[1m<e9><f4>[mr
1[7mdicend

addstart[m
/[7mregions[m=[7musgbnz
elequint[m/2
[7melekwint[m/3[15;11H[K[16;1H[7maddend[m[17;1H[K[18;1H1[7mgood[m: wrong OK puts. Test the end
[7mbad[m:  [7minputs[m [7mcomment[m [7mok[m [7mOk[m. [7mtest[m [7mdéôl[m [7mend[m [7mthe
badend[m[21;1H[K[22;1H2[7mgood[m: puts
[7mbad[m: [7minputs[m [7mcomment[m [7mok[m [7mOk[m [7mend[m [7mthe[m. [7mtest[m [7mdéôl
badend[m[25;1H[K[26;1HTest [7mrules[m [7mfor[m [7mcompounding[m.[27;1H[K[28;1H3[7maffstart
SET[m [7mISO8859-1[m[29;15H[K[30;1H[K[31;1H[7mCOMPOUNDMIN[m 3[31;15H[K[32;1H[7mCOMPOUNDRULE[m [7mm[m*
[7mNEEDCOMPOUND[m [7mx[m
3[7maffend[m[34;9H[K[35;1H[K[36;1H3[7mdicstart[m
1234[37;6H[K[38;1H[7mfoo[m/[7mm[m[38;6H[K[39;1H[7mbar[m/[7mmx[m[39;7H[K[40;1H[7mm[m[1m<ef>[m/[7mm[m[40;8H[K[41;1H[7mla[m/[7mmx[m[41;6H[K[42;1H3[7mdicend[m[42;8H[K[43;1H[K[44;1H3[7mgood[m: [7mfoo[m [7mmï[m [7mfoobar[m [7mfoofoobar[m [7mbarfoo[m [7mbarbarfoo
bad[m: [7mbar[m [7mla[m [7mfoomï[m [7mbarmï[m [7mmïfoo[m [7mmïbar[m [7mmïmï[m [7mlala[m [7mmïla[m [7mlamï[m [7mfoola[m [7mlabar
badend[m[46;7H[K[47;1H[K[24;1H[47;1H:" Compound words[24;1H[47;1H[K[47;1H:call TestOne('3', '3')"Xtest.aff" [47;13H[K[47;1H"Xtest.aff" 5 lines, 60 characters written
"Xtest.dic" "Xtest.dic" 5 lines, 29 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - fooCompressing word tree...[47;26H[K[47;1H
Compressed 6 of 31 nodes; 25 (80%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 125 bytes
3 lines yanked
3 more lines
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:call TestOne('4', '4')"Xtest.aff" [47;13H[K[47;1H"Xtest.aff" 45 lines, 559 characters written
"Xtest.dic" "Xtest.dic" 8 lines, 59 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - wordCompressing word tree...[47;26H[K[47;1H
Compressed 2 of 91 nodes; 89 (97%) remaining
Compressed 0 of 15 nodes; 15 (100%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 520 bytes
12 lines yanked
12 more lines
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:call TestOne('5', '5')"Xtest.aff" [47;13H[K[47;1H"Xtest.aff" 25 lines, 237 characters written
"Xtest.dic" "Xtest.dic" 6 lines, 57 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - fooCompressing word tree...[47;26H[K[47;1H
Compressed 19 of 107 nodes; 88 (82%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 440 bytes
10 lines yanked
10 more lines
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:call TestOne('6', '6')"Xtest.aff" [47;13H[K[47;1H"Xtest.aff" 23 lines, 211 characters written
"Xtest.dic" "Xtest.dic" 6 lines, 53 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - meeCompressing word tree...[47;26H[K[47;1H
Compressed 19 of 89 nodes; 70 (78%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 350 bytes
9 lines yanked
9 more lines
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:call TestOne('7', '7')"Xtest.aff" [47;13H[K[47;1H"Xtest.aff" 26 lines, 338 characters written
"Xtest.dic" "Xtest.dic" 6 lines, 67 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - meeCompressing word tree...[47;26H[K[47;1H
Compressed 19 of 91 nodes; 72 (79%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 360 bytes
9 lines yanked
9 more lines
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:"[m[H[2J[1;1H[7mSFX[m 391 [7mY[m 1
[7mSFX[m 391 0 [7ma1[m .

[7mSFX[m 111 [7mY[m 1
[7mSFX[m 111 0 [7ma[m[1m<e9>[m .

[7mPFX[m 17 [7mY[m 1
[7mPFX[m 17 0 [7mpre[m/432 .
7[7maffend[m

7[7mdicstart[m
1234
[7mmee[m/391,111,9999
bar/17,61003,123
lead/2
tail/123
[7mmiddle[m/77,1
7[7mdicend[m

7[7mgood[m: meea1 meeaé bar prebar barmeat prebarmeat  leadprebar[21;7Hlead tail leadtail  leadmiddletail
[7mbad[m: [7mmee[m [7mmeea2[m [7mprabar[m [7mprobarmaat[m [7mmiddle[m [7mleadmiddle[m [7mmiddletail[m [7mtaillead[23;9Hleadprobar
badend

test[m [7moutput[m:

[7mtest[m 1-1
# [7mfile[m: [7mXtest[m.[7mutf[m-8.[7mspl
Comment
deol
déôr
input
OK
output
outputs
outtest
put
puts
test
testen
testn
the[m [7mend
uk
wrong[m
-------[24;1H[m[H[2J[1;1H[7mTests[m [7mfor[m [7mspell[m [7mchecking[m [7mwith[m '[7mencoding[m' [7mset[m [7mto[m "[7mutf[m-8".  [7mvim[m: [7mset[m [7mft[m=[7mvim[m :

[7mSTARTTEST[m
:[7mso[m [7msmall[m.[7mvim[m
:[7mso[m [7mmbyte[m.[7mvim[m
:"
:" [7mDon[m'[7mt[m [7mwant[m [7mto[m [7mdepend[m [7mon[m [7mthe[m [7mlocale[m [7mfrom[m [7mthe[m [7menvironment[m.  [7mThe[m .[7maff[m [7mand[m .[7mdic[m
:" [7mtext[m [7mis[m [7min[m [7mlatin1[m, [7mthe[m [7mtest[m [7mtext[m [7mis[m [7mutf[m-8.
:[7mset[m [7menc[m=[7mlatin1[m
:[7me[m!
:[7mset[m [7menc[m=[7mutf[m-8
:[7mset[m [7mfenc[m=
:"
:" [7mFunction[m [7mto[m [7mtest[m .[7maff[m/.[7mdic[m [7mwith[m [7mlist[m [7mof[m [7mgood[m [7mand[m [7mbad[m [7mwords[m.
:[7mfunc[m [7mTestOne[m([7maff[m, [7mdic[m)
  [7mset[m [7mspellfile[m=
  $[7mput[m =''
  $[7mput[m ='[7mtest[m '. [7ma[m:[7maff[m . '-' . [7ma[m:[7mdic[m
  " [7mGenerate[m [7ma[m .[7mspl[m [7mfile[m [7mfrom[m [7ma[m .[7mdic[m [7mand[m .[7maff[m [7mfile[m.
  [7mexe[m '1;/^' . [7ma[m:[7maff[m . '[7maffstart[m/+1,/^' . [7ma[m:[7maff[m . '[7maffend[m/-1[7mw[m! [7mXtest[m.[7maff[m'
  [7mexe[m '1;/^' . [7ma[m:[7mdic[m . '[7mdicstart[m/+1,/^' . [7ma[m:[7mdic[m . '[7mdicend[m/-1[7mw[m! [7mXtest[m.[7mdic[m'
  [7mmkspell[m! [7mXtest[m [7mXtest[m
  " [7muse[m [7mthat[m [7mspell[m [7mfile
[m  [7mset[m [7mspl[m=[7mXtest[m.[7mutf[m-8.[7mspl[m [7mspell[m
  " [7mlist[m [7mall[m [7mvalid[m [7mwords
[m  [7mspelldump[m
  %[7myank
[m  [7mquit[m
  $[7mput[m
  $[7mput[m ='-------'
  " [7mfind[m [7mall[m [7mbad[m [7mwords[m [7mand[m [7msuggestions[m [7mfor[m [7mthem
[m  [7mexe[m '1;/^' . [7ma[m:[7maff[m . '[7mgood[m:'
  [7mnormal[m 0[7mf[m:][7ms
[m  [7mlet[m [7mprevbad[m = ''
  [7mwhile[m 1
    [7mlet[m [[7mbad[m, [7ma[m] = [7mspellbadword[m()
    [7mif[m [7mbad[m == '' || [7mbad[m == [7mprevbad[m || [7mbad[m == '[7mbadend[m'[38;7H[7mbreak
[m    [7mendif
[m    [7mlet[m [7mprevbad[m = [7mbad
[m    [7mlet[m [7mlst[m = [7mspellsuggest[m([7mbad[m, 3)
    [7mnormal[m [7mmm[m
    $[7mput[m =[7mbad[m
    $[7mput[m =[7mstring[m([7mlst[m)
    [7mnormal[m `[7mm[m][7ms
[m  [7mendwhile[1;1H[47;1H[m:/^test output:/,$wq! test.out"test.out" [47;12H[K[47;1H"test.out" [New File] 270 lines, 3685 characters written[?1l>
rm -rf X* test.ok viminfo
rm -rf test60.failed test.ok test.out X* viminfo
cp test60.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test60.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test60.in" 577 lines, 12425 characters[1;1HTests for the exists() function.  vim: set ft=vim :

STARTTEST
:so small.vim
:function! RunTest(str, result)
    if exists(a:str) == a:result[7;9Hecho "OK"
    else[9;9Hecho "FAILED: Checking for " . a:str
    endif
endfunction
:function! TestExists()
    augroup myagroup[14;9Hautocmd! BufEnter *.my echo 'myfile edited'
    augroup END[17;5Hlet test_cases = [][19;5H" valid autocmd group
    let test_cases += [['#myagroup', 1]]
    " valid autocmd group with garbage
    let test_cases += [['#myagroup+b', 0]]
    " Valid autocmd group and event
    let test_cases += [['#myagroup#BufEnter', 1]]
    " Valid autocmd group, event and pattern
    let test_cases += [['#myagroup#BufEnter#*.my', 1]]
    " Valid autocmd event
    let test_cases += [['#BufEnter', 1]]
    " Valid autocmd event and pattern
    let test_cases += [['#BufEnter#*.my', 1]]
    " Non-existing autocmd group or event
    let test_cases += [['#xyzagroup', 0]]
    " Non-existing autocmd group and valid autocmd event
    let test_cases += [['#xyzagroup#BufEnter', 0]]
    " Valid autocmd group and event with no matching pattern
    let test_cases += [['#myagroup#CmdwinEnter', 0]]
    " Valid autocmd group and non-existing autocmd event
    let test_cases += [['#myagroup#xyzacmd', 0]]
    " Valid autocmd group and event and non-matching pattern
    let test_cases += [['#myagroup#BufEnter#xyzpat', 0]]
    " Valid autocmd event and non-matching pattern
    let test_cases += [['#BufEnter#xyzpat', 0]]
    " Empty autocmd group, event and pattern
    let test_cases += [['###', 0]]
    " Empty autocmd group and event or empty event and pattern
    let test_cases += [['##', 0]][1;1H[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 572 lines, 12353 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[m[H[2J[1;5Helse[2;9Hecho "FAILED"
    endif[5;5H" Function arguments
    function TestFuncArg(func_arg, ...)[7;9Hecho 'a:func_arg: 1'[8;9Hif exists('a:func_arg')[9;13Hecho "OK"[10;9Helse[11;13Hecho "FAILED"[12;9Hendif[14;9Hecho 'a:non_exists_arg: 0'[15;9Hif !exists('a:non_exists_arg')[16;13Hecho "OK"[17;9Helse[18;13Hecho "FAILED"[19;9Hendif[21;9Hecho 'a:1: 1'[22;9Hif exists('a:1')[23;13Hecho "OK"[24;9Helse[25;13Hecho "FAILED"[26;9Hendif[28;9Hecho 'a:2: 0'[29;9Hif !exists('a:2')[30;13Hecho "OK"[31;9Helse[32;13Hecho "FAILED"[33;9Hendif
    endfunction[36;5Hcall TestFuncArg("arg1", "arg2")[38;5Hredir END
endfunction
:call TestExists()
:edit! test.out
:set ff=unix
:w
:qa!
ENDTEST

:so! Xdotest[46;1H[47;1H[K[47;1H:so small.vim[46;1H[47;1H[K[47;1H:function! RunTest(str, result)
:      if exists(a:str) == a:result
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED: Checking for " . a:str
:        endif
:  endfunction[1;1H[6L[1;5Helse[2;9Hecho "FAILED"
    endif[5;5H" Function arguments
    function TestFuncArg(func_arg, ...)[47;1H[K[46;1H
:function! TestExists()
:      augroup myagroup
:  [1m^I[mautocmd! BufEnter *.my echo 'myfile edited'
:      augroup END
:  
:      let test_cases = []
:  
:      " valid autocmd group
:      let test_cases += [['#myagroup', 1]]
:      " valid autocmd group with garbage
:      let test_cases += [['#myagroup+b', 0]]
:      " Valid autocmd group and event
:      let test_cases += [['#myagroup#BufEnter', 1]]
:      " Valid autocmd group, event and pattern
:      let test_cases += [['#myagroup#BufEnter#*.my', 1]]
:      " Valid autocmd event
:      let test_cases += [['#BufEnter', 1]]
:      " Valid autocmd event and pattern
:      let test_cases += [['#BufEnter#*.my', 1]]
:      " Non-existing autocmd group or event
:      let test_cases += [['#xyzagroup', 0]]
:      " Non-existing autocmd group and valid autocmd event
:      let test_cases += [['#xyzagroup#BufEnter', 0]]
:      " Valid autocmd group and event with no matching pattern
:      let test_cases += [['#myagroup#CmdwinEnter', 0]]
:      " Valid autocmd group and non-existing autocmd event
:      let test_cases += [['#myagroup#xyzacmd', 0]]
:      " Valid autocmd group and event and non-matching pattern
:      let test_cases += [['#myagroup#BufEnter#xyzpat', 0]]
:      " Valid autocmd event and non-matching pattern
:      let test_cases += [['#BufEnter#xyzpat', 0]]
:      " Empty autocmd group, event and pattern
:      let test_cases += [['###', 0]]
:      " Empty autocmd group and event or empty event and pattern
:      let test_cases += [['##', 0]]
:      " Valid autocmd event
:      let test_cases += [['##FileReadCmd', 1]]
:      " Non-existing autocmd event
:      let test_cases += [['##MySpecialCmd', 0]]
:  
:      " Existing and working option (long form)
:      let test_cases += [['&textwidth', 1]]
:      " Existing and working option (short form)
:      let test_cases += [['&tw', 1]]
:      " Existing and working option with garbage
:      let test_cases += [['&tw-', 0]]
:      " Global option
:      let test_cases += [['&g:errorformat', 1]]
:      " Local option
:      let test_cases += [['&l:errorformat', 1]]
:      " Negative form of existing and working option (long form)
:      let test_cases += [['&nojoinspaces', 0]]
:      " Negative form of existing and working option (short form)
:      let test_cases += [['&nojs', 0]]
:      " Non-existing option
:      let test_cases += [['&myxyzoption', 0]]
:  
:      " Existing and working option (long form)
:      let test_cases += [['+incsearch', 1]]
:      " Existing and working option with garbage
:      let test_cases += [['+incsearch!1', 0]]
:      " Existing and working option (short form)
:      let test_cases += [['+is', 1]]
:      " Existing option that is hidden.
:      let test_cases += [['+autoprint', 0]]
:  
:      " Existing environment variable
:      let $EDITOR_NAME = 'Vim Editor'
:      let test_cases += [['$EDITOR_NAME', 1]]
:      " Non-existing environment variable
:      let test_cases += [['$NON_ENV_VAR', 0]]
:  
:      " Valid internal function
:      let test_cases += [['*bufnr', 1]]
:      " Valid internal function with ()
:      let test_cases += [['*bufnr()', 1]]
:      " Non-existing internal function
:      let test_cases += [['*myxyzfunc', 0]]
:      " Valid internal function with garbage
:      let test_cases += [['*bufnr&6', 0]]
:  
:      " Valid user defined function
:      let test_cases += [['*TestExists', 1]]
:      " Non-existing user defined function
:      let test_cases += [['*MyxyzFunc', 0]]
:  
:      redir! > test.out
:  
:      for [test_case, result] in test_cases
:          [1m^I[mecho test_case . ": " . result
:            call RunTest(test_case, result)
:        endfor
:  
:      " Valid internal command (full match)
:      echo ':edit: 2'
:      if exists(':edit') == 2
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Valid internal command (full match) with garbage
:      echo ':edit/a: 0'
:      if exists(':edit/a') == 0
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Valid internal command (partial match)
:      echo ':q: 1'
:      if exists(':q') == 1
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Non-existing internal command
:      echo ':invalidcmd: 0'
:      if !exists(':invalidcmd')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " User defined command (full match)
:      command! MyCmd :echo 'My command'
:      echo ':MyCmd: 2'
:      if exists(':MyCmd') == 2
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " User defined command (partial match)
:      command! MyOtherCmd :echo 'Another command'
:      echo ':My: 3'
:      if exists(':My') == 3
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Command modifier
:      echo ':rightbelow: 2'
:      if exists(':rightbelow') == 2
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Non-existing user defined command (full match)
:      delcommand MyCmd
:  
:      echo ':MyCmd: 0'
:      if !exists(':MyCmd')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Non-existing user defined command (partial match)
:      delcommand MyOtherCmd
:  
:      echo ':My: 0'
:      if !exists(':My')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Valid local variable
:      let local_var = 1
:      echo 'local_var: 1'
:      if exists('local_var')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Valid local variable with garbage
:      let local_var = 1
:      echo 'local_var%n: 0'
:      if !exists('local_var%n')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Non-existing local variable
:      unlet local_var
:      echo 'local_var: 0'
:      if !exists('local_var')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Valid local list
:      let local_list = ["blue", "orange"]
:      echo 'local_list: 1'
:      if exists('local_list')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Valid local list item
:      echo 'local_list[1]: 1'
:      if exists('local_list[1]')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Valid local list item with garbage
:      echo 'local_list[1]+5: 0'
:      if !exists('local_list[1]+5')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Invalid local list item
:      echo 'local_list[2]: 0'
:      if !exists('local_list[2]')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Non-existing local list
:      unlet local_list
:      echo 'local_list: 0'
:      if !exists('local_list')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Valid local dictionary
:      let local_dict = {"xcord":100, "ycord":2}
:      echo 'local_dict: 1'
:      if exists('local_dict')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Non-existing local dictionary
:      unlet local_dict
:      echo 'local_dict: 0'
:      if !exists('local_dict')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Existing local curly-brace variable
:      let str = "local"
:      let curly_{str}_var = 1
:      echo 'curly_' . str . '_var: 1'
:      if exists('curly_{str}_var')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Non-existing local curly-brace variable
:      unlet curly_{str}_var
:      echo 'curly_' . str . '_var: 0'
:      if !exists('curly_{str}_var')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:  
:      " Existing global variable
:      let g:global_var = 1
:      echo 'g:global_var: 1'
:      if exists('g:global_var')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Existing global variable with garbage
:      echo 'g:global_var-n: 1'
:      if !exists('g:global_var-n')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Non-existing global variable
:      unlet g:global_var
:      echo 'g:global_var: 0'
:      if !exists('g:global_var')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Existing global list
:      let g:global_list = ["blue", "orange"]
:      echo 'g:global_list: 1'
:      if exists('g:global_list')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Non-existing global list
:      unlet g:global_list
:      echo 'g:global_list: 0'
:      if !exists('g:global_list')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Existing global dictionary
:      let g:global_dict = {"xcord":100, "ycord":2}
:      echo 'g:global_dict: 1'
:      if exists('g:global_dict')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Non-existing global dictionary
:      unlet g:global_dict
:      echo 'g:global_dict: 0'
:      if !exists('g:global_dict')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Existing global curly-brace variable
:      let str = "global"
:      let g:curly_{str}_var = 1
:      echo 'g:curly_' . str . '_var: 1'
:      if exists('g:curly_{str}_var')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Non-existing global curly-brace variable
:      unlet g:curly_{str}_var
:      echo 'g:curly_' . str . '_var: 0'
:      if !exists('g:curly_{str}_var')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Existing window variable
:      echo 'w:window_var: 1'
:      let w:window_var = 1
:      if exists('w:window_var')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Non-existing window variable
:      unlet w:window_var
:      echo 'w:window_var: 0'
:      if !exists('w:window_var')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Existing window list
:      let w:window_list = ["blue", "orange"]
:      echo 'w:window_list: 1'
:      if exists('w:window_list')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Non-existing window list
:      unlet w:window_list
:      echo 'w:window_list: 0'
:      if !exists('w:window_list')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Existing window dictionary
:      let w:window_dict = {"xcord":100, "ycord":2}
:      echo 'w:window_dict: 1'
:      if exists('w:window_dict')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Non-existing window dictionary
:      unlet w:window_dict
:      echo 'w:window_dict: 0'
:      if !exists('w:window_dict')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Existing window curly-brace variable
:      let str = "window"
:      let w:curly_{str}_var = 1
:      echo 'w:curly_' . str . '_var: 1'
:      if exists('w:curly_{str}_var')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Non-existing window curly-brace variable
:      unlet w:curly_{str}_var
:      echo 'w:curly_' . str . '_var: 0'
:      if !exists('w:curly_{str}_var')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Existing buffer variable
:      echo 'b:buffer_var: 1'
:      let b:buffer_var = 1
:      if exists('b:buffer_var')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Non-existing buffer variable
:      unlet b:buffer_var
:      echo 'b:buffer_var: 0'
:      if !exists('b:buffer_var')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Existing buffer list
:      let b:buffer_list = ["blue", "orange"]
:      echo 'b:buffer_list: 1'
:      if exists('b:buffer_list')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Non-existing buffer list
:      unlet b:buffer_list
:      echo 'b:buffer_list: 0'
:      if !exists('b:buffer_list')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Existing buffer dictionary
:      let b:buffer_dict = {"xcord":100, "ycord":2}
:      echo 'b:buffer_dict: 1'
:      if exists('b:buffer_dict')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Non-existing buffer dictionary
:      unlet b:buffer_dict
:      echo 'b:buffer_dict: 0'
:      if !exists('b:buffer_dict')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Existing buffer curly-brace variable
:      let str = "buffer"
:      let b:curly_{str}_var = 1
:      echo 'b:curly_' . str . '_var: 1'
:      if exists('b:curly_{str}_var')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Non-existing buffer curly-brace variable
:      unlet b:curly_{str}_var
:      echo 'b:curly_' . str . '_var: 0'
:      if !exists('b:curly_{str}_var')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Script-local tests
:      source test60.vim
:  
:      " Existing Vim internal variable
:      echo 'v:version: 1'
:      if exists('v:version')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Non-existing Vim internal variable
:      echo 'v:non_exists_var: 0'
:      if !exists('v:non_exists_var')
:    [1m^I[mecho "OK"
:        else
:    [1m^I[mecho "FAILED"
:        endif
:  
:      " Function arguments
:      function TestFuncArg(func_arg, ...)
:            echo 'a:func_arg: 1'
:            if exists('a:func_arg')
:                  echo "OK"
:              else
:                  echo "FAILED"
:              endif
:    
:            echo 'a:non_exists_arg: 0'
:            if !exists('a:non_exists_arg')
:                  echo "OK"
:              else
:                  echo "FAILED"
:              endif
:    
:            echo 'a:1: 1'
:            if exists('a:1')
:                  echo "OK"
:              else
:                  echo "FAILED"
:              endif
:    
:            echo 'a:2: 0'
:            if !exists('a:2')
:                  echo "OK"
:              else
:                  echo "FAILED"
:              endif
:        endfunction
:    
:        call TestFuncArg("arg1", "arg2")
:    
:        redir END
:    endfunction[m[H[2J[1;5Helse[2;9Hecho "FAILED"
    endif[5;5H" Function arguments
    function TestFuncArg(func_arg, ...)[7;9Hecho 'a:func_arg: 1'[8;9Hif exists('a:func_arg')[9;13Hecho "OK"[10;9Helse[11;13Hecho "FAILED"[12;9Hendif[14;9Hecho 'a:non_exists_arg: 0'[15;9Hif !exists('a:non_exists_arg')[16;13Hecho "OK"[17;9Helse[18;13Hecho "FAILED"[19;9Hendif[21;9Hecho 'a:1: 1'[22;9Hif exists('a:1')[23;13Hecho "OK"[24;9Helse[25;13Hecho "FAILED"[26;9Hendif[28;9Hecho 'a:2: 0'[29;9Hif !exists('a:2')[30;13Hecho "OK"[31;9Helse[32;13Hecho "FAILED"[33;9Hendif
    endfunction[36;5Hcall TestFuncArg("arg1", "arg2")[38;5Hredir END
endfunction
:call TestExists()
:edit! test.out
:set ff=unix
:w
:qa!
ENDTEST

:call TestExists()#myagroup: 1[47;13H[K[47;1H
OK
#myagroup+b: 0
OK
#myagroup#BufEnter: 1
OK
#myagroup#BufEnter#*.my: 1
OK
#BufEnter: 1
OK
#BufEnter#*.my: 1
OK
#xyzagroup: 0
OK
#xyzagroup#BufEnter: 0
OK
#myagroup#CmdwinEnter: 0
OK
#myagroup#xyzacmd: 0
OK
#myagroup#BufEnter#xyzpat: 0
OK
#BufEnter#xyzpat: 0
OK
###: 0
OK
##: 0
OK
##FileReadCmd: 1
OK
##MySpecialCmd: 0
OK
&textwidth: 1
OK
&tw: 1
OK
&tw-: 0
OK
&g:errorformat: 1
OK
&l:errorformat: 1
OK
&nojoinspaces: 0
OK
&nojs: 0
OK
&myxyzoption: 0
OK
+incsearch: 1
OK
+incsearch!1: 0
OK
+is: 1
OK
+autoprint: 0
OK
$EDITOR_NAME: 1
OK
$NON_ENV_VAR: 0
OK
*bufnr: 1
OK
*bufnr(): 1
OK
*myxyzfunc: 0
OK
*bufnr&6: 0
OK
*TestExists: 1
OK
*MyxyzFunc: 0
OK
:edit: 2
OK
:edit/a: 0
OK
:q: 1
OK
:invalidcmd: 0
OK
:MyCmd: 2
OK
:My: 3
OK
:rightbelow: 2
OK
:MyCmd: 0
OK
:My: 0
OK
local_var: 1
OK
local_var%n: 0
OK
local_var: 0
OK
local_list: 1
OK
local_list[1]: 1
OK
local_list[1]+5: 0
OK
local_list[2]: 0
OK
local_list: 0
OK
local_dict: 1
OK
local_dict: 0
OK
curly_local_var: 1
OK
curly_local_var: 0
OK
g:global_var: 1
OK
g:global_var-n: 1
OK
g:global_var: 0
OK
g:global_list: 1
OK
g:global_list: 0
OK
g:global_dict: 1
OK
g:global_dict: 0
OK
g:curly_global_var: 1
OK
g:curly_global_var: 0
OK
w:window_var: 1
OK
w:window_var: 0
OK
w:window_list: 1
OK
w:window_list: 0
OK
w:window_dict: 1
OK
w:window_dict: 0
OK
w:curly_window_var: 1
OK
w:curly_window_var: 0
OK
b:buffer_var: 1
OK
b:buffer_var: 0
OK
b:buffer_list: 1
OK
b:buffer_list: 0
OK
b:buffer_dict: 1
OK
b:buffer_dict: 0
OK
b:curly_buffer_var: 1
OK
b:curly_buffer_var: 0
OK
s:script_var: 1
OK
s:script_var: 0
OK
s:script_list: 1
OK
s:script_list: 0
OK
s:script_dict: 1
OK
s:script_dict: 0
OK
s:curly_script_var: 1
OK
s:curly_script_var: 0
OK
*s:my_script_func: 1
OK
*s:my_script_func: 0
OK
v:version: 1
OK
v:non_exists_var: 0
OK
a:func_arg: 1
OK
a:non_exists_arg: 0
OK
a:1: 1
OK
a:2: 0
OK
[7mPress ENTER or type command to continue[m[47;1H[K[47;1H:edit! test.out"test.out" [47;12H[K[47;12H[Incomplete last line] 197 lines, 1844 characters[m[H[2J[2;1H#myagroup: 1
OK
#myagroup+b: 0
OK
#myagroup#BufEnter: 1
OK
#myagroup#BufEnter#*.my: 1
OK
#BufEnter: 1
OK
#BufEnter#*.my: 1
OK
#xyzagroup: 0
OK
#xyzagroup#BufEnter: 0
OK
#myagroup#CmdwinEnter: 0
OK
#myagroup#xyzacmd: 0
OK
#myagroup#BufEnter#xyzpat: 0
OK
#BufEnter#xyzpat: 0
OK
###: 0
OK
##: 0
OK
##FileReadCmd: 1
OK
##MySpecialCmd: 0
OK
&textwidth: 1
OK
&tw: 1
OK
&tw-: 0
OK
&g:errorformat: 1
OK
&l:errorformat: 1
OK
&nojoinspaces: 0
OK
&nojs: 0
"test.out" [Incomplete last line] 197 lines, 1844 characters[1;1H[47;1H[K[47;1H:set ff=unix[1;1H[47;1H[K[47;1H:w"test.out" 197 lines, 1845 characters written[1;1H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test61.failed test.ok test.out X* viminfo
cp test61.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test61.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test61.in" 59 lines, 1011 characters[1;1HTests for undo tree.
Since this script is sourced we need to explicitly break changes up in
undo-able pieces.  Do that by setting 'undolevels'.

STARTTEST
:" Delete three characters and undo
Gx:set ul=100
x:set ul=100
x:.w! test.out
g-:.w >>test.out
g-:.w >>test.out
g-:.w >>test.out
g-:.w >>test.out
:"
:/^111/w >>test.out
:" Delete three other characters and go back in time step by step
$x:set ul=100
x:set ul=100
x:.w >>test.out
:sleep 1
g-:.w >>test.out
g-:.w >>test.out
g-:.w >>test.out
g-:.w >>test.out
g-:.w >>test.out
g-:.w >>test.out
g-:.w >>test.out
g-:.w >>test.out
10g+:.w >>test.out
:"
:/^222/w >>test.out
:" Delay for three seconds and go some seconds forward and backward
:sleep 2
Aa[1m^[[m:set ul=100
Ab[1m^[[m:set ul=100
Ac[1m^[[m:set ul=100
:.w >>test.out
:ear 1s
:.w >>test.out
:ear 3s
:.w >>test.out
:later 1s
:.w >>test.out
:later 1h
:.w >>test.out
:"[1;1H[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[5;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[6;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 48 lines, 814 characters written[6;1H[47;1H[K[47;1H:set ff& cpo+=A[6;1H[47;1H/ENDTEST[47;10H[K[47;1H[1;46r[1;1H[8M[1;47r[39;1H:" test undojoin
Goaaaa[1m^[[m:set ul=100
obbbb[1m^[[mu:.w >>test.out
obbbb[1m^[[m:set ul=100
:undojoin
occcc[1m^[[mu:.w >>test.out
:qa!
ENDTEST[47;1H[K[46;1H[1;46r[46;1H
[1;47r[46;1H
:so! Xdotest[46;1H[47;1H[K[47;1H:" Delete three characters and undo[46;1H[1;46r[1;1H[4M[1;47r[43;1H1111 -----
2222 -----

123456789[47;1H[K[46;1H23456789[46;9H[K[46;1H
:set ul=100[46;1H3456789[46;8H[K[46;1H[47;1H[K[47;1H:set ul=100[46;1H456789[46;7H[K[46;1H[47;1H[K[47;1H:.w! test.out"test.out" [47;12H[K[47;12H[New File] 1 line, 7 characters written[46;1H
1 change; before #3  0 seconds ago[47;35H[K[46;1H3456789[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 8 characters appended[46;1H
1 change; before #2  0 seconds ago[47;35H[K[46;1H23456789[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 9 characters appended[46;1H
1 change; before #1  0 seconds ago[47;35H[K[46;1H123456789[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 10 characters appended[46;1H
Already at oldest change[47;25H[K[46;1H[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 10 characters appended[46;1H[47;1H[K[47;1H:"[46;1H[47;1H[K[47;1H:/^111/w >>test.out[7msearch hit BOTTOM, continuing at TOP[m"test.out" [47;12H[K[47;12H1 line, 11 characters appended[46;1H[47;1H[K[47;1H:" Delete three other characters and go back in time step by step[46;1H[8C[46;9H[K[46;8H[47;1H[K[47;1H:set ul=100[46;8H[46;8H[K[46;7H[47;1H[K[47;1H:set ul=100[46;7H[46;7H[K[46;6H[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 7 characters appended[46;6H[47;1H[K[47;1H:sleep 1[46;6H
1 change; before #6  1 seconds ago[46;7H7[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 8 characters appended[46;7H
1 change; before #5  1 seconds ago[47;35H[K[46;8H8[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 9 characters appended[46;8H
4 changes; after #3  1 seconds ago[47;35H[K[46;1H456789[46;7H[K[46;1H[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 7 characters appended[46;1H
1 change; before #3  1 seconds ago[47;35H[K[46;1H3456789[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 8 characters appended[46;1H
1 change; before #2  1 seconds ago[47;35H[K[46;1H23456789[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 9 characters appended[46;1H
1 change; before #1  1 seconds ago[47;35H[K[46;1H123456789[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 10 characters appended[46;1H
Already at oldest change[47;25H[K[46;1H[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 10 characters appended[46;1H
Already at oldest change[47;25H[K[46;1H[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 10 characters appended[46;1H
3 changes; after #6  1 seconds ago[47;35H[K[46;7H[K[46;6H[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 7 characters appended[46;6H[47;1H[K[47;1H:"[46;6H[47;1H[K[47;1H:/^222/w >>test.out[7msearch hit BOTTOM, continuing at TOP[m"test.out" [47;12H[K[47;12H1 line, 11 characters appended[46;6H[47;1H[K[47;1H:" Delay for three seconds and go some seconds forward and backward[46;6H[47;1H[K[47;1H:sleep 2[46;6H6a[47;1H[K[47;1H:set ul=100[46;7Hab[47;1H[K[47;1H:set ul=100[46;8Hbc[47;1H[K[47;1H:set ul=100[46;9H[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 10 characters appended[46;9H[47;1H[K[47;1H:ear 1s3 changes; before #7  0 seconds ago[46;7H[K[46;6H[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 7 characters appended[46;6H[47;1H[K[47;1H:ear 3s3 changes; before #1  3 seconds ago[46;7H789[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 10 characters appended[46;9H[47;1H[K[47;1H:later 1s3 changes; after #6  3 seconds ago[46;7H[K[46;6H[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 7 characters appended[46;6H[47;1H[K[47;1H:later 1h3 changes; after #9  0 seconds ago[46;7Habc[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 10 characters appended[46;9H[47;1H[K[47;1H:"[46;9H[47;1H[K[47;1H:" test undojoin[46;9H[1;46r[46;1H
[1;47r[46;1Haaaa[47;1H[K[46;4H
:set ul=100[46;4H[1;46r[46;1H
[1;47r[46;1Hbbbb[47;1H[K[46;4H
1 line less; before #11  0 seconds ago[46;2H[K[46;1H[1m~[45;4H[m[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 5 characters appended[45;4H
bbbb[47;1H[K[47;1H:set ul=100[46;4H[47;1H[K[47;1H:undojoin[46;4H[1;46r[46;1H
[1;47r[46;1Hcccc[47;1H[K[46;4H
2 fewer lines; before #12  0 seconds ago[45;2H[K[45;1H[1m~[m[46;2H[K[46;1H[1m~[44;4H[m[47;1H[K[47;1H:.w >>test.out"test.out" [47;12H[K[47;12H1 line, 5 characters appended[44;4H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo
rm -rf test62.failed test.ok test.out X* viminfo
cp test62.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up
../vim -u unix.vim -U NONE --noplugin -s dotest.in test62.in
Vim: Warning: Output is not to a terminal
[?1h=[1;47r[m[H[2J[47;1H"test62.in" 32 lines, 522 characters[1;1HTests for tab pages

STARTTEST
:so small.vim
:" Simple test for opening and closing a tab page
:tabnew
:let nr = tabpagenr()
:q
:call append(line('$'), 'tab page ' . nr)
:"
:" Open three tab pages and use ":tabdo"
:0tabnew
:1tabnew
:888tabnew
:tabdo call append(line('$'), 'this is tab page ' . tabpagenr())
:tabclose! 2
:tabrewind
:let line1 = getline('$')
:undo
:q
:tablast
:let line2 = getline('$')
:q!
:call append(line('$'), line1)
:call append(line('$'), line2)
:"
:"
:/^Results/,$w! test.out
:qa!
ENDTEST

Results:
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~[1;1H[m[47;1H[K[47;1H:set cp[1;1H[47;1H[K[47;1H:map dotest /^STARTTEST^[1m^M[mj:set ff=unix cpo-=A^[1m^M[m:.,/ENDTEST/-1w! Xdotest^[1m^M[m:set ff& cpo+=A^[1m^M[mnj0:so! Xdotest^[1m^M[mdotest[1;1H[47;1H[K[47;1H/^STARTTEST[3;1H
[47;1H[K[47;1H:set ff=unix cpo-=A[4;1H[47;1H[K[47;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [47;11H[K[47;11H[New File] 26 lines, 473 characters written[4;1H[47;1H[K[47;1H:set ff& cpo+=A[4;1H[47;1H/ENDTEST[47;10H[K[47;1H[30;1H
[47;1H[K[47;1H:so! Xdotest[31;1H[47;1H[K[47;1H:so small.vim[31;1H[47;1H[K[47;1H:" Simple test for opening and closing a tab page[31;1H[47;1H[K[47;1H:tabnew[m[H[2J[1;1H[4m test62.in [m[1m| [No Name] [m[7m________________________________________________________________________________________________________[m[1;127H[4mX[m[3;1H[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[2;1H[47;1H[m:let nr = tabpagenr()[2;1H[47;1H[K[47;1H:q[m[H[2J[1;1HTests for tab pages

STARTTEST
:so small.vim
:" Simple test for opening and closing a tab page
:tabnew
:let nr = tabpagenr()
:q
:call append(line('$'), 'tab page ' . nr)
:"
:" Open three tab pages and use ":tabdo"
:0tabnew
:1tabnew
:888tabnew
:tabdo call append(line('$'), 'this is tab page ' . tabpagenr())
:tabclose! 2
:tabrewind
:let line1 = getline('$')
:undo
:q
:tablast
:let line2 = getline('$')
:q!
:call append(line('$'), line1)
:call append(line('$'), line2)
:"
:"
:/^Results/,$w! test.out
:qa!
ENDTEST

Results:
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~[31;1H[47;1H[m:call append(line('$'), 'tab page ' . nr)[33;1Htab page 2[31;1H[47;1H[K[47;1H:"[31;1H[47;1H[K[47;1H:" Open three tab pages and use ":tabdo"[31;1H[47;1H[K[47;1H:0tabnew[m[H[2J[1;1H[1m [No Name] |[m[4m + test62.in [m[7m______________________________________________________________________________________________________[m[1;127H[4mX[m[3;1H[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[2;1H[47;1H[m:1tabnew[m[H[2J[1;1H[4m [No Name] [m[1m| [No Name] |[m[4m + test62.in [m[7m__________________________________________________________________________________________[m[1;127H[4mX[m[3;1H[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[2;1H[47;1H[m:888tabnew[m[H[2J[1;1H[4m [No Name] | [No Name] | + test62.in [m[1m| [No Name] [m[7m______________________________________________________________________________[m[1;127H[4mX[m[3;1H[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[2;1H[47;1H[m:tabdo call append(line('$'), 'this is tab page ' . tabpagenr())[m[H[2J[1;1H[4m + [No Name] | + [No Name] | + test62.in [m[1m| + [No Name] [m[7m________________________________________________________________________[m[1;127H[4mX[m[3;1Hthis is tab page 4
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[2;1H[47;1H[m:tabclose! 2[1;18H[4mtest62.in[m[1C[1m| + [No Name] [m[7m______________[71C_[m[1;127H[4mX[2;1H[m[47;1H[K[47;1H:tabrewind[m[H[2J[1;1H[1m + [No Name] |[m[4m + test62.in | + [No Name] [m[7m______________________________________________________________________________________[m[1;127H[4mX[m[3;1Hthis is tab page 1
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[2;1H[47;1H[m:let line1 = getline('$')[2;1H[47;1H[K[47;1H:undo2 fewer lines; before #1  0 seconds ago[1;2H[1m[No Name] |[m[4m + test62.in | + [No Name] [m[7m__[85C_[m[1;127H[4mX[m[3;2H[K[3;1H[1m~[2;1H[m[47;1H[K[47;1H:q[m[H[2J[1;1H[1m + test62.in |[m[4m + [No Name] [m[7m____________________________________________________________________________________________________[m[1;127H[4mX[m[2;1HTests for tab pages

STARTTEST
:so small.vim
:" Simple test for opening and closing a tab page
:tabnew
:let nr = tabpagenr()
:q
:call append(line('$'), 'tab page ' . nr)
:"
:" Open three tab pages and use ":tabdo"
:0tabnew
:1tabnew
:888tabnew
:tabdo call append(line('$'), 'this is tab page ' . tabpagenr())
:tabclose! 2
:tabrewind
:let line1 = getline('$')
:undo
:q
:tablast
:let line2 = getline('$')
:q!
:call append(line('$'), line1)
:call append(line('$'), line2)
:"
:"
:/^Results/,$w! test.out
:qa!
ENDTEST

Results:
tab page 2
this is tab page 3
[1m~
~
~
~
~
~
~
~
~
~
~[32;1H[47;1H[m:tablast[m[H[2J[1;1H[4m + test62.in [m[1m| + [No Name] [m[7m____________________________________________________________________________________________________[m[1;127H[4mX[m[3;1Hthis is tab page 4
[1m~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[2;1H[47;1H[m:let line2 = getline('$')[2;1H[47;1H[K[47;1H:q![m[H[2J[1;1HTests for tab pages

STARTTEST
:so small.vim
:" Simple test for opening and closing a tab page
:tabnew
:let nr = tabpagenr()
:q
:call append(line('$'), 'tab page ' . nr)
:"
:" Open three tab pages and use ":tabdo"
:0tabnew
:1tabnew
:888tabnew
:tabdo call append(line('$'), 'this is tab page ' . tabpagenr())
:tabclose! 2
:tabrewind
:let line1 = getline('$')
:undo
:q
:tablast
:let line2 = getline('$')
:q!
:call append(line('$'), line1)
:call append(line('$'), line2)
:"
:"
:/^Results/,$w! test.out
:qa!
ENDTEST

Results:
tab page 2
this is tab page 3
[1m~
~
~
~
~
~
~
~
~
~
~
~[31;1H[47;1H[m:call append(line('$'), line1)[35;1Hthis is tab page 1[31;1H[47;1H[K[47;1H:call append(line('$'), line2)[36;1Hthis is tab page 4[31;1H[47;1H[K[47;1H:"[31;1H[47;1H[K[47;1H:"[31;1H[47;1H[K[47;1H:/^Results/,$w! test.out"test.out" [47;12H[K[47;12H[New File] 5 lines, 77 characters written[31;1H[47;1H[K[47;1H:qa![?1l>[47;1H[K[47;1Hrm -rf X* test.ok viminfo

Test results:
ALL DONE
make[2]: Leaving directory `/sources/vim70/src/testdir'
make[1]: Leaving directory `/sources/vim70/src'
